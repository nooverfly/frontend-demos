(function (r, n) {
  typeof exports == "object" && typeof module != "undefined"
    ? (module.exports = n())
    : typeof define == "function" && define.amd
    ? define(n)
    : ((r = typeof globalThis != "undefined" ? globalThis : r || self),
      (r.Loca = n()));
})(this, function () {
  "use strict";
  var runtime = { exports: {} };
  function _instanceof$8(r, n) {
    return n != null && typeof Symbol != "undefined" && n[Symbol.hasInstance]
      ? !!n[Symbol.hasInstance](r)
      : r instanceof n;
  }
  (function (r) {
    var n = (function (i) {
      var s = function (E, k, D) {
          return (
            Object.defineProperty(E, k, {
              value: D,
              enumerable: !0,
              configurable: !0,
              writable: !0,
            }),
            E[k]
          );
        },
        a = function (E, k, D, q) {
          var J = k && _instanceof$8(k.prototype, l) ? k : l,
            de = Object.create(J.prototype),
            we = new g(q || []);
          return (de._invoke = p(E, D, we)), de;
        },
        o = function (E, k, D) {
          try {
            return { type: "normal", arg: E.call(k, D) };
          } catch (q) {
            return { type: "throw", arg: q };
          }
        },
        l = function () {},
        u = function () {},
        f = function () {},
        c = function (E) {
          ["next", "throw", "return"].forEach(function (k) {
            s(E, k, function (D) {
              return this._invoke(k, D);
            });
          });
        },
        h = function (E, k) {
          function D(de, we, Se, He) {
            var et = o(E[de], E, we);
            if (et.type === "throw") He(et.arg);
            else {
              var Ke = et.arg,
                Fe = Ke.value;
              return Fe && typeof Fe == "object" && b.call(Fe, "__await")
                ? k.resolve(Fe.__await).then(
                    function (qe) {
                      D("next", qe, Se, He);
                    },
                    function (qe) {
                      D("throw", qe, Se, He);
                    }
                  )
                : k.resolve(Fe).then(
                    function (qe) {
                      (Ke.value = qe), Se(Ke);
                    },
                    function (qe) {
                      return D("throw", qe, Se, He);
                    }
                  );
            }
          }
          var q;
          function J(de, we) {
            function Se() {
              return new k(function (He, et) {
                D(de, we, He, et);
              });
            }
            return (q = q ? q.then(Se, Se) : Se());
          }
          this._invoke = J;
        },
        p = function (E, k, D) {
          var q = W;
          return function (de, we) {
            if (q === j) throw new Error("Generator is already running");
            if (q === L) {
              if (de === "throw") throw we;
              return y();
            }
            for (D.method = de, D.arg = we; ; ) {
              var Se = D.delegate;
              if (Se) {
                var He = w(Se, D);
                if (He) {
                  if (He === T) continue;
                  return He;
                }
              }
              if (D.method === "next") D.sent = D._sent = D.arg;
              else if (D.method === "throw") {
                if (q === W) throw ((q = L), D.arg);
                D.dispatchException(D.arg);
              } else D.method === "return" && D.abrupt("return", D.arg);
              q = j;
              var et = o(E, k, D);
              if (et.type === "normal") {
                if (((q = D.done ? L : Z), et.arg === T)) continue;
                return { value: et.arg, done: D.done };
              } else
                et.type === "throw" &&
                  ((q = L), (D.method = "throw"), (D.arg = et.arg));
            }
          };
        },
        d = function (E) {
          var k = { tryLoc: E[0] };
          1 in E && (k.catchLoc = E[1]),
            2 in E && ((k.finallyLoc = E[2]), (k.afterLoc = E[3])),
            this.tryEntries.push(k);
        },
        m = function (E) {
          var k = E.completion || {};
          (k.type = "normal"), delete k.arg, (E.completion = k);
        },
        g = function (E) {
          (this.tryEntries = [{ tryLoc: "root" }]),
            E.forEach(d, this),
            this.reset(!0);
        },
        v = function (E) {
          if (E) {
            var k = E[I];
            if (k) return k.call(E);
            if (typeof E.next == "function") return E;
            if (!isNaN(E.length)) {
              var D = -1,
                q = function J() {
                  for (; ++D < E.length; )
                    if (b.call(E, D)) return (J.value = E[D]), (J.done = !1), J;
                  return (J.value = S), (J.done = !0), J;
                };
              return (q.next = q);
            }
          }
          return { next: y };
        },
        y = function () {
          return { value: S, done: !0 };
        },
        _ = Object.prototype,
        b = _.hasOwnProperty,
        S,
        P = typeof Symbol == "function" ? Symbol : {},
        I = P.iterator || "@@iterator",
        F = P.asyncIterator || "@@asyncIterator",
        X = P.toStringTag || "@@toStringTag";
      try {
        s({}, "");
      } catch (O) {
        s = function (k, D, q) {
          return (k[D] = q);
        };
      }
      i.wrap = a;
      var W = "suspendedStart",
        Z = "suspendedYield",
        j = "executing",
        L = "completed",
        T = {},
        A = {};
      s(A, I, function () {
        return this;
      });
      var $ = Object.getPrototypeOf,
        R = $ && $($(v([])));
      R && R !== _ && b.call(R, I) && (A = R);
      var M = (f.prototype = l.prototype = Object.create(A));
      (u.prototype = f),
        s(M, "constructor", f),
        s(f, "constructor", u),
        (u.displayName = s(f, X, "GeneratorFunction")),
        (i.isGeneratorFunction = function (O) {
          var E = typeof O == "function" && O.constructor;
          return E
            ? E === u || (E.displayName || E.name) === "GeneratorFunction"
            : !1;
        }),
        (i.mark = function (O) {
          return (
            Object.setPrototypeOf
              ? Object.setPrototypeOf(O, f)
              : ((O.__proto__ = f), s(O, X, "GeneratorFunction")),
            (O.prototype = Object.create(M)),
            O
          );
        }),
        (i.awrap = function (O) {
          return { __await: O };
        }),
        c(h.prototype),
        s(h.prototype, F, function () {
          return this;
        }),
        (i.AsyncIterator = h),
        (i.async = function (O, E, k, D, q) {
          q === void 0 && (q = Promise);
          var J = new h(a(O, E, k, D), q);
          return i.isGeneratorFunction(E)
            ? J
            : J.next().then(function (de) {
                return de.done ? de.value : J.next();
              });
        });
      function w(O, E) {
        var k = O.iterator[E.method];
        if (k === S) {
          if (((E.delegate = null), E.method === "throw")) {
            if (
              O.iterator.return &&
              ((E.method = "return"),
              (E.arg = S),
              w(O, E),
              E.method === "throw")
            )
              return T;
            (E.method = "throw"),
              (E.arg = new TypeError(
                "The iterator does not provide a 'throw' method"
              ));
          }
          return T;
        }
        var D = o(k, O.iterator, E.arg);
        if (D.type === "throw")
          return (E.method = "throw"), (E.arg = D.arg), (E.delegate = null), T;
        var q = D.arg;
        if (!q)
          return (
            (E.method = "throw"),
            (E.arg = new TypeError("iterator result is not an object")),
            (E.delegate = null),
            T
          );
        if (q.done)
          (E[O.resultName] = q.value),
            (E.next = O.nextLoc),
            E.method !== "return" && ((E.method = "next"), (E.arg = S));
        else return q;
        return (E.delegate = null), T;
      }
      return (
        c(M),
        s(M, X, "Generator"),
        s(M, I, function () {
          return this;
        }),
        s(M, "toString", function () {
          return "[object Generator]";
        }),
        (i.keys = function (O) {
          var E = [];
          for (var k in O) E.push(k);
          return (
            E.reverse(),
            function D() {
              for (; E.length; ) {
                var q = E.pop();
                if (q in O) return (D.value = q), (D.done = !1), D;
              }
              return (D.done = !0), D;
            }
          );
        }),
        (i.values = v),
        (g.prototype = {
          constructor: g,
          reset: function (E) {
            if (
              ((this.prev = 0),
              (this.next = 0),
              (this.sent = this._sent = S),
              (this.done = !1),
              (this.delegate = null),
              (this.method = "next"),
              (this.arg = S),
              this.tryEntries.forEach(m),
              !E)
            )
              for (var k in this)
                k.charAt(0) === "t" &&
                  b.call(this, k) &&
                  !isNaN(+k.slice(1)) &&
                  (this[k] = S);
          },
          stop: function () {
            this.done = !0;
            var E = this.tryEntries[0],
              k = E.completion;
            if (k.type === "throw") throw k.arg;
            return this.rval;
          },
          dispatchException: function (E) {
            var k = function (et, Ke) {
              return (
                (de.type = "throw"),
                (de.arg = E),
                (D.next = et),
                Ke && ((D.method = "next"), (D.arg = S)),
                !!Ke
              );
            };
            if (this.done) throw E;
            for (var D = this, q = this.tryEntries.length - 1; q >= 0; --q) {
              var J = this.tryEntries[q],
                de = J.completion;
              if (J.tryLoc === "root") return k("end");
              if (J.tryLoc <= this.prev) {
                var we = b.call(J, "catchLoc"),
                  Se = b.call(J, "finallyLoc");
                if (we && Se) {
                  if (this.prev < J.catchLoc) return k(J.catchLoc, !0);
                  if (this.prev < J.finallyLoc) return k(J.finallyLoc);
                } else if (we) {
                  if (this.prev < J.catchLoc) return k(J.catchLoc, !0);
                } else if (Se) {
                  if (this.prev < J.finallyLoc) return k(J.finallyLoc);
                } else
                  throw new Error("try statement without catch or finally");
              }
            }
          },
          abrupt: function (E, k) {
            for (var D = this.tryEntries.length - 1; D >= 0; --D) {
              var q = this.tryEntries[D];
              if (
                q.tryLoc <= this.prev &&
                b.call(q, "finallyLoc") &&
                this.prev < q.finallyLoc
              ) {
                var J = q;
                break;
              }
            }
            J &&
              (E === "break" || E === "continue") &&
              J.tryLoc <= k &&
              k <= J.finallyLoc &&
              (J = null);
            var de = J ? J.completion : {};
            return (
              (de.type = E),
              (de.arg = k),
              J
                ? ((this.method = "next"), (this.next = J.finallyLoc), T)
                : this.complete(de)
            );
          },
          complete: function (E, k) {
            if (E.type === "throw") throw E.arg;
            return (
              E.type === "break" || E.type === "continue"
                ? (this.next = E.arg)
                : E.type === "return"
                ? ((this.rval = this.arg = E.arg),
                  (this.method = "return"),
                  (this.next = "end"))
                : E.type === "normal" && k && (this.next = k),
              T
            );
          },
          finish: function (E) {
            for (var k = this.tryEntries.length - 1; k >= 0; --k) {
              var D = this.tryEntries[k];
              if (D.finallyLoc === E)
                return this.complete(D.completion, D.afterLoc), m(D), T;
            }
          },
          catch: function (O) {
            for (var E = this.tryEntries.length - 1; E >= 0; --E) {
              var k = this.tryEntries[E];
              if (k.tryLoc === O) {
                var D = k.completion;
                if (D.type === "throw") {
                  var q = D.arg;
                  m(k);
                }
                return q;
              }
            }
            throw new Error("illegal catch attempt");
          },
          delegateYield: function (E, k, D) {
            return (
              (this.delegate = { iterator: v(E), resultName: k, nextLoc: D }),
              this.method === "next" && (this.arg = S),
              T
            );
          },
        }),
        i
      );
    })(r.exports);
    try {
      regeneratorRuntime = n;
    } catch (i) {
      typeof globalThis == "object"
        ? (globalThis.regeneratorRuntime = n)
        : Function("r", "regeneratorRuntime = r")(n);
    }
  })(runtime);
  var regeneratorRuntime$1 = runtime.exports,
    commonjsGlobal =
      typeof globalThis != "undefined"
        ? globalThis
        : typeof window != "undefined"
        ? window
        : typeof global != "undefined"
        ? global
        : typeof self != "undefined"
        ? self
        : {};
  function getAugmentedNamespace(r) {
    var n = r.default;
    if (typeof n == "function") {
      var i = function () {
        return n.apply(this, arguments);
      };
      i.prototype = n.prototype;
    } else i = {};
    return (
      Object.defineProperty(i, "__esModule", { value: !0 }),
      Object.keys(r).forEach(function (s) {
        var a = Object.getOwnPropertyDescriptor(r, s);
        Object.defineProperty(
          i,
          s,
          a.get
            ? a
            : {
                enumerable: !0,
                get: function () {
                  return r[s];
                },
              }
        );
      }),
      i
    );
  }
  var lbsLocaLayers_umd_tmp$1 = { exports: {} },
    uaParser = { exports: {} };
  function _instanceof$7(r, n) {
    return n != null && typeof Symbol != "undefined" && n[Symbol.hasInstance]
      ? !!n[Symbol.hasInstance](r)
      : r instanceof n;
  }
  var _typeof$5 = function (r) {
      return r && typeof Symbol != "undefined" && r.constructor === Symbol
        ? "symbol"
        : typeof r;
    },
    hasRequiredUaParser;
  function requireUaParser() {
    return (
      hasRequiredUaParser ||
        ((hasRequiredUaParser = 1),
        (function (r, n) {
          (function (i, s) {
            var a = "0.7.31",
              o = "",
              l = "?",
              u = "function",
              f = "undefined",
              c = "object",
              h = "string",
              p = "major",
              d = "model",
              m = "name",
              g = "type",
              v = "vendor",
              y = "version",
              _ = "architecture",
              b = "console",
              S = "mobile",
              P = "tablet",
              I = "smarttv",
              F = "wearable",
              X = "embedded",
              W = 255,
              Z = "Amazon",
              j = "Apple",
              L = "ASUS",
              T = "BlackBerry",
              A = "Browser",
              $ = "Chrome",
              R = "Edge",
              M = "Firefox",
              w = "Google",
              O = "Huawei",
              E = "LG",
              k = "Microsoft",
              D = "Motorola",
              q = "Opera",
              J = "Samsung",
              de = "Sony",
              we = "Xiaomi",
              Se = "Zebra",
              He = "Facebook",
              et = function (ut, ct) {
                var vt = {};
                for (var rt in ut)
                  ct[rt] && ct[rt].length % 2 === 0
                    ? (vt[rt] = ct[rt].concat(ut[rt]))
                    : (vt[rt] = ut[rt]);
                return vt;
              },
              Ke = function (ut) {
                for (var ct = {}, vt = 0; vt < ut.length; vt++)
                  ct[ut[vt].toUpperCase()] = ut[vt];
                return ct;
              },
              Fe = function (ut, ct) {
                return (typeof ut == "undefined"
                  ? "undefined"
                  : _typeof$5(ut)) === h
                  ? qe(ct).indexOf(qe(ut)) !== -1
                  : !1;
              },
              qe = function (ut) {
                return ut.toLowerCase();
              },
              Mt = function (ut) {
                return _typeof$5(ut) === h
                  ? ut.replace(/[^\d\.]/g, o).split(".")[0]
                  : s;
              },
              ot = function (ut, ct) {
                if (_typeof$5(ut) === h)
                  return (
                    (ut = ut.replace(/^\s\s*/, o).replace(/\s\s*$/, o)),
                    _typeof$5(ct) === f ? ut : ut.substring(0, W)
                  );
              },
              at = function (ut, ct) {
                for (
                  var vt = 0, rt, Wt, Vt, mt, yt, xt;
                  vt < ct.length && !yt;

                ) {
                  var It = ct[vt],
                    Bt = ct[vt + 1];
                  for (rt = Wt = 0; rt < It.length && !yt; )
                    if (((yt = It[rt++].exec(ut)), yt))
                      for (Vt = 0; Vt < Bt.length; Vt++)
                        (xt = yt[++Wt]),
                          (mt = Bt[Vt]),
                          (typeof mt == "undefined"
                            ? "undefined"
                            : _typeof$5(mt)) === c && mt.length > 0
                            ? mt.length === 2
                              ? _typeof$5(mt[1]) == u
                                ? (this[mt[0]] = mt[1].call(this, xt))
                                : (this[mt[0]] = mt[1])
                              : mt.length === 3
                              ? _typeof$5(mt[1]) === u &&
                                !(mt[1].exec && mt[1].test)
                                ? (this[mt[0]] = xt
                                    ? mt[1].call(this, xt, mt[2])
                                    : s)
                                : (this[mt[0]] = xt
                                    ? xt.replace(mt[1], mt[2])
                                    : s)
                              : mt.length === 4 &&
                                (this[mt[0]] = xt
                                  ? mt[3].call(this, xt.replace(mt[1], mt[2]))
                                  : s)
                            : (this[mt] = xt || s);
                  vt += 2;
                }
              },
              Lt = function (ut, ct) {
                for (var vt in ct)
                  if (_typeof$5(ct[vt]) === c && ct[vt].length > 0) {
                    for (var rt = 0; rt < ct[vt].length; rt++)
                      if (Fe(ct[vt][rt], ut)) return vt === l ? s : vt;
                  } else if (Fe(ct[vt], ut)) return vt === l ? s : vt;
                return ut;
              },
              $t = {
                "1.0": "/8",
                1.2: "/1",
                1.3: "/3",
                "2.0": "/412",
                "2.0.2": "/416",
                "2.0.3": "/417",
                "2.0.4": "/419",
                "?": "/",
              },
              Rt = {
                ME: "4.90",
                "NT 3.11": "NT3.51",
                "NT 4.0": "NT4.0",
                2000: "NT 5.0",
                XP: ["NT 5.1", "NT 5.2"],
                Vista: "NT 6.0",
                7: "NT 6.1",
                8: "NT 6.2",
                8.1: "NT 6.3",
                10: ["NT 6.4", "NT 10.0"],
                RT: "ARM",
              },
              Ot = {
                browser: [
                  [/\b(?:crmo|crios)\/([\w\.]+)/i],
                  [y, [m, "Chrome"]],
                  [/edg(?:e|ios|a)?\/([\w\.]+)/i],
                  [y, [m, "Edge"]],
                  [
                    /(opera mini)\/([-\w\.]+)/i,
                    /(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,
                    /(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i,
                  ],
                  [m, y],
                  [/opios[\/ ]+([\w\.]+)/i],
                  [y, [m, q + " Mini"]],
                  [/\bopr\/([\w\.]+)/i],
                  [y, [m, q]],
                  [
                    /(kindle)\/([\w\.]+)/i,
                    /(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,
                    /(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,
                    /(ba?idubrowser)[\/ ]?([\w\.]+)/i,
                    /(?:ms|\()(ie) ([\w\.]+)/i,
                    /(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,
                    /(weibo)__([\d\.]+)/i,
                  ],
                  [m, y],
                  [/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],
                  [y, [m, "UC" + A]],
                  [/\bqbcore\/([\w\.]+)/i],
                  [y, [m, "WeChat(Win) Desktop"]],
                  [/micromessenger\/([\w\.]+)/i],
                  [y, [m, "WeChat"]],
                  [/konqueror\/([\w\.]+)/i],
                  [y, [m, "Konqueror"]],
                  [/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],
                  [y, [m, "IE"]],
                  [/yabrowser\/([\w\.]+)/i],
                  [y, [m, "Yandex"]],
                  [/(avast|avg)\/([\w\.]+)/i],
                  [[m, /(.+)/, "$1 Secure " + A], y],
                  [/\bfocus\/([\w\.]+)/i],
                  [y, [m, M + " Focus"]],
                  [/\bopt\/([\w\.]+)/i],
                  [y, [m, q + " Touch"]],
                  [/coc_coc\w+\/([\w\.]+)/i],
                  [y, [m, "Coc Coc"]],
                  [/dolfin\/([\w\.]+)/i],
                  [y, [m, "Dolphin"]],
                  [/coast\/([\w\.]+)/i],
                  [y, [m, q + " Coast"]],
                  [/miuibrowser\/([\w\.]+)/i],
                  [y, [m, "MIUI " + A]],
                  [/fxios\/([-\w\.]+)/i],
                  [y, [m, M]],
                  [/\bqihu|(qi?ho?o?|360)browser/i],
                  [[m, "360 " + A]],
                  [/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],
                  [[m, /(.+)/, "$1 " + A], y],
                  [/(comodo_dragon)\/([\w\.]+)/i],
                  [[m, /_/g, " "], y],
                  [
                    /(electron)\/([\w\.]+) safari/i,
                    /(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,
                    /m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i,
                  ],
                  [m, y],
                  [/(metasr)[\/ ]?([\w\.]+)/i, /(lbbrowser)/i],
                  [m],
                  [
                    /((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i,
                  ],
                  [[m, He], y],
                  [
                    /safari (line)\/([\w\.]+)/i,
                    /\b(line)\/([\w\.]+)\/iab/i,
                    /(chromium|instagram)[\/ ]([-\w\.]+)/i,
                  ],
                  [m, y],
                  [/\bgsa\/([\w\.]+) .*safari\//i],
                  [y, [m, "GSA"]],
                  [/headlesschrome(?:\/([\w\.]+)| )/i],
                  [y, [m, $ + " Headless"]],
                  [/ wv\).+(chrome)\/([\w\.]+)/i],
                  [[m, $ + " WebView"], y],
                  [/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],
                  [y, [m, "Android " + A]],
                  [
                    /(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i,
                  ],
                  [m, y],
                  [/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],
                  [y, [m, "Mobile Safari"]],
                  [/version\/([\w\.]+) .*(mobile ?safari|safari)/i],
                  [y, m],
                  [/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],
                  [m, [y, Lt, $t]],
                  [/(webkit|khtml)\/([\w\.]+)/i],
                  [m, y],
                  [/(navigator|netscape\d?)\/([-\w\.]+)/i],
                  [[m, "Netscape"], y],
                  [/mobile vr; rv:([\w\.]+)\).+firefox/i],
                  [y, [m, M + " Reality"]],
                  [
                    /ekiohf.+(flow)\/([\w\.]+)/i,
                    /(swiftfox)/i,
                    /(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,
                    /(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,
                    /(firefox)\/([\w\.]+)/i,
                    /(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,
                    /(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,
                    /(links) \(([\w\.]+)/i,
                  ],
                  [m, y],
                ],
                cpu: [
                  [/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],
                  [[_, "amd64"]],
                  [/(ia32(?=;))/i],
                  [[_, qe]],
                  [/((?:i[346]|x)86)[;\)]/i],
                  [[_, "ia32"]],
                  [/\b(aarch64|arm(v?8e?l?|_?64))\b/i],
                  [[_, "arm64"]],
                  [/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],
                  [[_, "armhf"]],
                  [/windows (ce|mobile); ppc;/i],
                  [[_, "arm"]],
                  [/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],
                  [[_, /ower/, o, qe]],
                  [/(sun4\w)[;\)]/i],
                  [[_, "sparc"]],
                  [
                    /((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i,
                  ],
                  [[_, qe]],
                ],
                device: [
                  [
                    /\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i,
                  ],
                  [d, [v, J], [g, P]],
                  [
                    /\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,
                    /samsung[- ]([-\w]+)/i,
                    /sec-(sgh\w+)/i,
                  ],
                  [d, [v, J], [g, S]],
                  [/\((ip(?:hone|od)[\w ]*);/i],
                  [d, [v, j], [g, S]],
                  [
                    /\((ipad);[-\w\),; ]+apple/i,
                    /applecoremedia\/[\w\.]+ \((ipad)/i,
                    /\b(ipad)\d\d?,\d\d?[;\]].+ios/i,
                  ],
                  [d, [v, j], [g, P]],
                  [
                    /\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i,
                  ],
                  [d, [v, O], [g, P]],
                  [
                    /(?:huawei|honor)([-\w ]+)[;\)]/i,
                    /\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i,
                  ],
                  [d, [v, O], [g, S]],
                  [
                    /\b(poco[\w ]+)(?: bui|\))/i,
                    /\b; (\w+) build\/hm\1/i,
                    /\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,
                    /\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,
                    /\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i,
                  ],
                  [
                    [d, /_/g, " "],
                    [v, we],
                    [g, S],
                  ],
                  [/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],
                  [
                    [d, /_/g, " "],
                    [v, we],
                    [g, P],
                  ],
                  [
                    /; (\w+) bui.+ oppo/i,
                    /\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i,
                  ],
                  [d, [v, "OPPO"], [g, S]],
                  [
                    /vivo (\w+)(?: bui|\))/i,
                    /\b(v[12]\d{3}\w?[at])(?: bui|;)/i,
                  ],
                  [d, [v, "Vivo"], [g, S]],
                  [/\b(rmx[12]\d{3})(?: bui|;|\))/i],
                  [d, [v, "Realme"], [g, S]],
                  [
                    /\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,
                    /\bmot(?:orola)?[- ](\w*)/i,
                    /((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i,
                  ],
                  [d, [v, D], [g, S]],
                  [/\b(mz60\d|xoom[2 ]{0,2}) build\//i],
                  [d, [v, D], [g, P]],
                  [
                    /((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i,
                  ],
                  [d, [v, E], [g, P]],
                  [
                    /(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,
                    /\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,
                    /\blg-?([\d\w]+) bui/i,
                  ],
                  [d, [v, E], [g, S]],
                  [
                    /(ideatab[-\w ]+)/i,
                    /lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i,
                  ],
                  [d, [v, "Lenovo"], [g, P]],
                  [
                    /(?:maemo|nokia).*(n900|lumia \d+)/i,
                    /nokia[-_ ]?([-\w\.]*)/i,
                  ],
                  [
                    [d, /_/g, " "],
                    [v, "Nokia"],
                    [g, S],
                  ],
                  [/(pixel c)\b/i],
                  [d, [v, w], [g, P]],
                  [/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],
                  [d, [v, w], [g, S]],
                  [
                    /droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i,
                  ],
                  [d, [v, de], [g, S]],
                  [/sony tablet [ps]/i, /\b(?:sony)?sgp\w+(?: bui|\))/i],
                  [
                    [d, "Xperia Tablet"],
                    [v, de],
                    [g, P],
                  ],
                  [
                    / (kb2005|in20[12]5|be20[12][59])\b/i,
                    /(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i,
                  ],
                  [d, [v, "OnePlus"], [g, S]],
                  [
                    /(alexa)webm/i,
                    /(kf[a-z]{2}wi)( bui|\))/i,
                    /(kf[a-z]+)( bui|\)).+silk\//i,
                  ],
                  [d, [v, Z], [g, P]],
                  [/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],
                  [
                    [d, /(.+)/g, "Fire Phone $1"],
                    [v, Z],
                    [g, S],
                  ],
                  [/(playbook);[-\w\),; ]+(rim)/i],
                  [d, v, [g, P]],
                  [/\b((?:bb[a-f]|st[hv])100-\d)/i, /\(bb10; (\w+)/i],
                  [d, [v, T], [g, S]],
                  [
                    /(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i,
                  ],
                  [d, [v, L], [g, P]],
                  [/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],
                  [d, [v, L], [g, S]],
                  [/(nexus 9)/i],
                  [d, [v, "HTC"], [g, P]],
                  [
                    /(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,
                    /(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,
                    /(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i,
                  ],
                  [v, [d, /_/g, " "], [g, S]],
                  [/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],
                  [d, [v, "Acer"], [g, P]],
                  [/droid.+; (m[1-5] note) bui/i, /\bmz-([-\w]{2,})/i],
                  [d, [v, "Meizu"], [g, S]],
                  [/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],
                  [d, [v, "Sharp"], [g, S]],
                  [
                    /(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,
                    /(hp) ([\w ]+\w)/i,
                    /(asus)-?(\w+)/i,
                    /(microsoft); (lumia[\w ]+)/i,
                    /(lenovo)[-_ ]?([-\w]+)/i,
                    /(jolla)/i,
                    /(oppo) ?([\w ]+) bui/i,
                  ],
                  [v, d, [g, S]],
                  [
                    /(archos) (gamepad2?)/i,
                    /(hp).+(touchpad(?!.+tablet)|tablet)/i,
                    /(kindle)\/([\w\.]+)/i,
                    /(nook)[\w ]+build\/(\w+)/i,
                    /(dell) (strea[kpr\d ]*[\dko])/i,
                    /(le[- ]+pan)[- ]+(\w{1,9}) bui/i,
                    /(trinity)[- ]*(t\d{3}) bui/i,
                    /(gigaset)[- ]+(q\w{1,9}) bui/i,
                    /(vodafone) ([\w ]+)(?:\)| bui)/i,
                  ],
                  [v, d, [g, P]],
                  [/(surface duo)/i],
                  [d, [v, k], [g, P]],
                  [/droid [\d\.]+; (fp\du?)(?: b|\))/i],
                  [d, [v, "Fairphone"], [g, S]],
                  [/(u304aa)/i],
                  [d, [v, "AT&T"], [g, S]],
                  [/\bsie-(\w*)/i],
                  [d, [v, "Siemens"], [g, S]],
                  [/\b(rct\w+) b/i],
                  [d, [v, "RCA"], [g, P]],
                  [/\b(venue[\d ]{2,7}) b/i],
                  [d, [v, "Dell"], [g, P]],
                  [/\b(q(?:mv|ta)\w+) b/i],
                  [d, [v, "Verizon"], [g, P]],
                  [/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],
                  [d, [v, "Barnes & Noble"], [g, P]],
                  [/\b(tm\d{3}\w+) b/i],
                  [d, [v, "NuVision"], [g, P]],
                  [/\b(k88) b/i],
                  [d, [v, "ZTE"], [g, P]],
                  [/\b(nx\d{3}j) b/i],
                  [d, [v, "ZTE"], [g, S]],
                  [/\b(gen\d{3}) b.+49h/i],
                  [d, [v, "Swiss"], [g, S]],
                  [/\b(zur\d{3}) b/i],
                  [d, [v, "Swiss"], [g, P]],
                  [/\b((zeki)?tb.*\b) b/i],
                  [d, [v, "Zeki"], [g, P]],
                  [/\b([yr]\d{2}) b/i, /\b(dragon[- ]+touch |dt)(\w{5}) b/i],
                  [[v, "Dragon Touch"], d, [g, P]],
                  [/\b(ns-?\w{0,9}) b/i],
                  [d, [v, "Insignia"], [g, P]],
                  [/\b((nxa|next)-?\w{0,9}) b/i],
                  [d, [v, "NextBook"], [g, P]],
                  [/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],
                  [[v, "Voice"], d, [g, S]],
                  [/\b(lvtel\-)?(v1[12]) b/i],
                  [[v, "LvTel"], d, [g, S]],
                  [/\b(ph-1) /i],
                  [d, [v, "Essential"], [g, S]],
                  [/\b(v(100md|700na|7011|917g).*\b) b/i],
                  [d, [v, "Envizen"], [g, P]],
                  [/\b(trio[-\w\. ]+) b/i],
                  [d, [v, "MachSpeed"], [g, P]],
                  [/\btu_(1491) b/i],
                  [d, [v, "Rotor"], [g, P]],
                  [/(shield[\w ]+) b/i],
                  [d, [v, "Nvidia"], [g, P]],
                  [/(sprint) (\w+)/i],
                  [v, d, [g, S]],
                  [/(kin\.[onetw]{3})/i],
                  [
                    [d, /\./g, " "],
                    [v, k],
                    [g, S],
                  ],
                  [/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],
                  [d, [v, Se], [g, P]],
                  [/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],
                  [d, [v, Se], [g, S]],
                  [/(ouya)/i, /(nintendo) ([wids3utch]+)/i],
                  [v, d, [g, b]],
                  [/droid.+; (shield) bui/i],
                  [d, [v, "Nvidia"], [g, b]],
                  [/(playstation [345portablevi]+)/i],
                  [d, [v, de], [g, b]],
                  [/\b(xbox(?: one)?(?!; xbox))[\); ]/i],
                  [d, [v, k], [g, b]],
                  [/smart-tv.+(samsung)/i],
                  [v, [g, I]],
                  [/hbbtv.+maple;(\d+)/i],
                  [
                    [d, /^/, "SmartTV"],
                    [v, J],
                    [g, I],
                  ],
                  [
                    /(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i,
                  ],
                  [
                    [v, E],
                    [g, I],
                  ],
                  [/(apple) ?tv/i],
                  [v, [d, j + " TV"], [g, I]],
                  [/crkey/i],
                  [
                    [d, $ + "cast"],
                    [v, w],
                    [g, I],
                  ],
                  [/droid.+aft(\w)( bui|\))/i],
                  [d, [v, Z], [g, I]],
                  [/\(dtv[\);].+(aquos)/i],
                  [d, [v, "Sharp"], [g, I]],
                  [
                    /\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,
                    /hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i,
                  ],
                  [
                    [v, ot],
                    [d, ot],
                    [g, I],
                  ],
                  [/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],
                  [[g, I]],
                  [/((pebble))app/i],
                  [v, d, [g, F]],
                  [/droid.+; (glass) \d/i],
                  [d, [v, w], [g, F]],
                  [/droid.+; (wt63?0{2,3})\)/i],
                  [d, [v, Se], [g, F]],
                  [/(quest( 2)?)/i],
                  [d, [v, He], [g, F]],
                  [/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],
                  [v, [g, X]],
                  [/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],
                  [d, [g, S]],
                  [
                    /droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i,
                  ],
                  [d, [g, P]],
                  [/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],
                  [[g, P]],
                  [/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],
                  [[g, S]],
                  [/(android[-\w\. ]{0,9});.+buil/i],
                  [d, [v, "Generic"]],
                ],
                engine: [
                  [/windows.+ edge\/([\w\.]+)/i],
                  [y, [m, R + "HTML"]],
                  [/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],
                  [y, [m, "Blink"]],
                  [
                    /(presto)\/([\w\.]+)/i,
                    /(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,
                    /ekioh(flow)\/([\w\.]+)/i,
                    /(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,
                    /(icab)[\/ ]([23]\.[\d\.]+)/i,
                  ],
                  [m, y],
                  [/rv\:([\w\.]{1,9})\b.+(gecko)/i],
                  [y, m],
                ],
                os: [
                  [/microsoft (windows) (vista|xp)/i],
                  [m, y],
                  [
                    /(windows) nt 6\.2; (arm)/i,
                    /(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,
                    /(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,
                  ],
                  [m, [y, Lt, Rt]],
                  [/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],
                  [
                    [m, "Windows"],
                    [y, Lt, Rt],
                  ],
                  [
                    /ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,
                    /cfnetwork\/.+darwin/i,
                  ],
                  [
                    [y, /_/g, "."],
                    [m, "iOS"],
                  ],
                  [
                    /(mac os x) ?([\w\. ]*)/i,
                    /(macintosh|mac_powerpc\b)(?!.+haiku)/i,
                  ],
                  [
                    [m, "Mac OS"],
                    [y, /_/g, "."],
                  ],
                  [/droid ([\w\.]+)\b.+(android[- ]x86)/i],
                  [y, m],
                  [
                    /(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,
                    /(blackberry)\w*\/([\w\.]*)/i,
                    /(tizen|kaios)[\/ ]([\w\.]+)/i,
                    /\((series40);/i,
                  ],
                  [m, y],
                  [/\(bb(10);/i],
                  [y, [m, T]],
                  [/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],
                  [y, [m, "Symbian"]],
                  [
                    /mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i,
                  ],
                  [y, [m, M + " OS"]],
                  [/web0s;.+rt(tv)/i, /\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],
                  [y, [m, "webOS"]],
                  [/crkey\/([\d\.]+)/i],
                  [y, [m, $ + "cast"]],
                  [/(cros) [\w]+ ([\w\.]+\w)/i],
                  [[m, "Chromium OS"], y],
                  [
                    /(nintendo|playstation) ([wids345portablevuch]+)/i,
                    /(xbox); +xbox ([^\);]+)/i,
                    /\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,
                    /(mint)[\/\(\) ]?(\w*)/i,
                    /(mageia|vectorlinux)[; ]/i,
                    /([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,
                    /(hurd|linux) ?([\w\.]*)/i,
                    /(gnu) ?([\w\.]*)/i,
                    /\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,
                    /(haiku) (\w+)/i,
                  ],
                  [m, y],
                  [/(sunos) ?([\w\.\d]*)/i],
                  [[m, "Solaris"], y],
                  [
                    /((?:open)?solaris)[-\/ ]?([\w\.]*)/i,
                    /(aix) ((\d)(?=\.|\)| )[\w\.])*/i,
                    /\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,
                    /(unix) ?([\w\.]*)/i,
                  ],
                  [m, y],
                ],
              },
              wt = function (At, ut) {
                if (
                  ((typeof At == "undefined" ? "undefined" : _typeof$5(At)) ===
                    c && ((ut = At), (At = s)),
                  !_instanceof$7(this, wt))
                )
                  return new wt(At, ut).getResult();
                var ct =
                    At ||
                    ((typeof i == "undefined" ? "undefined" : _typeof$5(i)) !==
                      f &&
                    i.navigator &&
                    i.navigator.userAgent
                      ? i.navigator.userAgent
                      : o),
                  vt = ut ? et(Ot, ut) : Ot;
                return (
                  (this.getBrowser = function () {
                    var rt = {};
                    return (
                      (rt[m] = s),
                      (rt[y] = s),
                      at.call(rt, ct, vt.browser),
                      (rt.major = Mt(rt.version)),
                      rt
                    );
                  }),
                  (this.getCPU = function () {
                    var rt = {};
                    return (rt[_] = s), at.call(rt, ct, vt.cpu), rt;
                  }),
                  (this.getDevice = function () {
                    var rt = {};
                    return (
                      (rt[v] = s),
                      (rt[d] = s),
                      (rt[g] = s),
                      at.call(rt, ct, vt.device),
                      rt
                    );
                  }),
                  (this.getEngine = function () {
                    var rt = {};
                    return (
                      (rt[m] = s), (rt[y] = s), at.call(rt, ct, vt.engine), rt
                    );
                  }),
                  (this.getOS = function () {
                    var rt = {};
                    return (rt[m] = s), (rt[y] = s), at.call(rt, ct, vt.os), rt;
                  }),
                  (this.getResult = function () {
                    return {
                      ua: this.getUA(),
                      browser: this.getBrowser(),
                      engine: this.getEngine(),
                      os: this.getOS(),
                      device: this.getDevice(),
                      cpu: this.getCPU(),
                    };
                  }),
                  (this.getUA = function () {
                    return ct;
                  }),
                  (this.setUA = function (rt) {
                    return (
                      (ct =
                        (typeof rt == "undefined"
                          ? "undefined"
                          : _typeof$5(rt)) === h && rt.length > W
                          ? ot(rt, W)
                          : rt),
                      this
                    );
                  }),
                  this.setUA(ct),
                  this
                );
              };
            (wt.VERSION = a),
              (wt.BROWSER = Ke([m, y, p])),
              (wt.CPU = Ke([_])),
              (wt.DEVICE = Ke([d, v, g, b, S, I, P, F, X])),
              (wt.ENGINE = wt.OS = Ke([m, y])),
              r.exports && (n = r.exports = wt),
              (n.UAParser = wt);
            var kt =
              (typeof i == "undefined" ? "undefined" : _typeof$5(i)) !== f &&
              (i.jQuery || i.Zepto);
            if (kt && !kt.ua) {
              var Pt = new wt();
              (kt.ua = Pt.getResult()),
                (kt.ua.get = function () {
                  return Pt.getUA();
                }),
                (kt.ua.set = function (At) {
                  Pt.setUA(At);
                  var ut = Pt.getResult();
                  for (var ct in ut) kt.ua[ct] = ut[ct];
                });
            }
          })(typeof window == "object" ? window : commonjsGlobal);
        })(uaParser, uaParser.exports)),
      uaParser.exports
    );
  }
  var chito = { exports: {} },
    core = {},
    animation = {},
    eventemitter = {};
  function _instanceof$6(r, n) {
    return n != null && typeof Symbol != "undefined" && n[Symbol.hasInstance]
      ? !!n[Symbol.hasInstance](r)
      : r instanceof n;
  }
  var hasRequiredEventemitter;
  function requireEventemitter() {
    return (
      hasRequiredEventemitter ||
        ((hasRequiredEventemitter = 1),
        (function (r) {
          var n = function (u, f) {
              if (!_instanceof$6(u, f))
                throw new TypeError("Cannot call a class as a function");
            },
            i = function (u) {
              for (
                var f = -1,
                  c = arguments.length <= 1 ? 0 : arguments.length - 1;
                ++f < c;

              ) {
                var h = arguments.length <= f + 1 ? void 0 : arguments[f + 1];
                for (var p in h) h.hasOwnProperty(p) && (u[p] = h[p]);
              }
              return u;
            };
          Object.defineProperty(r, "__esModule", { value: !0 });
          var s = (function () {
              var l = function (f, c) {
                for (var h = 0; h < c.length; h++) {
                  var p = c[h];
                  (p.enumerable = p.enumerable || !1),
                    (p.configurable = !0),
                    "value" in p && (p.writable = !0),
                    Object.defineProperty(f, p.key, p);
                }
              };
              return function (u, f, c) {
                return f && l(u.prototype, f), c && l(u, c), u;
              };
            })(),
            a = -1,
            o = (function () {
              function l() {
                n(this, l), (this.__events__ = {}), (this.__id__ = ++a);
              }
              return (
                s(l, [
                  {
                    key: "on",
                    value: function (f, c, h) {
                      var p = this.__events__,
                        d = (p[f] = p[f] || []);
                      h === this && (h = void 0);
                      for (var m = -1, g = d; ++m < g; ) {
                        var v = d[m],
                          y = v.fn,
                          _ = v.ctx;
                        if (y === c && _ === h) return this;
                      }
                      var b = { fn: c, ctx: h };
                      return d.push(b), this;
                    },
                  },
                  {
                    key: "once",
                    value: function (f, c, h) {
                      function p(d) {
                        this.off(f, p), c.call(this, d);
                      }
                      return (p.listener = c), this.on(f, p, h);
                    },
                  },
                  {
                    key: "off",
                    value: function (f, c, h) {
                      var p = this.__events__;
                      if (!f) return (this.__events__ = {}), this;
                      if (!c) return delete p[f], this;
                      var d = p[f];
                      if (d)
                        for (var m = d.length; --m >= 0; ) {
                          var g = d[m],
                            v = g.fn,
                            y = g.ctx;
                          y === h &&
                            (v === c || v === v.listener) &&
                            (d.splice(m, 1), (v = function () {}));
                        }
                      return this;
                    },
                  },
                  {
                    key: "emit",
                    value: function (f, c) {
                      var h = this.__events__[f];
                      if (h)
                        for (
                          var p = i({}, c, { target: this, type: f }),
                            d = -1,
                            m = h.length;
                          ++d < m;

                        ) {
                          var g = h[d],
                            v = g.fn,
                            y = g.ctx;
                          v.call(y || this, p);
                        }
                      return this;
                    },
                  },
                  {
                    key: "events",
                    get: function () {
                      return this.__events__;
                    },
                  },
                  {
                    key: "id",
                    get: function () {
                      return this.__id__;
                    },
                  },
                ]),
                l
              );
            })();
          r.default = o;
        })(eventemitter)),
      eventemitter
    );
  }
  var util = {},
    hasRequiredUtil;
  function requireUtil() {
    return (
      hasRequiredUtil ||
        ((hasRequiredUtil = 1),
        (function (r) {
          var n = function (u, f) {
              for (var c = u ? f.length : 0; c-- > 0; ) {
                var h = f[c];
                u.splice(h, 1);
              }
              return u;
            },
            i = function (u, f) {
              var c = [];
              if (!(u && u.length)) return c;
              if (typeof f == "function") {
                for (var h = -1, p = [], d = u.length; ++h < d; ) {
                  var m = u[h];
                  f(m, h, u) && (c.push(m), p.push(h));
                }
                n(u, p);
              }
              return c;
            },
            s = function (u, f) {
              for (var c in u)
                if (u.hasOwnProperty(c)) {
                  var h = u[c];
                  f(h, c, u);
                }
            };
          Object.defineProperty(r, "__esModule", { value: !0 });
          var a = (function () {
            var l = function (f, c) {
              var h = [],
                p = !0,
                d = !1,
                m = void 0;
              try {
                for (
                  var g = f[Symbol.iterator](), v;
                  !(p = (v = g.next()).done) &&
                  (h.push(v.value), !(c && h.length === c));
                  p = !0
                );
              } catch (y) {
                (d = !0), (m = y);
              } finally {
                try {
                  !p && g.return && g.return();
                } finally {
                  if (d) throw m;
                }
              }
              return h;
            };
            return function (u, f) {
              if (Array.isArray(u)) return u;
              if (Symbol.iterator in Object(u)) return l(u, f);
              throw new TypeError(
                "Invalid attempt to destructure non-iterable instance"
              );
            };
          })();
          function o(l) {
            var u =
              arguments.length > 1 && arguments[1] !== void 0
                ? arguments[1]
                : {};
            if (!Array.isArray(l)) return l;
            var f = u.type,
              c = f === void 0 ? "" : f,
              h = u.range,
              p = h === void 0 ? [0, 1] : h,
              d = u.min,
              m = d === void 0 ? Math.min.apply(Math, l) : d,
              g = u.max,
              v = g === void 0 ? Math.max.apply(Math, l) : g;
            c = c.toLowerCase();
            for (var y = [], _ = v - m, b = -1, S = l.length; ++b < S; ) {
              var P = l[b];
              P > v && (P = v), P < m && (P = m);
              var I = void 0;
              c !== "log" ? (I = (P - m) / _) : (I = Math.log10(P)), y.push(I);
            }
            c === "log" && (y = o(y));
            var F = a(p, 2),
              X = F[0],
              W = F[1];
            if (X !== 0 || W !== 1) {
              for (var Z = -1, j = y.length, L = W - X, T = []; ++Z < j; ) {
                var A = y[Z],
                  $ = L * A + X;
                T.push($);
              }
              y = T;
            }
            return y;
          }
          r.default = { remove: i, normalize: o, forInMap: s };
        })(util)),
      util
    );
  }
  var animationframe = {},
    hasRequiredAnimationframe;
  function requireAnimationframe() {
    if (hasRequiredAnimationframe) return animationframe;
    (hasRequiredAnimationframe = 1),
      Object.defineProperty(animationframe, "__esModule", { value: !0 }),
      (function () {
        if (
          ("performance" in window || (window.performance = {}),
          (Date.now =
            Date.now ||
            function () {
              return new Date().getTime();
            }),
          !("now" in window.performance))
        ) {
          var i =
            window.performance.timing &&
            window.performance.timing.navigationStart
              ? window.performance.timing.navigationStart
              : Date.now();
          window.performance.now = function () {
            return Date.now() - i;
          };
        }
      })();
    var r = (function () {
        return (
          (typeof window != "undefined" &&
            (window.requestAnimationFrame ||
              window.msRequestAnimationFrame ||
              window.mozRequestAnimationFrame ||
              window.webkitRequestAnimationFrame)) ||
          function (i) {
            setTimeout(i, 16);
          }
        );
      })(),
      n = (function () {
        return (
          (typeof window != "undefined" &&
            (window.cancelAnimationFrame ||
              window.msCancelAnimationFrame ||
              window.mozCancelAnimationFrame ||
              window.webkitCancelAnimationFrame)) ||
          function (i) {
            clearTimeout(i);
          }
        );
      })();
    return (
      (animationframe.requestAnimationFrame = r),
      (animationframe.cancelAnimationFrame = n),
      animationframe
    );
  }
  var define = {},
    hasRequiredDefine;
  function requireDefine() {
    if (hasRequiredDefine) return define;
    (hasRequiredDefine = 1),
      Object.defineProperty(define, "__esModule", { value: !0 });
    var r = {
        UPDATE: "update",
        START: "start",
        REPEAT: "repeat",
        REPEAT_COMPLETE: "repeatComplete",
        AFTER_UPDATE: "afterUpdate",
        COMPLETE: "complete",
        PAUSE: "pause",
        STOP: "stop",
        RESET: "reset",
      },
      n = {
        DURATION: "duration",
        REPEAT: "repeat",
        DELAY: "delay",
        EASING: "easing",
        INTERVAL: "interval",
        YOYO: "yoyo",
        START: "startAt",
      },
      i = {
        LINEAR: "Linear",
        QUADRATIC_IN: "QuadraticIn",
        QUADRATIC_OUT: "QuadraticOut",
        QUADRATIC_IN_OUT: "QuadraticInOut",
        CUBIC_IN: "CubicIn",
        CUBIC_OUT: "CubicOut",
        CUBIC_IN_OUT: "CubicInOut",
        QUARTIC_IN: "QuarticIn",
        QUARTIC_OUT: "QuarticOut",
        QUARTIC_IN_OUT: "QuarticInOut",
        QUINTIC_IN: "QuinticIn",
        QUINTIC_OUT: "QuinticOut",
        QUINTIC_IN_OUT: "QuinticInOut",
        SINUSOIDAL_IN: "SinusoidalIn",
        SINUSOIDAL_OUT: "SinusoidalOut",
        SINUSOIDAL_IN_OUT: "SinusoidalInOut",
        EXPONENTIAL_IN: "ExponentialIn",
        EXPONENTIAL_OUT: "ExponentialOut",
        EXPONENTIAL_IN_OUT: "ExponentialInOut",
        CIRCULAR_IN: "CircularIn",
        CIRCULAR_OUT: "CircularOut",
        CIRCULAR_IN_OUT: "CircularInOut",
        ELASTIC_IN: "ElasticIn",
        ELASTIC_OUT: "ElasticOut",
        ELASTIC_IN_OUT: "ElasticInOut",
        BACK_IN: "BackIn",
        BACK_OUT: "BackOut",
        BACK_IN_OUT: "BackInOut",
        BOUNCE_IN: "BounceIn",
        BOUNCE_OUT: "BounceOut",
        BOUNCE_IN_OUT: "BounceInOut",
      };
    return (define.Ev = r), (define.Attr = n), (define.Easing = i), define;
  }
  function _instanceof$5(r, n) {
    return n != null && typeof Symbol != "undefined" && n[Symbol.hasInstance]
      ? !!n[Symbol.hasInstance](r)
      : r instanceof n;
  }
  var _typeof$4 = function (r) {
      return r && typeof Symbol != "undefined" && r.constructor === Symbol
        ? "symbol"
        : typeof r;
    },
    hasRequiredAnimation;
  function requireAnimation() {
    return (
      hasRequiredAnimation ||
        ((hasRequiredAnimation = 1),
        (function (r) {
          var n = function (y) {
              return y && y.__esModule ? y : { default: y };
            },
            i = function (y, _) {
              if (!_instanceof$5(y, _))
                throw new TypeError("Cannot call a class as a function");
            },
            s = function (y, _) {
              if (!y)
                throw new ReferenceError(
                  "this hasn't been initialised - super() hasn't been called"
                );
              return _ && (typeof _ == "object" || typeof _ == "function")
                ? _
                : y;
            },
            a = function (y, _) {
              if (typeof _ != "function" && _ !== null)
                throw new TypeError(
                  "Super expression must either be null or a function, not " +
                    (typeof _ == "undefined" ? "undefined" : _typeof$4(_))
                );
              (y.prototype = Object.create(_ && _.prototype, {
                constructor: {
                  value: y,
                  enumerable: !1,
                  writable: !0,
                  configurable: !0,
                },
              })),
                _ &&
                  (Object.setPrototypeOf
                    ? Object.setPrototypeOf(y, _)
                    : (y.__proto__ = _));
            };
          Object.defineProperty(r, "__esModule", { value: !0 });
          var o = (function () {
              var v = function (_, b) {
                for (var S = 0; S < b.length; S++) {
                  var P = b[S];
                  (P.enumerable = P.enumerable || !1),
                    (P.configurable = !0),
                    "value" in P && (P.writable = !0),
                    Object.defineProperty(_, P.key, P);
                }
              };
              return function (y, _, b) {
                return _ && v(y.prototype, _), b && v(y, b), y;
              };
            })(),
            l = requireEventemitter(),
            u = n(l),
            f = requireUtil(),
            c = n(f),
            h = requireAnimationframe(),
            p = requireDefine(),
            d = c.default.remove,
            m = c.default.forInMap,
            g = (function (v) {
              a(y, v);
              function y(_) {
                i(this, y);
                var b = s(
                  this,
                  (y.__proto__ || Object.getPrototypeOf(y)).call(this)
                );
                return (
                  (b._options = {}),
                  (b._savedClipMap = {}),
                  (b._clips = []),
                  (b._clipMap = {}),
                  (b._options = _ || {}),
                  b
                );
              }
              return (
                o(y, [
                  {
                    key: "_startAni",
                    value: function () {
                      var b = this,
                        S = function P(I) {
                          (b._timer = (0, h.requestAnimationFrame)(P)),
                            b._update(I);
                        };
                      this._timer = (0, h.requestAnimationFrame)(S);
                    },
                  },
                  {
                    key: "_stopAni",
                    value: function () {
                      var b = this._timer;
                      return b
                        ? ((0, h.cancelAnimationFrame)(b),
                          (this._timer = null),
                          !0)
                        : !1;
                    },
                  },
                  {
                    key: "_update",
                    value: function (b) {
                      var S = this._clips;
                      this.emit(p.Ev.UPDATE, { timestamp: b });
                      for (var P = 0; P < S.length; ) {
                        var I = S[P],
                          F = I.update(b);
                        F ? P++ : this._rmClip(I);
                      }
                      (this._clips = S),
                        this.emit(p.Ev.AFTER_UPDATE),
                        S.length === 0 &&
                          (this._stopAni(), this.emit(p.Ev.COMPLETE));
                    },
                  },
                  {
                    key: "start",
                    value: function () {
                      var b = this._clips,
                        S = b.length;
                      if (this._timer || S === 0) return this;
                      this.emit(p.Ev.START);
                      for (var P = -1; ++P < S; ) {
                        var I = b[P];
                        I.start();
                      }
                      return this._startAni(), this;
                    },
                  },
                  {
                    key: "stop",
                    value: function () {
                      return this._stop(!1), this;
                    },
                  },
                  {
                    key: "pause",
                    value: function () {
                      return this._stop(!0), this;
                    },
                  },
                  {
                    key: "reset",
                    value: function () {
                      this._stop(!1, !0, !1);
                      var b = this._savedClipMap,
                        S = [];
                      return (
                        m(b, function (P) {
                          P.stop(!0), S.push(P);
                        }),
                        (this._clips = S),
                        this.emit(p.Ev.RESET),
                        this
                      );
                    },
                  },
                  {
                    key: "_stop",
                    value: function (b, S) {
                      var P =
                        arguments.length > 2 && arguments[2] !== void 0
                          ? arguments[2]
                          : !0;
                      this._stopAni();
                      var I = this._clips,
                        F = I.length;
                      if (F) {
                        for (var X = -1; ++X < F; ) {
                          var W = I[X];
                          b ? W.pause() : W.stop(S);
                        }
                        P && this.emit(b ? p.Ev.PAUSE : p.Ev.STOP);
                      }
                    },
                  },
                  {
                    key: "addClip",
                    value: function (b) {
                      var S =
                        arguments.length > 1 && arguments[1] !== void 0
                          ? arguments[1]
                          : !0;
                      Array.isArray(b) || (b = [b]);
                      for (var P = -1, I = b.length; ++P < I; ) {
                        var F = b[P];
                        this._hasSavedClip(F) ||
                          (this._addClip(F),
                          this._addSavedClip(F),
                          this._timer && S && F.start());
                      }
                      return this;
                    },
                  },
                  {
                    key: "_addClip",
                    value: function (b) {
                      var S = this._clips;
                      S.indexOf(b) === -1 && (S.push(b), (b._animation = this));
                    },
                  },
                  {
                    key: "_addSavedClip",
                    value: function (b) {
                      var S = this._savedClipMap,
                        P = b.id;
                      S[P] !== b && ((S[P] = b), (b._animation = this));
                    },
                  },
                  {
                    key: "removeClip",
                    value: function (b) {
                      var S = this._savedClipMap;
                      return (
                        b
                          ? (this._rmClip(b),
                            this._rmSavedClip(b),
                            (b._animation = null))
                          : (m(S, function (P) {
                              P._animation = null;
                            }),
                            (this._clips = []),
                            (this._savedClipMap = {})),
                        this
                      );
                    },
                  },
                  {
                    key: "_rmClip",
                    value: function (b) {
                      d(this._clips, function (S) {
                        return S === b;
                      });
                    },
                  },
                  {
                    key: "_rmSavedClip",
                    value: function (b) {
                      this._hasSavedClip(b) && delete this._savedClipMap[b.id];
                    },
                  },
                  {
                    key: "getClips",
                    value: function () {
                      return this._clips;
                    },
                  },
                  {
                    key: "_hasSavedClip",
                    value: function (b) {
                      var S = b.id,
                        P = this._savedClipMap,
                        I = P[S];
                      return I && I === b;
                    },
                  },
                  {
                    key: "_hasClip",
                    value: function (b) {
                      return this._clips.indexOf(b) !== -1;
                    },
                  },
                  {
                    key: "destroy",
                    value: function () {
                      this.off(), this._stopAni(), this.removeClip();
                    },
                  },
                ]),
                y
              );
            })(u.default);
          (g.Event = p.Ev), (r.default = g);
        })(animation)),
      animation
    );
  }
  var clip = {},
    easing = {},
    hasRequiredEasing;
  function requireEasing() {
    return (
      hasRequiredEasing ||
        ((hasRequiredEasing = 1),
        (function (r) {
          Object.defineProperty(r, "__esModule", { value: !0 });
          var n = {
            Linear: function (s) {
              return s;
            },
            QuadraticIn: function (s) {
              return s * s;
            },
            QuadraticOut: function (s) {
              return s * (2 - s);
            },
            QuadraticInOut: function (s) {
              return (s *= 2) < 1 ? 0.5 * s * s : -0.5 * (--s * (s - 2) - 1);
            },
            CubicIn: function (s) {
              return s * s * s;
            },
            CubicOut: function (s) {
              return --s * s * s + 1;
            },
            CubicInOut: function (s) {
              return (s *= 2) < 1
                ? 0.5 * s * s * s
                : 0.5 * ((s -= 2) * s * s + 2);
            },
            QuarticIn: function (s) {
              return s * s * s * s;
            },
            QuarticOut: function (s) {
              return 1 - --s * s * s * s;
            },
            QuarticInOut: function (s) {
              return (s *= 2) < 1
                ? 0.5 * s * s * s * s
                : -0.5 * ((s -= 2) * s * s * s - 2);
            },
            QuinticIn: function (s) {
              return s * s * s * s * s;
            },
            QuinticOut: function (s) {
              return --s * s * s * s * s + 1;
            },
            QuinticInOut: function (s) {
              return (s *= 2) < 1
                ? 0.5 * s * s * s * s * s
                : 0.5 * ((s -= 2) * s * s * s * s + 2);
            },
            SinusoidalIn: function (s) {
              return 1 - Math.cos((s * Math.PI) / 2);
            },
            SinusoidalOut: function (s) {
              return Math.sin((s * Math.PI) / 2);
            },
            SinusoidalInOut: function (s) {
              return 0.5 * (1 - Math.cos(Math.PI * s));
            },
            ExponentialIn: function (s) {
              return s === 0 ? 0 : Math.pow(1024, s - 1);
            },
            ExponentialOut: function (s) {
              return s === 1 ? 1 : 1 - Math.pow(2, -10 * s);
            },
            ExponentialInOut: function (s) {
              return s === 0
                ? 0
                : s === 1
                ? 1
                : (s *= 2) < 1
                ? 0.5 * Math.pow(1024, s - 1)
                : 0.5 * (-Math.pow(2, -10 * (s - 1)) + 2);
            },
            CircularIn: function (s) {
              return 1 - Math.sqrt(1 - s * s);
            },
            CircularOut: function (s) {
              return Math.sqrt(1 - --s * s);
            },
            CircularInOut: function (s) {
              return (s *= 2) < 1
                ? -0.5 * (Math.sqrt(1 - s * s) - 1)
                : 0.5 * (Math.sqrt(1 - (s -= 2) * s) + 1);
            },
            ElasticIn: function (s) {
              var a,
                o = 0.1,
                l = 0.4;
              return s === 0
                ? 0
                : s === 1
                ? 1
                : (!o || o < 1
                    ? ((o = 1), (a = l / 4))
                    : (a = (l * Math.asin(1 / o)) / (2 * Math.PI)),
                  -(
                    o *
                    Math.pow(2, 10 * (s -= 1)) *
                    Math.sin(((s - a) * (2 * Math.PI)) / l)
                  ));
            },
            ElasticOut: function (s) {
              var a,
                o = 0.1,
                l = 0.4;
              return s === 0
                ? 0
                : s === 1
                ? 1
                : (!o || o < 1
                    ? ((o = 1), (a = l / 4))
                    : (a = (l * Math.asin(1 / o)) / (2 * Math.PI)),
                  o *
                    Math.pow(2, -10 * s) *
                    Math.sin(((s - a) * (2 * Math.PI)) / l) +
                    1);
            },
            ElasticInOut: function (s) {
              var a,
                o = 0.1,
                l = 0.4;
              return s === 0
                ? 0
                : s === 1
                ? 1
                : (!o || o < 1
                    ? ((o = 1), (a = l / 4))
                    : (a = (l * Math.asin(1 / o)) / (2 * Math.PI)),
                  (s *= 2) < 1
                    ? -0.5 *
                      (o *
                        Math.pow(2, 10 * (s -= 1)) *
                        Math.sin(((s - a) * (2 * Math.PI)) / l))
                    : o *
                        Math.pow(2, -10 * (s -= 1)) *
                        Math.sin(((s - a) * (2 * Math.PI)) / l) *
                        0.5 +
                      1);
            },
            BackIn: function (s) {
              var a = 1.70158;
              return s * s * ((a + 1) * s - a);
            },
            BackOut: function (s) {
              var a = 1.70158;
              return --s * s * ((a + 1) * s + a) + 1;
            },
            BackInOut: function (s) {
              var a = 2.5949095;
              return (s *= 2) < 1
                ? 0.5 * (s * s * ((a + 1) * s - a))
                : 0.5 * ((s -= 2) * s * ((a + 1) * s + a) + 2);
            },
            BounceIn: function (s) {
              return 1 - n.BounceOut(1 - s);
            },
            BounceOut: function (s) {
              return s < 1 / 2.75
                ? 7.5625 * s * s
                : s < 2 / 2.75
                ? 7.5625 * (s -= 1.5 / 2.75) * s + 0.75
                : s < 2.5 / 2.75
                ? 7.5625 * (s -= 2.25 / 2.75) * s + 0.9375
                : 7.5625 * (s -= 2.625 / 2.75) * s + 0.984375;
            },
            BounceInOut: function (s) {
              return s < 0.5
                ? n.BounceIn(s * 2) * 0.5
                : n.BounceOut(s * 2 - 1) * 0.5 + 0.5;
            },
          };
          r.default = n;
        })(easing)),
      easing
    );
  }
  var Interpolation = {},
    hasRequiredInterpolation;
  function requireInterpolation() {
    return (
      hasRequiredInterpolation ||
        ((hasRequiredInterpolation = 1),
        (function (r) {
          Object.defineProperty(r, "__esModule", { value: !0 });
          var n = {
            Linear: function (s, a) {
              var o = s.length - 1,
                l = o * a,
                u = Math.floor(l),
                f = n.Utils.Linear;
              return a < 0
                ? f(s[0], s[1], l)
                : a > 1
                ? f(s[o], s[o - 1], o - l)
                : f(s[u], s[u + 1 > o ? o : u + 1], l - u);
            },
            Bezier: function (s, a) {
              for (
                var o = 0,
                  l = s.length - 1,
                  u = Math.pow,
                  f = n.Utils.Bernstein,
                  c = 0;
                c <= l;
                c++
              )
                o += u(1 - a, l - c) * u(a, c) * s[c] * f(l, c);
              return o;
            },
            CatmullRom: function (s, a) {
              var o = s.length - 1,
                l = o * a,
                u = Math.floor(l),
                f = n.Utils.CatmullRom;
              return s[0] === s[o]
                ? (a < 0 && (u = Math.floor((l = o * (1 + a)))),
                  f(
                    s[(u - 1 + o) % o],
                    s[u],
                    s[(u + 1) % o],
                    s[(u + 2) % o],
                    l - u
                  ))
                : a < 0
                ? s[0] - (f(s[0], s[0], s[1], s[1], -l) - s[0])
                : a > 1
                ? s[o] - (f(s[o], s[o], s[o - 1], s[o - 1], l - o) - s[o])
                : f(
                    s[u ? u - 1 : 0],
                    s[u],
                    s[o < u + 1 ? o : u + 1],
                    s[o < u + 2 ? o : u + 2],
                    l - u
                  );
            },
            Utils: {
              Linear: function (s, a, o) {
                return (a - s) * o + s;
              },
              Bernstein: function (s, a) {
                var o = n.Utils.Factorial;
                return o(s) / o(a) / o(s - a);
              },
              Factorial: (function () {
                var i = [1];
                return function (s) {
                  var a = 1;
                  if (i[s]) return i[s];
                  for (var o = s; o > 1; o--) a *= o;
                  return (i[s] = a), a;
                };
              })(),
              CatmullRom: function (s, a, o, l, u) {
                var f = (o - s) * 0.5,
                  c = (l - a) * 0.5,
                  h = u * u,
                  p = u * h;
                return (
                  (2 * a - 2 * o + f + c) * p +
                  (-3 * a + 3 * o - 2 * f - c) * h +
                  f * u +
                  a
                );
              },
            },
          };
          r.default = n;
        })(Interpolation)),
      Interpolation
    );
  }
  function _instanceof$4(r, n) {
    return n != null && typeof Symbol != "undefined" && n[Symbol.hasInstance]
      ? !!n[Symbol.hasInstance](r)
      : r instanceof n;
  }
  var _typeof$3 = function (r) {
      return r && typeof Symbol != "undefined" && r.constructor === Symbol
        ? "symbol"
        : typeof r;
    },
    hasRequiredClip;
  function requireClip() {
    return (
      hasRequiredClip ||
        ((hasRequiredClip = 1),
        (function (r) {
          var n = function (v) {
              return v && v.__esModule ? v : { default: v };
            },
            i = function (v, y) {
              if (!_instanceof$4(v, y))
                throw new TypeError("Cannot call a class as a function");
            },
            s = function (v, y) {
              if (!v)
                throw new ReferenceError(
                  "this hasn't been initialised - super() hasn't been called"
                );
              return y && (typeof y == "object" || typeof y == "function")
                ? y
                : v;
            },
            a = function (v, y) {
              if (typeof y != "function" && y !== null)
                throw new TypeError(
                  "Super expression must either be null or a function, not " +
                    (typeof y == "undefined" ? "undefined" : _typeof$3(y))
                );
              (v.prototype = Object.create(y && y.prototype, {
                constructor: {
                  value: v,
                  enumerable: !1,
                  writable: !0,
                  configurable: !0,
                },
              })),
                y &&
                  (Object.setPrototypeOf
                    ? Object.setPrototypeOf(v, y)
                    : (v.__proto__ = y));
            };
          Object.defineProperty(r, "__esModule", { value: !0 });
          var o = (function () {
              var g = function (y, _) {
                for (var b = 0; b < _.length; b++) {
                  var S = _[b];
                  (S.enumerable = S.enumerable || !1),
                    (S.configurable = !0),
                    "value" in S && (S.writable = !0),
                    Object.defineProperty(y, S.key, S);
                }
              };
              return function (v, y, _) {
                return y && g(v.prototype, y), _ && g(v, _), v;
              };
            })(),
            l = requireEventemitter(),
            u = n(l),
            f = requireEasing(),
            c = n(f),
            h = requireInterpolation(),
            p = n(h),
            d = requireDefine(),
            m = (function (g) {
              a(v, g),
                o(v, null, [
                  {
                    key: "registerPlugin",
                    value: function (_) {
                      var b = _.type,
                        S = this._plugins,
                        P = S && S[b];
                      P || ((this._plugins = S || {}), (this._plugins[b] = _));
                    },
                  },
                ]);
              function v(y, _) {
                i(this, v);
                var b = s(
                  this,
                  (v.__proto__ || Object.getPrototypeOf(v)).call(this)
                );
                return (
                  (b._options = {}),
                  (b._attr = {}),
                  (b._startAt = 0),
                  (b._stopped = !0),
                  (b._paused = !1),
                  (b._startTime = 0),
                  (b._pauseStart = 0),
                  (b._pauseTime = 0),
                  (b._reversed = !1),
                  (b._chainClips = []),
                  (b._tracks = []),
                  (b._interpolation = p.default.Linear),
                  (b._options = y || {}),
                  (b._attr = _),
                  b._initOption(y),
                  (b._tracks = b._transform(_)),
                  b
                );
              }
              return (
                o(v, [
                  {
                    key: "_initOption",
                    value: function (_) {
                      var b = _[d.Attr.EASING] || d.Easing.LINEAR;
                      (this._easing = c.default[b] ? c.default[b] : b),
                        (this._delay = _[d.Attr.DELAY] || 0);
                      var S = _[d.Attr.DURATION];
                      (this._duration = typeof S == "undefined" ? 1e3 : S),
                        (this._repeat_0 = this._repeat = _[d.Attr.REPEAT] || 1),
                        (this._interval = _[d.Attr.INTERVAL] || 0),
                        (this._yoyo = _[d.Attr.YOYO] || !1),
                        (this._startAt = _[d.Attr.START] || 0);
                    },
                  },
                  {
                    key: "_transform",
                    value: function (_) {
                      var b = this.constructor._plugins,
                        S = [];
                      for (var P in _)
                        if (_.hasOwnProperty(P)) {
                          var I = _[P];
                          for (var F in b) {
                            var X = b[F];
                            if (X.test(I, P)) {
                              (I = X.parse(I, P)), (I.__type__ = X.type);
                              break;
                            }
                          }
                          S.push({ key: P, value: I });
                        }
                      return S;
                    },
                  },
                  {
                    key: "start",
                    value: function (_) {
                      var b = window.performance.now(),
                        S = !1;
                      if (this._paused)
                        (this._pauseTime += b - this._pauseStart),
                          (this._paused = !1);
                      else {
                        if (!_ && !this._stopped) return this;
                        (S = !0),
                          (this._stopped = !1),
                          (this._startTime = b + this._delay);
                      }
                      this.emit(d.Ev.START);
                      var P = this._repeat;
                      return (
                        P > 1 &&
                          P === this._repeat_0 &&
                          S &&
                          this.emit(d.Ev.REPEAT, { remain: 0 }),
                        this
                      );
                    },
                  },
                  {
                    key: "stop",
                    value: function (_) {
                      return (
                        this._stopped ||
                          ((this._stopped = !0),
                          (this._paused = !1),
                          (this._pauseTime = 0),
                          (this._pauseStart = 0),
                          this.emit(d.Ev.STOP),
                          this.stopChain()),
                        _ && (this._repeat = this._repeat_0),
                        this
                      );
                    },
                  },
                  {
                    key: "pause",
                    value: function () {
                      return this._stopped || this._paused
                        ? this
                        : ((this._paused = !0),
                          (this._pauseStart = window.performance.now()),
                          this.emit(d.Ev.PAUSE),
                          this);
                    },
                  },
                  {
                    key: "update",
                    value: function (_) {
                      if (
                        this._stopped ||
                        this._paused ||
                        (_ && _ < this._startTime)
                      )
                        return !0;
                      var b = _ - this._pauseTime,
                        S = this._getProgress(b),
                        P = S.progress,
                        I = S.elapsed,
                        F = this._updateAttr(P, I);
                      return (
                        this.emit(d.Ev.UPDATE, {
                          progress: P,
                          keyframe: F,
                          elapsed: I,
                        }),
                        this._afterUpdate(b, I)
                      );
                    },
                  },
                  {
                    key: "_getProgress",
                    value: function (_) {
                      var b = (_ - this._startTime) / this._duration;
                      (b += this._startAt), (b = Math.min(b, 1));
                      var S = this._easing(this._reversed ? 1 - b : b);
                      return { progress: S, elapsed: b };
                    },
                  },
                  {
                    key: "_updateAttr",
                    value: function (_, b) {
                      for (
                        var S = this._tracks, P = {}, I = 0, F = S.length;
                        I < F;

                      ) {
                        var X = S[I++],
                          W = X.key,
                          Z = X.value,
                          j = Z.__type__;
                        if (j) {
                          var L = this.constructor._plugins[j];
                          Z = L.valueOf(Z, _, b, W);
                        } else Z = this._interpolation(Z, _);
                        P[W] = Z;
                      }
                      return P;
                    },
                  },
                  {
                    key: "_afterUpdate",
                    value: function (_, b) {
                      if (b === 1) {
                        var S = this._repeat,
                          P = this._repeat_0;
                        if (S > 1)
                          return (
                            isFinite(S) && S--,
                            (this._startTime = _ + this._interval),
                            (this._startAt = 0),
                            this._yoyo && (this._reversed = !this._reversed),
                            (this._repeat = S),
                            this.emit(d.Ev.REPEAT_COMPLETE, { repeat: S }),
                            this.emit(d.Ev.REPEAT, { remain: P - S }),
                            !0
                          );
                        (this._stopped = !0),
                          (this._pauseTime = 0),
                          (this._pauseStart = 0),
                          (this._repeat = P),
                          P > 1 &&
                            this.emit(d.Ev.REPEAT_COMPLETE, { repeat: 0 }),
                          this.emit(d.Ev.COMPLETE);
                        for (
                          var I = -1,
                            F = this._chainClips,
                            X = F.length,
                            W = this._animation;
                          ++I < X;

                        ) {
                          var Z = F[I];
                          W && W._addClip(Z), Z.start();
                        }
                        return !1;
                      }
                      return !0;
                    },
                  },
                  {
                    key: "chain",
                    value: function () {
                      for (
                        var _ = arguments.length, b = Array(_), S = 0;
                        S < _;
                        S++
                      )
                        b[S] = arguments[S];
                      return (this._chainClips = b), this;
                    },
                  },
                  {
                    key: "stopChain",
                    value: function () {
                      for (
                        var _ = -1, b = this._chainClips, S = b.length;
                        ++_ < S;

                      ) {
                        var P = b[_];
                        P.stop();
                      }
                      return this;
                    },
                  },
                  {
                    key: "destroy",
                    value: function () {
                      this.off(),
                        (this._stopped = !0),
                        (this._paused = !1),
                        (this._startTime = 0),
                        (this._pauseTime = 0),
                        (this._pauseStart = 0),
                        (this._chainClips = []);
                      var _ = this._animation;
                      _ && _.removeClip(this), (this._animation = null);
                    },
                  },
                ]),
                v
              );
            })(u.default);
          (m.Event = d.Ev),
            (m.Attr = d.Attr),
            (m.Easing = d.Easing),
            (r.default = m);
        })(clip)),
      clip
    );
  }
  var hasRequiredCore;
  function requireCore() {
    return (
      hasRequiredCore ||
        ((hasRequiredCore = 1),
        (function (r) {
          var n = function (u) {
            return u && u.__esModule ? u : { default: u };
          };
          Object.defineProperty(r, "__esModule", { value: !0 }),
            (r.Clip = r.Animation = void 0);
          var i = requireAnimation(),
            s = n(i),
            a = requireClip(),
            o = n(a);
          (r.default = { Animation: s.default, Clip: o.default }),
            (r.Animation = s.default),
            (r.Clip = o.default);
        })(core)),
      core
    );
  }
  var color$2 = {},
    color$1 = {},
    colorhelper = {},
    csscolorparser = {},
    hasRequiredCsscolorparser;
  function requireCsscolorparser() {
    var r = function (f) {
        return (f = Math.round(f)), f < 0 ? 0 : f > 255 ? 255 : f;
      },
      n = function (f) {
        return f < 0 ? 0 : f > 1 ? 1 : f;
      },
      i = function (f) {
        return f[f.length - 1] === "%"
          ? r((parseFloat(f) / 100) * 255)
          : r(parseInt(f));
      },
      s = function (f) {
        return f[f.length - 1] === "%"
          ? n(parseFloat(f) / 100)
          : n(parseFloat(f));
      },
      a = function (f, c, h) {
        return (
          h < 0 ? (h += 1) : h > 1 && (h -= 1),
          h * 6 < 1
            ? f + (c - f) * h * 6
            : h * 2 < 1
            ? c
            : h * 3 < 2
            ? f + (c - f) * (0.6666666666666666 - h) * 6
            : f
        );
      },
      o = function (f) {
        var c = f.replace(/ /g, "").toLowerCase();
        if (c in l) return l[c].slice();
        if (c[0] === "#") {
          if (c.length === 4) {
            var h = parseInt(c.substr(1), 16);
            return h >= 0 && h <= 4095
              ? [
                  ((h & 3840) >> 4) | ((h & 3840) >> 8),
                  (h & 240) | ((h & 240) >> 4),
                  (h & 15) | ((h & 15) << 4),
                  1,
                ]
              : null;
          } else if (c.length === 7) {
            var h = parseInt(c.substr(1), 16);
            return h >= 0 && h <= 16777215
              ? [(h & 16711680) >> 16, (h & 65280) >> 8, h & 255, 1]
              : null;
          }
          return null;
        }
        var p = c.indexOf("("),
          d = c.indexOf(")");
        if (p !== -1 && d + 1 === c.length) {
          var m = c.substr(0, p),
            g = c.substr(p + 1, d - (p + 1)).split(","),
            v = 1;
          switch (m) {
            case "rgba":
              if (g.length !== 4) return null;
              v = s(g.pop());
            case "rgb":
              return g.length !== 3 ? null : [i(g[0]), i(g[1]), i(g[2]), v];
            case "hsla":
              if (g.length !== 4) return null;
              v = s(g.pop());
            case "hsl":
              if (g.length !== 3) return null;
              var y = (((parseFloat(g[0]) % 360) + 360) % 360) / 360,
                _ = s(g[1]),
                b = s(g[2]),
                S = b <= 0.5 ? b * (_ + 1) : b + _ - b * _,
                P = b * 2 - S;
              return [
                r(a(P, S, y + 0.3333333333333333) * 255),
                r(a(P, S, y) * 255),
                r(a(P, S, y - 0.3333333333333333) * 255),
                v,
              ];
            default:
              return null;
          }
        }
        return null;
      };
    if (hasRequiredCsscolorparser) return csscolorparser;
    hasRequiredCsscolorparser = 1;
    var l = {
      transparent: [0, 0, 0, 0],
      aliceblue: [240, 248, 255, 1],
      antiquewhite: [250, 235, 215, 1],
      aqua: [0, 255, 255, 1],
      aquamarine: [127, 255, 212, 1],
      azure: [240, 255, 255, 1],
      beige: [245, 245, 220, 1],
      bisque: [255, 228, 196, 1],
      black: [0, 0, 0, 1],
      blanchedalmond: [255, 235, 205, 1],
      blue: [0, 0, 255, 1],
      blueviolet: [138, 43, 226, 1],
      brown: [165, 42, 42, 1],
      burlywood: [222, 184, 135, 1],
      cadetblue: [95, 158, 160, 1],
      chartreuse: [127, 255, 0, 1],
      chocolate: [210, 105, 30, 1],
      coral: [255, 127, 80, 1],
      cornflowerblue: [100, 149, 237, 1],
      cornsilk: [255, 248, 220, 1],
      crimson: [220, 20, 60, 1],
      cyan: [0, 255, 255, 1],
      darkblue: [0, 0, 139, 1],
      darkcyan: [0, 139, 139, 1],
      darkgoldenrod: [184, 134, 11, 1],
      darkgray: [169, 169, 169, 1],
      darkgreen: [0, 100, 0, 1],
      darkgrey: [169, 169, 169, 1],
      darkkhaki: [189, 183, 107, 1],
      darkmagenta: [139, 0, 139, 1],
      darkolivegreen: [85, 107, 47, 1],
      darkorange: [255, 140, 0, 1],
      darkorchid: [153, 50, 204, 1],
      darkred: [139, 0, 0, 1],
      darksalmon: [233, 150, 122, 1],
      darkseagreen: [143, 188, 143, 1],
      darkslateblue: [72, 61, 139, 1],
      darkslategray: [47, 79, 79, 1],
      darkslategrey: [47, 79, 79, 1],
      darkturquoise: [0, 206, 209, 1],
      darkviolet: [148, 0, 211, 1],
      deeppink: [255, 20, 147, 1],
      deepskyblue: [0, 191, 255, 1],
      dimgray: [105, 105, 105, 1],
      dimgrey: [105, 105, 105, 1],
      dodgerblue: [30, 144, 255, 1],
      firebrick: [178, 34, 34, 1],
      floralwhite: [255, 250, 240, 1],
      forestgreen: [34, 139, 34, 1],
      fuchsia: [255, 0, 255, 1],
      gainsboro: [220, 220, 220, 1],
      ghostwhite: [248, 248, 255, 1],
      gold: [255, 215, 0, 1],
      goldenrod: [218, 165, 32, 1],
      gray: [128, 128, 128, 1],
      green: [0, 128, 0, 1],
      greenyellow: [173, 255, 47, 1],
      grey: [128, 128, 128, 1],
      honeydew: [240, 255, 240, 1],
      hotpink: [255, 105, 180, 1],
      indianred: [205, 92, 92, 1],
      indigo: [75, 0, 130, 1],
      ivory: [255, 255, 240, 1],
      khaki: [240, 230, 140, 1],
      lavender: [230, 230, 250, 1],
      lavenderblush: [255, 240, 245, 1],
      lawngreen: [124, 252, 0, 1],
      lemonchiffon: [255, 250, 205, 1],
      lightblue: [173, 216, 230, 1],
      lightcoral: [240, 128, 128, 1],
      lightcyan: [224, 255, 255, 1],
      lightgoldenrodyellow: [250, 250, 210, 1],
      lightgray: [211, 211, 211, 1],
      lightgreen: [144, 238, 144, 1],
      lightgrey: [211, 211, 211, 1],
      lightpink: [255, 182, 193, 1],
      lightsalmon: [255, 160, 122, 1],
      lightseagreen: [32, 178, 170, 1],
      lightskyblue: [135, 206, 250, 1],
      lightslategray: [119, 136, 153, 1],
      lightslategrey: [119, 136, 153, 1],
      lightsteelblue: [176, 196, 222, 1],
      lightyellow: [255, 255, 224, 1],
      lime: [0, 255, 0, 1],
      limegreen: [50, 205, 50, 1],
      linen: [250, 240, 230, 1],
      magenta: [255, 0, 255, 1],
      maroon: [128, 0, 0, 1],
      mediumaquamarine: [102, 205, 170, 1],
      mediumblue: [0, 0, 205, 1],
      mediumorchid: [186, 85, 211, 1],
      mediumpurple: [147, 112, 219, 1],
      mediumseagreen: [60, 179, 113, 1],
      mediumslateblue: [123, 104, 238, 1],
      mediumspringgreen: [0, 250, 154, 1],
      mediumturquoise: [72, 209, 204, 1],
      mediumvioletred: [199, 21, 133, 1],
      midnightblue: [25, 25, 112, 1],
      mintcream: [245, 255, 250, 1],
      mistyrose: [255, 228, 225, 1],
      moccasin: [255, 228, 181, 1],
      navajowhite: [255, 222, 173, 1],
      navy: [0, 0, 128, 1],
      oldlace: [253, 245, 230, 1],
      olive: [128, 128, 0, 1],
      olivedrab: [107, 142, 35, 1],
      orange: [255, 165, 0, 1],
      orangered: [255, 69, 0, 1],
      orchid: [218, 112, 214, 1],
      palegoldenrod: [238, 232, 170, 1],
      palegreen: [152, 251, 152, 1],
      paleturquoise: [175, 238, 238, 1],
      palevioletred: [219, 112, 147, 1],
      papayawhip: [255, 239, 213, 1],
      peachpuff: [255, 218, 185, 1],
      peru: [205, 133, 63, 1],
      pink: [255, 192, 203, 1],
      plum: [221, 160, 221, 1],
      powderblue: [176, 224, 230, 1],
      purple: [128, 0, 128, 1],
      rebeccapurple: [102, 51, 153, 1],
      red: [255, 0, 0, 1],
      rosybrown: [188, 143, 143, 1],
      royalblue: [65, 105, 225, 1],
      saddlebrown: [139, 69, 19, 1],
      salmon: [250, 128, 114, 1],
      sandybrown: [244, 164, 96, 1],
      seagreen: [46, 139, 87, 1],
      seashell: [255, 245, 238, 1],
      sienna: [160, 82, 45, 1],
      silver: [192, 192, 192, 1],
      skyblue: [135, 206, 235, 1],
      slateblue: [106, 90, 205, 1],
      slategray: [112, 128, 144, 1],
      slategrey: [112, 128, 144, 1],
      snow: [255, 250, 250, 1],
      springgreen: [0, 255, 127, 1],
      steelblue: [70, 130, 180, 1],
      tan: [210, 180, 140, 1],
      teal: [0, 128, 128, 1],
      thistle: [216, 191, 216, 1],
      tomato: [255, 99, 71, 1],
      turquoise: [64, 224, 208, 1],
      violet: [238, 130, 238, 1],
      wheat: [245, 222, 179, 1],
      white: [255, 255, 255, 1],
      whitesmoke: [245, 245, 245, 1],
      yellow: [255, 255, 0, 1],
      yellowgreen: [154, 205, 50, 1],
    };
    try {
      csscolorparser.parseCSSColor = o;
    } catch (u) {}
    return csscolorparser;
  }
  var hasRequiredColorhelper;
  function requireColorhelper() {
    return (
      hasRequiredColorhelper ||
        ((hasRequiredColorhelper = 1),
        (function (r) {
          var n = function (h) {
              return h && h.__esModule ? h : { default: h };
            },
            i = function (h) {
              return (h = Math.round(h)), h < 0 ? 0 : h > 255 ? 255 : h;
            },
            s = function (h) {
              return h < 0 ? 0 : h > 1 ? 1 : h;
            };
          Object.defineProperty(r, "__esModule", { value: !0 });
          var a = (function () {
              var c = function (p, d) {
                var m = [],
                  g = !0,
                  v = !1,
                  y = void 0;
                try {
                  for (
                    var _ = p[Symbol.iterator](), b;
                    !(g = (b = _.next()).done) &&
                    (m.push(b.value), !(d && m.length === d));
                    g = !0
                  );
                } catch (S) {
                  (v = !0), (y = S);
                } finally {
                  try {
                    !g && _.return && _.return();
                  } finally {
                    if (v) throw y;
                  }
                }
                return m;
              };
              return function (h, p) {
                if (Array.isArray(h)) return h;
                if (Symbol.iterator in Object(h)) return c(h, p);
                throw new TypeError(
                  "Invalid attempt to destructure non-iterable instance"
                );
              };
            })(),
            o = requireCsscolorparser(),
            l = n(o),
            u = l.default.parseCSSColor,
            f = {
              isColor: function (h) {
                if (typeof h == "string") return !!(0, l.default)(h);
                if (Array.isArray(h)) {
                  for (var p = 0, d = h.length; p < d; ) {
                    var m = h[p++];
                    if (typeof m == "string") {
                      if (!u(m)) return !1;
                    } else return !1;
                  }
                  return !0;
                }
                return !1;
              },
              toColorIncrease: function (h) {
                return [h[0] || 0, h[1] || 0, h[2] || 0, h[3] || 0];
              },
              toNormal: function (h) {
                if (Array.isArray(h)) {
                  for (var p = [], d = 0, m = h.length; d < m; ) {
                    var g = h[d++];
                    if (typeof g == "string") {
                      var v = u(g);
                      if (v) p.push(v);
                      else return null;
                    } else return null;
                  }
                  return p;
                } else return typeof h == "string" ? u(h) : null;
              },
              toNormalArray: function (h) {
                if (Array.isArray(h)) {
                  for (var p = [], d = 0, m = h.length; d < m; ) {
                    var g = h[d++];
                    if (typeof g == "string") {
                      var v = u(g);
                      if (v) p.push(v);
                      else return null;
                    } else return null;
                  }
                  return p;
                } else return typeof h == "string" ? [u(h)] : null;
              },
              linearGradient: function (h) {
                var p =
                    arguments.length > 1 && arguments[1] !== void 0
                      ? arguments[1]
                      : 0,
                  d =
                    arguments.length > 2 && arguments[2] !== void 0
                      ? arguments[2]
                      : f.Utils.Linear,
                  m = h.length - 1,
                  g = m * p,
                  v = g >> 0,
                  y = d,
                  _ = function (F, X, W) {
                    var Z = a(F, 4),
                      j = Z[0],
                      L = Z[1],
                      T = Z[2],
                      A = Z[3],
                      $ = a(X, 4),
                      R = $[0],
                      M = $[1],
                      w = $[2],
                      O = $[3],
                      E = [
                        y(j, R, W) >> 0,
                        y(L, M, W) >> 0,
                        y(T, w, W) >> 0,
                        y(A, O, W),
                      ];
                    return E;
                  },
                  b = h[v],
                  S = h[v + 1 > m ? m : v + 1],
                  P = g - v;
                return _(b, S, P);
              },
              mixColors: function (h, p) {
                var d = this.toNormal(h);
                if (Array.isArray(p) && d) {
                  var m = [
                      i(d[0] + p[0] || 0),
                      i(d[1] + p[1] || 0),
                      i(d[2] + p[2] || 0),
                      s(d[3] + p[3] || 0),
                    ],
                    g = m[0],
                    v = m[1],
                    y = m[2],
                    _ = m[3],
                    b = [g, v, y, _].join(",");
                  return "rgba(" + b + ")";
                } else return h;
              },
              toRGBA: function (h) {
                if (h && h.length >= 3) {
                  var p = typeof h[3] == "undefined" ? 1 : h[3],
                    d = i(h[0]),
                    m = i(h[1]),
                    g = i(h[2]),
                    v = s(p);
                  return "rgba(" + d + "," + m + "," + g + "," + v + ")";
                } else return "transparent";
              },
              Utils: {
                Linear: function (h, p, d) {
                  return (p - h) * d + h;
                },
              },
            };
          r.default = f;
        })(colorhelper)),
      colorhelper
    );
  }
  var hasRequiredColor$1;
  function requireColor$1() {
    return (
      hasRequiredColor$1 ||
        ((hasRequiredColor$1 = 1),
        (function (r) {
          var n = function (f) {
            return f && f.__esModule ? f : { default: f };
          };
          Object.defineProperty(r, "__esModule", { value: !0 });
          var i = requireClip(),
            s = n(i),
            a = requireColorhelper(),
            o = n(a),
            l = {
              type: "color",
              test: function (f, c) {
                return o.default.isColor(f);
              },
              parse: function (f, c) {
                return o.default.toNormalArray(f);
              },
              valueOf: function (f, c, h, p) {
                var d = o.default.linearGradient(f, c);
                return (d = o.default.toRGBA(d)), d;
              },
            };
          s.default.registerPlugin(l), (r.default = l);
        })(color$1)),
      color$1
    );
  }
  var hasRequiredColor;
  function requireColor() {
    return (
      hasRequiredColor || ((hasRequiredColor = 1), requireColor$1()), color$2
    );
  }
  var coordinate2d$1 = {},
    coordinate2d = {},
    vector = {},
    hasRequiredVector;
  function requireVector() {
    return (
      hasRequiredVector ||
        ((hasRequiredVector = 1),
        (function (r) {
          Object.defineProperty(r, "__esModule", { value: !0 });
          var n = typeof Float32Array == "undefined" ? Array : Float32Array,
            i = {
              create: function () {
                var a =
                    arguments.length > 0 && arguments[0] !== void 0
                      ? arguments[0]
                      : 0,
                  o =
                    arguments.length > 1 && arguments[1] !== void 0
                      ? arguments[1]
                      : 0,
                  l = new n(2);
                return (l[0] = a), (l[1] = o), l;
              },
              copy: function (a, o) {
                return (a[0] = o[0]), (a[1] = o[1]), a;
              },
              clone: function (a) {
                var o = new n(2);
                return (o[0] = a[0]), (o[1] = a[1]), o;
              },
              set: function (a, o, l) {
                return (a[0] = o), (a[1] = l), a;
              },
              add: function (a, o, l) {
                return (a[0] = o[0] + l[0]), (a[1] = o[1] + l[1]), a;
              },
              scaleAndAdd: function (a, o, l, u) {
                return (a[0] = o[0] + l[0] * u), (a[1] = o[1] + l[1] * u), a;
              },
              sub: function (a, o, l) {
                return (a[0] = o[0] - l[0]), (a[1] = o[1] - l[1]), a;
              },
              length: function (a) {
                return Math.sqrt(this.lengthSquare(a));
              },
              lengthSquare: function (a) {
                return a[0] * a[0] + a[1] * a[1];
              },
              multiply: function (a, o, l) {
                return (a[0] = o[0] * l[0]), (a[1] = o[1] * l[1]), a;
              },
              divide: function (a, o, l) {
                return (a[0] = o[0] / l[0]), (a[1] = o[1] / l[1]), a;
              },
              dot: function (a, o) {
                return a[0] * o[0] + a[1] * o[1];
              },
              scale: function (a, o, l) {
                return (a[0] = o[0] * l), (a[1] = o[1] * l), a;
              },
              normalize: function (a, o) {
                var l = this.len(o);
                return (
                  l === 0
                    ? ((a[0] = 0), (a[1] = 0))
                    : ((a[0] = o[0] / l), (a[1] = o[1] / l)),
                  a
                );
              },
              distance: function (a, o) {
                return Math.sqrt(this.distanceSquare(a, o));
              },
              distanceSquare: function (a, o) {
                return (
                  (a[0] - o[0]) * (a[0] - o[0]) + (a[1] - o[1]) * (a[1] - o[1])
                );
              },
              negate: function (a, o) {
                return (a[0] = -o[0]), (a[1] = -o[1]), a;
              },
              lerp: function (a, o, l, u) {
                return (
                  (a[0] = o[0] + u * (l[0] - o[0])),
                  (a[1] = o[1] + u * (l[1] - o[1])),
                  a
                );
              },
              applyTransform: function (a, o, l) {
                var u = o[0],
                  f = o[1];
                return (
                  (a[0] = l[0] * u + l[2] * f + l[4]),
                  (a[1] = l[1] * u + l[3] * f + l[5]),
                  a
                );
              },
              min: function (a, o, l) {
                return (
                  (a[0] = Math.min(o[0], l[0])),
                  (a[1] = Math.min(o[1], l[1])),
                  a
                );
              },
              max: function (a, o, l) {
                return (
                  (a[0] = Math.max(o[0], l[0])),
                  (a[1] = Math.max(o[1], l[1])),
                  a
                );
              },
              getAngle: function (a, o) {
                var l = 0,
                  u = a[0] - o[0];
                return u != 0 && (l = Math.atan2(a[1] - o[1], a[0] - o[0])), l;
              },
            };
          (i.len = i.length),
            (i.lenSquare = i.lengthSquare),
            (i.dist = i.distance),
            (i.distSquare = i.distanceSquare),
            (r.default = i);
        })(vector)),
      vector
    );
  }
  var hasRequiredCoordinate2d$1;
  function requireCoordinate2d$1() {
    return (
      hasRequiredCoordinate2d$1 ||
        ((hasRequiredCoordinate2d$1 = 1),
        (function (r) {
          var n = function (h) {
              return h && h.__esModule ? h : { default: h };
            },
            i = function (h) {
              for (
                var p = 0, d = h.length, m = 0, g = [], v = [], y = 0;
                p < d - 1;

              ) {
                var _ = h[p],
                  b = h[p + 1],
                  S = u.default.distance(_, b);
                (m += S),
                  (y = u.default.getAngle(b, _)),
                  g.push(_),
                  v.push({
                    length: m,
                    segmentLength: S,
                    segment: [_.slice(), b.slice()],
                    path: g.slice(),
                    angle: y,
                  }),
                  p++;
              }
              return (v.sum = m), v;
            };
          Object.defineProperty(r, "__esModule", { value: !0 });
          var s = (function () {
              var c = function (p, d) {
                var m = [],
                  g = !0,
                  v = !1,
                  y = void 0;
                try {
                  for (
                    var _ = p[Symbol.iterator](), b;
                    !(g = (b = _.next()).done) &&
                    (m.push(b.value), !(d && m.length === d));
                    g = !0
                  );
                } catch (S) {
                  (v = !0), (y = S);
                } finally {
                  try {
                    !g && _.return && _.return();
                  } finally {
                    if (v) throw y;
                  }
                }
                return m;
              };
              return function (h, p) {
                if (Array.isArray(h)) return h;
                if (Symbol.iterator in Object(h)) return c(h, p);
                throw new TypeError(
                  "Invalid attempt to destructure non-iterable instance"
                );
              };
            })(),
            a = requireClip(),
            o = n(a),
            l = requireVector(),
            u = n(l),
            f = {
              type: "coordinate-2d",
              test: function (h, p) {
                var d = !1;
                if (Array.isArray(h))
                  for (var m = -1, g = h.length; ++m < g; ) {
                    var v = h[m];
                    if (Array.isArray(v)) {
                      var y = s(v, 2),
                        _ = y[0],
                        b = y[1],
                        S = [+_, +b];
                      (_ = S[0]),
                        (b = S[1]),
                        (d =
                          typeof _ == "number" &&
                          typeof b == "number" &&
                          isFinite(_) &&
                          isFinite(b));
                    }
                  }
                return d;
              },
              parse: function (h, p) {
                for (var d = [], m = -1, g = h.length; ++m < g; ) {
                  var v = h[m],
                    y = s(v, 2),
                    _ = y[0],
                    b = y[1],
                    S = [+_, +b];
                  (_ = S[0]), (b = S[1]), d.push([_, b]);
                }
                var P = i(d);
                return P;
              },
              valueOf: function (h, p, d, m) {
                for (
                  var g = h.sum, v = g * p, y = -1, _ = h.length, b = h[0];
                  ++y < _;

                ) {
                  var S = h[y];
                  if (v <= S.length) {
                    b = S;
                    break;
                  }
                }
                var P = s(b.segment, 2),
                  I = P[0],
                  F = P[1],
                  X = 0;
                y == 0 ? (X = v) : (X = v - h[y - 1].length);
                var W = X / b.segmentLength,
                  Z = u.default.create(),
                  j = u.default.create();
                return (
                  u.default.sub(Z, F, I),
                  u.default.scaleAndAdd(j, I, Z, W),
                  (j.step = b),
                  j
                );
              },
            };
          o.default.registerPlugin(f), (r.default = f);
        })(coordinate2d)),
      coordinate2d
    );
  }
  var hasRequiredCoordinate2d;
  function requireCoordinate2d() {
    return (
      hasRequiredCoordinate2d ||
        ((hasRequiredCoordinate2d = 1), requireCoordinate2d$1()),
      coordinate2d$1
    );
  }
  var hasRequiredChito;
  function requireChito() {
    return (
      hasRequiredChito ||
        ((hasRequiredChito = 1),
        (function (r) {
          var n = requireCore(),
            i = n.Animation,
            s = n.Clip;
          requireColor(),
            requireCoordinate2d(),
            (r.exports.default = { Animation: i, Clip: s }),
            (r.exports.Animation = i),
            (r.exports.Clip = s);
        })(chito)),
      chito.exports
    );
  }
  var bezier$1 = {};
  function _arrayLikeToArray$1(r, n) {
    (n == null || n > r.length) && (n = r.length);
    for (var i = 0, s = new Array(n); i < n; i++) s[i] = r[i];
    return s;
  }
  function _arrayWithoutHoles$1(r) {
    if (Array.isArray(r)) return _arrayLikeToArray$1(r);
  }
  function _classCallCheck$1(r, n) {
    if (!(r instanceof n))
      throw new TypeError("Cannot call a class as a function");
  }
  function _defineProperties$1(r, n) {
    for (var i = 0; i < n.length; i++) {
      var s = n[i];
      (s.enumerable = s.enumerable || !1),
        (s.configurable = !0),
        "value" in s && (s.writable = !0),
        Object.defineProperty(r, s.key, s);
    }
  }
  function _createClass$1(r, n, i) {
    return (
      n && _defineProperties$1(r.prototype, n),
      i && _defineProperties$1(r, i),
      r
    );
  }
  function _instanceof$3(r, n) {
    return n != null && typeof Symbol != "undefined" && n[Symbol.hasInstance]
      ? !!n[Symbol.hasInstance](r)
      : r instanceof n;
  }
  function _iterableToArray$1(r) {
    if (
      (typeof Symbol != "undefined" && r[Symbol.iterator] != null) ||
      r["@@iterator"] != null
    )
      return Array.from(r);
  }
  function _nonIterableSpread$1() {
    throw new TypeError(
      "Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."
    );
  }
  function _toConsumableArray$1(r) {
    return (
      _arrayWithoutHoles$1(r) ||
      _iterableToArray$1(r) ||
      _unsupportedIterableToArray$1(r) ||
      _nonIterableSpread$1()
    );
  }
  function _unsupportedIterableToArray$1(r, n) {
    if (!!r) {
      if (typeof r == "string") return _arrayLikeToArray$1(r, n);
      var i = Object.prototype.toString.call(r).slice(8, -1);
      if (
        (i === "Object" && r.constructor && (i = r.constructor.name),
        i === "Map" || i === "Set")
      )
        return Array.from(i);
      if (
        i === "Arguments" ||
        /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)
      )
        return _arrayLikeToArray$1(r, n);
    }
  }
  var hasRequiredBezier;
  function requireBezier() {
    var r = function (L) {
      return L < 0 ? -u(-L, 0.3333333333333333) : u(L, 0.3333333333333333);
    };
    if (hasRequiredBezier) return bezier$1;
    (hasRequiredBezier = 1),
      Object.defineProperty(bezier$1, "__esModule", { value: !0 }),
      (bezier$1.Bezier = void 0);
    var n = Math.abs,
      i = Math.cos,
      s = Math.sin,
      a = Math.acos,
      o = Math.atan2,
      l = Math.sqrt,
      u = Math.pow,
      f = Math.PI,
      c = 2 * f,
      h = f / 2,
      p = 1e-6,
      d = Number.MAX_SAFE_INTEGER || 9007199254740991,
      m = Number.MIN_SAFE_INTEGER || -9007199254740991,
      g = { x: 0, y: 0, z: 0 },
      v = {
        Tvalues: [
          -0.06405689286260563, 0.06405689286260563, -0.1911188674736163,
          0.1911188674736163, -0.3150426796961634, 0.3150426796961634,
          -0.4337935076260451, 0.4337935076260451, -0.5454214713888396,
          0.5454214713888396, -0.6480936519369755, 0.6480936519369755,
          -0.7401241915785544, 0.7401241915785544, -0.820001985973903,
          0.820001985973903, -0.8864155270044011, 0.8864155270044011,
          -0.9382745520027328, 0.9382745520027328, -0.9747285559713095,
          0.9747285559713095, -0.9951872199970213, 0.9951872199970213,
        ],
        Cvalues: [
          0.12793819534675216, 0.12793819534675216, 0.1258374563468283,
          0.1258374563468283, 0.12167047292780339, 0.12167047292780339,
          0.1155056680537256, 0.1155056680537256, 0.10744427011596563,
          0.10744427011596563, 0.09761865210411388, 0.09761865210411388,
          0.08619016153195327, 0.08619016153195327, 0.0733464814110803,
          0.0733464814110803, 0.05929858491543678, 0.05929858491543678,
          0.04427743881741981, 0.04427743881741981, 0.028531388628933663,
          0.028531388628933663, 0.0123412297999872, 0.0123412297999872,
        ],
        arcfn: function (L, T) {
          var A = T(L),
            $ = A.x * A.x + A.y * A.y;
          return typeof A.z != "undefined" && ($ += A.z * A.z), l($);
        },
        compute: function (L, T, A) {
          if (L === 0) return (T[0].t = 0), T[0];
          var $ = T.length - 1;
          if (L === 1) return (T[$].t = 1), T[$];
          var R = 1 - L,
            M = T;
          if ($ === 0) return (T[0].t = L), T[0];
          if ($ === 1) {
            var w = {
              x: R * M[0].x + L * M[1].x,
              y: R * M[0].y + L * M[1].y,
              t: L,
            };
            return A && (w.z = R * M[0].z + L * M[1].z), w;
          }
          if ($ < 4) {
            var O = R * R,
              E = L * L,
              k,
              D,
              q,
              J = 0;
            $ === 2
              ? ((M = [M[0], M[1], M[2], g]), (k = O), (D = R * L * 2), (q = E))
              : $ === 3 &&
                ((k = O * R), (D = O * L * 3), (q = R * E * 3), (J = L * E));
            var de = {
              x: k * M[0].x + D * M[1].x + q * M[2].x + J * M[3].x,
              y: k * M[0].y + D * M[1].y + q * M[2].y + J * M[3].y,
              t: L,
            };
            return (
              A && (de.z = k * M[0].z + D * M[1].z + q * M[2].z + J * M[3].z),
              de
            );
          }
          for (var we = JSON.parse(JSON.stringify(T)); we.length > 1; ) {
            for (var Se = 0; Se < we.length - 1; Se++)
              (we[Se] = {
                x: we[Se].x + (we[Se + 1].x - we[Se].x) * L,
                y: we[Se].y + (we[Se + 1].y - we[Se].y) * L,
              }),
                typeof we[Se].z != "undefined" &&
                  (we[Se] = we[Se].z + (we[Se + 1].z - we[Se].z) * L);
            we.splice(we.length - 1, 1);
          }
          return (we[0].t = L), we[0];
        },
        computeWithRatios: function (L, T, A, $) {
          var R = 1 - L,
            M = A,
            w = T,
            O = M[0],
            E = M[1],
            k = M[2],
            D = M[3],
            q;
          if (((O *= R), (E *= L), w.length === 2))
            return (
              (q = O + E),
              {
                x: (O * w[0].x + E * w[1].x) / q,
                y: (O * w[0].y + E * w[1].y) / q,
                z: $ ? (O * w[0].z + E * w[1].z) / q : !1,
                t: L,
              }
            );
          if (((O *= R), (E *= 2 * R), (k *= L * L), w.length === 3))
            return (
              (q = O + E + k),
              {
                x: (O * w[0].x + E * w[1].x + k * w[2].x) / q,
                y: (O * w[0].y + E * w[1].y + k * w[2].y) / q,
                z: $ ? (O * w[0].z + E * w[1].z + k * w[2].z) / q : !1,
                t: L,
              }
            );
          if (
            ((O *= R),
            (E *= 1.5 * R),
            (k *= 3 * R),
            (D *= L * L * L),
            w.length === 4)
          )
            return (
              (q = O + E + k + D),
              {
                x: (O * w[0].x + E * w[1].x + k * w[2].x + D * w[3].x) / q,
                y: (O * w[0].y + E * w[1].y + k * w[2].y + D * w[3].y) / q,
                z: $
                  ? (O * w[0].z + E * w[1].z + k * w[2].z + D * w[3].z) / q
                  : !1,
                t: L,
              }
            );
        },
        derive: function (L, T) {
          for (var A = [], $ = L, R = $.length, M = R - 1; R > 1; R--, M--) {
            for (var w = [], O = 0, E = void 0; O < M; O++)
              (E = {
                x: M * ($[O + 1].x - $[O].x),
                y: M * ($[O + 1].y - $[O].y),
              }),
                T && (E.z = M * ($[O + 1].z - $[O].z)),
                w.push(E);
            A.push(w), ($ = w);
          }
          return A;
        },
        between: function (L, T, A) {
          return (
            (T <= L && L <= A) || v.approximately(L, T) || v.approximately(L, A)
          );
        },
        approximately: function (L, T, A) {
          return n(L - T) <= (A || p);
        },
        length: function (L) {
          for (var T = 0.5, A = v.Tvalues.length, $ = 0, R = 0, M; R < A; R++)
            (M = T * v.Tvalues[R] + T), ($ += v.Cvalues[R] * v.arcfn(M, L));
          return T * $;
        },
        map: function (L, T, A, $, R) {
          var M = A - T,
            w = R - $,
            O = L - T,
            E = O / M;
          return $ + w * E;
        },
        lerp: function (L, T, A) {
          var $ = { x: T.x + L * (A.x - T.x), y: T.y + L * (A.y - T.y) };
          return !!T.z && !!A.z && ($.z = T.z + L * (A.z - T.z)), $;
        },
        pointToString: function (L) {
          var T = L.x + "/" + L.y;
          return typeof L.z != "undefined" && (T += "/" + L.z), T;
        },
        pointsToString: function (L) {
          return "[" + L.map(v.pointToString).join(", ") + "]";
        },
        copy: function (L) {
          return JSON.parse(JSON.stringify(L));
        },
        angle: function (L, T, A) {
          var $ = T.x - L.x,
            R = T.y - L.y,
            M = A.x - L.x,
            w = A.y - L.y,
            O = $ * w - R * M,
            E = $ * M + R * w;
          return o(O, E);
        },
        round: function (L, T) {
          var A = "" + L,
            $ = A.indexOf(".");
          return parseFloat(A.substring(0, $ + 1 + T));
        },
        dist: function (L, T) {
          var A = L.x - T.x,
            $ = L.y - T.y;
          return l(A * A + $ * $);
        },
        closest: function (L, T) {
          var A = u(2, 63),
            $,
            R;
          return (
            L.forEach(function (M, w) {
              (R = v.dist(T, M)), R < A && ((A = R), ($ = w));
            }),
            { mdist: A, mpos: $ }
          );
        },
        abcratio: function (L, T) {
          if (T !== 2 && T !== 3) return !1;
          if (typeof L == "undefined") L = 0.5;
          else if (L === 0 || L === 1) return L;
          var A = u(L, T) + u(1 - L, T),
            $ = A - 1;
          return n($ / A);
        },
        projectionratio: function (L, T) {
          if (T !== 2 && T !== 3) return !1;
          if (typeof L == "undefined") L = 0.5;
          else if (L === 0 || L === 1) return L;
          var A = u(1 - L, T),
            $ = u(L, T) + A;
          return A / $;
        },
        lli8: function (L, T, A, $, R, M, w, O) {
          var E = (L * $ - T * A) * (R - w) - (L - A) * (R * O - M * w),
            k = (L * $ - T * A) * (M - O) - (T - $) * (R * O - M * w),
            D = (L - A) * (M - O) - (T - $) * (R - w);
          return D == 0 ? !1 : { x: E / D, y: k / D };
        },
        lli4: function (L, T, A, $) {
          var R = L.x,
            M = L.y,
            w = T.x,
            O = T.y,
            E = A.x,
            k = A.y,
            D = $.x,
            q = $.y;
          return v.lli8(R, M, w, O, E, k, D, q);
        },
        lli: function (L, T) {
          return v.lli4(L, L.c, T, T.c);
        },
        makeline: function (L, T) {
          var A = L.x,
            $ = L.y,
            R = T.x,
            M = T.y,
            w = (R - A) / 3,
            O = (M - $) / 3;
          return new Z(A, $, A + w, $ + O, A + 2 * w, $ + 2 * O, R, M);
        },
        findbbox: function (L) {
          var T = d,
            A = d,
            $ = m,
            R = m;
          return (
            L.forEach(function (M) {
              var w = M.bbox();
              T > w.x.min && (T = w.x.min),
                A > w.y.min && (A = w.y.min),
                $ < w.x.max && ($ = w.x.max),
                R < w.y.max && (R = w.y.max);
            }),
            {
              x: { min: T, mid: (T + $) / 2, max: $, size: $ - T },
              y: { min: A, mid: (A + R) / 2, max: R, size: R - A },
            }
          );
        },
        shapeintersections: function (L, T, A, $, R) {
          if (!v.bboxoverlap(T, $)) return [];
          var M = [],
            w = [L.startcap, L.forward, L.back, L.endcap],
            O = [A.startcap, A.forward, A.back, A.endcap];
          return (
            w.forEach(function (E) {
              E.virtual ||
                O.forEach(function (k) {
                  if (!k.virtual) {
                    var D = E.intersects(k, R);
                    D.length > 0 &&
                      ((D.c1 = E),
                      (D.c2 = k),
                      (D.s1 = L),
                      (D.s2 = A),
                      M.push(D));
                  }
                });
            }),
            M
          );
        },
        makeshape: function (L, T, A) {
          var $ = T.points.length,
            R = L.points.length,
            M = v.makeline(T.points[$ - 1], L.points[0]),
            w = v.makeline(L.points[R - 1], T.points[0]),
            O = {
              startcap: M,
              forward: L,
              back: T,
              endcap: w,
              bbox: v.findbbox([M, L, T, w]),
            };
          return (
            (O.intersections = function (E) {
              return v.shapeintersections(O, O.bbox, E, E.bbox, A);
            }),
            O
          );
        },
        getminmax: function (L, T, A) {
          if (!A) return { min: 0, max: 0 };
          var $ = d,
            R = m,
            M,
            w;
          A.indexOf(0) === -1 && (A = [0].concat(A)),
            A.indexOf(1) === -1 && A.push(1);
          for (var O = 0, E = A.length; O < E; O++)
            (M = A[O]),
              (w = L.get(M)),
              w[T] < $ && ($ = w[T]),
              w[T] > R && (R = w[T]);
          return { min: $, mid: ($ + R) / 2, max: R, size: R - $ };
        },
        align: function (L, T) {
          var A = T.p1.x,
            $ = T.p1.y,
            R = -o(T.p2.y - $, T.p2.x - A),
            M = function (O) {
              return {
                x: (O.x - A) * i(R) - (O.y - $) * s(R),
                y: (O.x - A) * s(R) + (O.y - $) * i(R),
              };
            };
          return L.map(M);
        },
        roots: function (L, T) {
          T = T || { p1: { x: 0, y: 0 }, p2: { x: 1, y: 0 } };
          var A = L.length - 1,
            $ = v.align(L, T),
            R = function (ar) {
              return 0 <= ar && ar <= 1;
            };
          if (A === 2) {
            var M = $[0].y,
              w = $[1].y,
              O = $[2].y,
              E = M - 2 * w + O;
            if (E !== 0) {
              var k = -l(w * w - M * O),
                D = -M + w,
                q = -(k + D) / E,
                J = -(-k + D) / E;
              return [q, J].filter(R);
            } else if (w !== O && E === 0)
              return [(2 * w - O) / (2 * w - 2 * O)].filter(R);
            return [];
          }
          var de = $[0].y,
            we = $[1].y,
            Se = $[2].y,
            He = $[3].y,
            et = -de + 3 * we - 3 * Se + He,
            Ke = 3 * de - 6 * we + 3 * Se,
            Fe = -3 * de + 3 * we,
            qe = de;
          if (v.approximately(et, 0)) {
            if (v.approximately(Ke, 0))
              return v.approximately(Fe, 0) ? [] : [-qe / Fe].filter(R);
            var Mt = l(Fe * Fe - 4 * Ke * qe),
              ot = 2 * Ke;
            return [(Mt - Fe) / ot, (-Fe - Mt) / ot].filter(R);
          }
          (Ke /= et), (Fe /= et), (qe /= et);
          var at = (3 * Fe - Ke * Ke) / 3,
            Lt = at / 3,
            $t = (2 * Ke * Ke * Ke - 9 * Ke * Fe + 27 * qe) / 27,
            Rt = $t / 2,
            Ot = Rt * Rt + Lt * Lt * Lt,
            wt,
            kt,
            Pt,
            At,
            ut;
          if (Ot < 0) {
            var ct = -at / 3,
              vt = ct * ct * ct,
              rt = l(vt),
              Wt = -$t / (2 * rt),
              Vt = Wt < -1 ? -1 : Wt > 1 ? 1 : Wt,
              mt = a(Vt),
              yt = r(rt),
              xt = 2 * yt;
            return (
              (Pt = xt * i(mt / 3) - Ke / 3),
              (At = xt * i((mt + c) / 3) - Ke / 3),
              (ut = xt * i((mt + 2 * c) / 3) - Ke / 3),
              [Pt, At, ut].filter(R)
            );
          } else {
            if (Ot === 0)
              return (
                (wt = Rt < 0 ? r(-Rt) : -r(Rt)),
                (Pt = 2 * wt - Ke / 3),
                (At = -wt - Ke / 3),
                [Pt, At].filter(R)
              );
            var It = l(Ot);
            return (
              (wt = r(-Rt + It)),
              (kt = r(Rt + It)),
              [wt - kt - Ke / 3].filter(R)
            );
          }
        },
        droots: function (L) {
          if (L.length === 3) {
            var T = L[0],
              A = L[1],
              $ = L[2],
              R = T - 2 * A + $;
            if (R !== 0) {
              var M = -l(A * A - T * $),
                w = -T + A,
                O = -(M + w) / R,
                E = -(-M + w) / R;
              return [O, E];
            } else if (A !== $ && R === 0) return [(2 * A - $) / (2 * (A - $))];
            return [];
          }
          if (L.length === 2) {
            var k = L[0],
              D = L[1];
            return k !== D ? [k / (k - D)] : [];
          }
          return [];
        },
        curvature: function (L, T, A, $, R) {
          var M,
            w,
            O,
            E,
            k = 0,
            D = 0,
            q = v.compute(L, T),
            J = v.compute(L, A),
            de = q.x * q.x + q.y * q.y;
          if (
            ($
              ? ((M = l(
                  u(q.y * J.z - J.y * q.z, 2) +
                    u(q.z * J.x - J.z * q.x, 2) +
                    u(q.x * J.y - J.x * q.y, 2)
                )),
                (w = u(de + q.z * q.z, 3 / 2)))
              : ((M = q.x * J.y - q.y * J.x), (w = u(de, 3 / 2))),
            M === 0 || w === 0)
          )
            return { k: 0, r: 0 };
          if (((k = M / w), (D = w / M), !R)) {
            var we = v.curvature(L - 0.001, T, A, $, !0).k,
              Se = v.curvature(L + 0.001, T, A, $, !0).k;
            (E = (Se - k + (k - we)) / 2), (O = (n(Se - k) + n(k - we)) / 2);
          }
          return { k: k, r: D, dk: E, adk: O };
        },
        inflections: function (L) {
          if (L.length < 4) return [];
          var T = v.align(L, { p1: L[0], p2: L.slice(-1)[0] }),
            A = T[2].x * T[1].y,
            $ = T[3].x * T[1].y,
            R = T[1].x * T[2].y,
            M = T[3].x * T[2].y,
            w = 18 * (-3 * A + 2 * $ + 3 * R - M),
            O = 18 * (3 * A - $ - 3 * R),
            E = 18 * (R - A);
          if (v.approximately(w, 0)) {
            if (!v.approximately(O, 0)) {
              var k = -E / O;
              if (0 <= k && k <= 1) return [k];
            }
            return [];
          }
          var D = O * O - 4 * w * E,
            q = Math.sqrt(D),
            J = 2 * w;
          return v.approximately(J, 0)
            ? []
            : [(q - O) / J, -(O + q) / J].filter(function (de) {
                return 0 <= de && de <= 1;
              });
        },
        bboxoverlap: function (L, T) {
          for (var A = ["x", "y"], $ = A.length, R = 0, M, w, O, E; R < $; R++)
            if (
              ((M = A[R]),
              (w = L[M].mid),
              (O = T[M].mid),
              (E = (L[M].size + T[M].size) / 2),
              n(w - O) >= E)
            )
              return !1;
          return !0;
        },
        expandbox: function (L, T) {
          T.x.min < L.x.min && (L.x.min = T.x.min),
            T.y.min < L.y.min && (L.y.min = T.y.min),
            T.z && T.z.min < L.z.min && (L.z.min = T.z.min),
            T.x.max > L.x.max && (L.x.max = T.x.max),
            T.y.max > L.y.max && (L.y.max = T.y.max),
            T.z && T.z.max > L.z.max && (L.z.max = T.z.max),
            (L.x.mid = (L.x.min + L.x.max) / 2),
            (L.y.mid = (L.y.min + L.y.max) / 2),
            L.z && (L.z.mid = (L.z.min + L.z.max) / 2),
            (L.x.size = L.x.max - L.x.min),
            (L.y.size = L.y.max - L.y.min),
            L.z && (L.z.size = L.z.max - L.z.min);
        },
        pairiteration: function (L, T, A) {
          var $ = L.bbox(),
            R = T.bbox(),
            M = 1e5,
            w = A || 0.5;
          if ($.x.size + $.y.size < w && R.x.size + R.y.size < w)
            return [
              (((M * (L._t1 + L._t2)) / 2) | 0) / M +
                "/" +
                (((M * (T._t1 + T._t2)) / 2) | 0) / M,
            ];
          var O = L.split(0.5),
            E = T.split(0.5),
            k = [
              { left: O.left, right: E.left },
              { left: O.left, right: E.right },
              { left: O.right, right: E.right },
              { left: O.right, right: E.left },
            ];
          k = k.filter(function (q) {
            return v.bboxoverlap(q.left.bbox(), q.right.bbox());
          });
          var D = [];
          return (
            k.length === 0 ||
              (k.forEach(function (q) {
                D = D.concat(v.pairiteration(q.left, q.right, w));
              }),
              (D = D.filter(function (q, J) {
                return D.indexOf(q) === J;
              }))),
            D
          );
        },
        getccenter: function (L, T, A) {
          var $ = T.x - L.x,
            R = T.y - L.y,
            M = A.x - T.x,
            w = A.y - T.y,
            O = $ * i(h) - R * s(h),
            E = $ * s(h) + R * i(h),
            k = M * i(h) - w * s(h),
            D = M * s(h) + w * i(h),
            q = (L.x + T.x) / 2,
            J = (L.y + T.y) / 2,
            de = (T.x + A.x) / 2,
            we = (T.y + A.y) / 2,
            Se = q + O,
            He = J + E,
            et = de + k,
            Ke = we + D,
            Fe = v.lli8(q, J, Se, He, de, we, et, Ke),
            qe = v.dist(Fe, L),
            Mt = o(L.y - Fe.y, L.x - Fe.x),
            ot = o(T.y - Fe.y, T.x - Fe.x),
            at = o(A.y - Fe.y, A.x - Fe.x),
            Lt;
          return (
            Mt < at
              ? ((Mt > ot || ot > at) && (Mt += c),
                Mt > at && ((Lt = at), (at = Mt), (Mt = Lt)))
              : at < ot && ot < Mt
              ? ((Lt = at), (at = Mt), (Mt = Lt))
              : (at += c),
            (Fe.s = Mt),
            (Fe.e = at),
            (Fe.r = qe),
            Fe
          );
        },
        numberSort: function (L, T) {
          return L - T;
        },
      },
      y = (function () {
        function j(T) {
          _classCallCheck$1(this, j),
            (this.curves = []),
            (this._3d = !1),
            T && ((this.curves = T), (this._3d = this.curves[0]._3d));
        }
        var L = j.prototype;
        return (
          (L.valueOf = function () {
            return this.toString();
          }),
          (L.toString = function () {
            return (
              "[" +
              this.curves
                .map(function (A) {
                  return v.pointsToString(A.points);
                })
                .join(", ") +
              "]"
            );
          }),
          (L.addCurve = function (A) {
            this.curves.push(A), (this._3d = this._3d || A._3d);
          }),
          (L.length = function () {
            return this.curves
              .map(function (A) {
                return A.length();
              })
              .reduce(function (A, $) {
                return A + $;
              });
          }),
          (L.curve = function (A) {
            return this.curves[A];
          }),
          (L.bbox = function () {
            for (var A = this.curves, $ = A[0].bbox(), R = 1; R < A.length; R++)
              v.expandbox($, A[R].bbox());
            return $;
          }),
          (L.offset = function (A) {
            var $ = [];
            return (
              this.curves.forEach(function (R) {
                var M;
                (M = $).push.apply(M, _toConsumableArray$1(R.offset(A)));
              }),
              new j($)
            );
          }),
          j
        );
      })(),
      _ = Math.abs,
      b = Math.min,
      S = Math.max,
      P = Math.cos,
      I = Math.sin,
      F = Math.acos,
      X = Math.sqrt,
      W = Math.PI,
      Z = (function () {
        function j(T) {
          _classCallCheck$1(this, j);
          var A = T && T.forEach ? T : Array.from(arguments).slice(),
            $ = !1;
          if (typeof A[0] == "object") {
            $ = A.length;
            var R = [];
            A.forEach(function (Se) {
              ["x", "y", "z"].forEach(function (He) {
                typeof Se[He] != "undefined" && R.push(Se[He]);
              });
            }),
              (A = R);
          }
          var M = !1,
            w = A.length;
          if ($) {
            if ($ > 4) {
              if (arguments.length !== 1)
                throw new Error(
                  "Only new Bezier(point[]) is accepted for 4th and higher order curves"
                );
              M = !0;
            }
          } else if (
            w !== 6 &&
            w !== 8 &&
            w !== 9 &&
            w !== 12 &&
            arguments.length !== 1
          )
            throw new Error(
              "Only new Bezier(point[]) is accepted for 4th and higher order curves"
            );
          for (
            var O = (this._3d =
                (!M && (w === 9 || w === 12)) ||
                (T && T[0] && typeof T[0].z != "undefined")),
              E = (this.points = []),
              k = 0,
              D = O ? 3 : 2;
            k < w;
            k += D
          ) {
            var q = { x: A[k], y: A[k + 1] };
            O && (q.z = A[k + 2]), E.push(q);
          }
          var J = (this.order = E.length - 1),
            de = (this.dims = ["x", "y"]);
          O && de.push("z"), (this.dimlen = de.length);
          var we = v.align(E, { p1: E[0], p2: E[J] });
          (this._linear = !we.some(function (Se) {
            return _(Se.y) > 1e-4;
          })),
            (this._lut = []),
            (this._t1 = 0),
            (this._t2 = 1),
            this.update();
        }
        var L = j.prototype;
        return (
          (L.getUtils = function () {
            return j.getUtils();
          }),
          (L.valueOf = function () {
            return this.toString();
          }),
          (L.toString = function () {
            return v.pointsToString(this.points);
          }),
          (L.toSVG = function () {
            if (this._3d) return !1;
            for (
              var A = this.points,
                $ = A[0].x,
                R = A[0].y,
                M = ["M", $, R, this.order === 2 ? "Q" : "C"],
                w = 1,
                O = A.length;
              w < O;
              w++
            )
              M.push(A[w].x), M.push(A[w].y);
            return M.join(" ");
          }),
          (L.setRatios = function (A) {
            if (A.length !== this.points.length)
              throw new Error("incorrect number of ratio values");
            (this.ratios = A), (this._lut = []);
          }),
          (L.verify = function () {
            var A = this.coordDigest();
            A !== this._print && ((this._print = A), this.update());
          }),
          (L.coordDigest = function () {
            return this.points
              .map(function (A, $) {
                return "" + $ + A.x + A.y + (A.z ? A.z : 0);
              })
              .join("");
          }),
          (L.update = function () {
            (this._lut = []),
              (this.dpoints = v.derive(this.points, this._3d)),
              this.computedirection();
          }),
          (L.computedirection = function () {
            var A = this.points,
              $ = v.angle(A[0], A[this.order], A[1]);
            this.clockwise = $ > 0;
          }),
          (L.length = function () {
            return v.length(this.derivative.bind(this));
          }),
          (L.getABC = function (A, $) {
            $ = $ || this.get(A);
            var R = this.points[0],
              M = this.points[this.order];
            return j.getABC(this.order, R, $, M, A);
          }),
          (L.getLUT = function (A) {
            if ((this.verify(), (A = A || 100), this._lut.length === A))
              return this._lut;
            (this._lut = []), A--;
            for (var $ = 0, R, M; $ < A; $++)
              (M = $ / (A - 1)),
                (R = this.compute(M)),
                (R.t = M),
                this._lut.push(R);
            return this._lut;
          }),
          (L.on = function (A, $) {
            $ = $ || 5;
            for (
              var R = this.getLUT(), M = [], w = 0, O, E = 0;
              w < R.length;
              w++
            )
              (O = R[w]), v.dist(O, A) < $ && (M.push(O), (E += w / R.length));
            return M.length ? (t /= M.length) : !1;
          }),
          (L.project = function (A) {
            var $ = this.getLUT(),
              R = $.length - 1,
              M = v.closest($, A),
              w = M.mpos,
              O = (w - 1) / R,
              E = (w + 1) / R,
              k = 0.1 / R,
              D = M.mdist,
              q = O,
              J = q,
              de;
            D += 1;
            for (var we; q < E + k; q += k)
              (de = this.compute(q)),
                (we = v.dist(A, de)),
                we < D && ((D = we), (J = q));
            return (
              (J = J < 0 ? 0 : J > 1 ? 1 : J),
              (de = this.compute(J)),
              (de.t = J),
              (de.d = D),
              de
            );
          }),
          (L.get = function (A) {
            return this.compute(A);
          }),
          (L.point = function (A) {
            return this.points[A];
          }),
          (L.compute = function (A) {
            return this.ratios
              ? v.computeWithRatios(A, this.points, this.ratios, this._3d)
              : v.compute(A, this.points, this._3d, this.ratios);
          }),
          (L.raise = function () {
            for (
              var A = this.points, $ = [A[0]], R = A.length, M = 1, w, O;
              M < R;
              M++
            )
              (w = A[M]),
                (O = A[M - 1]),
                ($[M] = {
                  x: ((R - M) / R) * w.x + (M / R) * O.x,
                  y: ((R - M) / R) * w.y + (M / R) * O.y,
                });
            return ($[R] = A[R - 1]), new j($);
          }),
          (L.derivative = function (A) {
            return v.compute(A, this.dpoints[0]);
          }),
          (L.dderivative = function (A) {
            return v.compute(A, this.dpoints[1]);
          }),
          (L.align = function () {
            var A = this.points;
            return new j(v.align(A, { p1: A[0], p2: A[A.length - 1] }));
          }),
          (L.curvature = function (A) {
            return v.curvature(A, this.dpoints[0], this.dpoints[1], this._3d);
          }),
          (L.inflections = function () {
            return v.inflections(this.points);
          }),
          (L.normal = function (A) {
            return this._3d ? this.__normal3(A) : this.__normal2(A);
          }),
          (L.__normal2 = function (A) {
            var $ = this.derivative(A),
              R = X($.x * $.x + $.y * $.y);
            return { x: -$.y / R, y: $.x / R };
          }),
          (L.__normal3 = function (A) {
            var $ = this.derivative(A),
              R = this.derivative(A + 0.01),
              M = X($.x * $.x + $.y * $.y + $.z * $.z),
              w = X(R.x * R.x + R.y * R.y + R.z * R.z);
            ($.x /= M),
              ($.y /= M),
              ($.z /= M),
              (R.x /= w),
              (R.y /= w),
              (R.z /= w);
            var O = {
                x: R.y * $.z - R.z * $.y,
                y: R.z * $.x - R.x * $.z,
                z: R.x * $.y - R.y * $.x,
              },
              E = X(O.x * O.x + O.y * O.y + O.z * O.z);
            (O.x /= E), (O.y /= E), (O.z /= E);
            var k = [
                O.x * O.x,
                O.x * O.y - O.z,
                O.x * O.z + O.y,
                O.x * O.y + O.z,
                O.y * O.y,
                O.y * O.z - O.x,
                O.x * O.z - O.y,
                O.y * O.z + O.x,
                O.z * O.z,
              ],
              D = {
                x: k[0] * $.x + k[1] * $.y + k[2] * $.z,
                y: k[3] * $.x + k[4] * $.y + k[5] * $.z,
                z: k[6] * $.x + k[7] * $.y + k[8] * $.z,
              };
            return D;
          }),
          (L.hull = function (A) {
            var $ = this.points,
              R = [],
              M = [],
              w = 0;
            for (
              M[w++] = $[0],
                M[w++] = $[1],
                M[w++] = $[2],
                this.order === 3 && (M[w++] = $[3]);
              $.length > 1;

            ) {
              R = [];
              for (var O = 0, E = void 0, k = $.length - 1; O < k; O++)
                (E = v.lerp(A, $[O], $[O + 1])), (M[w++] = E), R.push(E);
              $ = R;
            }
            return M;
          }),
          (L.split = function (A, $) {
            if (A === 0 && !!$) return this.split($).left;
            if ($ === 1) return this.split(A).right;
            var R = this.hull(A),
              M = {
                left:
                  this.order === 2
                    ? new j([R[0], R[3], R[5]])
                    : new j([R[0], R[4], R[7], R[9]]),
                right:
                  this.order === 2
                    ? new j([R[5], R[4], R[2]])
                    : new j([R[9], R[8], R[6], R[3]]),
                span: R,
              };
            return (
              (M.left._t1 = v.map(0, 0, 1, this._t1, this._t2)),
              (M.left._t2 = v.map(A, 0, 1, this._t1, this._t2)),
              (M.right._t1 = v.map(A, 0, 1, this._t1, this._t2)),
              (M.right._t2 = v.map(1, 0, 1, this._t1, this._t2)),
              $ ? (($ = v.map($, A, 1, 0, 1)), M.right.split($).left) : M
            );
          }),
          (L.extrema = function () {
            var A = {},
              $ = [];
            return (
              this.dims.forEach(
                function (R) {
                  var M = function (E) {
                      return E[R];
                    },
                    w = this.dpoints[0].map(M);
                  (A[R] = v.droots(w)),
                    this.order === 3 &&
                      ((w = this.dpoints[1].map(M)),
                      (A[R] = A[R].concat(v.droots(w)))),
                    (A[R] = A[R].filter(function (O) {
                      return O >= 0 && O <= 1;
                    })),
                    ($ = $.concat(A[R].sort(v.numberSort)));
                }.bind(this)
              ),
              (A.values = $.sort(v.numberSort).filter(function (R, M) {
                return $.indexOf(R) === M;
              })),
              A
            );
          }),
          (L.bbox = function () {
            var A = this.extrema(),
              $ = {};
            return (
              this.dims.forEach(
                function (R) {
                  $[R] = v.getminmax(this, R, A[R]);
                }.bind(this)
              ),
              $
            );
          }),
          (L.overlaps = function (A) {
            var $ = this.bbox(),
              R = A.bbox();
            return v.bboxoverlap($, R);
          }),
          (L.offset = function (A, $) {
            if (typeof $ != "undefined") {
              var R = this.get(A),
                M = this.normal(A),
                w = { c: R, n: M, x: R.x + M.x * $, y: R.y + M.y * $ };
              return this._3d && (w.z = R.z + M.z * $), w;
            }
            if (this._linear) {
              var O = this.normal(0),
                E = this.points.map(function (k) {
                  var D = { x: k.x + A * O.x, y: k.y + A * O.y };
                  return k.z && O.z && (D.z = k.z + A * O.z), D;
                });
              return [new j(E)];
            }
            return this.reduce().map(function (k) {
              return k._linear ? k.offset(A)[0] : k.scale(A);
            });
          }),
          (L.simple = function () {
            if (this.order === 3) {
              var A = v.angle(this.points[0], this.points[3], this.points[1]),
                $ = v.angle(this.points[0], this.points[3], this.points[2]);
              if ((A > 0 && $ < 0) || (A < 0 && $ > 0)) return !1;
            }
            var R = this.normal(0),
              M = this.normal(1),
              w = R.x * M.x + R.y * M.y;
            return this._3d && (w += R.z * M.z), _(F(w)) < W / 3;
          }),
          (L.reduce = function () {
            var A,
              $ = 0,
              R = 0,
              M = 0.01,
              w,
              O = [],
              E = [],
              k = this.extrema().values;
            for (
              k.indexOf(0) === -1 && (k = [0].concat(k)),
                k.indexOf(1) === -1 && k.push(1),
                $ = k[0],
                A = 1;
              A < k.length;
              A++
            )
              (R = k[A]),
                (w = this.split($, R)),
                (w._t1 = $),
                (w._t2 = R),
                O.push(w),
                ($ = R);
            return (
              O.forEach(function (D) {
                for ($ = 0, R = 0; R <= 1; )
                  for (R = $ + M; R <= 1 + M; R += M)
                    if (((w = D.split($, R)), !w.simple())) {
                      if (((R -= M), _($ - R) < M)) return [];
                      (w = D.split($, R)),
                        (w._t1 = v.map($, 0, 1, D._t1, D._t2)),
                        (w._t2 = v.map(R, 0, 1, D._t1, D._t2)),
                        E.push(w),
                        ($ = R);
                      break;
                    }
                $ < 1 &&
                  ((w = D.split($, 1)),
                  (w._t1 = v.map($, 0, 1, D._t1, D._t2)),
                  (w._t2 = D._t2),
                  E.push(w));
              }),
              E
            );
          }),
          (L.scale = function (A) {
            var $ = this.order,
              R = !1;
            if ((typeof A == "function" && (R = A), R && $ === 2))
              return this.raise().scale(R);
            var M = this.clockwise,
              w = R ? R(0) : A,
              O = R ? R(1) : A,
              E = [this.offset(0, 10), this.offset(1, 10)],
              k = this.points,
              D = [],
              q = v.lli4(E[0], E[0].c, E[1], E[1].c);
            if (!q)
              throw new Error(
                "cannot scale this curve. Try reducing it first."
              );
            if (
              ([0, 1].forEach(function (de) {
                var we = (D[de * $] = v.copy(k[de * $]));
                (we.x += (de ? O : w) * E[de].n.x),
                  (we.y += (de ? O : w) * E[de].n.y);
              }),
              !R)
            ) {
              var J = this;
              return (
                [0, 1].forEach(function (de) {
                  if (!($ === 2 && !!de)) {
                    var we = D[de * $],
                      Se = J.derivative(de),
                      He = { x: we.x + Se.x, y: we.y + Se.y };
                    D[de + 1] = v.lli4(we, He, q, k[de + 1]);
                  }
                }),
                new j(D)
              );
            }
            return (
              [0, 1].forEach(function (de) {
                if (!($ === 2 && !!de)) {
                  var we = k[de + 1],
                    Se = { x: we.x - q.x, y: we.y - q.y },
                    He = R ? R((de + 1) / $) : A;
                  R && !M && (He = -He);
                  var et = X(Se.x * Se.x + Se.y * Se.y);
                  (Se.x /= et),
                    (Se.y /= et),
                    (D[de + 1] = { x: we.x + He * Se.x, y: we.y + He * Se.y });
                }
              }),
              new j(D)
            );
          }),
          (L.outline = function (A, $, R, M) {
            var w = function (at, Lt, $t, Rt, Ot) {
              return function (wt) {
                var kt = Rt / $t,
                  Pt = (Rt + Ot) / $t,
                  At = Lt - at;
                return v.map(wt, 0, 1, at + kt * At, at + Pt * At);
              };
            };
            $ = typeof $ == "undefined" ? A : $;
            var O = this.reduce(),
              E = O.length,
              k = [],
              D = [],
              q,
              J = 0,
              de = this.length(),
              we = typeof R != "undefined" && typeof M != "undefined";
            O.forEach(function (ot) {
              var at = ot.length();
              we
                ? (k.push(ot.scale(w(A, R, de, J, at))),
                  D.push(ot.scale(w(-$, -M, de, J, at))))
                : (k.push(ot.scale(A)), D.push(ot.scale(-$))),
                (J += at);
            }),
              (D = D.map(function (ot) {
                return (
                  (q = ot.points),
                  q[3]
                    ? (ot.points = [q[3], q[2], q[1], q[0]])
                    : (ot.points = [q[2], q[1], q[0]]),
                  ot
                );
              }).reverse());
            var Se = k[0].points[0],
              He = k[E - 1].points[k[E - 1].points.length - 1],
              et = D[E - 1].points[D[E - 1].points.length - 1],
              Ke = D[0].points[0],
              Fe = v.makeline(et, Se),
              qe = v.makeline(He, Ke),
              Mt = [Fe].concat(k).concat([qe]).concat(D);
            return new y(Mt);
          }),
          (L.outlineshapes = function (A, $, R) {
            $ = $ || A;
            for (
              var M = this.outline(A, $).curves, w = [], O = 1, E = M.length;
              O < E / 2;
              O++
            ) {
              var k = v.makeshape(M[O], M[E - O], R);
              (k.startcap.virtual = O > 1),
                (k.endcap.virtual = O < E / 2 - 1),
                w.push(k);
            }
            return w;
          }),
          (L.intersects = function (A, $) {
            return A
              ? A.p1 && A.p2
                ? this.lineIntersects(A)
                : (_instanceof$3(A, j) && (A = A.reduce()),
                  this.curveintersects(this.reduce(), A, $))
              : this.selfintersects($);
          }),
          (L.lineIntersects = function (A) {
            var $ = this,
              R = b(A.p1.x, A.p2.x),
              M = b(A.p1.y, A.p2.y),
              w = S(A.p1.x, A.p2.x),
              O = S(A.p1.y, A.p2.y);
            return v.roots(this.points, A).filter(function (E) {
              var k = $.get(E);
              return v.between(k.x, R, w) && v.between(k.y, M, O);
            });
          }),
          (L.selfintersects = function (A) {
            for (
              var $ = this.reduce(), R = $.length - 2, M = [], w = 0, O, E, k;
              w < R;
              w++
            ) {
              var D;
              (E = $.slice(w, w + 1)),
                (k = $.slice(w + 2)),
                (O = this.curveintersects(E, k, A)),
                (D = M).push.apply(D, _toConsumableArray$1(O));
            }
            return M;
          }),
          (L.curveintersects = function (A, $, R) {
            var M = [];
            A.forEach(function (O) {
              $.forEach(function (E) {
                O.overlaps(E) && M.push({ left: O, right: E });
              });
            });
            var w = [];
            return (
              M.forEach(function (O) {
                var E = v.pairiteration(O.left, O.right, R);
                E.length > 0 && (w = w.concat(E));
              }),
              w
            );
          }),
          (L.arcs = function (A) {
            return (A = A || 0.5), this._iterate(A, []);
          }),
          (L._error = function (A, $, R, M) {
            var w = (M - R) / 4,
              O = this.get(R + w),
              E = this.get(M - w),
              k = v.dist(A, $),
              D = v.dist(A, O),
              q = v.dist(A, E);
            return _(D - k) + _(q - k);
          }),
          (L._iterate = function (A, $) {
            var R = 0,
              M = 1,
              w;
            do {
              (w = 0), (M = 1);
              var O = this.get(R),
                E = void 0,
                k = void 0,
                D = void 0,
                q = void 0,
                J = !1,
                de = !1,
                we = void 0,
                Se = M,
                He = 1;
              do {
                (de = J),
                  (q = D),
                  (Se = (R + M) / 2),
                  (E = this.get(Se)),
                  (k = this.get(M)),
                  (D = v.getccenter(O, E, k)),
                  (D.interval = { start: R, end: M });
                var et = this._error(D, O, R, M);
                if (((J = et <= A), (we = de && !J), we || (He = M), J)) {
                  if (M >= 1) {
                    if (((D.interval.end = He = 1), (q = D), M > 1)) {
                      var Ke = { x: D.x + D.r * P(D.e), y: D.y + D.r * I(D.e) };
                      D.e += v.angle({ x: D.x, y: D.y }, Ke, this.get(1));
                    }
                    break;
                  }
                  M = M + (M - R) / 2;
                } else M = Se;
              } while (!we && w++ < 100);
              if (w >= 100) break;
              (q = q || D), $.push(q), (R = He);
            } while (M < 1);
            return $;
          }),
          (j.quadraticFromPoints = function (A, $, R, M) {
            if ((typeof M == "undefined" && (M = 0.5), M === 0))
              return new j($, $, R);
            if (M === 1) return new j(A, $, $);
            var w = j.getABC(2, A, $, R, M);
            return new j(A, w.A, R);
          }),
          (j.cubicFromPoints = function (A, $, R, M, w) {
            typeof M == "undefined" && (M = 0.5);
            var O = j.getABC(3, A, $, R, M);
            typeof w == "undefined" && (w = v.dist($, O.C));
            var E = (w * (1 - M)) / M,
              k = v.dist(A, R),
              D = (R.x - A.x) / k,
              q = (R.y - A.y) / k,
              J = w * D,
              de = w * q,
              we = E * D,
              Se = E * q,
              He = { x: $.x - J, y: $.y - de },
              et = { x: $.x + we, y: $.y + Se },
              Ke = O.A,
              Fe = {
                x: Ke.x + (He.x - Ke.x) / (1 - M),
                y: Ke.y + (He.y - Ke.y) / (1 - M),
              },
              qe = { x: Ke.x + (et.x - Ke.x) / M, y: Ke.y + (et.y - Ke.y) / M },
              Mt = { x: A.x + (Fe.x - A.x) / M, y: A.y + (Fe.y - A.y) / M },
              ot = {
                x: R.x + (qe.x - R.x) / (1 - M),
                y: R.y + (qe.y - R.y) / (1 - M),
              };
            return new j(A, Mt, ot, R);
          }),
          (j.getUtils = function () {
            return v;
          }),
          (j.getABC = function () {
            var A =
                arguments.length > 0 && arguments[0] !== void 0
                  ? arguments[0]
                  : 2,
              $ = arguments.length > 1 ? arguments[1] : void 0,
              R = arguments.length > 2 ? arguments[2] : void 0,
              M = arguments.length > 3 ? arguments[3] : void 0,
              w =
                arguments.length > 4 && arguments[4] !== void 0
                  ? arguments[4]
                  : 0.5,
              O = v.projectionratio(w, A),
              E = 1 - O,
              k = { x: O * $.x + E * M.x, y: O * $.y + E * M.y },
              D = v.abcratio(w, A),
              q = { x: R.x + (R.x - k.x) / D, y: R.y + (R.y - k.y) / D };
            return { A: q, B: R, C: k, S: $, E: M };
          }),
          _createClass$1(j, null, [
            {
              key: "PolyBezier",
              get: function () {
                return y;
              },
            },
          ]),
          j
        );
      })();
    return (bezier$1.Bezier = Z), bezier$1;
  }
  var src, hasRequiredSrc;
  function requireSrc() {
    var r = function (y, _) {
        return 1 - 3 * _ + 3 * y;
      },
      n = function (y, _) {
        return 3 * _ - 6 * y;
      },
      i = function (y) {
        return 3 * y;
      },
      s = function (y, _, b) {
        return ((r(_, b) * y + n(_, b)) * y + i(_)) * y;
      },
      a = function (y, _, b) {
        return 3 * r(_, b) * y * y + 2 * n(_, b) * y + i(_);
      },
      o = function (y, _, b, S, P) {
        var I,
          F,
          X = 0;
        do
          (F = _ + (b - _) / 2),
            (I = s(F, S, P) - y),
            I > 0 ? (b = F) : (_ = F);
        while (Math.abs(I) > h && ++X < p);
        return F;
      },
      l = function (y, _, b, S) {
        for (var P = 0; P < f; ++P) {
          var I = a(_, b, S);
          if (I === 0) return _;
          var F = s(_, b, S) - y;
          _ -= F / I;
        }
        return _;
      },
      u = function (y) {
        return y;
      };
    if (hasRequiredSrc) return src;
    hasRequiredSrc = 1;
    var f = 4,
      c = 0.001,
      h = 1e-7,
      p = 10,
      d = 11,
      m = 1 / (d - 1),
      g = typeof Float32Array == "function";
    return (
      (src = function (y, _, b, S) {
        var P = function (W) {
          for (var Z = 0, j = 1, L = d - 1; j !== L && I[j] <= W; ++j) Z += m;
          --j;
          var T = (W - I[j]) / (I[j + 1] - I[j]),
            A = Z + T * m,
            $ = a(A, y, b);
          return $ >= c ? l(W, A, y, b) : $ === 0 ? A : o(W, Z, Z + m, y, b);
        };
        if (!(0 <= y && y <= 1 && 0 <= b && b <= 1))
          throw new Error("bezier x values must be in [0, 1] range");
        if (y === _ && b === S) return u;
        for (var I = g ? new Float32Array(d) : new Array(d), F = 0; F < d; ++F)
          I[F] = s(F * m, y, b);
        return function (W) {
          return W === 0 ? 0 : W === 1 ? 1 : s(P(W), _, S);
        };
      }),
      src
    );
  }
  var earcut = { exports: {} },
    hasRequiredEarcut;
  function requireEarcut() {
    var r = function (w, O, E) {
        E = E || 2;
        var k = O && O.length,
          D = k ? O[0] * E : w.length,
          q = n(w, 0, D, E, !0),
          J = [];
        if (!q || q.next === q.prev) return J;
        var de, we, Se, He, et, Ke, Fe;
        if ((k && (q = u(w, O, q, E)), w.length > 80 * E)) {
          (de = Se = w[0]), (we = He = w[1]);
          for (var qe = E; qe < D; qe += E)
            (et = w[qe]),
              (Ke = w[qe + 1]),
              et < de && (de = et),
              Ke < we && (we = Ke),
              et > Se && (Se = et),
              Ke > He && (He = Ke);
          (Fe = Math.max(Se - de, He - we)), (Fe = Fe !== 0 ? 1 / Fe : 0);
        }
        return R(q, J, E, de, we, Fe), J;
      },
      n = function (w, O, E, k, D) {
        var q, J;
        if (D === $(w, O, E, k) > 0)
          for (q = O; q < E; q += k) J = L(q, w[q], w[q + 1], J);
        else for (q = E - k; q >= O; q -= k) J = L(q, w[q], w[q + 1], J);
        return J && S(J, J.next) && (T(J), (J = J.next)), J;
      },
      i = function (w, O) {
        if (!w) return w;
        O || (O = w);
        var E = w,
          k;
        do
          if (
            ((k = !1),
            !E.steiner && (S(E, E.next) || b(E.prev, E, E.next) === 0))
          ) {
            if ((T(E), (E = O = E.prev), E === E.next)) break;
            k = !0;
          } else E = E.next;
        while (k || E !== O);
        return O;
      },
      s = function (w) {
        var O = w.prev,
          E = w,
          k = w.next;
        if (b(O, E, k) >= 0) return !1;
        for (var D = w.next.next; D !== w.prev; ) {
          if (
            y(O.x, O.y, E.x, E.y, k.x, k.y, D.x, D.y) &&
            b(D.prev, D, D.next) >= 0
          )
            return !1;
          D = D.next;
        }
        return !0;
      },
      a = function (w, O, E, k) {
        var D = w.prev,
          q = w,
          J = w.next;
        if (b(D, q, J) >= 0) return !1;
        for (
          var de = D.x < q.x ? (D.x < J.x ? D.x : J.x) : q.x < J.x ? q.x : J.x,
            we = D.y < q.y ? (D.y < J.y ? D.y : J.y) : q.y < J.y ? q.y : J.y,
            Se = D.x > q.x ? (D.x > J.x ? D.x : J.x) : q.x > J.x ? q.x : J.x,
            He = D.y > q.y ? (D.y > J.y ? D.y : J.y) : q.y > J.y ? q.y : J.y,
            et = g(de, we, O, E, k),
            Ke = g(Se, He, O, E, k),
            Fe = w.prevZ,
            qe = w.nextZ;
          Fe && Fe.z >= et && qe && qe.z <= Ke;

        ) {
          if (
            (Fe !== w.prev &&
              Fe !== w.next &&
              y(D.x, D.y, q.x, q.y, J.x, J.y, Fe.x, Fe.y) &&
              b(Fe.prev, Fe, Fe.next) >= 0) ||
            ((Fe = Fe.prevZ),
            qe !== w.prev &&
              qe !== w.next &&
              y(D.x, D.y, q.x, q.y, J.x, J.y, qe.x, qe.y) &&
              b(qe.prev, qe, qe.next) >= 0)
          )
            return !1;
          qe = qe.nextZ;
        }
        for (; Fe && Fe.z >= et; ) {
          if (
            Fe !== w.prev &&
            Fe !== w.next &&
            y(D.x, D.y, q.x, q.y, J.x, J.y, Fe.x, Fe.y) &&
            b(Fe.prev, Fe, Fe.next) >= 0
          )
            return !1;
          Fe = Fe.prevZ;
        }
        for (; qe && qe.z <= Ke; ) {
          if (
            qe !== w.prev &&
            qe !== w.next &&
            y(D.x, D.y, q.x, q.y, J.x, J.y, qe.x, qe.y) &&
            b(qe.prev, qe, qe.next) >= 0
          )
            return !1;
          qe = qe.nextZ;
        }
        return !0;
      },
      o = function (w, O, E) {
        var k = w;
        do {
          var D = k.prev,
            q = k.next.next;
          !S(D, q) &&
            P(D, k, k.next, q) &&
            W(D, q) &&
            W(q, D) &&
            (O.push(D.i / E),
            O.push(k.i / E),
            O.push(q.i / E),
            T(k),
            T(k.next),
            (k = w = q)),
            (k = k.next);
        } while (k !== w);
        return i(k);
      },
      l = function (w, O, E, k, D, q) {
        var J = w;
        do {
          for (var de = J.next.next; de !== J.prev; ) {
            if (J.i !== de.i && _(J, de)) {
              var we = j(J, de);
              (J = i(J, J.next)),
                (we = i(we, we.next)),
                R(J, O, E, k, D, q),
                R(we, O, E, k, D, q);
              return;
            }
            de = de.next;
          }
          J = J.next;
        } while (J !== w);
      },
      u = function (w, O, E, k) {
        var D = [],
          q,
          J,
          de,
          we,
          Se;
        for (q = 0, J = O.length; q < J; q++)
          (de = O[q] * k),
            (we = q < J - 1 ? O[q + 1] * k : w.length),
            (Se = n(w, de, we, k, !1)),
            Se === Se.next && (Se.steiner = !0),
            D.push(v(Se));
        for (D.sort(f), q = 0; q < D.length; q++)
          (E = c(D[q], E)), (E = i(E, E.next));
        return E;
      },
      f = function (w, O) {
        return w.x - O.x;
      },
      c = function (w, O) {
        var E = h(w, O);
        if (!E) return O;
        var k = j(E, w),
          D = i(E, E.next);
        return i(k, k.next), O === E ? D : O;
      },
      h = function (w, O) {
        var E = O,
          k = w.x,
          D = w.y,
          q = -1 / 0,
          J;
        do {
          if (D <= E.y && D >= E.next.y && E.next.y !== E.y) {
            var de = E.x + ((D - E.y) * (E.next.x - E.x)) / (E.next.y - E.y);
            if (de <= k && de > q) {
              if (((q = de), de === k)) {
                if (D === E.y) return E;
                if (D === E.next.y) return E.next;
              }
              J = E.x < E.next.x ? E : E.next;
            }
          }
          E = E.next;
        } while (E !== O);
        if (!J) return null;
        if (k === q) return J;
        var we = J,
          Se = J.x,
          He = J.y,
          et = 1 / 0,
          Ke;
        E = J;
        do
          k >= E.x &&
            E.x >= Se &&
            k !== E.x &&
            y(D < He ? k : q, D, Se, He, D < He ? q : k, D, E.x, E.y) &&
            ((Ke = Math.abs(D - E.y) / (k - E.x)),
            W(E, w) &&
              (Ke < et ||
                (Ke === et && (E.x > J.x || (E.x === J.x && p(J, E))))) &&
              ((J = E), (et = Ke))),
            (E = E.next);
        while (E !== we);
        return J;
      },
      p = function (w, O) {
        return b(w.prev, w, O.prev) < 0 && b(O.next, w, w.next) < 0;
      },
      d = function (w, O, E, k) {
        var D = w;
        do
          D.z === null && (D.z = g(D.x, D.y, O, E, k)),
            (D.prevZ = D.prev),
            (D.nextZ = D.next),
            (D = D.next);
        while (D !== w);
        (D.prevZ.nextZ = null), (D.prevZ = null), m(D);
      },
      m = function (w) {
        var O,
          E,
          k,
          D,
          q,
          J,
          de,
          we,
          Se = 1;
        do {
          for (E = w, w = null, q = null, J = 0; E; ) {
            for (
              J++, k = E, de = 0, O = 0;
              O < Se && (de++, (k = k.nextZ), !!k);
              O++
            );
            for (we = Se; de > 0 || (we > 0 && k); )
              de !== 0 && (we === 0 || !k || E.z <= k.z)
                ? ((D = E), (E = E.nextZ), de--)
                : ((D = k), (k = k.nextZ), we--),
                q ? (q.nextZ = D) : (w = D),
                (D.prevZ = q),
                (q = D);
            E = k;
          }
          (q.nextZ = null), (Se *= 2);
        } while (J > 1);
        return w;
      },
      g = function (w, O, E, k, D) {
        return (
          (w = 32767 * (w - E) * D),
          (O = 32767 * (O - k) * D),
          (w = (w | (w << 8)) & 16711935),
          (w = (w | (w << 4)) & 252645135),
          (w = (w | (w << 2)) & 858993459),
          (w = (w | (w << 1)) & 1431655765),
          (O = (O | (O << 8)) & 16711935),
          (O = (O | (O << 4)) & 252645135),
          (O = (O | (O << 2)) & 858993459),
          (O = (O | (O << 1)) & 1431655765),
          w | (O << 1)
        );
      },
      v = function (w) {
        var O = w,
          E = w;
        do (O.x < E.x || (O.x === E.x && O.y < E.y)) && (E = O), (O = O.next);
        while (O !== w);
        return E;
      },
      y = function (w, O, E, k, D, q, J, de) {
        return (
          (D - J) * (O - de) - (w - J) * (q - de) >= 0 &&
          (w - J) * (k - de) - (E - J) * (O - de) >= 0 &&
          (E - J) * (q - de) - (D - J) * (k - de) >= 0
        );
      },
      _ = function (w, O) {
        return (
          w.next.i !== O.i &&
          w.prev.i !== O.i &&
          !X(w, O) &&
          ((W(w, O) &&
            W(O, w) &&
            Z(w, O) &&
            (b(w.prev, w, O.prev) || b(w, O.prev, O))) ||
            (S(w, O) && b(w.prev, w, w.next) > 0 && b(O.prev, O, O.next) > 0))
        );
      },
      b = function (w, O, E) {
        return (O.y - w.y) * (E.x - O.x) - (O.x - w.x) * (E.y - O.y);
      },
      S = function (w, O) {
        return w.x === O.x && w.y === O.y;
      },
      P = function (w, O, E, k) {
        var D = F(b(w, O, E)),
          q = F(b(w, O, k)),
          J = F(b(E, k, w)),
          de = F(b(E, k, O));
        return !!(
          (D !== q && J !== de) ||
          (D === 0 && I(w, E, O)) ||
          (q === 0 && I(w, k, O)) ||
          (J === 0 && I(E, w, k)) ||
          (de === 0 && I(E, O, k))
        );
      },
      I = function (w, O, E) {
        return (
          O.x <= Math.max(w.x, E.x) &&
          O.x >= Math.min(w.x, E.x) &&
          O.y <= Math.max(w.y, E.y) &&
          O.y >= Math.min(w.y, E.y)
        );
      },
      F = function (w) {
        return w > 0 ? 1 : w < 0 ? -1 : 0;
      },
      X = function (w, O) {
        var E = w;
        do {
          if (
            E.i !== w.i &&
            E.next.i !== w.i &&
            E.i !== O.i &&
            E.next.i !== O.i &&
            P(E, E.next, w, O)
          )
            return !0;
          E = E.next;
        } while (E !== w);
        return !1;
      },
      W = function (w, O) {
        return b(w.prev, w, w.next) < 0
          ? b(w, O, w.next) >= 0 && b(w, w.prev, O) >= 0
          : b(w, O, w.prev) < 0 || b(w, w.next, O) < 0;
      },
      Z = function (w, O) {
        var E = w,
          k = !1,
          D = (w.x + O.x) / 2,
          q = (w.y + O.y) / 2;
        do
          E.y > q != E.next.y > q &&
            E.next.y !== E.y &&
            D < ((E.next.x - E.x) * (q - E.y)) / (E.next.y - E.y) + E.x &&
            (k = !k),
            (E = E.next);
        while (E !== w);
        return k;
      },
      j = function (w, O) {
        var E = new A(w.i, w.x, w.y),
          k = new A(O.i, O.x, O.y),
          D = w.next,
          q = O.prev;
        return (
          (w.next = O),
          (O.prev = w),
          (E.next = D),
          (D.prev = E),
          (k.next = E),
          (E.prev = k),
          (q.next = k),
          (k.prev = q),
          k
        );
      },
      L = function (w, O, E, k) {
        var D = new A(w, O, E);
        return (
          k
            ? ((D.next = k.next), (D.prev = k), (k.next.prev = D), (k.next = D))
            : ((D.prev = D), (D.next = D)),
          D
        );
      },
      T = function (w) {
        (w.next.prev = w.prev),
          (w.prev.next = w.next),
          w.prevZ && (w.prevZ.nextZ = w.nextZ),
          w.nextZ && (w.nextZ.prevZ = w.prevZ);
      },
      A = function (w, O, E) {
        (this.i = w),
          (this.x = O),
          (this.y = E),
          (this.prev = null),
          (this.next = null),
          (this.z = null),
          (this.prevZ = null),
          (this.nextZ = null),
          (this.steiner = !1);
      },
      $ = function (w, O, E, k) {
        for (var D = 0, q = O, J = E - k; q < E; q += k)
          (D += (w[J] - w[q]) * (w[q + 1] + w[J + 1])), (J = q);
        return D;
      };
    if (hasRequiredEarcut) return earcut.exports;
    (hasRequiredEarcut = 1), (earcut.exports = r), (earcut.exports.default = r);
    function R(M, w, O, E, k, D, q) {
      if (!!M) {
        !q && D && d(M, E, k, D);
        for (var J = M, de, we; M.prev !== M.next; ) {
          if (((de = M.prev), (we = M.next), D ? a(M, E, k, D) : s(M))) {
            w.push(de.i / O),
              w.push(M.i / O),
              w.push(we.i / O),
              T(M),
              (M = we.next),
              (J = we.next);
            continue;
          }
          if (((M = we), M === J)) {
            q
              ? q === 1
                ? ((M = o(i(M), w, O)), R(M, w, O, E, k, D, 2))
                : q === 2 && l(M, w, O, E, k, D)
              : R(i(M), w, O, E, k, D, 1);
            break;
          }
        }
      }
    }
    return (
      (r.deviation = function (M, w, O, E) {
        var k = w && w.length,
          D = k ? w[0] * O : M.length,
          q = Math.abs($(M, 0, D, O));
        if (k)
          for (var J = 0, de = w.length; J < de; J++) {
            var we = w[J] * O,
              Se = J < de - 1 ? w[J + 1] * O : M.length;
            q -= Math.abs($(M, we, Se, O));
          }
        var He = 0;
        for (J = 0; J < E.length; J += 3) {
          var et = E[J] * O,
            Ke = E[J + 1] * O,
            Fe = E[J + 2] * O;
          He += Math.abs(
            (M[et] - M[Fe]) * (M[Ke + 1] - M[et + 1]) -
              (M[et] - M[Ke]) * (M[Fe + 1] - M[et + 1])
          );
        }
        return q === 0 && He === 0 ? 0 : Math.abs((He - q) / q);
      }),
      (r.flatten = function (M) {
        for (
          var w = M[0][0].length,
            O = { vertices: [], holes: [], dimensions: w },
            E = 0,
            k = 0;
          k < M.length;
          k++
        ) {
          for (var D = 0; D < M[k].length; D++)
            for (var q = 0; q < w; q++) O.vertices.push(M[k][D][q]);
          k > 0 && ((E += M[k - 1].length), O.holes.push(E));
        }
        return O;
      }),
      earcut.exports
    );
  }
  var regl = { exports: {} };
  function _instanceof$2(r, n) {
    return n != null && typeof Symbol != "undefined" && n[Symbol.hasInstance]
      ? !!n[Symbol.hasInstance](r)
      : r instanceof n;
  }
  var _typeof$2 = function (r) {
      return r && typeof Symbol != "undefined" && r.constructor === Symbol
        ? "symbol"
        : typeof r;
    },
    hasRequiredRegl;
  function requireRegl() {
    return (
      hasRequiredRegl ||
        ((hasRequiredRegl = 1),
        (function (r, n) {
          (function (i, s) {
            r.exports = s();
          })(commonjsGlobal, function () {
            var i = function (C) {
                return typeof atob != "undefined" ? atob(C) : "base64:" + C;
              },
              s = function (C) {
                var B = new Error("(regl) " + C);
                throw (console.error(B), B);
              },
              a = function (C, B) {
                C || s(B);
              },
              o = function (C) {
                return C ? ": " + C : "";
              },
              l = function (C, B, Y) {
                C in B ||
                  s(
                    "unknown parameter (" +
                      C +
                      ")" +
                      o(Y) +
                      ". possible values: " +
                      Object.keys(B).join()
                  );
              },
              u = function (C, B) {
                tr(C) ||
                  s(
                    "invalid parameter type" + o(B) + ". must be a typed array"
                  );
              },
              f = function (C, B) {
                switch (B) {
                  case "number":
                    return typeof C == "number";
                  case "object":
                    return typeof C == "object";
                  case "string":
                    return typeof C == "string";
                  case "boolean":
                    return typeof C == "boolean";
                  case "function":
                    return typeof C == "function";
                  case "undefined":
                    return typeof C == "undefined";
                  case "symbol":
                    return (
                      (typeof C == "undefined" ? "undefined" : _typeof$2(C)) ===
                      "symbol"
                    );
                }
              },
              c = function (C, B, Y) {
                f(C, B) ||
                  s(
                    "invalid parameter type" +
                      o(Y) +
                      ". expected " +
                      B +
                      ", got " +
                      (typeof C == "undefined" ? "undefined" : _typeof$2(C))
                  );
              },
              h = function (C, B) {
                (C >= 0 && (C | 0) === C) ||
                  s(
                    "invalid parameter type, (" +
                      C +
                      ")" +
                      o(B) +
                      ". must be a nonnegative integer"
                  );
              },
              p = function (C, B, Y) {
                B.indexOf(C) < 0 &&
                  s("invalid value" + o(Y) + ". must be one of: " + B);
              },
              d = function (C) {
                Object.keys(C).forEach(function (B) {
                  fa.indexOf(B) < 0 &&
                    s(
                      'invalid regl constructor argument "' +
                        B +
                        '". must be one of ' +
                        fa
                    );
                });
              },
              m = function (C, B) {
                for (C = C + ""; C.length < B; ) C = " " + C;
                return C;
              },
              g = function () {
                (this.name = "unknown"),
                  (this.lines = []),
                  (this.index = {}),
                  (this.hasErrors = !1);
              },
              v = function (C, B) {
                (this.number = C), (this.line = B), (this.errors = []);
              },
              y = function (C, B, Y) {
                (this.file = C), (this.line = B), (this.message = Y);
              },
              _ = function () {
                var C = new Error(),
                  B = (C.stack || C).toString(),
                  Y = /compileProcedure.*\n\s*at.*\((.*)\)/.exec(B);
                if (Y) return Y[1];
                var ue = /compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(B);
                return ue ? ue[1] : "unknown";
              },
              b = function () {
                var C = new Error(),
                  B = (C.stack || C).toString(),
                  Y = /at REGLCommand.*\n\s+at.*\((.*)\)/.exec(B);
                if (Y) return Y[1];
                var ue = /at REGLCommand.*\n\s+at\s+(.*)\n/.exec(B);
                return ue ? ue[1] : "unknown";
              },
              S = function (C, B) {
                var Y = C.split("\n"),
                  ue = 1,
                  me = 0,
                  he = { unknown: new g(), 0: new g() };
                (he.unknown.name = he[0].name = B || _()),
                  he.unknown.lines.push(new v(0, ""));
                for (var _e = 0; _e < Y.length; ++_e) {
                  var Pe = Y[_e],
                    Le = /^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Pe);
                  if (Le)
                    switch (Le[1]) {
                      case "line":
                        var Oe = /(\d+)(\s+\d+)?/.exec(Le[2]);
                        Oe &&
                          ((ue = Oe[1] | 0),
                          Oe[2] &&
                            ((me = Oe[2] | 0), me in he || (he[me] = new g())));
                        break;
                      case "define":
                        var ze = /SHADER_NAME(_B64)?\s+(.*)$/.exec(Le[2]);
                        ze && (he[me].name = ze[1] ? i(ze[2]) : ze[2]);
                        break;
                    }
                  he[me].lines.push(new v(ue++, Pe));
                }
                return (
                  Object.keys(he).forEach(function ($e) {
                    var ke = he[$e];
                    ke.lines.forEach(function (Ie) {
                      ke.index[Ie.number] = Ie;
                    });
                  }),
                  he
                );
              },
              P = function (C) {
                var B = [];
                return (
                  C.split("\n").forEach(function (Y) {
                    if (!(Y.length < 5)) {
                      var ue = /^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(Y);
                      ue
                        ? B.push(new y(ue[1] | 0, ue[2] | 0, ue[3].trim()))
                        : Y.length > 0 && B.push(new y("unknown", 0, Y));
                    }
                  }),
                  B
                );
              },
              I = function (C, B) {
                B.forEach(function (Y) {
                  var ue = C[Y.file];
                  if (ue) {
                    var me = ue.index[Y.line];
                    if (me) {
                      me.errors.push(Y), (ue.hasErrors = !0);
                      return;
                    }
                  }
                  (C.unknown.hasErrors = !0), C.unknown.lines[0].errors.push(Y);
                });
              },
              F = function (C, B, Y, ue, me) {
                if (!C.getShaderParameter(B, C.COMPILE_STATUS)) {
                  var he = C.getShaderInfoLog(B),
                    _e = ue === C.FRAGMENT_SHADER ? "fragment" : "vertex";
                  A(Y, "string", _e + " shader source must be a string", me);
                  var Pe = S(Y, me),
                    Le = P(he);
                  I(Pe, Le),
                    Object.keys(Pe).forEach(function (Oe) {
                      var ze = Pe[Oe];
                      if (!ze.hasErrors) return;
                      var $e = [""],
                        ke = [""];
                      function Ie(Ee, le) {
                        $e.push(Ee), ke.push(le || "");
                      }
                      Ie(
                        "file number " + Oe + ": " + ze.name + "\n",
                        "color:red;text-decoration:underline;font-weight:bold"
                      ),
                        ze.lines.forEach(function (Ee) {
                          if (Ee.errors.length > 0) {
                            Ie(
                              m(Ee.number, 4) + "|  ",
                              "background-color:yellow; font-weight:bold"
                            ),
                              Ie(
                                Ee.line + $r,
                                "color:red; background-color:yellow; font-weight:bold"
                              );
                            var le = 0;
                            Ee.errors.forEach(function (se) {
                              var Ce = se.message,
                                We = /^\s*'(.*)'\s*:\s*(.*)$/.exec(Ce);
                              if (We) {
                                var ye = We[1];
                                switch (((Ce = We[2]), ye)) {
                                  case "assign":
                                    ye = "=";
                                    break;
                                }
                                le = Math.max(Ee.line.indexOf(ye, le), 0);
                              } else le = 0;
                              Ie(m("| ", 6)),
                                Ie(m("^^^", le + 3) + $r, "font-weight:bold"),
                                Ie(m("| ", 6)),
                                Ie(Ce + $r, "font-weight:bold");
                            }),
                              Ie(m("| ", 6) + $r);
                          } else Ie(m(Ee.number, 4) + "|  "), Ie(Ee.line + $r, "color:red");
                        }),
                        typeof document != "undefined" && !window.chrome
                          ? ((ke[0] = $e.join("%c")),
                            console.log.apply(console, ke))
                          : console.log($e.join(""));
                    }),
                    a.raise("Error compiling " + _e + " shader, " + Pe[0].name);
                }
              },
              X = function (C, B, Y, ue, me) {
                if (!C.getProgramParameter(B, C.LINK_STATUS)) {
                  var he = C.getProgramInfoLog(B),
                    _e = S(Y, me),
                    Pe = S(ue, me),
                    Le =
                      'Error linking program with vertex shader, "' +
                      Pe[0].name +
                      '", and fragment shader "' +
                      _e[0].name +
                      '"';
                  typeof document != "undefined"
                    ? console.log(
                        "%c" + Le + $r + "%c" + he,
                        "color:red;text-decoration:underline;font-weight:bold",
                        "color:red"
                      )
                    : console.log(Le + $r + he),
                    a.raise(Le);
                }
              },
              W = function (C) {
                C._commandRef = _();
              },
              Z = function (C, B, Y, ue) {
                W(C);
                function me(Le) {
                  return Le ? ue.id(Le) : 0;
                }
                (C._fragId = me(C.static.frag)),
                  (C._vertId = me(C.static.vert));
                function he(Le, Oe) {
                  Object.keys(Oe).forEach(function (ze) {
                    Le[ue.id(ze)] = !0;
                  });
                }
                var _e = (C._uniformSet = {});
                he(_e, B.static), he(_e, B.dynamic);
                var Pe = (C._attributeSet = {});
                he(Pe, Y.static),
                  he(Pe, Y.dynamic),
                  (C._hasCount =
                    "count" in C.static ||
                    "count" in C.dynamic ||
                    "elements" in C.static ||
                    "elements" in C.dynamic);
              },
              j = function (C, B) {
                var Y = b();
                s(
                  C +
                    " in command " +
                    (B || _()) +
                    (Y === "unknown" ? "" : " called from " + Y)
                );
              },
              L = function (C, B, Y) {
                C || j(B, Y || _());
              },
              T = function (C, B, Y, ue) {
                C in B ||
                  j(
                    "unknown parameter (" +
                      C +
                      ")" +
                      o(Y) +
                      ". possible values: " +
                      Object.keys(B).join(),
                    ue || _()
                  );
              },
              A = function (C, B, Y, ue) {
                f(C, B) ||
                  j(
                    "invalid parameter type" +
                      o(Y) +
                      ". expected " +
                      B +
                      ", got " +
                      (typeof C == "undefined" ? "undefined" : _typeof$2(C)),
                    ue || _()
                  );
              },
              $ = function (C) {
                C();
              },
              R = function (C, B, Y) {
                C.texture
                  ? p(
                      C.texture._texture.internalformat,
                      B,
                      "unsupported texture format for attachment"
                    )
                  : p(
                      C.renderbuffer._renderbuffer.format,
                      Y,
                      "unsupported renderbuffer format for attachment"
                    );
              },
              M = function (C, B) {
                return C === pa || C === da || C === va
                  ? 2
                  : C === ma
                  ? 4
                  : ur[C] * B;
              },
              w = function (C) {
                return !(C & (C - 1)) && !!C;
              },
              O = function (C, B, Y) {
                var ue,
                  me = B.width,
                  he = B.height,
                  _e = B.channels;
                a(
                  me > 0 &&
                    me <= Y.maxTextureSize &&
                    he > 0 &&
                    he <= Y.maxTextureSize,
                  "invalid texture shape"
                ),
                  (C.wrapS !== On || C.wrapT !== On) &&
                    a(
                      w(me) && w(he),
                      "incompatible wrap mode for texture, both width and height must be power of 2"
                    ),
                  B.mipmask === 1
                    ? me !== 1 &&
                      he !== 1 &&
                      a(
                        C.minFilter !== us &&
                          C.minFilter !== cs &&
                          C.minFilter !== fs &&
                          C.minFilter !== hs,
                        "min filter requires mipmap"
                      )
                    : (a(
                        w(me) && w(he),
                        "texture must be a square power of 2 to support mipmapping"
                      ),
                      a(
                        B.mipmask === (me << 1) - 1,
                        "missing or incomplete mipmap data"
                      )),
                  B.type === ha &&
                    (Y.extensions.indexOf("oes_texture_float_linear") < 0 &&
                      a(
                        C.minFilter === ca && C.magFilter === ca,
                        "filter not supported, must enable oes_texture_float_linear"
                      ),
                    a(
                      !C.genMipmaps,
                      "mipmap generation not supported with float textures"
                    ));
                var Pe = B.images;
                for (ue = 0; ue < 16; ++ue)
                  if (Pe[ue]) {
                    var Le = me >> ue,
                      Oe = he >> ue;
                    a(B.mipmask & (1 << ue), "missing mipmap data");
                    var ze = Pe[ue];
                    if (
                      (a(
                        ze.width === Le && ze.height === Oe,
                        "invalid shape for mip images"
                      ),
                      a(
                        ze.format === B.format &&
                          ze.internalformat === B.internalformat &&
                          ze.type === B.type,
                        "incompatible type for mip image"
                      ),
                      !ze.compressed)
                    )
                      if (ze.data) {
                        var $e =
                          Math.ceil(
                            (M(ze.type, _e) * Le) / ze.unpackAlignment
                          ) * ze.unpackAlignment;
                        a(
                          ze.data.byteLength === $e * Oe,
                          "invalid data for image, buffer size is inconsistent with image format"
                        );
                      } else ze.element || ze.copy;
                  } else
                    C.genMipmaps ||
                      a((B.mipmask & (1 << ue)) === 0, "extra mipmap data");
                B.compressed &&
                  a(
                    !C.genMipmaps,
                    "mipmap generation for compressed images not supported"
                  );
              },
              E = function (C, B, Y, ue) {
                var me = C.width,
                  he = C.height,
                  _e = C.channels;
                a(
                  me > 0 &&
                    me <= ue.maxTextureSize &&
                    he > 0 &&
                    he <= ue.maxTextureSize,
                  "invalid texture shape"
                ),
                  a(me === he, "cube map must be square"),
                  a(
                    B.wrapS === On && B.wrapT === On,
                    "wrap mode not supported by cube map"
                  );
                for (var Pe = 0; Pe < Y.length; ++Pe) {
                  var Le = Y[Pe];
                  a(
                    Le.width === me && Le.height === he,
                    "inconsistent cube map face shape"
                  ),
                    B.genMipmaps &&
                      (a(
                        !Le.compressed,
                        "can not generate mipmap for compressed textures"
                      ),
                      a(
                        Le.mipmask === 1,
                        "can not specify mipmaps and generate mipmaps"
                      ));
                  for (var Oe = Le.images, ze = 0; ze < 16; ++ze) {
                    var $e = Oe[ze];
                    if ($e) {
                      var ke = me >> ze,
                        Ie = he >> ze;
                      a(Le.mipmask & (1 << ze), "missing mipmap data"),
                        a(
                          $e.width === ke && $e.height === Ie,
                          "invalid shape for mip images"
                        ),
                        a(
                          $e.format === C.format &&
                            $e.internalformat === C.internalformat &&
                            $e.type === C.type,
                          "incompatible type for mip image"
                        ),
                        $e.compressed ||
                          ($e.data
                            ? a(
                                $e.data.byteLength ===
                                  ke *
                                    Ie *
                                    Math.max(
                                      M($e.type, _e),
                                      $e.unpackAlignment
                                    ),
                                "invalid data for image, buffer size is inconsistent with image format"
                              )
                            : $e.element || $e.copy);
                    }
                  }
                }
              },
              k = function (C, B) {
                (this.id = bs++), (this.type = C), (this.data = B);
              },
              D = function (C) {
                return C.replace(/\\/g, "\\\\").replace(/"/g, '\\"');
              },
              q = function (C) {
                return "[" + sn(C).join("][") + "]";
              },
              J = function (C, B) {
                return new k(C, q(B + ""));
              },
              de = function (C) {
                return (
                  (typeof C == "function" && !C._reglType) ||
                  _instanceof$2(C, k)
                );
              },
              we = function () {
                var C = { "": 0 },
                  B = [""];
                return {
                  id: function (ue) {
                    var me = C[ue];
                    return me || ((me = C[ue] = B.length), B.push(ue), me);
                  },
                  str: function (ue) {
                    return B[ue];
                  },
                };
              },
              Se = function (C, B, Y) {
                var ue = document.createElement("canvas");
                Gt(ue.style, {
                  border: 0,
                  margin: 0,
                  padding: 0,
                  top: 0,
                  left: 0,
                  width: "100%",
                  height: "100%",
                }),
                  C.appendChild(ue),
                  C === document.body &&
                    ((ue.style.position = "absolute"),
                    Gt(C.style, { margin: 0, padding: 0 }));
                function me() {
                  var Pe = window.innerWidth,
                    Le = window.innerHeight;
                  if (C !== document.body) {
                    var Oe = ue.getBoundingClientRect();
                    (Pe = Oe.right - Oe.left), (Le = Oe.bottom - Oe.top);
                  }
                  (ue.width = Y * Pe), (ue.height = Y * Le);
                }
                var he;
                C !== document.body && typeof ResizeObserver == "function"
                  ? ((he = new ResizeObserver(function () {
                      setTimeout(me);
                    })),
                    he.observe(C))
                  : window.addEventListener("resize", me, !1);
                function _e() {
                  he
                    ? he.disconnect()
                    : window.removeEventListener("resize", me),
                    C.removeChild(ue);
                }
                return me(), { canvas: ue, onDestroy: _e };
              },
              He = function (C, B) {
                function Y(ue) {
                  try {
                    return C.getContext(ue, B);
                  } catch (me) {
                    return null;
                  }
                }
                return (
                  Y("webgl") ||
                  Y("experimental-webgl") ||
                  Y("webgl-experimental")
                );
              },
              et = function (C) {
                return (
                  typeof C.nodeName == "string" &&
                  typeof C.appendChild == "function" &&
                  typeof C.getBoundingClientRect == "function"
                );
              },
              Ke = function (C) {
                return (
                  typeof C.drawArrays == "function" ||
                  typeof C.drawElements == "function"
                );
              },
              Fe = function (C) {
                return typeof C == "string"
                  ? C.split()
                  : (V(Array.isArray(C), "invalid extension array"), C);
              },
              qe = function (C) {
                return typeof C == "string"
                  ? (V(
                      typeof document != "undefined",
                      "not supported outside of DOM"
                    ),
                    document.querySelector(C))
                  : C;
              },
              Mt = function (C) {
                var B = C || {},
                  Y,
                  ue,
                  me,
                  he,
                  _e = {},
                  Pe = [],
                  Le = [],
                  Oe =
                    typeof window == "undefined" ? 1 : window.devicePixelRatio,
                  ze = !1,
                  $e = function (le) {
                    le && V.raise(le);
                  },
                  ke = function () {};
                if (
                  (typeof B == "string"
                    ? (V(
                        typeof document != "undefined",
                        "selector queries only supported in DOM enviroments"
                      ),
                      (Y = document.querySelector(B)),
                      V(Y, "invalid query string for element"))
                    : typeof B == "object"
                    ? et(B)
                      ? (Y = B)
                      : Ke(B)
                      ? ((he = B), (me = he.canvas))
                      : (V.constructor(B),
                        "gl" in B
                          ? (he = B.gl)
                          : "canvas" in B
                          ? (me = qe(B.canvas))
                          : "container" in B && (ue = qe(B.container)),
                        "attributes" in B &&
                          ((_e = B.attributes),
                          V.type(_e, "object", "invalid context attributes")),
                        "extensions" in B && (Pe = Fe(B.extensions)),
                        "optionalExtensions" in B &&
                          (Le = Fe(B.optionalExtensions)),
                        "onDone" in B &&
                          (V.type(
                            B.onDone,
                            "function",
                            "invalid or missing onDone callback"
                          ),
                          ($e = B.onDone)),
                        "profile" in B && (ze = !!B.profile),
                        "pixelRatio" in B &&
                          ((Oe = +B.pixelRatio),
                          V(Oe > 0, "invalid pixel ratio")))
                    : V.raise("invalid arguments to regl"),
                  Y &&
                    (Y.nodeName.toLowerCase() === "canvas"
                      ? (me = Y)
                      : (ue = Y)),
                  !he)
                ) {
                  if (!me) {
                    V(
                      typeof document != "undefined",
                      "must manually specify webgl context outside of DOM environments"
                    );
                    var Ie = Se(ue || document.body, $e, Oe);
                    if (!Ie) return null;
                    (me = Ie.canvas), (ke = Ie.onDestroy);
                  }
                  _e.premultipliedAlpha === void 0 &&
                    (_e.premultipliedAlpha = !0),
                    (he = He(me, _e));
                }
                return he
                  ? {
                      gl: he,
                      canvas: me,
                      container: ue,
                      extensions: Pe,
                      optionalExtensions: Le,
                      pixelRatio: Oe,
                      profile: ze,
                      onDone: $e,
                      onDestroy: ke,
                    }
                  : (ke(),
                    $e(
                      "webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"
                    ),
                    null);
              },
              ot = function (C, B) {
                var Y = {};
                function ue(_e) {
                  V.type(_e, "string", "extension name must be string");
                  var Pe = _e.toLowerCase(),
                    Le;
                  try {
                    Le = Y[Pe] = C.getExtension(Pe);
                  } catch (Oe) {}
                  return !!Le;
                }
                for (var me = 0; me < B.extensions.length; ++me) {
                  var he = B.extensions[me];
                  if (!ue(he))
                    return (
                      B.onDestroy(),
                      B.onDone(
                        '"' +
                          he +
                          '" extension is not supported by the current WebGL context, try upgrading your system or a different browser'
                      ),
                      null
                    );
                }
                return (
                  B.optionalExtensions.forEach(ue),
                  {
                    extensions: Y,
                    restore: function () {
                      Object.keys(Y).forEach(function (Pe) {
                        if (Y[Pe] && !ue(Pe))
                          throw new Error(
                            "(regl): error restoring extension " + Pe
                          );
                      });
                    },
                  }
                );
              },
              at = function (C, B) {
                for (var Y = Array(C), ue = 0; ue < C; ++ue) Y[ue] = B(ue);
                return Y;
              },
              Lt = function (C) {
                for (var B = 16; B <= 268435456; B *= 16) if (C <= B) return B;
                return 0;
              },
              $t = function (C) {
                var B, Y;
                return (
                  (B = (C > 65535) << 4),
                  (C >>>= B),
                  (Y = (C > 255) << 3),
                  (C >>>= Y),
                  (B |= Y),
                  (Y = (C > 15) << 2),
                  (C >>>= Y),
                  (B |= Y),
                  (Y = (C > 3) << 1),
                  (C >>>= Y),
                  (B |= Y),
                  B | (C >> 1)
                );
              },
              Rt = function () {
                var C = at(8, function () {
                  return [];
                });
                function B(he) {
                  var _e = Lt(he),
                    Pe = C[$t(_e) >> 2];
                  return Pe.length > 0 ? Pe.pop() : new ArrayBuffer(_e);
                }
                function Y(he) {
                  C[$t(he.byteLength) >> 2].push(he);
                }
                function ue(he, _e) {
                  var Pe = null;
                  switch (he) {
                    case ws:
                      Pe = new Int8Array(B(_e), 0, _e);
                      break;
                    case As:
                      Pe = new Uint8Array(B(_e), 0, _e);
                      break;
                    case Ps:
                      Pe = new Int16Array(B(2 * _e), 0, _e);
                      break;
                    case Es:
                      Pe = new Uint16Array(B(2 * _e), 0, _e);
                      break;
                    case $s:
                      Pe = new Int32Array(B(4 * _e), 0, _e);
                      break;
                    case Os:
                      Pe = new Uint32Array(B(4 * _e), 0, _e);
                      break;
                    case Ls:
                      Pe = new Float32Array(B(4 * _e), 0, _e);
                      break;
                    default:
                      return null;
                  }
                  return Pe.length !== _e ? Pe.subarray(0, _e) : Pe;
                }
                function me(he) {
                  Y(he.buffer);
                }
                return { alloc: B, free: Y, allocType: ue, freeType: me };
              },
              Ot = function (C) {
                return (
                  !!C &&
                  typeof C == "object" &&
                  Array.isArray(C.shape) &&
                  Array.isArray(C.stride) &&
                  typeof C.offset == "number" &&
                  C.shape.length === C.stride.length &&
                  (Array.isArray(C.data) || tr(C.data))
                );
              },
              wt = function (C, B, Y) {
                for (var ue = 0; ue < B; ++ue) Y[ue] = C[ue];
              },
              kt = function (C, B, Y, ue) {
                for (var me = 0, he = 0; he < B; ++he)
                  for (var _e = C[he], Pe = 0; Pe < Y; ++Pe) ue[me++] = _e[Pe];
              },
              Pt = function (C, B, Y, ue, me, he) {
                for (var _e = he, Pe = 0; Pe < B; ++Pe)
                  for (var Le = C[Pe], Oe = 0; Oe < Y; ++Oe)
                    for (var ze = Le[Oe], $e = 0; $e < ue; ++$e)
                      me[_e++] = ze[$e];
              },
              At = function (C, B, Y, ue) {
                var me = 1;
                if (B.length) for (var he = 0; he < B.length; ++he) me *= B[he];
                else me = 0;
                var _e = ue || qt.allocType(Y, me);
                switch (B.length) {
                  case 0:
                    break;
                  case 1:
                    wt(C, B[0], _e);
                    break;
                  case 2:
                    kt(C, B[0], B[1], _e);
                    break;
                  case 3:
                    Pt(C, B[0], B[1], B[2], _e, 0);
                    break;
                  default:
                    xa(C, B, 0, _e, 0);
                }
                return _e;
              },
              ut = function (C) {
                for (var B = [], Y = C; Y.length; Y = Y[0]) B.push(Y.length);
                return B;
              },
              ct = function (C) {
                return hi[Object.prototype.toString.call(C)] | 0;
              },
              vt = function (C, B) {
                for (var Y = 0; Y < B.length; ++Y) C[Y] = B[Y];
              },
              rt = function (C, B, Y, ue, me, he, _e) {
                for (var Pe = 0, Le = 0; Le < Y; ++Le)
                  for (var Oe = 0; Oe < ue; ++Oe)
                    C[Pe++] = B[me * Le + he * Oe + _e];
              },
              Wt = function (C, B, Y, ue) {
                var me = 0,
                  he = {};
                function _e(le) {
                  (this.id = me++),
                    (this.buffer = C.createBuffer()),
                    (this.type = le),
                    (this.usage = Sa),
                    (this.byteLength = 0),
                    (this.dimension = 1),
                    (this.dtype = pi),
                    (this.persistentData = null),
                    Y.profile && (this.stats = { size: 0 });
                }
                (_e.prototype.bind = function () {
                  C.bindBuffer(this.type, this.buffer);
                }),
                  (_e.prototype.destroy = function () {
                    ke(this);
                  });
                var Pe = [];
                function Le(le, se) {
                  var Ce = Pe.pop();
                  return (
                    Ce || (Ce = new _e(le)),
                    Ce.bind(),
                    $e(Ce, se, bl, 0, 1, !1),
                    Ce
                  );
                }
                function Oe(le) {
                  Pe.push(le);
                }
                function ze(le, se, Ce) {
                  (le.byteLength = se.byteLength),
                    C.bufferData(le.type, se, Ce);
                }
                function $e(le, se, Ce, We, ye, nt) {
                  var Je;
                  if (((le.usage = Ce), Array.isArray(se))) {
                    if (((le.dtype = We || vi), se.length > 0)) {
                      var Ue;
                      if (Array.isArray(se[0])) {
                        Je = Ca(se);
                        for (var be = 1, pe = 1; pe < Je.length; ++pe)
                          be *= Je[pe];
                        (le.dimension = be),
                          (Ue = di(se, Je, le.dtype)),
                          ze(le, Ue, Ce),
                          nt ? (le.persistentData = Ue) : qt.freeType(Ue);
                      } else if (typeof se[0] == "number") {
                        le.dimension = ye;
                        var Ye = qt.allocType(le.dtype, se.length);
                        vt(Ye, se),
                          ze(le, Ye, Ce),
                          nt ? (le.persistentData = Ye) : qt.freeType(Ye);
                      } else
                        tr(se[0])
                          ? ((le.dimension = se[0].length),
                            (le.dtype = We || ct(se[0]) || vi),
                            (Ue = di(se, [se.length, se[0].length], le.dtype)),
                            ze(le, Ue, Ce),
                            nt ? (le.persistentData = Ue) : qt.freeType(Ue))
                          : V.raise("invalid buffer data");
                    }
                  } else if (tr(se))
                    (le.dtype = We || ct(se)),
                      (le.dimension = ye),
                      ze(le, se, Ce),
                      nt &&
                        (le.persistentData = new Uint8Array(
                          new Uint8Array(se.buffer)
                        ));
                  else if (Ot(se)) {
                    Je = se.shape;
                    var Be = se.stride,
                      Te = se.offset,
                      De = 0,
                      Ne = 0,
                      dt = 0,
                      ht = 0;
                    Je.length === 1
                      ? ((De = Je[0]), (Ne = 1), (dt = Be[0]), (ht = 0))
                      : Je.length === 2
                      ? ((De = Je[0]), (Ne = Je[1]), (dt = Be[0]), (ht = Be[1]))
                      : V.raise("invalid shape"),
                      (le.dtype = We || ct(se.data) || vi),
                      (le.dimension = Ne);
                    var Ve = qt.allocType(le.dtype, De * Ne);
                    rt(Ve, se.data, De, Ne, dt, ht, Te),
                      ze(le, Ve, Ce),
                      nt ? (le.persistentData = Ve) : qt.freeType(Ve);
                  } else
                    _instanceof$2(se, ArrayBuffer)
                      ? ((le.dtype = pi),
                        (le.dimension = ye),
                        ze(le, se, Ce),
                        nt &&
                          (le.persistentData = new Uint8Array(
                            new Uint8Array(se)
                          )))
                      : V.raise("invalid buffer data");
                }
                function ke(le) {
                  B.bufferCount--, ue(le);
                  var se = le.buffer;
                  V(se, "buffer must not be deleted already"),
                    C.deleteBuffer(se),
                    (le.buffer = null),
                    delete he[le.id];
                }
                function Ie(le, se, Ce, We) {
                  B.bufferCount++;
                  var ye = new _e(se);
                  he[ye.id] = ye;
                  function nt(be) {
                    var pe = Sa,
                      Ye = null,
                      Be = 0,
                      Te = 0,
                      De = 1;
                    return (
                      Array.isArray(be) ||
                      tr(be) ||
                      Ot(be) ||
                      _instanceof$2(be, ArrayBuffer)
                        ? (Ye = be)
                        : typeof be == "number"
                        ? (Be = be | 0)
                        : be &&
                          (V.type(
                            be,
                            "object",
                            "buffer arguments must be an object, a number or an array"
                          ),
                          "data" in be &&
                            (V(
                              Ye === null ||
                                Array.isArray(Ye) ||
                                tr(Ye) ||
                                Ot(Ye),
                              "invalid data for buffer"
                            ),
                            (Ye = be.data)),
                          "usage" in be &&
                            (V.parameter(be.usage, Mn, "invalid buffer usage"),
                            (pe = Mn[be.usage])),
                          "type" in be &&
                            (V.parameter(be.type, Or, "invalid buffer type"),
                            (Te = Or[be.type])),
                          "dimension" in be &&
                            (V.type(
                              be.dimension,
                              "number",
                              "invalid dimension"
                            ),
                            (De = be.dimension | 0)),
                          "length" in be &&
                            (V.nni(
                              Be,
                              "buffer length must be a nonnegative integer"
                            ),
                            (Be = be.length | 0))),
                      ye.bind(),
                      Ye
                        ? $e(ye, Ye, pe, Te, De, We)
                        : (Be && C.bufferData(ye.type, Be, pe),
                          (ye.dtype = Te || pi),
                          (ye.usage = pe),
                          (ye.dimension = De),
                          (ye.byteLength = Be)),
                      Y.profile &&
                        (ye.stats.size = ye.byteLength * Sr[ye.dtype]),
                      nt
                    );
                  }
                  function Je(be, pe) {
                    V(
                      pe + be.byteLength <= ye.byteLength,
                      "invalid buffer subdata call, buffer is too small.  Can't write data of size " +
                        be.byteLength +
                        " starting from offset " +
                        pe +
                        " to a buffer of size " +
                        ye.byteLength
                    ),
                      C.bufferSubData(ye.type, pe, be);
                  }
                  function Ue(be, pe) {
                    var Ye = (pe || 0) | 0,
                      Be;
                    if ((ye.bind(), tr(be) || _instanceof$2(be, ArrayBuffer)))
                      Je(be, Ye);
                    else if (Array.isArray(be)) {
                      if (be.length > 0)
                        if (typeof be[0] == "number") {
                          var Te = qt.allocType(ye.dtype, be.length);
                          vt(Te, be), Je(Te, Ye), qt.freeType(Te);
                        } else if (Array.isArray(be[0]) || tr(be[0])) {
                          Be = Ca(be);
                          var De = di(be, Be, ye.dtype);
                          Je(De, Ye), qt.freeType(De);
                        } else V.raise("invalid buffer data");
                    } else if (Ot(be)) {
                      Be = be.shape;
                      var Ne = be.stride,
                        dt = 0,
                        ht = 0,
                        Ve = 0,
                        Ge = 0;
                      Be.length === 1
                        ? ((dt = Be[0]), (ht = 1), (Ve = Ne[0]), (Ge = 0))
                        : Be.length === 2
                        ? ((dt = Be[0]),
                          (ht = Be[1]),
                          (Ve = Ne[0]),
                          (Ge = Ne[1]))
                        : V.raise("invalid shape");
                      var st = Array.isArray(be.data) ? ye.dtype : ct(be.data),
                        pt = qt.allocType(st, dt * ht);
                      rt(pt, be.data, dt, ht, Ve, Ge, be.offset),
                        Je(pt, Ye),
                        qt.freeType(pt);
                    } else V.raise("invalid data for buffer subdata");
                    return nt;
                  }
                  return (
                    Ce || nt(le),
                    (nt._reglType = "buffer"),
                    (nt._buffer = ye),
                    (nt.subdata = Ue),
                    Y.profile && (nt.stats = ye.stats),
                    (nt.destroy = function () {
                      ke(ye);
                    }),
                    nt
                  );
                }
                function Ee() {
                  cr(he).forEach(function (le) {
                    (le.buffer = C.createBuffer()),
                      C.bindBuffer(le.type, le.buffer),
                      C.bufferData(
                        le.type,
                        le.persistentData || le.byteLength,
                        le.usage
                      );
                  });
                }
                return (
                  Y.profile &&
                    (B.getTotalBufferSize = function () {
                      var le = 0;
                      return (
                        Object.keys(he).forEach(function (se) {
                          le += he[se].stats.size;
                        }),
                        le
                      );
                    }),
                  {
                    create: Ie,
                    createStream: Le,
                    destroyStream: Oe,
                    clear: function () {
                      cr(he).forEach(ke), Pe.forEach(ke);
                    },
                    getBuffer: function (se) {
                      return se && _instanceof$2(se._buffer, _e)
                        ? se._buffer
                        : null;
                    },
                    restore: Ee,
                    _initBuffer: $e,
                  }
                );
              },
              Vt = function (C, B, Y, ue) {
                var me = {},
                  he = 0,
                  _e = { uint8: Hr, uint16: Wr };
                B.oes_element_index_uint && (_e.uint32 = Lr);
                function Pe(Ee) {
                  (this.id = he++),
                    (me[this.id] = this),
                    (this.buffer = Ee),
                    (this.primType = fn),
                    (this.vertCount = 0),
                    (this.type = 0);
                }
                Pe.prototype.bind = function () {
                  this.buffer.bind();
                };
                var Le = [];
                function Oe(Ee) {
                  var le = Le.pop();
                  return (
                    le || (le = new Pe(Y.create(null, mi, !0, !1)._buffer)),
                    $e(le, Ee, Ll, -1, -1, 0, 0),
                    le
                  );
                }
                function ze(Ee) {
                  Le.push(Ee);
                }
                function $e(Ee, le, se, Ce, We, ye, nt) {
                  Ee.buffer.bind();
                  var Je;
                  if (le) {
                    var Ue = nt;
                    !nt &&
                      (!tr(le) || (Ot(le) && !tr(le.data))) &&
                      (Ue = B.oes_element_index_uint ? Lr : Wr),
                      Y._initBuffer(Ee.buffer, le, se, Ue, 3);
                  } else
                    C.bufferData(mi, ye, se),
                      (Ee.buffer.dtype = Je || Hr),
                      (Ee.buffer.usage = se),
                      (Ee.buffer.dimension = 3),
                      (Ee.buffer.byteLength = ye);
                  if (((Je = nt), !nt)) {
                    switch (Ee.buffer.dtype) {
                      case Hr:
                      case Ol:
                        Je = Hr;
                        break;
                      case Wr:
                      case wa:
                        Je = Wr;
                        break;
                      case Lr:
                      case Aa:
                        Je = Lr;
                        break;
                      default:
                        V.raise("unsupported type for element array");
                    }
                    Ee.buffer.dtype = Je;
                  }
                  (Ee.type = Je),
                    V(
                      Je !== Lr || !!B.oes_element_index_uint,
                      "32 bit element buffers not supported, enable oes_element_index_uint first"
                    );
                  var be = We;
                  be < 0 &&
                    ((be = Ee.buffer.byteLength),
                    Je === Wr ? (be >>= 1) : Je === Lr && (be >>= 2)),
                    (Ee.vertCount = be);
                  var pe = Ce;
                  if (Ce < 0) {
                    pe = fn;
                    var Ye = Ee.buffer.dimension;
                    Ye === 1 && (pe = El),
                      Ye === 2 && (pe = $l),
                      Ye === 3 && (pe = fn);
                  }
                  Ee.primType = pe;
                }
                function ke(Ee) {
                  ue.elementsCount--,
                    V(Ee.buffer !== null, "must not double destroy elements"),
                    delete me[Ee.id],
                    Ee.buffer.destroy(),
                    (Ee.buffer = null);
                }
                function Ie(Ee, le) {
                  var se = Y.create(null, mi, !0),
                    Ce = new Pe(se._buffer);
                  ue.elementsCount++;
                  function We(ye) {
                    if (!ye)
                      se(),
                        (Ce.primType = fn),
                        (Ce.vertCount = 0),
                        (Ce.type = Hr);
                    else if (typeof ye == "number")
                      se(ye),
                        (Ce.primType = fn),
                        (Ce.vertCount = ye | 0),
                        (Ce.type = Hr);
                    else {
                      var nt = null,
                        Je = Tl,
                        Ue = -1,
                        be = -1,
                        pe = 0,
                        Ye = 0;
                      Array.isArray(ye) || tr(ye) || Ot(ye)
                        ? (nt = ye)
                        : (V.type(
                            ye,
                            "object",
                            "invalid arguments for elements"
                          ),
                          "data" in ye &&
                            ((nt = ye.data),
                            V(
                              Array.isArray(nt) || tr(nt) || Ot(nt),
                              "invalid data for element buffer"
                            )),
                          "usage" in ye &&
                            (V.parameter(
                              ye.usage,
                              Mn,
                              "invalid element buffer usage"
                            ),
                            (Je = Mn[ye.usage])),
                          "primitive" in ye &&
                            (V.parameter(
                              ye.primitive,
                              wr,
                              "invalid element buffer primitive"
                            ),
                            (Ue = wr[ye.primitive])),
                          "count" in ye &&
                            (V(
                              typeof ye.count == "number" && ye.count >= 0,
                              "invalid vertex count for elements"
                            ),
                            (be = ye.count | 0)),
                          "type" in ye &&
                            (V.parameter(ye.type, _e, "invalid buffer type"),
                            (Ye = _e[ye.type])),
                          "length" in ye
                            ? (pe = ye.length | 0)
                            : ((pe = be),
                              Ye === Wr || Ye === wa
                                ? (pe *= 2)
                                : (Ye === Lr || Ye === Aa) && (pe *= 4))),
                        $e(Ce, nt, Je, Ue, be, pe, Ye);
                    }
                    return We;
                  }
                  return (
                    We(Ee),
                    (We._reglType = "elements"),
                    (We._elements = Ce),
                    (We.subdata = function (ye, nt) {
                      return se.subdata(ye, nt), We;
                    }),
                    (We.destroy = function () {
                      ke(Ce);
                    }),
                    We
                  );
                }
                return {
                  create: Ie,
                  createStream: Oe,
                  destroyStream: ze,
                  getElements: function (le) {
                    return typeof le == "function" &&
                      _instanceof$2(le._elements, Pe)
                      ? le._elements
                      : null;
                  },
                  clear: function () {
                    cr(me).forEach(ke);
                  },
                };
              },
              mt = function (C) {
                for (
                  var B = qt.allocType(Rl, C.length), Y = 0;
                  Y < C.length;
                  ++Y
                )
                  if (isNaN(C[Y])) B[Y] = 65535;
                  else if (C[Y] === 1 / 0) B[Y] = 31744;
                  else if (C[Y] === -1 / 0) B[Y] = 64512;
                  else {
                    Pa[0] = C[Y];
                    var ue = Ml[0],
                      me = (ue >>> 31) << 15,
                      he = ((ue << 1) >>> 24) - 127,
                      _e = (ue >> 13) & ((1 << 10) - 1);
                    if (he < -24) B[Y] = me;
                    else if (he < -14) {
                      var Pe = -14 - he;
                      B[Y] = me + ((_e + 1024) >> Pe);
                    } else
                      he > 15
                        ? (B[Y] = me + 31744)
                        : (B[Y] = me + ((he + 15) << 10) + _e);
                  }
                return B;
              },
              yt = function (C) {
                return Array.isArray(C) || tr(C);
              },
              xt = function (C) {
                return "[object " + C + "]";
              },
              It = function (C) {
                return (
                  Array.isArray(C) &&
                  (C.length === 0 || typeof C[0] == "number")
                );
              },
              Bt = function (C) {
                if (!Array.isArray(C)) return !1;
                var B = C.length;
                return !(B === 0 || !yt(C[0]));
              },
              ar = function (C) {
                return Object.prototype.toString.call(C);
              },
              Gr = function (C) {
                return ar(C) === Va;
              },
              on = function (C) {
                return ar(C) === Ga;
              },
              oi = function (C) {
                return ar(C) === Ua;
              },
              Ur = function (C) {
                return ar(C) === ja;
              },
              Qo = function (C) {
                return ar(C) === qa;
              },
              Zo = function (C) {
                return ar(C) === Ha;
              },
              si = function (C) {
                if (!C) return !1;
                var B = ar(C);
                return tu.indexOf(B) >= 0 ? !0 : It(C) || Bt(C) || Ot(C);
              },
              ia = function (C) {
                return hi[Object.prototype.toString.call(C)] | 0;
              },
              Ko = function (C, B) {
                var Y = B.length;
                switch (C.type) {
                  case Xr:
                  case Ei:
                  case $i:
                  case hn:
                    var ue = qt.allocType(C.type, Y);
                    ue.set(B), (C.data = ue);
                    break;
                  case Yr:
                    C.data = mt(B);
                    break;
                  default:
                    V.raise(
                      "unsupported texture type, must specify a typed array"
                    );
                }
              },
              aa = function (C, B) {
                return qt.allocType(C.type === Yr ? hn : C.type, B);
              },
              oa = function (C, B) {
                C.type === Yr
                  ? ((C.data = mt(B)), qt.freeType(B))
                  : (C.data = B);
              },
              Jo = function (C, B, Y, ue, me, he) {
                for (
                  var _e = C.width,
                    Pe = C.height,
                    Le = C.channels,
                    Oe = _e * Pe * Le,
                    ze = aa(C, Oe),
                    $e = 0,
                    ke = 0;
                  ke < Pe;
                  ++ke
                )
                  for (var Ie = 0; Ie < _e; ++Ie)
                    for (var Ee = 0; Ee < Le; ++Ee)
                      ze[$e++] = B[Y * Ie + ue * ke + me * Ee + he];
                oa(C, ze);
              },
              En = function (C, B, Y, ue, me, he) {
                var _e;
                if (
                  (typeof rr[C] != "undefined"
                    ? (_e = rr[C])
                    : (_e = pr[C] * Qr[B]),
                  he && (_e *= 6),
                  me)
                ) {
                  for (var Pe = 0, Le = Y; Le >= 1; )
                    (Pe += _e * Le * Le), (Le /= 2);
                  return Pe;
                } else return _e * Y * ue;
              },
              es = function (C, B, Y, ue, me, he, _e) {
                var Pe = {
                    "don't care": Fn,
                    "dont care": Fn,
                    nice: Yl,
                    fast: Wl,
                  },
                  Le = { repeat: Vl, clamp: Oi, mirror: Gl },
                  Oe = { nearest: Li, linear: ql },
                  ze = Gt(
                    {
                      mipmap: Mi,
                      "nearest mipmap nearest": Ti,
                      "linear mipmap nearest": Da,
                      "nearest mipmap linear": Ba,
                      "linear mipmap linear": Mi,
                    },
                    Oe
                  ),
                  $e = { none: 0, browser: Na },
                  ke = { uint8: Xr, rgba4: Il, rgb565: Fl, "rgb5 a1": zl },
                  Ie = {
                    alpha: yi,
                    luminance: cn,
                    "luminance alpha": In,
                    rgb: kn,
                    rgba: Tr,
                    rgba4: $a,
                    "rgb5 a1": _i,
                    rgb565: Oa,
                  },
                  Ee = {};
                B.ext_srgb && ((Ie.srgb = xi), (Ie.srgba = Ci)),
                  B.oes_texture_float && (ke.float32 = ke.float = hn),
                  B.oes_texture_half_float &&
                    (ke.float16 = ke["half float"] = Yr),
                  B.webgl_depth_texture &&
                    (Gt(Ie, { depth: bi, "depth stencil": zn }),
                    Gt(ke, { uint16: Ei, uint32: $i, "depth stencil": Dl })),
                  B.webgl_compressed_texture_s3tc &&
                    Gt(Ee, {
                      "rgb s3tc dxt1": Si,
                      "rgba s3tc dxt1": wi,
                      "rgba s3tc dxt3": Ai,
                      "rgba s3tc dxt5": Pi,
                    }),
                  B.webgl_compressed_texture_atc &&
                    Gt(Ee, {
                      "rgb atc": La,
                      "rgba atc explicit alpha": Ta,
                      "rgba atc interpolated alpha": Ma,
                    }),
                  B.webgl_compressed_texture_pvrtc &&
                    Gt(Ee, {
                      "rgb pvrtc 4bppv1": Ra,
                      "rgb pvrtc 2bppv1": ka,
                      "rgba pvrtc 4bppv1": Ia,
                      "rgba pvrtc 2bppv1": za,
                    }),
                  B.webgl_compressed_texture_etc1 && (Ee["rgb etc1"] = Fa);
                var le = Array.prototype.slice.call(C.getParameter(kl));
                Object.keys(Ee).forEach(function (H) {
                  var ce = Ee[H];
                  le.indexOf(ce) >= 0 && (Ie[H] = ce);
                });
                var se = Object.keys(Ie);
                Y.textureFormats = se;
                var Ce = [];
                Object.keys(Ie).forEach(function (H) {
                  var ce = Ie[H];
                  Ce[ce] = H;
                });
                var We = [];
                Object.keys(ke).forEach(function (H) {
                  var ce = ke[H];
                  We[ce] = H;
                });
                var ye = [];
                Object.keys(Oe).forEach(function (H) {
                  var ce = Oe[H];
                  ye[ce] = H;
                });
                var nt = [];
                Object.keys(ze).forEach(function (H) {
                  var ce = ze[H];
                  nt[ce] = H;
                });
                var Je = [];
                Object.keys(Le).forEach(function (H) {
                  var ce = Le[H];
                  Je[ce] = H;
                });
                var Ue = se.reduce(function (H, ce) {
                  var ae = Ie[ce];
                  return (
                    ae === cn ||
                    ae === yi ||
                    ae === cn ||
                    ae === In ||
                    ae === bi ||
                    ae === zn ||
                    (B.ext_srgb && (ae === xi || ae === Ci))
                      ? (H[ae] = ae)
                      : ae === _i || ce.indexOf("rgba") >= 0
                      ? (H[ae] = Tr)
                      : (H[ae] = kn),
                    H
                  );
                }, {});
                function be() {
                  (this.internalformat = Tr),
                    (this.format = Tr),
                    (this.type = Xr),
                    (this.compressed = !1),
                    (this.premultiplyAlpha = !1),
                    (this.flipY = !1),
                    (this.unpackAlignment = 1),
                    (this.colorSpace = Na),
                    (this.width = 0),
                    (this.height = 0),
                    (this.channels = 0);
                }
                function pe(H, ce) {
                  (H.internalformat = ce.internalformat),
                    (H.format = ce.format),
                    (H.type = ce.type),
                    (H.compressed = ce.compressed),
                    (H.premultiplyAlpha = ce.premultiplyAlpha),
                    (H.flipY = ce.flipY),
                    (H.unpackAlignment = ce.unpackAlignment),
                    (H.colorSpace = ce.colorSpace),
                    (H.width = ce.width),
                    (H.height = ce.height),
                    (H.channels = ce.channels);
                }
                function Ye(H, ce) {
                  if (!(typeof ce != "object" || !ce)) {
                    if (
                      ("premultiplyAlpha" in ce &&
                        (V.type(
                          ce.premultiplyAlpha,
                          "boolean",
                          "invalid premultiplyAlpha"
                        ),
                        (H.premultiplyAlpha = ce.premultiplyAlpha)),
                      "flipY" in ce &&
                        (V.type(ce.flipY, "boolean", "invalid texture flip"),
                        (H.flipY = ce.flipY)),
                      "alignment" in ce &&
                        (V.oneOf(
                          ce.alignment,
                          [1, 2, 4, 8],
                          "invalid texture unpack alignment"
                        ),
                        (H.unpackAlignment = ce.alignment)),
                      "colorSpace" in ce &&
                        (V.parameter(ce.colorSpace, $e, "invalid colorSpace"),
                        (H.colorSpace = $e[ce.colorSpace])),
                      "type" in ce)
                    ) {
                      var ae = ce.type;
                      V(
                        B.oes_texture_float ||
                          !(ae === "float" || ae === "float32"),
                        "you must enable the OES_texture_float extension in order to use floating point textures."
                      ),
                        V(
                          B.oes_texture_half_float ||
                            !(ae === "half float" || ae === "float16"),
                          "you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."
                        ),
                        V(
                          B.webgl_depth_texture ||
                            !(
                              ae === "uint16" ||
                              ae === "uint32" ||
                              ae === "depth stencil"
                            ),
                          "you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."
                        ),
                        V.parameter(ae, ke, "invalid texture type"),
                        (H.type = ke[ae]);
                    }
                    var Ze = H.width,
                      bt = H.height,
                      G = H.channels,
                      z = !1;
                    "shape" in ce
                      ? (V(
                          Array.isArray(ce.shape) && ce.shape.length >= 2,
                          "shape must be an array"
                        ),
                        (Ze = ce.shape[0]),
                        (bt = ce.shape[1]),
                        ce.shape.length === 3 &&
                          ((G = ce.shape[2]),
                          V(G > 0 && G <= 4, "invalid number of channels"),
                          (z = !0)),
                        V(Ze >= 0 && Ze <= Y.maxTextureSize, "invalid width"),
                        V(bt >= 0 && bt <= Y.maxTextureSize, "invalid height"))
                      : ("radius" in ce &&
                          ((Ze = bt = ce.radius),
                          V(
                            Ze >= 0 && Ze <= Y.maxTextureSize,
                            "invalid radius"
                          )),
                        "width" in ce &&
                          ((Ze = ce.width),
                          V(
                            Ze >= 0 && Ze <= Y.maxTextureSize,
                            "invalid width"
                          )),
                        "height" in ce &&
                          ((bt = ce.height),
                          V(
                            bt >= 0 && bt <= Y.maxTextureSize,
                            "invalid height"
                          )),
                        "channels" in ce &&
                          ((G = ce.channels),
                          V(G > 0 && G <= 4, "invalid number of channels"),
                          (z = !0))),
                      (H.width = Ze | 0),
                      (H.height = bt | 0),
                      (H.channels = G | 0);
                    var K = !1;
                    if ("format" in ce) {
                      var ne = ce.format;
                      V(
                        B.webgl_depth_texture ||
                          !(ne === "depth" || ne === "depth stencil"),
                        "you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."
                      ),
                        V.parameter(ne, Ie, "invalid texture format");
                      var ie = (H.internalformat = Ie[ne]);
                      (H.format = Ue[ie]),
                        ne in ke && ("type" in ce || (H.type = ke[ne])),
                        ne in Ee && (H.compressed = !0),
                        (K = !0);
                    }
                    !z && K
                      ? (H.channels = pr[H.format])
                      : z && !K
                      ? H.channels !== Dn[H.format] &&
                        (H.format = H.internalformat = Dn[H.channels])
                      : K &&
                        z &&
                        V(
                          H.channels === pr[H.format],
                          "number of channels inconsistent with specified format"
                        );
                  }
                }
                function Be(H) {
                  C.pixelStorei(Zl, H.flipY),
                    C.pixelStorei(Kl, H.premultiplyAlpha),
                    C.pixelStorei(Jl, H.colorSpace),
                    C.pixelStorei(Ql, H.unpackAlignment);
                }
                function Te() {
                  be.call(this),
                    (this.xOffset = 0),
                    (this.yOffset = 0),
                    (this.data = null),
                    (this.needsFree = !1),
                    (this.element = null),
                    (this.needsCopy = !1);
                }
                function De(H, ce) {
                  var ae = null;
                  if (
                    (si(ce)
                      ? (ae = ce)
                      : ce &&
                        (V.type(ce, "object", "invalid pixel data type"),
                        Ye(H, ce),
                        "x" in ce && (H.xOffset = ce.x | 0),
                        "y" in ce && (H.yOffset = ce.y | 0),
                        si(ce.data) && (ae = ce.data)),
                    V(
                      !H.compressed || _instanceof$2(ae, Uint8Array),
                      "compressed texture data must be stored in a uint8array"
                    ),
                    ce.copy)
                  ) {
                    V(
                      !ae,
                      "can not specify copy and data field for the same texture"
                    );
                    var Ze = me.viewportWidth,
                      bt = me.viewportHeight;
                    (H.width = H.width || Ze - H.xOffset),
                      (H.height = H.height || bt - H.yOffset),
                      (H.needsCopy = !0),
                      V(
                        H.xOffset >= 0 &&
                          H.xOffset < Ze &&
                          H.yOffset >= 0 &&
                          H.yOffset < bt &&
                          H.width > 0 &&
                          H.width <= Ze &&
                          H.height > 0 &&
                          H.height <= bt,
                        "copy texture read out of bounds"
                      );
                  } else if (!ae)
                    (H.width = H.width || 1),
                      (H.height = H.height || 1),
                      (H.channels = H.channels || 4);
                  else if (tr(ae))
                    (H.channels = H.channels || 4),
                      (H.data = ae),
                      !("type" in ce) && H.type === Xr && (H.type = ia(ae));
                  else if (It(ae))
                    (H.channels = H.channels || 4),
                      Ko(H, ae),
                      (H.alignment = 1),
                      (H.needsFree = !0);
                  else if (Ot(ae)) {
                    var G = ae.data;
                    !Array.isArray(G) && H.type === Xr && (H.type = ia(G));
                    var z = ae.shape,
                      K = ae.stride,
                      ne,
                      ie,
                      te,
                      ee,
                      re,
                      U;
                    z.length === 3
                      ? ((te = z[2]), (U = K[2]))
                      : (V(
                          z.length === 2,
                          "invalid ndarray pixel data, must be 2 or 3D"
                        ),
                        (te = 1),
                        (U = 1)),
                      (ne = z[0]),
                      (ie = z[1]),
                      (ee = K[0]),
                      (re = K[1]),
                      (H.alignment = 1),
                      (H.width = ne),
                      (H.height = ie),
                      (H.channels = te),
                      (H.format = H.internalformat = Dn[te]),
                      (H.needsFree = !0),
                      Jo(H, G, ee, re, U, ae.offset);
                  } else if (Gr(ae) || on(ae) || oi(ae))
                    Gr(ae) || on(ae)
                      ? (H.element = ae)
                      : (H.element = ae.canvas),
                      (H.width = H.element.width),
                      (H.height = H.element.height),
                      (H.channels = 4);
                  else if (Ur(ae))
                    (H.element = ae),
                      (H.width = ae.width),
                      (H.height = ae.height),
                      (H.channels = 4);
                  else if (Qo(ae))
                    (H.element = ae),
                      (H.width = ae.naturalWidth),
                      (H.height = ae.naturalHeight),
                      (H.channels = 4);
                  else if (Zo(ae))
                    (H.element = ae),
                      (H.width = ae.videoWidth),
                      (H.height = ae.videoHeight),
                      (H.channels = 4);
                  else if (Bt(ae)) {
                    var Q = H.width || ae[0].length,
                      N = H.height || ae.length,
                      oe = H.channels;
                    yt(ae[0][0])
                      ? (oe = oe || ae[0][0].length)
                      : (oe = oe || 1);
                    for (
                      var fe = Tn.shape(ae), xe = 1, Ae = 0;
                      Ae < fe.length;
                      ++Ae
                    )
                      xe *= fe[Ae];
                    var Re = aa(H, xe);
                    Tn.flatten(ae, fe, "", Re),
                      oa(H, Re),
                      (H.alignment = 1),
                      (H.width = Q),
                      (H.height = N),
                      (H.channels = oe),
                      (H.format = H.internalformat = Dn[oe]),
                      (H.needsFree = !0);
                  }
                  H.type === hn
                    ? V(
                        Y.extensions.indexOf("oes_texture_float") >= 0,
                        "oes_texture_float extension not enabled"
                      )
                    : H.type === Yr &&
                      V(
                        Y.extensions.indexOf("oes_texture_half_float") >= 0,
                        "oes_texture_half_float extension not enabled"
                      );
                }
                function Ne(H, ce, ae) {
                  var Ze = H.element,
                    bt = H.data,
                    G = H.internalformat,
                    z = H.format,
                    K = H.type,
                    ne = H.width,
                    ie = H.height;
                  Be(H),
                    Ze
                      ? C.texImage2D(ce, ae, z, z, K, Ze)
                      : H.compressed
                      ? C.compressedTexImage2D(ce, ae, G, ne, ie, 0, bt)
                      : H.needsCopy
                      ? (ue(),
                        C.copyTexImage2D(
                          ce,
                          ae,
                          z,
                          H.xOffset,
                          H.yOffset,
                          ne,
                          ie,
                          0
                        ))
                      : C.texImage2D(ce, ae, z, ne, ie, 0, z, K, bt || null);
                }
                function dt(H, ce, ae, Ze, bt) {
                  var G = H.element,
                    z = H.data,
                    K = H.internalformat,
                    ne = H.format,
                    ie = H.type,
                    te = H.width,
                    ee = H.height;
                  Be(H),
                    G
                      ? C.texSubImage2D(ce, bt, ae, Ze, ne, ie, G)
                      : H.compressed
                      ? C.compressedTexSubImage2D(ce, bt, ae, Ze, K, te, ee, z)
                      : H.needsCopy
                      ? (ue(),
                        C.copyTexSubImage2D(
                          ce,
                          bt,
                          ae,
                          Ze,
                          H.xOffset,
                          H.yOffset,
                          te,
                          ee
                        ))
                      : C.texSubImage2D(ce, bt, ae, Ze, te, ee, ne, ie, z);
                }
                var ht = [];
                function Ve() {
                  return ht.pop() || new Te();
                }
                function Ge(H) {
                  H.needsFree && qt.freeType(H.data), Te.call(H), ht.push(H);
                }
                function st() {
                  be.call(this),
                    (this.genMipmaps = !1),
                    (this.mipmapHint = Fn),
                    (this.mipmask = 0),
                    (this.images = Array(16));
                }
                function pt(H, ce, ae) {
                  var Ze = (H.images[0] = Ve());
                  (H.mipmask = 1),
                    (Ze.width = H.width = ce),
                    (Ze.height = H.height = ae),
                    (Ze.channels = H.channels = 4);
                }
                function Ct(H, ce) {
                  var ae = null;
                  if (si(ce))
                    (ae = H.images[0] = Ve()),
                      pe(ae, H),
                      De(ae, ce),
                      (H.mipmask = 1);
                  else if ((Ye(H, ce), Array.isArray(ce.mipmap)))
                    for (var Ze = ce.mipmap, bt = 0; bt < Ze.length; ++bt)
                      (ae = H.images[bt] = Ve()),
                        pe(ae, H),
                        (ae.width >>= bt),
                        (ae.height >>= bt),
                        De(ae, Ze[bt]),
                        (H.mipmask |= 1 << bt);
                  else
                    (ae = H.images[0] = Ve()),
                      pe(ae, H),
                      De(ae, ce),
                      (H.mipmask = 1);
                  pe(H, H.images[0]),
                    H.compressed &&
                      (H.internalformat === Si ||
                        H.internalformat === wi ||
                        H.internalformat === Ai ||
                        H.internalformat === Pi) &&
                      V(
                        H.width % 4 === 0 && H.height % 4 === 0,
                        "for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4"
                      );
                }
                function Dt(H, ce) {
                  for (var ae = H.images, Ze = 0; Ze < ae.length; ++Ze) {
                    if (!ae[Ze]) return;
                    Ne(ae[Ze], ce, Ze);
                  }
                }
                var Nt = [];
                function St() {
                  var H = Nt.pop() || new st();
                  be.call(H), (H.mipmask = 0);
                  for (var ce = 0; ce < 16; ++ce) H.images[ce] = null;
                  return H;
                }
                function Yt(H) {
                  for (var ce = H.images, ae = 0; ae < ce.length; ++ae)
                    ce[ae] && Ge(ce[ae]), (ce[ae] = null);
                  Nt.push(H);
                }
                function zt() {
                  (this.minFilter = Li),
                    (this.magFilter = Li),
                    (this.wrapS = Oi),
                    (this.wrapT = Oi),
                    (this.anisotropic = 1),
                    (this.genMipmaps = !1),
                    (this.mipmapHint = Fn);
                }
                function Ht(H, ce) {
                  if ("min" in ce) {
                    var ae = ce.min;
                    V.parameter(ae, ze),
                      (H.minFilter = ze[ae]),
                      eu.indexOf(H.minFilter) >= 0 &&
                        !("faces" in ce) &&
                        (H.genMipmaps = !0);
                  }
                  if ("mag" in ce) {
                    var Ze = ce.mag;
                    V.parameter(Ze, Oe), (H.magFilter = Oe[Ze]);
                  }
                  var bt = H.wrapS,
                    G = H.wrapT;
                  if ("wrap" in ce) {
                    var z = ce.wrap;
                    typeof z == "string"
                      ? (V.parameter(z, Le), (bt = G = Le[z]))
                      : Array.isArray(z) &&
                        (V.parameter(z[0], Le),
                        V.parameter(z[1], Le),
                        (bt = Le[z[0]]),
                        (G = Le[z[1]]));
                  } else {
                    if ("wrapS" in ce) {
                      var K = ce.wrapS;
                      V.parameter(K, Le), (bt = Le[K]);
                    }
                    if ("wrapT" in ce) {
                      var ne = ce.wrapT;
                      V.parameter(ne, Le), (G = Le[ne]);
                    }
                  }
                  if (((H.wrapS = bt), (H.wrapT = G), "anisotropic" in ce)) {
                    var ie = ce.anisotropic;
                    V(
                      typeof ie == "number" &&
                        ie >= 1 &&
                        ie <= Y.maxAnisotropic,
                      "aniso samples must be between 1 and "
                    ),
                      (H.anisotropic = ce.anisotropic);
                  }
                  if ("mipmap" in ce) {
                    var te = !1;
                    switch (_typeof$2(ce.mipmap)) {
                      case "string":
                        V.parameter(ce.mipmap, Pe, "invalid mipmap hint"),
                          (H.mipmapHint = Pe[ce.mipmap]),
                          (H.genMipmaps = !0),
                          (te = !0);
                        break;
                      case "boolean":
                        te = H.genMipmaps = ce.mipmap;
                        break;
                      case "object":
                        V(Array.isArray(ce.mipmap), "invalid mipmap type"),
                          (H.genMipmaps = !1),
                          (te = !0);
                        break;
                      default:
                        V.raise("invalid mipmap type");
                    }
                    te && !("min" in ce) && (H.minFilter = Ti);
                  }
                }
                function Xt(H, ce) {
                  C.texParameteri(ce, jl, H.minFilter),
                    C.texParameteri(ce, Ul, H.magFilter),
                    C.texParameteri(ce, Bl, H.wrapS),
                    C.texParameteri(ce, Nl, H.wrapT),
                    B.ext_texture_filter_anisotropic &&
                      C.texParameteri(ce, Xl, H.anisotropic),
                    H.genMipmaps &&
                      (C.hint(Hl, H.mipmapHint), C.generateMipmap(ce));
                }
                var Qt = 0,
                  Kt = {},
                  nr = Y.maxTextureUnits,
                  Ut = Array(nr).map(function () {
                    return null;
                  });
                function _t(H) {
                  be.call(this),
                    (this.mipmask = 0),
                    (this.internalformat = Tr),
                    (this.id = Qt++),
                    (this.refCount = 1),
                    (this.target = H),
                    (this.texture = C.createTexture()),
                    (this.unit = -1),
                    (this.bindCount = 0),
                    (this.texInfo = new zt()),
                    _e.profile && (this.stats = { size: 0 });
                }
                function ir(H) {
                  C.activeTexture(dn), C.bindTexture(H.target, H.texture);
                }
                function Tt() {
                  var H = Ut[0];
                  H
                    ? C.bindTexture(H.target, H.texture)
                    : C.bindTexture(gr, null);
                }
                function lt(H) {
                  var ce = H.texture;
                  V(ce, "must not double destroy texture");
                  var ae = H.unit,
                    Ze = H.target;
                  ae >= 0 &&
                    (C.activeTexture(dn + ae),
                    C.bindTexture(Ze, null),
                    (Ut[ae] = null)),
                    C.deleteTexture(ce),
                    (H.texture = null),
                    (H.params = null),
                    (H.pixels = null),
                    (H.refCount = 0),
                    delete Kt[H.id],
                    he.textureCount--;
                }
                Gt(_t.prototype, {
                  bind: function () {
                    var ce = this;
                    ce.bindCount += 1;
                    var ae = ce.unit;
                    if (ae < 0) {
                      for (var Ze = 0; Ze < nr; ++Ze) {
                        var bt = Ut[Ze];
                        if (bt) {
                          if (bt.bindCount > 0) continue;
                          bt.unit = -1;
                        }
                        (Ut[Ze] = ce), (ae = Ze);
                        break;
                      }
                      ae >= nr &&
                        V.raise("insufficient number of texture units"),
                        _e.profile &&
                          he.maxTextureUnits < ae + 1 &&
                          (he.maxTextureUnits = ae + 1),
                        (ce.unit = ae),
                        C.activeTexture(dn + ae),
                        C.bindTexture(ce.target, ce.texture);
                    }
                    return ae;
                  },
                  unbind: function () {
                    this.bindCount -= 1;
                  },
                  decRef: function () {
                    --this.refCount <= 0 && lt(this);
                  },
                });
                function gt(H, ce) {
                  var ae = new _t(gr);
                  (Kt[ae.id] = ae), he.textureCount++;
                  function Ze(z, K) {
                    var ne = ae.texInfo;
                    zt.call(ne);
                    var ie = St();
                    return (
                      typeof z == "number"
                        ? typeof K == "number"
                          ? pt(ie, z | 0, K | 0)
                          : pt(ie, z | 0, z | 0)
                        : z
                        ? (V.type(
                            z,
                            "object",
                            "invalid arguments to regl.texture"
                          ),
                          Ht(ne, z),
                          Ct(ie, z))
                        : pt(ie, 1, 1),
                      ne.genMipmaps && (ie.mipmask = (ie.width << 1) - 1),
                      (ae.mipmask = ie.mipmask),
                      pe(ae, ie),
                      V.texture2D(ne, ie, Y),
                      (ae.internalformat = ie.internalformat),
                      (Ze.width = ie.width),
                      (Ze.height = ie.height),
                      ir(ae),
                      Dt(ie, gr),
                      Xt(ne, gr),
                      Tt(),
                      Yt(ie),
                      _e.profile &&
                        (ae.stats.size = En(
                          ae.internalformat,
                          ae.type,
                          ie.width,
                          ie.height,
                          ne.genMipmaps,
                          !1
                        )),
                      (Ze.format = Ce[ae.internalformat]),
                      (Ze.type = We[ae.type]),
                      (Ze.mag = ye[ne.magFilter]),
                      (Ze.min = nt[ne.minFilter]),
                      (Ze.wrapS = Je[ne.wrapS]),
                      (Ze.wrapT = Je[ne.wrapT]),
                      Ze
                    );
                  }
                  function bt(z, K, ne, ie) {
                    V(!!z, "must specify image data");
                    var te = K | 0,
                      ee = ne | 0,
                      re = ie | 0,
                      U = Ve();
                    return (
                      pe(U, ae),
                      (U.width = 0),
                      (U.height = 0),
                      De(U, z),
                      (U.width = U.width || (ae.width >> re) - te),
                      (U.height = U.height || (ae.height >> re) - ee),
                      V(
                        ae.type === U.type &&
                          ae.format === U.format &&
                          ae.internalformat === U.internalformat,
                        "incompatible format for texture.subimage"
                      ),
                      V(
                        te >= 0 &&
                          ee >= 0 &&
                          te + U.width <= ae.width &&
                          ee + U.height <= ae.height,
                        "texture.subimage write out of bounds"
                      ),
                      V(ae.mipmask & (1 << re), "missing mipmap data"),
                      V(
                        U.data || U.element || U.needsCopy,
                        "missing image data"
                      ),
                      ir(ae),
                      dt(U, gr, te, ee, re),
                      Tt(),
                      Ge(U),
                      Ze
                    );
                  }
                  function G(z, K) {
                    var ne = z | 0,
                      ie = K | 0 || ne;
                    if (ne === ae.width && ie === ae.height) return Ze;
                    (Ze.width = ae.width = ne),
                      (Ze.height = ae.height = ie),
                      ir(ae);
                    for (var te = 0; ae.mipmask >> te; ++te) {
                      var ee = ne >> te,
                        re = ie >> te;
                      if (!ee || !re) break;
                      C.texImage2D(
                        gr,
                        te,
                        ae.format,
                        ee,
                        re,
                        0,
                        ae.format,
                        ae.type,
                        null
                      );
                    }
                    return (
                      Tt(),
                      _e.profile &&
                        (ae.stats.size = En(
                          ae.internalformat,
                          ae.type,
                          ne,
                          ie,
                          !1,
                          !1
                        )),
                      Ze
                    );
                  }
                  return (
                    Ze(H, ce),
                    (Ze.subimage = bt),
                    (Ze.resize = G),
                    (Ze._reglType = "texture2d"),
                    (Ze._texture = ae),
                    _e.profile && (Ze.stats = ae.stats),
                    (Ze.destroy = function () {
                      ae.decRef();
                    }),
                    Ze
                  );
                }
                function Et(H, ce, ae, Ze, bt, G) {
                  var z = new _t(gi);
                  (Kt[z.id] = z), he.cubeCount++;
                  var K = new Array(6);
                  function ne(ee, re, U, Q, N, oe) {
                    var fe,
                      xe = z.texInfo;
                    for (zt.call(xe), fe = 0; fe < 6; ++fe) K[fe] = St();
                    if (typeof ee == "number" || !ee) {
                      var Ae = ee | 0 || 1;
                      for (fe = 0; fe < 6; ++fe) pt(K[fe], Ae, Ae);
                    } else if (typeof ee == "object")
                      if (re)
                        Ct(K[0], ee),
                          Ct(K[1], re),
                          Ct(K[2], U),
                          Ct(K[3], Q),
                          Ct(K[4], N),
                          Ct(K[5], oe);
                      else if ((Ht(xe, ee), Ye(z, ee), "faces" in ee)) {
                        var Re = ee.faces;
                        for (
                          V(
                            Array.isArray(Re) && Re.length === 6,
                            "cube faces must be a length 6 array"
                          ),
                            fe = 0;
                          fe < 6;
                          ++fe
                        )
                          V(
                            typeof Re[fe] == "object" && !!Re[fe],
                            "invalid input for cube map face"
                          ),
                            pe(K[fe], z),
                            Ct(K[fe], Re[fe]);
                      } else for (fe = 0; fe < 6; ++fe) Ct(K[fe], ee);
                    else V.raise("invalid arguments to cube map");
                    for (
                      pe(z, K[0]),
                        V.optional(function () {
                          Y.npotTextureCube ||
                            V(
                              Ea(z.width) && Ea(z.height),
                              "your browser does not support non power or two texture dimensions"
                            );
                        }),
                        xe.genMipmaps
                          ? (z.mipmask = (K[0].width << 1) - 1)
                          : (z.mipmask = K[0].mipmask),
                        V.textureCube(z, xe, K, Y),
                        z.internalformat = K[0].internalformat,
                        ne.width = K[0].width,
                        ne.height = K[0].height,
                        ir(z),
                        fe = 0;
                      fe < 6;
                      ++fe
                    )
                      Dt(K[fe], Rn + fe);
                    for (
                      Xt(xe, gi),
                        Tt(),
                        _e.profile &&
                          (z.stats.size = En(
                            z.internalformat,
                            z.type,
                            ne.width,
                            ne.height,
                            xe.genMipmaps,
                            !0
                          )),
                        ne.format = Ce[z.internalformat],
                        ne.type = We[z.type],
                        ne.mag = ye[xe.magFilter],
                        ne.min = nt[xe.minFilter],
                        ne.wrapS = Je[xe.wrapS],
                        ne.wrapT = Je[xe.wrapT],
                        fe = 0;
                      fe < 6;
                      ++fe
                    )
                      Yt(K[fe]);
                    return ne;
                  }
                  function ie(ee, re, U, Q, N) {
                    V(!!re, "must specify image data"),
                      V(
                        typeof ee == "number" &&
                          ee === (ee | 0) &&
                          ee >= 0 &&
                          ee < 6,
                        "invalid face"
                      );
                    var oe = U | 0,
                      fe = Q | 0,
                      xe = N | 0,
                      Ae = Ve();
                    return (
                      pe(Ae, z),
                      (Ae.width = 0),
                      (Ae.height = 0),
                      De(Ae, re),
                      (Ae.width = Ae.width || (z.width >> xe) - oe),
                      (Ae.height = Ae.height || (z.height >> xe) - fe),
                      V(
                        z.type === Ae.type &&
                          z.format === Ae.format &&
                          z.internalformat === Ae.internalformat,
                        "incompatible format for texture.subimage"
                      ),
                      V(
                        oe >= 0 &&
                          fe >= 0 &&
                          oe + Ae.width <= z.width &&
                          fe + Ae.height <= z.height,
                        "texture.subimage write out of bounds"
                      ),
                      V(z.mipmask & (1 << xe), "missing mipmap data"),
                      V(
                        Ae.data || Ae.element || Ae.needsCopy,
                        "missing image data"
                      ),
                      ir(z),
                      dt(Ae, Rn + ee, oe, fe, xe),
                      Tt(),
                      Ge(Ae),
                      ne
                    );
                  }
                  function te(ee) {
                    var re = ee | 0;
                    if (re !== z.width) {
                      (ne.width = z.width = re),
                        (ne.height = z.height = re),
                        ir(z);
                      for (var U = 0; U < 6; ++U)
                        for (var Q = 0; z.mipmask >> Q; ++Q)
                          C.texImage2D(
                            Rn + U,
                            Q,
                            z.format,
                            re >> Q,
                            re >> Q,
                            0,
                            z.format,
                            z.type,
                            null
                          );
                      return (
                        Tt(),
                        _e.profile &&
                          (z.stats.size = En(
                            z.internalformat,
                            z.type,
                            ne.width,
                            ne.height,
                            !1,
                            !0
                          )),
                        ne
                      );
                    }
                  }
                  return (
                    ne(H, ce, ae, Ze, bt, G),
                    (ne.subimage = ie),
                    (ne.resize = te),
                    (ne._reglType = "textureCube"),
                    (ne._texture = z),
                    _e.profile && (ne.stats = z.stats),
                    (ne.destroy = function () {
                      z.decRef();
                    }),
                    ne
                  );
                }
                function Jt() {
                  for (var H = 0; H < nr; ++H)
                    C.activeTexture(dn + H),
                      C.bindTexture(gr, null),
                      (Ut[H] = null);
                  cr(Kt).forEach(lt), (he.cubeCount = 0), (he.textureCount = 0);
                }
                _e.profile &&
                  (he.getTotalTextureSize = function () {
                    var H = 0;
                    return (
                      Object.keys(Kt).forEach(function (ce) {
                        H += Kt[ce].stats.size;
                      }),
                      H
                    );
                  });
                function or() {
                  for (var H = 0; H < nr; ++H) {
                    var ce = Ut[H];
                    ce && ((ce.bindCount = 0), (ce.unit = -1), (Ut[H] = null));
                  }
                  cr(Kt).forEach(function (ae) {
                    (ae.texture = C.createTexture()),
                      C.bindTexture(ae.target, ae.texture);
                    for (var Ze = 0; Ze < 32; ++Ze)
                      if ((ae.mipmask & (1 << Ze)) !== 0)
                        if (ae.target === gr)
                          C.texImage2D(
                            gr,
                            Ze,
                            ae.internalformat,
                            ae.width >> Ze,
                            ae.height >> Ze,
                            0,
                            ae.internalformat,
                            ae.type,
                            null
                          );
                        else
                          for (var bt = 0; bt < 6; ++bt)
                            C.texImage2D(
                              Rn + bt,
                              Ze,
                              ae.internalformat,
                              ae.width >> Ze,
                              ae.height >> Ze,
                              0,
                              ae.internalformat,
                              ae.type,
                              null
                            );
                    Xt(ae.texInfo, ae.target);
                  });
                }
                function Dr() {
                  for (var H = 0; H < nr; ++H) {
                    var ce = Ut[H];
                    ce && ((ce.bindCount = 0), (ce.unit = -1), (Ut[H] = null)),
                      C.activeTexture(dn + H),
                      C.bindTexture(gr, null),
                      C.bindTexture(gi, null);
                  }
                }
                return {
                  create2D: gt,
                  createCube: Et,
                  clear: Jt,
                  getTexture: function (ce) {
                    return null;
                  },
                  restore: or,
                  refresh: Dr,
                };
              },
              sa = function (C, B, Y) {
                return mr[C] * B * Y;
              },
              ts = function (C, B, Y, ue, me, he) {
                var _e = { cur: null, next: null, dirty: !1, setFBO: null },
                  Pe = ["rgba"],
                  Le = ["rgba4", "rgb565", "rgb5 a1"];
                B.ext_srgb && Le.push("srgba"),
                  B.ext_color_buffer_half_float && Le.push("rgba16f", "rgb16f"),
                  B.webgl_color_buffer_float && Le.push("rgba32f");
                var Oe = ["uint8"];
                B.oes_texture_half_float && Oe.push("half float", "float16"),
                  B.oes_texture_float && Oe.push("float", "float32");
                function ze(Te, De, Ne) {
                  (this.target = Te),
                    (this.texture = De),
                    (this.renderbuffer = Ne);
                  var dt = 0,
                    ht = 0;
                  De
                    ? ((dt = De.width), (ht = De.height))
                    : Ne && ((dt = Ne.width), (ht = Ne.height)),
                    (this.width = dt),
                    (this.height = ht);
                }
                function $e(Te) {
                  Te &&
                    (Te.texture && Te.texture._texture.decRef(),
                    Te.renderbuffer && Te.renderbuffer._renderbuffer.decRef());
                }
                function ke(Te, De, Ne) {
                  if (!!Te)
                    if (Te.texture) {
                      var dt = Te.texture._texture,
                        ht = Math.max(1, dt.width),
                        Ve = Math.max(1, dt.height);
                      V(
                        ht === De && Ve === Ne,
                        "inconsistent width/height for supplied texture"
                      ),
                        (dt.refCount += 1);
                    } else {
                      var Ge = Te.renderbuffer._renderbuffer;
                      V(
                        Ge.width === De && Ge.height === Ne,
                        "inconsistent width/height for renderbuffer"
                      ),
                        (Ge.refCount += 1);
                    }
                }
                function Ie(Te, De) {
                  De &&
                    (De.texture
                      ? C.framebufferTexture2D(
                          br,
                          Te,
                          De.target,
                          De.texture._texture.texture,
                          0
                        )
                      : C.framebufferRenderbuffer(
                          br,
                          Te,
                          Ri,
                          De.renderbuffer._renderbuffer.renderbuffer
                        ));
                }
                function Ee(Te) {
                  var De = Mr,
                    Ne = null,
                    dt = null,
                    ht = Te;
                  typeof Te == "object" &&
                    ((ht = Te.data), "target" in Te && (De = Te.target | 0)),
                    V.type(ht, "function", "invalid attachment data");
                  var Ve = ht._reglType;
                  return (
                    Ve === "texture2d"
                      ? ((Ne = ht), V(De === Mr))
                      : Ve === "textureCube"
                      ? ((Ne = ht),
                        V(De >= Nn && De < Nn + 6, "invalid cube map target"))
                      : Ve === "renderbuffer"
                      ? ((dt = ht), (De = Ri))
                      : V.raise("invalid regl object for attachment"),
                    new ze(De, Ne, dt)
                  );
                }
                function le(Te, De, Ne, dt, ht) {
                  if (Ne) {
                    var Ve = ue.create2D({
                      width: Te,
                      height: De,
                      format: dt,
                      type: ht,
                    });
                    return (Ve._texture.refCount = 0), new ze(Mr, Ve, null);
                  } else {
                    var Ge = me.create({ width: Te, height: De, format: dt });
                    return (
                      (Ge._renderbuffer.refCount = 0), new ze(Ri, null, Ge)
                    );
                  }
                }
                function se(Te) {
                  return Te && (Te.texture || Te.renderbuffer);
                }
                function Ce(Te, De, Ne) {
                  Te &&
                    (Te.texture
                      ? Te.texture.resize(De, Ne)
                      : Te.renderbuffer && Te.renderbuffer.resize(De, Ne),
                    (Te.width = De),
                    (Te.height = Ne));
                }
                var We = 0,
                  ye = {};
                function nt() {
                  (this.id = We++),
                    (ye[this.id] = this),
                    (this.framebuffer = C.createFramebuffer()),
                    (this.width = 0),
                    (this.height = 0),
                    (this.colorAttachments = []),
                    (this.depthAttachment = null),
                    (this.stencilAttachment = null),
                    (this.depthStencilAttachment = null);
                }
                function Je(Te) {
                  Te.colorAttachments.forEach($e),
                    $e(Te.depthAttachment),
                    $e(Te.stencilAttachment),
                    $e(Te.depthStencilAttachment);
                }
                function Ue(Te) {
                  var De = Te.framebuffer;
                  V(De, "must not double destroy framebuffer"),
                    C.deleteFramebuffer(De),
                    (Te.framebuffer = null),
                    he.framebufferCount--,
                    delete ye[Te.id];
                }
                function be(Te) {
                  var De;
                  C.bindFramebuffer(br, Te.framebuffer);
                  var Ne = Te.colorAttachments;
                  for (De = 0; De < Ne.length; ++De) Ie(ro + De, Ne[De]);
                  for (De = Ne.length; De < Y.maxColorAttachments; ++De)
                    C.framebufferTexture2D(br, ro + De, Mr, null, 0);
                  C.framebufferTexture2D(br, ao, Mr, null, 0),
                    C.framebufferTexture2D(br, no, Mr, null, 0),
                    C.framebufferTexture2D(br, io, Mr, null, 0),
                    Ie(no, Te.depthAttachment),
                    Ie(io, Te.stencilAttachment),
                    Ie(ao, Te.depthStencilAttachment);
                  var dt = C.checkFramebufferStatus(br);
                  !C.isContextLost() &&
                    dt !== oo &&
                    V.raise(
                      "framebuffer configuration not supported, status = " +
                        Zr[dt]
                    ),
                    C.bindFramebuffer(br, _e.next ? _e.next.framebuffer : null),
                    (_e.cur = _e.next),
                    C.getError();
                }
                function pe(Te, De) {
                  var Ne = new nt();
                  he.framebufferCount++;
                  function dt(Ve, Ge) {
                    var st;
                    V(
                      _e.next !== Ne,
                      "can not update framebuffer which is currently in use"
                    );
                    var pt = 0,
                      Ct = 0,
                      Dt = !0,
                      Nt = !0,
                      St = null,
                      Yt = !0,
                      zt = "rgba",
                      Ht = "uint8",
                      Xt = 1,
                      Qt = null,
                      Kt = null,
                      nr = null,
                      Ut = !1;
                    if (typeof Ve == "number")
                      (pt = Ve | 0), (Ct = Ge | 0 || pt);
                    else if (!Ve) pt = Ct = 1;
                    else {
                      V.type(Ve, "object", "invalid arguments for framebuffer");
                      var _t = Ve;
                      if ("shape" in _t) {
                        var ir = _t.shape;
                        V(
                          Array.isArray(ir) && ir.length >= 2,
                          "invalid shape for framebuffer"
                        ),
                          (pt = ir[0]),
                          (Ct = ir[1]);
                      } else
                        "radius" in _t && (pt = Ct = _t.radius),
                          "width" in _t && (pt = _t.width),
                          "height" in _t && (Ct = _t.height);
                      ("color" in _t || "colors" in _t) &&
                        ((St = _t.color || _t.colors),
                        Array.isArray(St) &&
                          V(
                            St.length === 1 || B.webgl_draw_buffers,
                            "multiple render targets not supported"
                          )),
                        St ||
                          ("colorCount" in _t &&
                            ((Xt = _t.colorCount | 0),
                            V(Xt > 0, "invalid color buffer count")),
                          "colorTexture" in _t &&
                            ((Yt = !!_t.colorTexture), (zt = "rgba4")),
                          "colorType" in _t &&
                            ((Ht = _t.colorType),
                            Yt
                              ? (V(
                                  B.oes_texture_float ||
                                    !(Ht === "float" || Ht === "float32"),
                                  "you must enable OES_texture_float in order to use floating point framebuffer objects"
                                ),
                                V(
                                  B.oes_texture_half_float ||
                                    !(Ht === "half float" || Ht === "float16"),
                                  "you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects"
                                ))
                              : Ht === "half float" || Ht === "float16"
                              ? (V(
                                  B.ext_color_buffer_half_float,
                                  "you must enable EXT_color_buffer_half_float to use 16-bit render buffers"
                                ),
                                (zt = "rgba16f"))
                              : (Ht === "float" || Ht === "float32") &&
                                (V(
                                  B.webgl_color_buffer_float,
                                  "you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"
                                ),
                                (zt = "rgba32f")),
                            V.oneOf(Ht, Oe, "invalid color type")),
                          "colorFormat" in _t &&
                            ((zt = _t.colorFormat),
                            Pe.indexOf(zt) >= 0
                              ? (Yt = !0)
                              : Le.indexOf(zt) >= 0
                              ? (Yt = !1)
                              : V.optional(function () {
                                  Yt
                                    ? V.oneOf(
                                        _t.colorFormat,
                                        Pe,
                                        "invalid color format for texture"
                                      )
                                    : V.oneOf(
                                        _t.colorFormat,
                                        Le,
                                        "invalid color format for renderbuffer"
                                      );
                                }))),
                        ("depthTexture" in _t || "depthStencilTexture" in _t) &&
                          ((Ut = !!(_t.depthTexture || _t.depthStencilTexture)),
                          V(
                            !Ut || B.webgl_depth_texture,
                            "webgl_depth_texture extension not supported"
                          )),
                        "depth" in _t &&
                          (typeof _t.depth == "boolean"
                            ? (Dt = _t.depth)
                            : ((Qt = _t.depth), (Nt = !1))),
                        "stencil" in _t &&
                          (typeof _t.stencil == "boolean"
                            ? (Nt = _t.stencil)
                            : ((Kt = _t.stencil), (Dt = !1))),
                        "depthStencil" in _t &&
                          (typeof _t.depthStencil == "boolean"
                            ? (Dt = Nt = _t.depthStencil)
                            : ((nr = _t.depthStencil), (Dt = !1), (Nt = !1)));
                    }
                    var Tt = null,
                      lt = null,
                      gt = null,
                      Et = null;
                    if (Array.isArray(St)) Tt = St.map(Ee);
                    else if (St) Tt = [Ee(St)];
                    else
                      for (Tt = new Array(Xt), st = 0; st < Xt; ++st)
                        Tt[st] = le(pt, Ct, Yt, zt, Ht);
                    V(
                      B.webgl_draw_buffers || Tt.length <= 1,
                      "you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."
                    ),
                      V(
                        Tt.length <= Y.maxColorAttachments,
                        "too many color attachments, not supported"
                      ),
                      (pt = pt || Tt[0].width),
                      (Ct = Ct || Tt[0].height),
                      Qt
                        ? (lt = Ee(Qt))
                        : Dt && !Nt && (lt = le(pt, Ct, Ut, "depth", "uint32")),
                      Kt
                        ? (gt = Ee(Kt))
                        : Nt &&
                          !Dt &&
                          (gt = le(pt, Ct, !1, "stencil", "uint8")),
                      nr
                        ? (Et = Ee(nr))
                        : !Qt &&
                          !Kt &&
                          Nt &&
                          Dt &&
                          (Et = le(
                            pt,
                            Ct,
                            Ut,
                            "depth stencil",
                            "depth stencil"
                          )),
                      V(
                        !!Qt + !!Kt + !!nr <= 1,
                        "invalid framebuffer configuration, can specify exactly one depth/stencil attachment"
                      );
                    var Jt = null;
                    for (st = 0; st < Tt.length; ++st)
                      if (
                        (ke(Tt[st], pt, Ct),
                        V(
                          !Tt[st] ||
                            (Tt[st].texture &&
                              cu.indexOf(Tt[st].texture._texture.format) >=
                                0) ||
                            (Tt[st].renderbuffer &&
                              xu.indexOf(
                                Tt[st].renderbuffer._renderbuffer.format
                              ) >= 0),
                          "framebuffer color attachment " + st + " is invalid"
                        ),
                        Tt[st] && Tt[st].texture)
                      ) {
                        var or =
                          ki[Tt[st].texture._texture.format] *
                          Vn[Tt[st].texture._texture.type];
                        Jt === null
                          ? (Jt = or)
                          : V(
                              Jt === or,
                              "all color attachments much have the same number of bits per pixel."
                            );
                      }
                    return (
                      ke(lt, pt, Ct),
                      V(
                        !lt ||
                          (lt.texture && lt.texture._texture.format === fu) ||
                          (lt.renderbuffer &&
                            lt.renderbuffer._renderbuffer.format === vu),
                        "invalid depth attachment for framebuffer object"
                      ),
                      ke(gt, pt, Ct),
                      V(
                        !gt ||
                          (gt.renderbuffer &&
                            gt.renderbuffer._renderbuffer.format === mu),
                        "invalid stencil attachment for framebuffer object"
                      ),
                      ke(Et, pt, Ct),
                      V(
                        !Et ||
                          (Et.texture && Et.texture._texture.format === uo) ||
                          (Et.renderbuffer &&
                            Et.renderbuffer._renderbuffer.format === uo),
                        "invalid depth-stencil attachment for framebuffer object"
                      ),
                      Je(Ne),
                      (Ne.width = pt),
                      (Ne.height = Ct),
                      (Ne.colorAttachments = Tt),
                      (Ne.depthAttachment = lt),
                      (Ne.stencilAttachment = gt),
                      (Ne.depthStencilAttachment = Et),
                      (dt.color = Tt.map(se)),
                      (dt.depth = se(lt)),
                      (dt.stencil = se(gt)),
                      (dt.depthStencil = se(Et)),
                      (dt.width = Ne.width),
                      (dt.height = Ne.height),
                      be(Ne),
                      dt
                    );
                  }
                  function ht(Ve, Ge) {
                    V(
                      _e.next !== Ne,
                      "can not resize a framebuffer which is currently in use"
                    );
                    var st = Math.max(Ve | 0, 1),
                      pt = Math.max(Ge | 0 || st, 1);
                    if (st === Ne.width && pt === Ne.height) return dt;
                    for (
                      var Ct = Ne.colorAttachments, Dt = 0;
                      Dt < Ct.length;
                      ++Dt
                    )
                      Ce(Ct[Dt], st, pt);
                    return (
                      Ce(Ne.depthAttachment, st, pt),
                      Ce(Ne.stencilAttachment, st, pt),
                      Ce(Ne.depthStencilAttachment, st, pt),
                      (Ne.width = dt.width = st),
                      (Ne.height = dt.height = pt),
                      be(Ne),
                      dt
                    );
                  }
                  return (
                    dt(Te, De),
                    Gt(dt, {
                      resize: ht,
                      _reglType: "framebuffer",
                      _framebuffer: Ne,
                      destroy: function () {
                        Ue(Ne), Je(Ne);
                      },
                      use: function (Ge) {
                        _e.setFBO({ framebuffer: dt }, Ge);
                      },
                    })
                  );
                }
                function Ye(Te) {
                  var De = Array(6);
                  function Ne(ht) {
                    var Ve;
                    V(
                      De.indexOf(_e.next) < 0,
                      "can not update framebuffer which is currently in use"
                    );
                    var Ge = { color: null },
                      st = 0,
                      pt = null,
                      Ct = "rgba",
                      Dt = "uint8",
                      Nt = 1;
                    if (typeof ht == "number") st = ht | 0;
                    else if (!ht) st = 1;
                    else {
                      V.type(ht, "object", "invalid arguments for framebuffer");
                      var St = ht;
                      if ("shape" in St) {
                        var Yt = St.shape;
                        V(
                          Array.isArray(Yt) && Yt.length >= 2,
                          "invalid shape for framebuffer"
                        ),
                          V(Yt[0] === Yt[1], "cube framebuffer must be square"),
                          (st = Yt[0]);
                      } else
                        "radius" in St && (st = St.radius | 0),
                          "width" in St
                            ? ((st = St.width | 0),
                              "height" in St &&
                                V(St.height === st, "must be square"))
                            : "height" in St && (st = St.height | 0);
                      ("color" in St || "colors" in St) &&
                        ((pt = St.color || St.colors),
                        Array.isArray(pt) &&
                          V(
                            pt.length === 1 || B.webgl_draw_buffers,
                            "multiple render targets not supported"
                          )),
                        pt ||
                          ("colorCount" in St &&
                            ((Nt = St.colorCount | 0),
                            V(Nt > 0, "invalid color buffer count")),
                          "colorType" in St &&
                            (V.oneOf(St.colorType, Oe, "invalid color type"),
                            (Dt = St.colorType)),
                          "colorFormat" in St &&
                            ((Ct = St.colorFormat),
                            V.oneOf(
                              St.colorFormat,
                              Pe,
                              "invalid color format for texture"
                            ))),
                        "depth" in St && (Ge.depth = St.depth),
                        "stencil" in St && (Ge.stencil = St.stencil),
                        "depthStencil" in St &&
                          (Ge.depthStencil = St.depthStencil);
                    }
                    var zt;
                    if (pt)
                      if (Array.isArray(pt))
                        for (zt = [], Ve = 0; Ve < pt.length; ++Ve)
                          zt[Ve] = pt[Ve];
                      else zt = [pt];
                    else {
                      zt = Array(Nt);
                      var Ht = { radius: st, format: Ct, type: Dt };
                      for (Ve = 0; Ve < Nt; ++Ve) zt[Ve] = ue.createCube(Ht);
                    }
                    for (
                      Ge.color = Array(zt.length), Ve = 0;
                      Ve < zt.length;
                      ++Ve
                    ) {
                      var Xt = zt[Ve];
                      V(
                        typeof Xt == "function" &&
                          Xt._reglType === "textureCube",
                        "invalid cube map"
                      ),
                        (st = st || Xt.width),
                        V(
                          Xt.width === st && Xt.height === st,
                          "invalid cube map shape"
                        ),
                        (Ge.color[Ve] = { target: Nn, data: zt[Ve] });
                    }
                    for (Ve = 0; Ve < 6; ++Ve) {
                      for (var Qt = 0; Qt < zt.length; ++Qt)
                        Ge.color[Qt].target = Nn + Ve;
                      Ve > 0 &&
                        ((Ge.depth = De[0].depth),
                        (Ge.stencil = De[0].stencil),
                        (Ge.depthStencil = De[0].depthStencil)),
                        De[Ve] ? De[Ve](Ge) : (De[Ve] = pe(Ge));
                    }
                    return Gt(Ne, { width: st, height: st, color: zt });
                  }
                  function dt(ht) {
                    var Ve,
                      Ge = ht | 0;
                    if (
                      (V(
                        Ge > 0 && Ge <= Y.maxCubeMapSize,
                        "invalid radius for cube fbo"
                      ),
                      Ge === Ne.width)
                    )
                      return Ne;
                    var st = Ne.color;
                    for (Ve = 0; Ve < st.length; ++Ve) st[Ve].resize(Ge);
                    for (Ve = 0; Ve < 6; ++Ve) De[Ve].resize(Ge);
                    return (Ne.width = Ne.height = Ge), Ne;
                  }
                  return (
                    Ne(Te),
                    Gt(Ne, {
                      faces: De,
                      resize: dt,
                      _reglType: "framebufferCube",
                      destroy: function () {
                        De.forEach(function (Ve) {
                          Ve.destroy();
                        });
                      },
                    })
                  );
                }
                function Be() {
                  (_e.cur = null),
                    (_e.next = null),
                    (_e.dirty = !0),
                    cr(ye).forEach(function (Te) {
                      (Te.framebuffer = C.createFramebuffer()), be(Te);
                    });
                }
                return Gt(_e, {
                  getFramebuffer: function (De) {
                    if (
                      typeof De == "function" &&
                      De._reglType === "framebuffer"
                    ) {
                      var Ne = De._framebuffer;
                      if (_instanceof$2(Ne, nt)) return Ne;
                    }
                    return null;
                  },
                  create: pe,
                  createCube: Ye,
                  clear: function () {
                    cr(ye).forEach(Ue);
                  },
                  restore: Be,
                });
              },
              li = function () {
                (this.state = 0),
                  (this.x = 0),
                  (this.y = 0),
                  (this.z = 0),
                  (this.w = 0),
                  (this.buffer = null),
                  (this.size = 0),
                  (this.normalized = !1),
                  (this.type = Cu),
                  (this.offset = 0),
                  (this.stride = 0),
                  (this.divisor = 0);
              },
              rs = function (C, B, Y, ue, me, he, _e) {
                for (
                  var Pe = Y.maxAttributes, Le = new Array(Pe), Oe = 0;
                  Oe < Pe;
                  ++Oe
                )
                  Le[Oe] = new li();
                var ze = 0,
                  $e = {},
                  ke = {
                    Record: li,
                    scope: {},
                    state: Le,
                    currentVAO: null,
                    targetVAO: null,
                    restore: Ee() ? Je : function () {},
                    createVAO: Ue,
                    getVAO: se,
                    destroyBuffer: Ie,
                    setVAO: Ee() ? Ce : We,
                    clear: Ee() ? ye : function () {},
                  };
                function Ie(be) {
                  for (var pe = 0; pe < Le.length; ++pe) {
                    var Ye = Le[pe];
                    Ye.buffer === be &&
                      (C.disableVertexAttribArray(pe), (Ye.buffer = null));
                  }
                }
                function Ee() {
                  return B.oes_vertex_array_object;
                }
                function le() {
                  return B.angle_instanced_arrays;
                }
                function se(be) {
                  return typeof be == "function" && be._vao ? be._vao : null;
                }
                function Ce(be) {
                  if (be !== ke.currentVAO) {
                    var pe = Ee();
                    be
                      ? pe.bindVertexArrayOES(be.vao)
                      : pe.bindVertexArrayOES(null),
                      (ke.currentVAO = be);
                  }
                }
                function We(be) {
                  if (be !== ke.currentVAO) {
                    if (be) be.bindAttrs();
                    else {
                      for (var pe = le(), Ye = 0; Ye < Le.length; ++Ye) {
                        var Be = Le[Ye];
                        Be.buffer
                          ? (C.enableVertexAttribArray(Ye),
                            Be.buffer.bind(),
                            C.vertexAttribPointer(
                              Ye,
                              Be.size,
                              Be.type,
                              Be.normalized,
                              Be.stride,
                              Be.offfset
                            ),
                            pe &&
                              Be.divisor &&
                              pe.vertexAttribDivisorANGLE(Ye, Be.divisor))
                          : (C.disableVertexAttribArray(Ye),
                            C.vertexAttrib4f(Ye, Be.x, Be.y, Be.z, Be.w));
                      }
                      _e.elements
                        ? C.bindBuffer(Gn, _e.elements.buffer.buffer)
                        : C.bindBuffer(Gn, null);
                    }
                    ke.currentVAO = be;
                  }
                }
                function ye() {
                  cr($e).forEach(function (be) {
                    be.destroy();
                  });
                }
                function nt() {
                  (this.id = ++ze),
                    (this.attributes = []),
                    (this.elements = null),
                    (this.ownsElements = !1),
                    (this.count = 0),
                    (this.offset = 0),
                    (this.instances = -1),
                    (this.primitive = 4);
                  var be = Ee();
                  be
                    ? (this.vao = be.createVertexArrayOES())
                    : (this.vao = null),
                    ($e[this.id] = this),
                    (this.buffers = []);
                }
                (nt.prototype.bindAttrs = function () {
                  for (
                    var be = le(), pe = this.attributes, Ye = 0;
                    Ye < pe.length;
                    ++Ye
                  ) {
                    var Be = pe[Ye];
                    Be.buffer
                      ? (C.enableVertexAttribArray(Ye),
                        C.bindBuffer(fo, Be.buffer.buffer),
                        C.vertexAttribPointer(
                          Ye,
                          Be.size,
                          Be.type,
                          Be.normalized,
                          Be.stride,
                          Be.offset
                        ),
                        be &&
                          Be.divisor &&
                          be.vertexAttribDivisorANGLE(Ye, Be.divisor))
                      : (C.disableVertexAttribArray(Ye),
                        C.vertexAttrib4f(Ye, Be.x, Be.y, Be.z, Be.w));
                  }
                  for (var Te = pe.length; Te < Pe; ++Te)
                    C.disableVertexAttribArray(Te);
                  var De = he.getElements(this.elements);
                  De
                    ? C.bindBuffer(Gn, De.buffer.buffer)
                    : C.bindBuffer(Gn, null);
                }),
                  (nt.prototype.refresh = function () {
                    var be = Ee();
                    be &&
                      (be.bindVertexArrayOES(this.vao),
                      this.bindAttrs(),
                      (ke.currentVAO = null),
                      be.bindVertexArrayOES(null));
                  }),
                  (nt.prototype.destroy = function () {
                    if (this.vao) {
                      var be = Ee();
                      this === ke.currentVAO &&
                        ((ke.currentVAO = null), be.bindVertexArrayOES(null)),
                        be.deleteVertexArrayOES(this.vao),
                        (this.vao = null);
                    }
                    this.ownsElements &&
                      (this.elements.destroy(),
                      (this.elements = null),
                      (this.ownsElements = !1)),
                      $e[this.id] && (delete $e[this.id], (ue.vaoCount -= 1));
                  });
                function Je() {
                  var be = Ee();
                  be &&
                    cr($e).forEach(function (pe) {
                      pe.refresh();
                    });
                }
                function Ue(be) {
                  var pe = new nt();
                  ue.vaoCount += 1;
                  function Ye(Be) {
                    var Te;
                    if (Array.isArray(Be))
                      (Te = Be),
                        pe.elements && pe.ownsElements && pe.elements.destroy(),
                        (pe.elements = null),
                        (pe.ownsElements = !1),
                        (pe.offset = 0),
                        (pe.count = 0),
                        (pe.instances = -1),
                        (pe.primitive = 4);
                    else {
                      if (
                        (V(
                          typeof Be == "object",
                          "invalid arguments for create vao"
                        ),
                        V(
                          "attributes" in Be,
                          "must specify attributes for vao"
                        ),
                        Be.elements)
                      ) {
                        var De = Be.elements;
                        pe.ownsElements
                          ? typeof De == "function" &&
                            De._reglType === "elements"
                            ? (pe.elements.destroy(), (pe.ownsElements = !1))
                            : (pe.elements(De), (pe.ownsElements = !1))
                          : he.getElements(Be.elements)
                          ? ((pe.elements = Be.elements),
                            (pe.ownsElements = !1))
                          : ((pe.elements = he.create(Be.elements)),
                            (pe.ownsElements = !0));
                      } else (pe.elements = null), (pe.ownsElements = !1);
                      (Te = Be.attributes),
                        (pe.offset = 0),
                        (pe.count = -1),
                        (pe.instances = -1),
                        (pe.primitive = 4),
                        pe.elements &&
                          ((pe.count = pe.elements._elements.vertCount),
                          (pe.primitive = pe.elements._elements.primType)),
                        "offset" in Be && (pe.offset = Be.offset | 0),
                        "count" in Be && (pe.count = Be.count | 0),
                        "instances" in Be && (pe.instances = Be.instances | 0),
                        "primitive" in Be &&
                          (V(
                            Be.primitive in wr,
                            "bad primitive type: " + Be.primitive
                          ),
                          (pe.primitive = wr[Be.primitive])),
                        V.optional(function () {
                          for (
                            var Dt = Object.keys(Be), Nt = 0;
                            Nt < Dt.length;
                            ++Nt
                          )
                            V(
                              co.indexOf(Dt[Nt]) >= 0,
                              'invalid option for vao: "' +
                                Dt[Nt] +
                                '" valid options are ' +
                                co
                            );
                        }),
                        V(Array.isArray(Te), "attributes must be an array");
                    }
                    V(Te.length < Pe, "too many attributes"),
                      V(Te.length > 0, "must specify at least one attribute");
                    var Ne = {},
                      dt = pe.attributes;
                    dt.length = Te.length;
                    for (var ht = 0; ht < Te.length; ++ht) {
                      var Ve = Te[ht],
                        Ge = (dt[ht] = new li()),
                        st = Ve.data || Ve;
                      if (Array.isArray(st) || tr(st) || Ot(st)) {
                        var pt;
                        pe.buffers[ht] &&
                          ((pt = pe.buffers[ht]),
                          tr(st) && pt._buffer.byteLength >= st.byteLength
                            ? pt.subdata(st)
                            : (pt.destroy(), (pe.buffers[ht] = null))),
                          pe.buffers[ht] ||
                            (pt = pe.buffers[ht] = me.create(Ve, fo, !1, !0)),
                          (Ge.buffer = me.getBuffer(pt)),
                          (Ge.size = Ge.buffer.dimension | 0),
                          (Ge.normalized = !1),
                          (Ge.type = Ge.buffer.dtype),
                          (Ge.offset = 0),
                          (Ge.stride = 0),
                          (Ge.divisor = 0),
                          (Ge.state = 1),
                          (Ne[ht] = 1);
                      } else
                        me.getBuffer(Ve)
                          ? ((Ge.buffer = me.getBuffer(Ve)),
                            (Ge.size = Ge.buffer.dimension | 0),
                            (Ge.normalized = !1),
                            (Ge.type = Ge.buffer.dtype),
                            (Ge.offset = 0),
                            (Ge.stride = 0),
                            (Ge.divisor = 0),
                            (Ge.state = 1))
                          : me.getBuffer(Ve.buffer)
                          ? ((Ge.buffer = me.getBuffer(Ve.buffer)),
                            (Ge.size = (+Ve.size || Ge.buffer.dimension) | 0),
                            (Ge.normalized = !!Ve.normalized || !1),
                            "type" in Ve
                              ? (V.parameter(
                                  Ve.type,
                                  Or,
                                  "invalid buffer type"
                                ),
                                (Ge.type = Or[Ve.type]))
                              : (Ge.type = Ge.buffer.dtype),
                            (Ge.offset = (Ve.offset || 0) | 0),
                            (Ge.stride = (Ve.stride || 0) | 0),
                            (Ge.divisor = (Ve.divisor || 0) | 0),
                            (Ge.state = 1),
                            V(
                              Ge.size >= 1 && Ge.size <= 4,
                              "size must be between 1 and 4"
                            ),
                            V(Ge.offset >= 0, "invalid offset"),
                            V(
                              Ge.stride >= 0 && Ge.stride <= 255,
                              "stride must be between 0 and 255"
                            ),
                            V(Ge.divisor >= 0, "divisor must be positive"),
                            V(
                              !Ge.divisor || !!B.angle_instanced_arrays,
                              "ANGLE_instanced_arrays must be enabled to use divisor"
                            ))
                          : "x" in Ve
                          ? (V(
                              ht > 0,
                              "first attribute must not be a constant"
                            ),
                            (Ge.x = +Ve.x || 0),
                            (Ge.y = +Ve.y || 0),
                            (Ge.z = +Ve.z || 0),
                            (Ge.w = +Ve.w || 0),
                            (Ge.state = 2))
                          : V(!1, "invalid attribute spec for location " + ht);
                    }
                    for (var Ct = 0; Ct < pe.buffers.length; ++Ct)
                      !Ne[Ct] &&
                        pe.buffers[Ct] &&
                        (pe.buffers[Ct].destroy(), (pe.buffers[Ct] = null));
                    return pe.refresh(), Ye;
                  }
                  return (
                    (Ye.destroy = function () {
                      for (var Be = 0; Be < pe.buffers.length; ++Be)
                        pe.buffers[Be] && pe.buffers[Be].destroy();
                      (pe.buffers.length = 0),
                        pe.ownsElements &&
                          (pe.elements.destroy(),
                          (pe.elements = null),
                          (pe.ownsElements = !1)),
                        pe.destroy();
                    }),
                    (Ye._vao = pe),
                    (Ye._reglType = "vao"),
                    Ye(be)
                  );
                }
                return ke;
              },
              ns = function (C, B, Y, ue) {
                var me = {},
                  he = {};
                function _e(le, se, Ce, We) {
                  (this.name = le),
                    (this.id = se),
                    (this.location = Ce),
                    (this.info = We);
                }
                function Pe(le, se) {
                  for (var Ce = 0; Ce < le.length; ++Ce)
                    if (le[Ce].id === se.id) {
                      le[Ce].location = se.location;
                      return;
                    }
                  le.push(se);
                }
                function Le(le, se, Ce) {
                  var We = le === ho ? me : he,
                    ye = We[se];
                  if (!ye) {
                    var nt = B.str(se);
                    (ye = C.createShader(le)),
                      C.shaderSource(ye, nt),
                      C.compileShader(ye),
                      V.shaderError(C, ye, nt, le, Ce),
                      (We[se] = ye);
                  }
                  return ye;
                }
                var Oe = {},
                  ze = [],
                  $e = 0;
                function ke(le, se) {
                  (this.id = $e++),
                    (this.fragId = le),
                    (this.vertId = se),
                    (this.program = null),
                    (this.uniforms = []),
                    (this.attributes = []),
                    (this.refCount = 1),
                    ue.profile &&
                      (this.stats = { uniformsCount: 0, attributesCount: 0 });
                }
                function Ie(le, se, Ce) {
                  var We,
                    ye,
                    nt = Le(ho, le.fragId),
                    Je = Le(Su, le.vertId),
                    Ue = (le.program = C.createProgram());
                  if ((C.attachShader(Ue, nt), C.attachShader(Ue, Je), Ce))
                    for (We = 0; We < Ce.length; ++We) {
                      var be = Ce[We];
                      C.bindAttribLocation(Ue, be[0], be[1]);
                    }
                  C.linkProgram(Ue),
                    V.linkError(C, Ue, B.str(le.fragId), B.str(le.vertId), se);
                  var pe = C.getProgramParameter(Ue, wu);
                  ue.profile && (le.stats.uniformsCount = pe);
                  var Ye = le.uniforms;
                  for (We = 0; We < pe; ++We)
                    if (((ye = C.getActiveUniform(Ue, We)), ye)) {
                      if (ye.size > 1)
                        for (var Be = 0; Be < ye.size; ++Be) {
                          var Te = ye.name.replace("[0]", "[" + Be + "]");
                          Pe(
                            Ye,
                            new _e(
                              Te,
                              B.id(Te),
                              C.getUniformLocation(Ue, Te),
                              ye
                            )
                          );
                        }
                      var De = ye.name;
                      ye.size > 1 && (De = De.replace("[0]", "")),
                        Pe(
                          Ye,
                          new _e(De, B.id(De), C.getUniformLocation(Ue, De), ye)
                        );
                    }
                  var Ne = C.getProgramParameter(Ue, Au);
                  ue.profile && (le.stats.attributesCount = Ne);
                  var dt = le.attributes;
                  for (We = 0; We < Ne; ++We)
                    (ye = C.getActiveAttrib(Ue, We)),
                      ye &&
                        Pe(
                          dt,
                          new _e(
                            ye.name,
                            B.id(ye.name),
                            C.getAttribLocation(Ue, ye.name),
                            ye
                          )
                        );
                }
                ue.profile &&
                  ((Y.getMaxUniformsCount = function () {
                    var le = 0;
                    return (
                      ze.forEach(function (se) {
                        se.stats.uniformsCount > le &&
                          (le = se.stats.uniformsCount);
                      }),
                      le
                    );
                  }),
                  (Y.getMaxAttributesCount = function () {
                    var le = 0;
                    return (
                      ze.forEach(function (se) {
                        se.stats.attributesCount > le &&
                          (le = se.stats.attributesCount);
                      }),
                      le
                    );
                  }));
                function Ee() {
                  (me = {}), (he = {});
                  for (var le = 0; le < ze.length; ++le)
                    Ie(
                      ze[le],
                      null,
                      ze[le].attributes.map(function (se) {
                        return [se.location, se.name];
                      })
                    );
                }
                return {
                  clear: function () {
                    var se = C.deleteShader.bind(C);
                    cr(me).forEach(se),
                      (me = {}),
                      cr(he).forEach(se),
                      (he = {}),
                      ze.forEach(function (Ce) {
                        C.deleteProgram(Ce.program);
                      }),
                      (ze.length = 0),
                      (Oe = {}),
                      (Y.shaderCount = 0);
                  },
                  program: function (se, Ce, We, ye) {
                    V.command(se >= 0, "missing vertex shader", We),
                      V.command(Ce >= 0, "missing fragment shader", We);
                    var nt = Oe[Ce];
                    nt || (nt = Oe[Ce] = {});
                    var Je = nt[se];
                    if (Je && (Je.refCount++, !ye)) return Je;
                    var Ue = new ke(Ce, se);
                    return (
                      Y.shaderCount++,
                      Ie(Ue, We, ye),
                      Je || (nt[se] = Ue),
                      ze.push(Ue),
                      Gt(Ue, {
                        destroy: function () {
                          if ((Ue.refCount--, Ue.refCount <= 0)) {
                            C.deleteProgram(Ue.program);
                            var pe = ze.indexOf(Ue);
                            ze.splice(pe, 1), Y.shaderCount--;
                          }
                          nt[Ue.vertId].refCount <= 0 &&
                            (C.deleteShader(he[Ue.vertId]),
                            delete he[Ue.vertId],
                            delete Oe[Ue.fragId][Ue.vertId]),
                            Object.keys(Oe[Ue.fragId]).length ||
                              (C.deleteShader(me[Ue.fragId]),
                              delete me[Ue.fragId],
                              delete Oe[Ue.fragId]);
                        },
                      })
                    );
                  },
                  restore: Ee,
                  shader: Le,
                  frag: -1,
                  vert: -1,
                };
              },
              is = function (C, B, Y, ue, me, he, _e) {
                function Pe(ze) {
                  var $e;
                  B.next === null
                    ? (V(
                        me.preserveDrawingBuffer,
                        'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'
                      ),
                      ($e = pn))
                    : (V(
                        B.next.colorAttachments[0].texture !== null,
                        "You cannot read from a renderbuffer"
                      ),
                      ($e = B.next.colorAttachments[0].texture._texture.type),
                      V.optional(function () {
                        he.oes_texture_float
                          ? (V(
                              $e === pn || $e === Un,
                              "Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"
                            ),
                            $e === Un &&
                              V(
                                _e.readFloat,
                                "Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float"
                              ))
                          : V(
                              $e === pn,
                              "Reading from a framebuffer is only allowed for the type 'uint8'"
                            );
                      }));
                  var ke = 0,
                    Ie = 0,
                    Ee = ue.framebufferWidth,
                    le = ue.framebufferHeight,
                    se = null;
                  tr(ze)
                    ? (se = ze)
                    : ze &&
                      (V.type(ze, "object", "invalid arguments to regl.read()"),
                      (ke = ze.x | 0),
                      (Ie = ze.y | 0),
                      V(
                        ke >= 0 && ke < ue.framebufferWidth,
                        "invalid x offset for regl.read"
                      ),
                      V(
                        Ie >= 0 && Ie < ue.framebufferHeight,
                        "invalid y offset for regl.read"
                      ),
                      (Ee = (ze.width || ue.framebufferWidth - ke) | 0),
                      (le = (ze.height || ue.framebufferHeight - Ie) | 0),
                      (se = ze.data || null)),
                    se &&
                      ($e === pn
                        ? V(
                            _instanceof$2(se, Uint8Array),
                            "buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"
                          )
                        : $e === Un &&
                          V(
                            _instanceof$2(se, Float32Array),
                            "buffer must be 'Float32Array' when reading from a framebuffer of type 'float'"
                          )),
                    V(
                      Ee > 0 && Ee + ke <= ue.framebufferWidth,
                      "invalid width for read pixels"
                    ),
                    V(
                      le > 0 && le + Ie <= ue.framebufferHeight,
                      "invalid height for read pixels"
                    ),
                    Y();
                  var Ce = Ee * le * 4;
                  return (
                    se ||
                      ($e === pn
                        ? (se = new Uint8Array(Ce))
                        : $e === Un && (se = se || new Float32Array(Ce))),
                    V.isTypedArray(
                      se,
                      "data buffer for regl.read() must be a typedarray"
                    ),
                    V(
                      se.byteLength >= Ce,
                      "data buffer for regl.read() too small"
                    ),
                    C.pixelStorei(Eu, 4),
                    C.readPixels(ke, Ie, Ee, le, Pu, $e, se),
                    se
                  );
                }
                function Le(ze) {
                  var $e;
                  return (
                    B.setFBO({ framebuffer: ze.framebuffer }, function () {
                      $e = Pe(ze);
                    }),
                    $e
                  );
                }
                function Oe(ze) {
                  return !ze || !("framebuffer" in ze) ? Pe(ze) : Le(ze);
                }
                return Oe;
              },
              jr = function (C) {
                return Array.prototype.slice.call(C);
              },
              qr = function (C) {
                return jr(C).join("");
              },
              as = function () {
                var C = 0,
                  B = [],
                  Y = [];
                function ue($e) {
                  for (var ke = 0; ke < Y.length; ++ke)
                    if (Y[ke] === $e) return B[ke];
                  var Ie = "g" + C++;
                  return B.push(Ie), Y.push($e), Ie;
                }
                function me() {
                  var $e = [];
                  function ke() {
                    $e.push.apply($e, jr(arguments));
                  }
                  var Ie = [];
                  function Ee() {
                    var le = "v" + C++;
                    return (
                      Ie.push(le),
                      arguments.length > 0 &&
                        ($e.push(le, "="),
                        $e.push.apply($e, jr(arguments)),
                        $e.push(";")),
                      le
                    );
                  }
                  return Gt(ke, {
                    def: Ee,
                    toString: function () {
                      return qr([
                        Ie.length > 0 ? "var " + Ie.join(",") + ";" : "",
                        qr($e),
                      ]);
                    },
                  });
                }
                function he() {
                  var $e = me(),
                    ke = me(),
                    Ie = $e.toString,
                    Ee = ke.toString;
                  function le(se, Ce) {
                    ke(se, Ce, "=", $e.def(se, Ce), ";");
                  }
                  return Gt(
                    function () {
                      $e.apply($e, jr(arguments));
                    },
                    {
                      def: $e.def,
                      entry: $e,
                      exit: ke,
                      save: le,
                      set: function (Ce, We, ye) {
                        le(Ce, We), $e(Ce, We, "=", ye, ";");
                      },
                      toString: function () {
                        return Ie() + Ee();
                      },
                    }
                  );
                }
                function _e() {
                  var $e = qr(arguments),
                    ke = he(),
                    Ie = he(),
                    Ee = ke.toString,
                    le = Ie.toString;
                  return Gt(ke, {
                    then: function () {
                      return ke.apply(ke, jr(arguments)), this;
                    },
                    else: function () {
                      return Ie.apply(Ie, jr(arguments)), this;
                    },
                    toString: function () {
                      var Ce = le();
                      return (
                        Ce && (Ce = "else{" + Ce + "}"),
                        qr(["if(", $e, "){", Ee(), "}", Ce])
                      );
                    },
                  });
                }
                var Pe = me(),
                  Le = {};
                function Oe($e, ke) {
                  var Ie = [];
                  function Ee() {
                    var ye = "a" + Ie.length;
                    return Ie.push(ye), ye;
                  }
                  ke = ke || 0;
                  for (var le = 0; le < ke; ++le) Ee();
                  var se = he(),
                    Ce = se.toString,
                    We = (Le[$e] = Gt(se, {
                      arg: Ee,
                      toString: function () {
                        return qr(["function(", Ie.join(), "){", Ce(), "}"]);
                      },
                    }));
                  return We;
                }
                function ze() {
                  var $e = ['"use strict";', Pe, "return {"];
                  Object.keys(Le).forEach(function (Ee) {
                    $e.push('"', Ee, '":', Le[Ee].toString(), ",");
                  }),
                    $e.push("}");
                  var ke = qr($e)
                      .replace(/;/g, ";\n")
                      .replace(/}/g, "}\n")
                      .replace(/{/g, "{\n"),
                    Ie = Function.apply(null, B.concat(ke));
                  return Ie.apply(null, Y);
                }
                return {
                  global: Pe,
                  link: ue,
                  block: me,
                  proc: Oe,
                  scope: he,
                  cond: _e,
                  compile: ze,
                };
              },
              $n = function (C) {
                return Array.isArray(C) || tr(C) || Ot(C);
              },
              la = function (C) {
                return C.sort(function (B, Y) {
                  return B === xr ? -1 : Y === xr ? 1 : B < Y ? -1 : 1;
                });
              },
              Zt = function (C, B, Y, ue) {
                (this.thisDep = C),
                  (this.contextDep = B),
                  (this.propDep = Y),
                  (this.append = ue);
              },
              Cr = function (C) {
                return C && !(C.thisDep || C.contextDep || C.propDep);
              },
              jt = function (C) {
                return new Zt(!1, !1, !1, C);
              },
              sr = function (C, B) {
                var Y = C.type;
                if (Y === zi) {
                  var ue = C.data.length;
                  return new Zt(!0, ue >= 1, ue >= 2, B);
                } else if (Y === jn) {
                  var me = C.data;
                  return new Zt(me.thisDep, me.contextDep, me.propDep, B);
                } else {
                  if (Y === vo) return new Zt(!1, !1, !1, B);
                  if (Y === mo) {
                    for (
                      var he = !1, _e = !1, Pe = !1, Le = 0;
                      Le < C.data.length;
                      ++Le
                    ) {
                      var Oe = C.data[Le];
                      if (Oe.type === Fi) Pe = !0;
                      else if (Oe.type === Di) _e = !0;
                      else if (Oe.type === Bi) he = !0;
                      else if (Oe.type === zi) {
                        he = !0;
                        var ze = Oe.data;
                        ze >= 1 && (_e = !0), ze >= 2 && (Pe = !0);
                      } else
                        Oe.type === jn &&
                          ((he = he || Oe.data.thisDep),
                          (_e = _e || Oe.data.contextDep),
                          (Pe = Pe || Oe.data.propDep));
                    }
                    return new Zt(he, _e, Pe, B);
                  } else return new Zt(Y === Bi, Y === Di, Y === Fi, B);
                }
              },
              os = function (
                C,
                B,
                Y,
                ue,
                me,
                he,
                _e,
                Pe,
                Le,
                Oe,
                ze,
                $e,
                ke,
                Ie,
                Ee
              ) {
                var le = Oe.Record,
                  se = {
                    add: 32774,
                    subtract: 32778,
                    "reverse subtract": 32779,
                  };
                Y.ext_blend_minmax && ((se.min = Uu), (se.max = ju));
                var Ce = Y.angle_instanced_arrays,
                  We = Y.webgl_draw_buffers,
                  ye = Y.oes_vertex_array_object,
                  nt = { dirty: !0, profile: Ee.profile },
                  Je = {},
                  Ue = [],
                  be = {},
                  pe = {};
                function Ye(G) {
                  return G.replace(".", "_");
                }
                function Be(G, z, K) {
                  var ne = Ye(G);
                  Ue.push(G), (Je[ne] = nt[ne] = !!K), (be[ne] = z);
                }
                function Te(G, z, K) {
                  var ne = Ye(G);
                  Ue.push(G),
                    Array.isArray(K)
                      ? ((nt[ne] = K.slice()), (Je[ne] = K.slice()))
                      : (nt[ne] = Je[ne] = K),
                    (pe[ne] = z);
                }
                Be(go, zu),
                  Be(yo, Iu),
                  Te(_o, "blendColor", [0, 0, 0, 0]),
                  Te(Ni, "blendEquationSeparate", [Bo, Bo]),
                  Te(Vi, "blendFuncSeparate", [Do, Fo, Do, Fo]),
                  Be(bo, Du, !0),
                  Te(xo, "depthFunc", Hu),
                  Te(Co, "depthRange", [0, 1]),
                  Te(So, "depthMask", !0),
                  Te(Gi, Gi, [!0, !0, !0, !0]),
                  Be(wo, ku),
                  Te(Ao, "cullFace", Fr),
                  Te(Ui, Ui, ra),
                  Te(ji, ji, 1),
                  Be(Po, Nu),
                  Te(qi, "polygonOffset", [0, 0]),
                  Be(Eo, Vu),
                  Be($o, Gu),
                  Te(Hi, "sampleCoverage", [1, !1]),
                  Be(Oo, Fu),
                  Te(Lo, "stencilMask", -1),
                  Te(Wi, "stencilFunc", [qu, 0, -1]),
                  Te(Yi, "stencilOpSeparate", [An, Pr, Pr, Pr]),
                  Te(vn, "stencilOpSeparate", [Fr, Pr, Pr, Pr]),
                  Be(To, Bu),
                  Te(qn, "scissor", [
                    0,
                    0,
                    C.drawingBufferWidth,
                    C.drawingBufferHeight,
                  ]),
                  Te(xr, xr, [
                    0,
                    0,
                    C.drawingBufferWidth,
                    C.drawingBufferHeight,
                  ]);
                var De = {
                    gl: C,
                    context: ke,
                    strings: B,
                    next: Je,
                    current: nt,
                    draw: $e,
                    elements: he,
                    buffer: me,
                    shader: ze,
                    attributes: Oe.state,
                    vao: Oe,
                    uniforms: Le,
                    framebuffer: Pe,
                    extensions: Y,
                    timer: Ie,
                    isBufferArgs: $n,
                  },
                  Ne = {
                    primTypes: wr,
                    compareFuncs: nn,
                    blendFuncs: yr,
                    blendEquations: se,
                    stencilOps: Er,
                    glTypes: Or,
                    orientationType: na,
                  };
                V.optional(function () {
                  De.isArrayLike = yt;
                }),
                  We &&
                    ((Ne.backBuffer = [Fr]),
                    (Ne.drawBuffer = at(ue.maxDrawbuffers, function (G) {
                      return G === 0
                        ? [0]
                        : at(G, function (z) {
                            return Wu + z;
                          });
                    })));
                var dt = 0;
                function ht() {
                  var G = as(),
                    z = G.link,
                    K = G.global;
                  (G.id = dt++), (G.batchId = "0");
                  var ne = z(De),
                    ie = (G.shared = { props: "a0" });
                  Object.keys(De).forEach(function (Q) {
                    ie[Q] = K.def(ne, ".", Q);
                  }),
                    V.optional(function () {
                      (G.CHECK = z(V)),
                        (G.commandStr = V.guessCommand()),
                        (G.command = z(G.commandStr)),
                        (G.assert = function (Q, N, oe) {
                          Q(
                            "if(!(",
                            N,
                            "))",
                            this.CHECK,
                            ".commandRaise(",
                            z(oe),
                            ",",
                            this.command,
                            ");"
                          );
                        }),
                        (Ne.invalidBlendCombinations = Vo);
                    });
                  var te = (G.next = {}),
                    ee = (G.current = {});
                  Object.keys(pe).forEach(function (Q) {
                    Array.isArray(nt[Q]) &&
                      ((te[Q] = K.def(ie.next, ".", Q)),
                      (ee[Q] = K.def(ie.current, ".", Q)));
                  });
                  var re = (G.constants = {});
                  Object.keys(Ne).forEach(function (Q) {
                    re[Q] = K.def(JSON.stringify(Ne[Q]));
                  }),
                    (G.invoke = function (Q, N) {
                      switch (N.type) {
                        case zi:
                          var oe = ["this", ie.context, ie.props, G.batchId];
                          return Q.def(
                            z(N.data),
                            ".call(",
                            oe.slice(0, Math.max(N.data.length + 1, 4)),
                            ")"
                          );
                        case Fi:
                          return Q.def(ie.props, N.data);
                        case Di:
                          return Q.def(ie.context, N.data);
                        case Bi:
                          return Q.def("this", N.data);
                        case jn:
                          return N.data.append(G, Q), N.data.ref;
                        case vo:
                          return N.data.toString();
                        case mo:
                          return N.data.map(function (fe) {
                            return G.invoke(Q, fe);
                          });
                      }
                    }),
                    (G.attribCache = {});
                  var U = {};
                  return (
                    (G.scopeAttrib = function (Q) {
                      var N = B.id(Q);
                      if (N in U) return U[N];
                      var oe = Oe.scope[N];
                      oe || (oe = Oe.scope[N] = new le());
                      var fe = (U[N] = z(oe));
                      return fe;
                    }),
                    G
                  );
                }
                function Ve(G) {
                  var z = G.static,
                    K = G.dynamic,
                    ne;
                  if (mn in z) {
                    var ie = !!z[mn];
                    (ne = jt(function (ee, re) {
                      return ie;
                    })),
                      (ne.enable = ie);
                  } else if (mn in K) {
                    var te = K[mn];
                    ne = sr(te, function (ee, re) {
                      return ee.invoke(re, te);
                    });
                  }
                  return ne;
                }
                function Ge(G, z) {
                  var K = G.static,
                    ne = G.dynamic;
                  if (Rr in K) {
                    var ie = K[Rr];
                    return ie
                      ? ((ie = Pe.getFramebuffer(ie)),
                        V.command(ie, "invalid framebuffer object"),
                        jt(function (ee, re) {
                          var U = ee.link(ie),
                            Q = ee.shared;
                          re.set(Q.framebuffer, ".next", U);
                          var N = Q.context;
                          return (
                            re.set(N, "." + en, U + ".width"),
                            re.set(N, "." + tn, U + ".height"),
                            U
                          );
                        }))
                      : jt(function (ee, re) {
                          var U = ee.shared;
                          re.set(U.framebuffer, ".next", "null");
                          var Q = U.context;
                          return (
                            re.set(Q, "." + en, Q + "." + Ro),
                            re.set(Q, "." + tn, Q + "." + ko),
                            "null"
                          );
                        });
                  } else if (Rr in ne) {
                    var te = ne[Rr];
                    return sr(te, function (ee, re) {
                      var U = ee.invoke(re, te),
                        Q = ee.shared,
                        N = Q.framebuffer,
                        oe = re.def(N, ".getFramebuffer(", U, ")");
                      V.optional(function () {
                        ee.assert(
                          re,
                          "!" + U + "||" + oe,
                          "invalid framebuffer object"
                        );
                      }),
                        re.set(N, ".next", oe);
                      var fe = Q.context;
                      return (
                        re.set(
                          fe,
                          "." + en,
                          oe + "?" + oe + ".width:" + fe + "." + Ro
                        ),
                        re.set(
                          fe,
                          "." + tn,
                          oe + "?" + oe + ".height:" + fe + "." + ko
                        ),
                        oe
                      );
                    });
                  } else return null;
                }
                function st(G, z, K) {
                  var ne = G.static,
                    ie = G.dynamic;
                  function te(U) {
                    if (U in ne) {
                      var Q = ne[U];
                      V.commandType(Q, "object", "invalid " + U, K.commandStr);
                      var N = !0,
                        oe = Q.x | 0,
                        fe = Q.y | 0,
                        xe,
                        Ae;
                      return (
                        "width" in Q
                          ? ((xe = Q.width | 0),
                            V.command(xe >= 0, "invalid " + U, K.commandStr))
                          : (N = !1),
                        "height" in Q
                          ? ((Ae = Q.height | 0),
                            V.command(Ae >= 0, "invalid " + U, K.commandStr))
                          : (N = !1),
                        new Zt(
                          !N && z && z.thisDep,
                          !N && z && z.contextDep,
                          !N && z && z.propDep,
                          function (it, tt) {
                            var Xe = it.shared.context,
                              Qe = xe;
                            "width" in Q || (Qe = tt.def(Xe, ".", en, "-", oe));
                            var Me = Ae;
                            return (
                              "height" in Q ||
                                (Me = tt.def(Xe, ".", tn, "-", fe)),
                              [oe, fe, Qe, Me]
                            );
                          }
                        )
                      );
                    } else if (U in ie) {
                      var Re = ie[U],
                        je = sr(Re, function (it, tt) {
                          var Xe = it.invoke(tt, Re);
                          V.optional(function () {
                            it.assert(
                              tt,
                              Xe + "&&typeof " + Xe + '==="object"',
                              "invalid " + U
                            );
                          });
                          var Qe = it.shared.context,
                            Me = tt.def(Xe, ".x|0"),
                            ve = tt.def(Xe, ".y|0"),
                            ft = tt.def(
                              '"width" in ',
                              Xe,
                              "?",
                              Xe,
                              ".width|0:",
                              "(",
                              Qe,
                              ".",
                              en,
                              "-",
                              Me,
                              ")"
                            ),
                            Ft = tt.def(
                              '"height" in ',
                              Xe,
                              "?",
                              Xe,
                              ".height|0:",
                              "(",
                              Qe,
                              ".",
                              tn,
                              "-",
                              ve,
                              ")"
                            );
                          return (
                            V.optional(function () {
                              it.assert(
                                tt,
                                ft + ">=0&&" + Ft + ">=0",
                                "invalid " + U
                              );
                            }),
                            [Me, ve, ft, Ft]
                          );
                        });
                      return (
                        z &&
                          ((je.thisDep = je.thisDep || z.thisDep),
                          (je.contextDep = je.contextDep || z.contextDep),
                          (je.propDep = je.propDep || z.propDep)),
                        je
                      );
                    } else
                      return z
                        ? new Zt(z.thisDep, z.contextDep, z.propDep, function (
                            it,
                            tt
                          ) {
                            var Xe = it.shared.context;
                            return [
                              0,
                              0,
                              tt.def(Xe, ".", en),
                              tt.def(Xe, ".", tn),
                            ];
                          })
                        : null;
                  }
                  var ee = te(xr);
                  if (ee) {
                    var re = ee;
                    ee = new Zt(
                      ee.thisDep,
                      ee.contextDep,
                      ee.propDep,
                      function (U, Q) {
                        var N = re.append(U, Q),
                          oe = U.shared.context;
                        return (
                          Q.set(oe, "." + $u, N[2]),
                          Q.set(oe, "." + Ou, N[3]),
                          N
                        );
                      }
                    );
                  }
                  return { viewport: ee, scissor_box: te(qn) };
                }
                function pt(G, z) {
                  var K = G.static,
                    ne = typeof K[yn] == "string" && typeof K[gn] == "string";
                  if (ne) {
                    if (Object.keys(z.dynamic).length > 0) return null;
                    var ie = z.static,
                      te = Object.keys(ie);
                    if (te.length > 0 && typeof ie[te[0]] == "number") {
                      for (var ee = [], re = 0; re < te.length; ++re)
                        V(
                          typeof ie[te[re]] == "number",
                          "must specify all vertex attribute locations when using vaos"
                        ),
                          ee.push([ie[te[re]] | 0, te[re]]);
                      return ee;
                    }
                  }
                  return null;
                }
                function Ct(G, z, K) {
                  var ne = G.static,
                    ie = G.dynamic;
                  function te(N) {
                    if (N in ne) {
                      var oe = B.id(ne[N]);
                      V.optional(function () {
                        ze.shader(Go[N], oe, V.guessCommand());
                      });
                      var fe = jt(function () {
                        return oe;
                      });
                      return (fe.id = oe), fe;
                    } else if (N in ie) {
                      var xe = ie[N];
                      return sr(xe, function (Ae, Re) {
                        var je = Ae.invoke(Re, xe),
                          it = Re.def(Ae.shared.strings, ".id(", je, ")");
                        return (
                          V.optional(function () {
                            Re(
                              Ae.shared.shader,
                              ".shader(",
                              Go[N],
                              ",",
                              it,
                              ",",
                              Ae.command,
                              ");"
                            );
                          }),
                          it
                        );
                      });
                    }
                    return null;
                  }
                  var ee = te(yn),
                    re = te(gn),
                    U = null,
                    Q;
                  return (
                    Cr(ee) && Cr(re)
                      ? ((U = ze.program(re.id, ee.id, null, K)),
                        (Q = jt(function (N, oe) {
                          return N.link(U);
                        })))
                      : (Q = new Zt(
                          (ee && ee.thisDep) || (re && re.thisDep),
                          (ee && ee.contextDep) || (re && re.contextDep),
                          (ee && ee.propDep) || (re && re.propDep),
                          function (N, oe) {
                            var fe = N.shared.shader,
                              xe;
                            ee
                              ? (xe = ee.append(N, oe))
                              : (xe = oe.def(fe, ".", yn));
                            var Ae;
                            re
                              ? (Ae = re.append(N, oe))
                              : (Ae = oe.def(fe, ".", gn));
                            var Re = fe + ".program(" + Ae + "," + xe;
                            return (
                              V.optional(function () {
                                Re += "," + N.command;
                              }),
                              oe.def(Re + ")")
                            );
                          }
                        )),
                    { frag: ee, vert: re, progVar: Q, program: U }
                  );
                }
                function Dt(G, z) {
                  var K = G.static,
                    ne = G.dynamic,
                    ie = {},
                    te = !1;
                  function ee() {
                    if (_n in K) {
                      var tt = K[_n];
                      return (
                        tt !== null &&
                          Oe.getVAO(tt) === null &&
                          (tt = Oe.createVAO(tt)),
                        (te = !0),
                        (ie.vao = tt),
                        jt(function (Qe) {
                          var Me = Oe.getVAO(tt);
                          return Me ? Qe.link(Me) : "null";
                        })
                      );
                    } else if (_n in ne) {
                      te = !0;
                      var Xe = ne[_n];
                      return sr(Xe, function (Qe, Me) {
                        var ve = Qe.invoke(Me, Xe);
                        return Me.def(Qe.shared.vao + ".getVAO(" + ve + ")");
                      });
                    }
                    return null;
                  }
                  var re = ee(),
                    U = !1;
                  function Q() {
                    if (kr in K) {
                      var tt = K[kr];
                      if (((ie.elements = tt), $n(tt))) {
                        var Xe = (ie.elements = he.create(tt, !0));
                        (tt = he.getElements(Xe)), (U = !0);
                      } else
                        tt &&
                          ((tt = he.getElements(tt)),
                          (U = !0),
                          V.command(tt, "invalid elements", z.commandStr));
                      var Qe = jt(function (ve, ft) {
                        if (tt) {
                          var Ft = ve.link(tt);
                          return (ve.ELEMENTS = Ft), Ft;
                        }
                        return (ve.ELEMENTS = null), null;
                      });
                      return (Qe.value = tt), Qe;
                    } else if (kr in ne) {
                      U = !0;
                      var Me = ne[kr];
                      return sr(Me, function (ve, ft) {
                        var Ft = ve.shared,
                          er = Ft.isBufferArgs,
                          hr = Ft.elements,
                          Br = ve.invoke(ft, Me),
                          _r = ft.def("null"),
                          Nr = ft.def(er, "(", Br, ")"),
                          an = ve
                            .cond(Nr)
                            .then(_r, "=", hr, ".createStream(", Br, ");")
                            .else(_r, "=", hr, ".getElements(", Br, ");");
                        return (
                          V.optional(function () {
                            ve.assert(
                              an.else,
                              "!" + Br + "||" + _r,
                              "invalid elements"
                            );
                          }),
                          ft.entry(an),
                          ft.exit(
                            ve.cond(Nr).then(hr, ".destroyStream(", _r, ");")
                          ),
                          (ve.ELEMENTS = _r),
                          _r
                        );
                      });
                    } else if (te)
                      return new Zt(
                        re.thisDep,
                        re.contextDep,
                        re.propDep,
                        function (ve, ft) {
                          return ft.def(
                            ve.shared.vao +
                              ".currentVAO?" +
                              ve.shared.elements +
                              ".getElements(" +
                              ve.shared.vao +
                              ".currentVAO.elements):null"
                          );
                        }
                      );
                    return null;
                  }
                  var N = Q();
                  function oe() {
                    if (Ir in K) {
                      var tt = K[Ir];
                      return (
                        (ie.primitive = tt),
                        V.commandParameter(
                          tt,
                          wr,
                          "invalid primitve",
                          z.commandStr
                        ),
                        jt(function (Qe, Me) {
                          return wr[tt];
                        })
                      );
                    } else if (Ir in ne) {
                      var Xe = ne[Ir];
                      return sr(Xe, function (Qe, Me) {
                        var ve = Qe.constants.primTypes,
                          ft = Qe.invoke(Me, Xe);
                        return (
                          V.optional(function () {
                            Qe.assert(
                              Me,
                              ft + " in " + ve,
                              "invalid primitive, must be one of " +
                                Object.keys(wr)
                            );
                          }),
                          Me.def(ve, "[", ft, "]")
                        );
                      });
                    } else {
                      if (U)
                        return Cr(N)
                          ? N.value
                            ? jt(function (Qe, Me) {
                                return Me.def(Qe.ELEMENTS, ".primType");
                              })
                            : jt(function () {
                                return ta;
                              })
                          : new Zt(
                              N.thisDep,
                              N.contextDep,
                              N.propDep,
                              function (Qe, Me) {
                                var ve = Qe.ELEMENTS;
                                return Me.def(ve, "?", ve, ".primType:", ta);
                              }
                            );
                      if (te)
                        return new Zt(
                          re.thisDep,
                          re.contextDep,
                          re.propDep,
                          function (Qe, Me) {
                            return Me.def(
                              Qe.shared.vao +
                                ".currentVAO?" +
                                Qe.shared.vao +
                                ".currentVAO.primitive:" +
                                ta
                            );
                          }
                        );
                    }
                    return null;
                  }
                  function fe(tt, Xe) {
                    if (tt in K) {
                      var Qe = K[tt] | 0;
                      return (
                        Xe ? (ie.offset = Qe) : (ie.instances = Qe),
                        V.command(
                          !Xe || Qe >= 0,
                          "invalid " + tt,
                          z.commandStr
                        ),
                        jt(function (ve, ft) {
                          return Xe && (ve.OFFSET = Qe), Qe;
                        })
                      );
                    } else if (tt in ne) {
                      var Me = ne[tt];
                      return sr(Me, function (ve, ft) {
                        var Ft = ve.invoke(ft, Me);
                        return (
                          Xe &&
                            ((ve.OFFSET = Ft),
                            V.optional(function () {
                              ve.assert(ft, Ft + ">=0", "invalid " + tt);
                            })),
                          Ft
                        );
                      });
                    } else if (Xe) {
                      if (U)
                        return jt(function (ve, ft) {
                          return (ve.OFFSET = 0), 0;
                        });
                      if (te)
                        return new Zt(
                          re.thisDep,
                          re.contextDep,
                          re.propDep,
                          function (ve, ft) {
                            return ft.def(
                              ve.shared.vao +
                                ".currentVAO?" +
                                ve.shared.vao +
                                ".currentVAO.offset:0"
                            );
                          }
                        );
                    } else if (te)
                      return new Zt(
                        re.thisDep,
                        re.contextDep,
                        re.propDep,
                        function (ve, ft) {
                          return ft.def(
                            ve.shared.vao +
                              ".currentVAO?" +
                              ve.shared.vao +
                              ".currentVAO.instances:-1"
                          );
                        }
                      );
                    return null;
                  }
                  var xe = fe(Hn, !0);
                  function Ae() {
                    if (zr in K) {
                      var tt = K[zr] | 0;
                      return (
                        (ie.count = tt),
                        V.command(
                          typeof tt == "number" && tt >= 0,
                          "invalid vertex count",
                          z.commandStr
                        ),
                        jt(function () {
                          return tt;
                        })
                      );
                    } else if (zr in ne) {
                      var Xe = ne[zr];
                      return sr(Xe, function (ft, Ft) {
                        var er = ft.invoke(Ft, Xe);
                        return (
                          V.optional(function () {
                            ft.assert(
                              Ft,
                              "typeof " +
                                er +
                                '==="number"&&' +
                                er +
                                ">=0&&" +
                                er +
                                "===(" +
                                er +
                                "|0)",
                              "invalid vertex count"
                            );
                          }),
                          er
                        );
                      });
                    } else if (U)
                      if (Cr(N)) {
                        if (N)
                          return xe
                            ? new Zt(
                                xe.thisDep,
                                xe.contextDep,
                                xe.propDep,
                                function (ft, Ft) {
                                  var er = Ft.def(
                                    ft.ELEMENTS,
                                    ".vertCount-",
                                    ft.OFFSET
                                  );
                                  return (
                                    V.optional(function () {
                                      ft.assert(
                                        Ft,
                                        er + ">=0",
                                        "invalid vertex offset/element buffer too small"
                                      );
                                    }),
                                    er
                                  );
                                }
                              )
                            : jt(function (ft, Ft) {
                                return Ft.def(ft.ELEMENTS, ".vertCount");
                              });
                        var Qe = jt(function () {
                          return -1;
                        });
                        return (
                          V.optional(function () {
                            Qe.MISSING = !0;
                          }),
                          Qe
                        );
                      } else {
                        var Me = new Zt(
                          N.thisDep || xe.thisDep,
                          N.contextDep || xe.contextDep,
                          N.propDep || xe.propDep,
                          function (ft, Ft) {
                            var er = ft.ELEMENTS;
                            return ft.OFFSET
                              ? Ft.def(
                                  er,
                                  "?",
                                  er,
                                  ".vertCount-",
                                  ft.OFFSET,
                                  ":-1"
                                )
                              : Ft.def(er, "?", er, ".vertCount:-1");
                          }
                        );
                        return (
                          V.optional(function () {
                            Me.DYNAMIC = !0;
                          }),
                          Me
                        );
                      }
                    else if (te) {
                      var ve = new Zt(
                        re.thisDep,
                        re.contextDep,
                        re.propDep,
                        function (ft, Ft) {
                          return Ft.def(
                            ft.shared.vao,
                            ".currentVAO?",
                            ft.shared.vao,
                            ".currentVAO.count:-1"
                          );
                        }
                      );
                      return ve;
                    }
                    return null;
                  }
                  var Re = oe(),
                    je = Ae(),
                    it = fe(Wn, !1);
                  return {
                    elements: N,
                    primitive: Re,
                    count: je,
                    instances: it,
                    offset: xe,
                    vao: re,
                    vaoActive: te,
                    elementsActive: U,
                    static: ie,
                  };
                }
                function Nt(G, z) {
                  var K = G.static,
                    ne = G.dynamic,
                    ie = {};
                  return (
                    Ue.forEach(function (te) {
                      var ee = Ye(te);
                      function re(U, Q) {
                        if (te in K) {
                          var N = U(K[te]);
                          ie[ee] = jt(function () {
                            return N;
                          });
                        } else if (te in ne) {
                          var oe = ne[te];
                          ie[ee] = sr(oe, function (fe, xe) {
                            return Q(fe, xe, fe.invoke(xe, oe));
                          });
                        }
                      }
                      switch (te) {
                        case wo:
                        case yo:
                        case go:
                        case Oo:
                        case bo:
                        case To:
                        case Po:
                        case Eo:
                        case $o:
                        case So:
                          return re(
                            function (U) {
                              return (
                                V.commandType(U, "boolean", te, z.commandStr), U
                              );
                            },
                            function (U, Q, N) {
                              return (
                                V.optional(function () {
                                  U.assert(
                                    Q,
                                    "typeof " + N + '==="boolean"',
                                    "invalid flag " + te,
                                    U.commandStr
                                  );
                                }),
                                N
                              );
                            }
                          );
                        case xo:
                          return re(
                            function (U) {
                              return (
                                V.commandParameter(
                                  U,
                                  nn,
                                  "invalid " + te,
                                  z.commandStr
                                ),
                                nn[U]
                              );
                            },
                            function (U, Q, N) {
                              var oe = U.constants.compareFuncs;
                              return (
                                V.optional(function () {
                                  U.assert(
                                    Q,
                                    N + " in " + oe,
                                    "invalid " +
                                      te +
                                      ", must be one of " +
                                      Object.keys(nn)
                                  );
                                }),
                                Q.def(oe, "[", N, "]")
                              );
                            }
                          );
                        case Co:
                          return re(
                            function (U) {
                              return (
                                V.command(
                                  yt(U) &&
                                    U.length === 2 &&
                                    typeof U[0] == "number" &&
                                    typeof U[1] == "number" &&
                                    U[0] <= U[1],
                                  "depth range is 2d array",
                                  z.commandStr
                                ),
                                U
                              );
                            },
                            function (U, Q, N) {
                              V.optional(function () {
                                U.assert(
                                  Q,
                                  U.shared.isArrayLike +
                                    "(" +
                                    N +
                                    ")&&" +
                                    N +
                                    ".length===2&&typeof " +
                                    N +
                                    '[0]==="number"&&typeof ' +
                                    N +
                                    '[1]==="number"&&' +
                                    N +
                                    "[0]<=" +
                                    N +
                                    "[1]",
                                  "depth range must be a 2d array"
                                );
                              });
                              var oe = Q.def("+", N, "[0]"),
                                fe = Q.def("+", N, "[1]");
                              return [oe, fe];
                            }
                          );
                        case Vi:
                          return re(
                            function (U) {
                              V.commandType(
                                U,
                                "object",
                                "blend.func",
                                z.commandStr
                              );
                              var Q = "srcRGB" in U ? U.srcRGB : U.src,
                                N = "srcAlpha" in U ? U.srcAlpha : U.src,
                                oe = "dstRGB" in U ? U.dstRGB : U.dst,
                                fe = "dstAlpha" in U ? U.dstAlpha : U.dst;
                              return (
                                V.commandParameter(
                                  Q,
                                  yr,
                                  ee + ".srcRGB",
                                  z.commandStr
                                ),
                                V.commandParameter(
                                  N,
                                  yr,
                                  ee + ".srcAlpha",
                                  z.commandStr
                                ),
                                V.commandParameter(
                                  oe,
                                  yr,
                                  ee + ".dstRGB",
                                  z.commandStr
                                ),
                                V.commandParameter(
                                  fe,
                                  yr,
                                  ee + ".dstAlpha",
                                  z.commandStr
                                ),
                                V.command(
                                  Vo.indexOf(Q + ", " + oe) === -1,
                                  "unallowed blending combination (srcRGB, dstRGB) = (" +
                                    Q +
                                    ", " +
                                    oe +
                                    ")",
                                  z.commandStr
                                ),
                                [yr[Q], yr[oe], yr[N], yr[fe]]
                              );
                            },
                            function (U, Q, N) {
                              var oe = U.constants.blendFuncs;
                              V.optional(function () {
                                U.assert(
                                  Q,
                                  N + "&&typeof " + N + '==="object"',
                                  "invalid blend func, must be an object"
                                );
                              });
                              function fe(Xe, Qe) {
                                var Me = Q.def(
                                  '"',
                                  Xe,
                                  Qe,
                                  '" in ',
                                  N,
                                  "?",
                                  N,
                                  ".",
                                  Xe,
                                  Qe,
                                  ":",
                                  N,
                                  ".",
                                  Xe
                                );
                                return (
                                  V.optional(function () {
                                    U.assert(
                                      Q,
                                      Me + " in " + oe,
                                      "invalid " +
                                        te +
                                        "." +
                                        Xe +
                                        Qe +
                                        ", must be one of " +
                                        Object.keys(yr)
                                    );
                                  }),
                                  Me
                                );
                              }
                              var xe = fe("src", "RGB"),
                                Ae = fe("dst", "RGB");
                              V.optional(function () {
                                var Xe = U.constants.invalidBlendCombinations;
                                U.assert(
                                  Q,
                                  Xe +
                                    ".indexOf(" +
                                    xe +
                                    '+", "+' +
                                    Ae +
                                    ") === -1 ",
                                  "unallowed blending combination for (srcRGB, dstRGB)"
                                );
                              });
                              var Re = Q.def(oe, "[", xe, "]"),
                                je = Q.def(oe, "[", fe("src", "Alpha"), "]"),
                                it = Q.def(oe, "[", Ae, "]"),
                                tt = Q.def(oe, "[", fe("dst", "Alpha"), "]");
                              return [Re, it, je, tt];
                            }
                          );
                        case Ni:
                          return re(
                            function (U) {
                              if (typeof U == "string")
                                return (
                                  V.commandParameter(
                                    U,
                                    se,
                                    "invalid " + te,
                                    z.commandStr
                                  ),
                                  [se[U], se[U]]
                                );
                              if (typeof U == "object")
                                return (
                                  V.commandParameter(
                                    U.rgb,
                                    se,
                                    te + ".rgb",
                                    z.commandStr
                                  ),
                                  V.commandParameter(
                                    U.alpha,
                                    se,
                                    te + ".alpha",
                                    z.commandStr
                                  ),
                                  [se[U.rgb], se[U.alpha]]
                                );
                              V.commandRaise(
                                "invalid blend.equation",
                                z.commandStr
                              );
                            },
                            function (U, Q, N) {
                              var oe = U.constants.blendEquations,
                                fe = Q.def(),
                                xe = Q.def(),
                                Ae = U.cond("typeof ", N, '==="string"');
                              return (
                                V.optional(function () {
                                  function Re(je, it, tt) {
                                    U.assert(
                                      je,
                                      tt + " in " + oe,
                                      "invalid " +
                                        it +
                                        ", must be one of " +
                                        Object.keys(se)
                                    );
                                  }
                                  Re(Ae.then, te, N),
                                    U.assert(
                                      Ae.else,
                                      N + "&&typeof " + N + '==="object"',
                                      "invalid " + te
                                    ),
                                    Re(Ae.else, te + ".rgb", N + ".rgb"),
                                    Re(Ae.else, te + ".alpha", N + ".alpha");
                                }),
                                Ae.then(fe, "=", xe, "=", oe, "[", N, "];"),
                                Ae.else(
                                  fe,
                                  "=",
                                  oe,
                                  "[",
                                  N,
                                  ".rgb];",
                                  xe,
                                  "=",
                                  oe,
                                  "[",
                                  N,
                                  ".alpha];"
                                ),
                                Q(Ae),
                                [fe, xe]
                              );
                            }
                          );
                        case _o:
                          return re(
                            function (U) {
                              return (
                                V.command(
                                  yt(U) && U.length === 4,
                                  "blend.color must be a 4d array",
                                  z.commandStr
                                ),
                                at(4, function (Q) {
                                  return +U[Q];
                                })
                              );
                            },
                            function (U, Q, N) {
                              return (
                                V.optional(function () {
                                  U.assert(
                                    Q,
                                    U.shared.isArrayLike +
                                      "(" +
                                      N +
                                      ")&&" +
                                      N +
                                      ".length===4",
                                    "blend.color must be a 4d array"
                                  );
                                }),
                                at(4, function (oe) {
                                  return Q.def("+", N, "[", oe, "]");
                                })
                              );
                            }
                          );
                        case Lo:
                          return re(
                            function (U) {
                              return (
                                V.commandType(U, "number", ee, z.commandStr),
                                U | 0
                              );
                            },
                            function (U, Q, N) {
                              return (
                                V.optional(function () {
                                  U.assert(
                                    Q,
                                    "typeof " + N + '==="number"',
                                    "invalid stencil.mask"
                                  );
                                }),
                                Q.def(N, "|0")
                              );
                            }
                          );
                        case Wi:
                          return re(
                            function (U) {
                              V.commandType(U, "object", ee, z.commandStr);
                              var Q = U.cmp || "keep",
                                N = U.ref || 0,
                                oe = "mask" in U ? U.mask : -1;
                              return (
                                V.commandParameter(
                                  Q,
                                  nn,
                                  te + ".cmp",
                                  z.commandStr
                                ),
                                V.commandType(
                                  N,
                                  "number",
                                  te + ".ref",
                                  z.commandStr
                                ),
                                V.commandType(
                                  oe,
                                  "number",
                                  te + ".mask",
                                  z.commandStr
                                ),
                                [nn[Q], N, oe]
                              );
                            },
                            function (U, Q, N) {
                              var oe = U.constants.compareFuncs;
                              V.optional(function () {
                                function Re() {
                                  U.assert(
                                    Q,
                                    Array.prototype.join.call(arguments, ""),
                                    "invalid stencil.func"
                                  );
                                }
                                Re(N + "&&typeof ", N, '==="object"'),
                                  Re(
                                    '!("cmp" in ',
                                    N,
                                    ")||(",
                                    N,
                                    ".cmp in ",
                                    oe,
                                    ")"
                                  );
                              });
                              var fe = Q.def(
                                  '"cmp" in ',
                                  N,
                                  "?",
                                  oe,
                                  "[",
                                  N,
                                  ".cmp]",
                                  ":",
                                  Pr
                                ),
                                xe = Q.def(N, ".ref|0"),
                                Ae = Q.def(
                                  '"mask" in ',
                                  N,
                                  "?",
                                  N,
                                  ".mask|0:-1"
                                );
                              return [fe, xe, Ae];
                            }
                          );
                        case Yi:
                        case vn:
                          return re(
                            function (U) {
                              V.commandType(U, "object", ee, z.commandStr);
                              var Q = U.fail || "keep",
                                N = U.zfail || "keep",
                                oe = U.zpass || "keep";
                              return (
                                V.commandParameter(
                                  Q,
                                  Er,
                                  te + ".fail",
                                  z.commandStr
                                ),
                                V.commandParameter(
                                  N,
                                  Er,
                                  te + ".zfail",
                                  z.commandStr
                                ),
                                V.commandParameter(
                                  oe,
                                  Er,
                                  te + ".zpass",
                                  z.commandStr
                                ),
                                [te === vn ? Fr : An, Er[Q], Er[N], Er[oe]]
                              );
                            },
                            function (U, Q, N) {
                              var oe = U.constants.stencilOps;
                              V.optional(function () {
                                U.assert(
                                  Q,
                                  N + "&&typeof " + N + '==="object"',
                                  "invalid " + te
                                );
                              });
                              function fe(xe) {
                                return (
                                  V.optional(function () {
                                    U.assert(
                                      Q,
                                      '!("' +
                                        xe +
                                        '" in ' +
                                        N +
                                        ")||(" +
                                        N +
                                        "." +
                                        xe +
                                        " in " +
                                        oe +
                                        ")",
                                      "invalid " +
                                        te +
                                        "." +
                                        xe +
                                        ", must be one of " +
                                        Object.keys(Er)
                                    );
                                  }),
                                  Q.def(
                                    '"',
                                    xe,
                                    '" in ',
                                    N,
                                    "?",
                                    oe,
                                    "[",
                                    N,
                                    ".",
                                    xe,
                                    "]:",
                                    Pr
                                  )
                                );
                              }
                              return [
                                te === vn ? Fr : An,
                                fe("fail"),
                                fe("zfail"),
                                fe("zpass"),
                              ];
                            }
                          );
                        case qi:
                          return re(
                            function (U) {
                              V.commandType(U, "object", ee, z.commandStr);
                              var Q = U.factor | 0,
                                N = U.units | 0;
                              return (
                                V.commandType(
                                  Q,
                                  "number",
                                  ee + ".factor",
                                  z.commandStr
                                ),
                                V.commandType(
                                  N,
                                  "number",
                                  ee + ".units",
                                  z.commandStr
                                ),
                                [Q, N]
                              );
                            },
                            function (U, Q, N) {
                              V.optional(function () {
                                U.assert(
                                  Q,
                                  N + "&&typeof " + N + '==="object"',
                                  "invalid " + te
                                );
                              });
                              var oe = Q.def(N, ".factor|0"),
                                fe = Q.def(N, ".units|0");
                              return [oe, fe];
                            }
                          );
                        case Ao:
                          return re(
                            function (U) {
                              var Q = 0;
                              return (
                                U === "front"
                                  ? (Q = An)
                                  : U === "back" && (Q = Fr),
                                V.command(!!Q, ee, z.commandStr),
                                Q
                              );
                            },
                            function (U, Q, N) {
                              return (
                                V.optional(function () {
                                  U.assert(
                                    Q,
                                    N + '==="front"||' + N + '==="back"',
                                    "invalid cull.face"
                                  );
                                }),
                                Q.def(N, '==="front"?', An, ":", Fr)
                              );
                            }
                          );
                        case ji:
                          return re(
                            function (U) {
                              return (
                                V.command(
                                  typeof U == "number" &&
                                    U >= ue.lineWidthDims[0] &&
                                    U <= ue.lineWidthDims[1],
                                  "invalid line width, must be a positive number between " +
                                    ue.lineWidthDims[0] +
                                    " and " +
                                    ue.lineWidthDims[1],
                                  z.commandStr
                                ),
                                U
                              );
                            },
                            function (U, Q, N) {
                              return (
                                V.optional(function () {
                                  U.assert(
                                    Q,
                                    "typeof " +
                                      N +
                                      '==="number"&&' +
                                      N +
                                      ">=" +
                                      ue.lineWidthDims[0] +
                                      "&&" +
                                      N +
                                      "<=" +
                                      ue.lineWidthDims[1],
                                    "invalid line width"
                                  );
                                }),
                                N
                              );
                            }
                          );
                        case Ui:
                          return re(
                            function (U) {
                              return (
                                V.commandParameter(U, na, ee, z.commandStr),
                                na[U]
                              );
                            },
                            function (U, Q, N) {
                              return (
                                V.optional(function () {
                                  U.assert(
                                    Q,
                                    N + '==="cw"||' + N + '==="ccw"',
                                    "invalid frontFace, must be one of cw,ccw"
                                  );
                                }),
                                Q.def(N + '==="cw"?' + zo + ":" + ra)
                              );
                            }
                          );
                        case Gi:
                          return re(
                            function (U) {
                              return (
                                V.command(
                                  yt(U) && U.length === 4,
                                  "color.mask must be length 4 array",
                                  z.commandStr
                                ),
                                U.map(function (Q) {
                                  return !!Q;
                                })
                              );
                            },
                            function (U, Q, N) {
                              return (
                                V.optional(function () {
                                  U.assert(
                                    Q,
                                    U.shared.isArrayLike +
                                      "(" +
                                      N +
                                      ")&&" +
                                      N +
                                      ".length===4",
                                    "invalid color.mask"
                                  );
                                }),
                                at(4, function (oe) {
                                  return "!!" + N + "[" + oe + "]";
                                })
                              );
                            }
                          );
                        case Hi:
                          return re(
                            function (U) {
                              V.command(
                                typeof U == "object" && U,
                                ee,
                                z.commandStr
                              );
                              var Q = "value" in U ? U.value : 1,
                                N = !!U.invert;
                              return (
                                V.command(
                                  typeof Q == "number" && Q >= 0 && Q <= 1,
                                  "sample.coverage.value must be a number between 0 and 1",
                                  z.commandStr
                                ),
                                [Q, N]
                              );
                            },
                            function (U, Q, N) {
                              V.optional(function () {
                                U.assert(
                                  Q,
                                  N + "&&typeof " + N + '==="object"',
                                  "invalid sample.coverage"
                                );
                              });
                              var oe = Q.def(
                                  '"value" in ',
                                  N,
                                  "?+",
                                  N,
                                  ".value:1"
                                ),
                                fe = Q.def("!!", N, ".invert");
                              return [oe, fe];
                            }
                          );
                      }
                    }),
                    ie
                  );
                }
                function St(G, z) {
                  var K = G.static,
                    ne = G.dynamic,
                    ie = {};
                  return (
                    Object.keys(K).forEach(function (te) {
                      var ee = K[te],
                        re;
                      if (typeof ee == "number" || typeof ee == "boolean")
                        re = jt(function () {
                          return ee;
                        });
                      else if (typeof ee == "function") {
                        var U = ee._reglType;
                        U === "texture2d" || U === "textureCube"
                          ? (re = jt(function (Q) {
                              return Q.link(ee);
                            }))
                          : U === "framebuffer" || U === "framebufferCube"
                          ? (V.command(
                              ee.color.length > 0,
                              'missing color attachment for framebuffer sent to uniform "' +
                                te +
                                '"',
                              z.commandStr
                            ),
                            (re = jt(function (Q) {
                              return Q.link(ee.color[0]);
                            })))
                          : V.commandRaise(
                              'invalid data for uniform "' + te + '"',
                              z.commandStr
                            );
                      } else
                        yt(ee)
                          ? (re = jt(function (Q) {
                              var N = Q.global.def(
                                "[",
                                at(ee.length, function (oe) {
                                  return (
                                    V.command(
                                      typeof ee[oe] == "number" ||
                                        typeof ee[oe] == "boolean",
                                      "invalid uniform " + te,
                                      Q.commandStr
                                    ),
                                    ee[oe]
                                  );
                                }),
                                "]"
                              );
                              return N;
                            }))
                          : V.commandRaise(
                              'invalid or missing data for uniform "' +
                                te +
                                '"',
                              z.commandStr
                            );
                      (re.value = ee), (ie[te] = re);
                    }),
                    Object.keys(ne).forEach(function (te) {
                      var ee = ne[te];
                      ie[te] = sr(ee, function (re, U) {
                        return re.invoke(U, ee);
                      });
                    }),
                    ie
                  );
                }
                function Yt(G, z) {
                  var K = G.static,
                    ne = G.dynamic,
                    ie = {};
                  return (
                    Object.keys(K).forEach(function (te) {
                      var ee = K[te],
                        re = B.id(te),
                        U = new le();
                      if ($n(ee))
                        (U.state = Jr),
                          (U.buffer = me.getBuffer(me.create(ee, rn, !1, !0))),
                          (U.type = 0);
                      else {
                        var Q = me.getBuffer(ee);
                        if (Q) (U.state = Jr), (U.buffer = Q), (U.type = 0);
                        else if (
                          (V.command(
                            typeof ee == "object" && ee,
                            "invalid data for attribute " + te,
                            z.commandStr
                          ),
                          "constant" in ee)
                        ) {
                          var N = ee.constant;
                          (U.buffer = "null"),
                            (U.state = Ii),
                            typeof N == "number"
                              ? (U.x = N)
                              : (V.command(
                                  yt(N) && N.length > 0 && N.length <= 4,
                                  "invalid constant for attribute " + te,
                                  z.commandStr
                                ),
                                Kr.forEach(function (it, tt) {
                                  tt < N.length && (U[it] = N[tt]);
                                }));
                        } else {
                          $n(ee.buffer)
                            ? (Q = me.getBuffer(
                                me.create(ee.buffer, rn, !1, !0)
                              ))
                            : (Q = me.getBuffer(ee.buffer)),
                            V.command(
                              !!Q,
                              'missing buffer for attribute "' + te + '"',
                              z.commandStr
                            );
                          var oe = ee.offset | 0;
                          V.command(
                            oe >= 0,
                            'invalid offset for attribute "' + te + '"',
                            z.commandStr
                          );
                          var fe = ee.stride | 0;
                          V.command(
                            fe >= 0 && fe < 256,
                            'invalid stride for attribute "' +
                              te +
                              '", must be integer betweeen [0, 255]',
                            z.commandStr
                          );
                          var xe = ee.size | 0;
                          V.command(
                            !("size" in ee) || (xe > 0 && xe <= 4),
                            'invalid size for attribute "' +
                              te +
                              '", must be 1,2,3,4',
                            z.commandStr
                          );
                          var Ae = !!ee.normalized,
                            Re = 0;
                          "type" in ee &&
                            (V.commandParameter(
                              ee.type,
                              Or,
                              "invalid type for attribute " + te,
                              z.commandStr
                            ),
                            (Re = Or[ee.type]));
                          var je = ee.divisor | 0;
                          V.optional(function () {
                            "divisor" in ee &&
                              (V.command(
                                je === 0 || Ce,
                                'cannot specify divisor for attribute "' +
                                  te +
                                  '", instancing not supported',
                                z.commandStr
                              ),
                              V.command(
                                je >= 0,
                                'invalid divisor for attribute "' + te + '"',
                                z.commandStr
                              ));
                            var it = z.commandStr,
                              tt = [
                                "buffer",
                                "offset",
                                "divisor",
                                "normalized",
                                "type",
                                "size",
                                "stride",
                              ];
                            Object.keys(ee).forEach(function (Xe) {
                              V.command(
                                tt.indexOf(Xe) >= 0,
                                'unknown parameter "' +
                                  Xe +
                                  '" for attribute pointer "' +
                                  te +
                                  '" (valid parameters are ' +
                                  tt +
                                  ")",
                                it
                              );
                            });
                          }),
                            (U.buffer = Q),
                            (U.state = Jr),
                            (U.size = xe),
                            (U.normalized = Ae),
                            (U.type = Re || Q.dtype),
                            (U.offset = oe),
                            (U.stride = fe),
                            (U.divisor = je);
                        }
                      }
                      ie[te] = jt(function (it, tt) {
                        var Xe = it.attribCache;
                        if (re in Xe) return Xe[re];
                        var Qe = { isStream: !1 };
                        return (
                          Object.keys(U).forEach(function (Me) {
                            Qe[Me] = U[Me];
                          }),
                          U.buffer &&
                            ((Qe.buffer = it.link(U.buffer)),
                            (Qe.type = Qe.type || Qe.buffer + ".dtype")),
                          (Xe[re] = Qe),
                          Qe
                        );
                      });
                    }),
                    Object.keys(ne).forEach(function (te) {
                      var ee = ne[te];
                      function re(U, Q) {
                        var N = U.invoke(Q, ee),
                          oe = U.shared,
                          fe = U.constants,
                          xe = oe.isBufferArgs,
                          Ae = oe.buffer;
                        V.optional(function () {
                          U.assert(
                            Q,
                            N +
                              "&&(typeof " +
                              N +
                              '==="object"||typeof ' +
                              N +
                              '==="function")&&(' +
                              xe +
                              "(" +
                              N +
                              ")||" +
                              Ae +
                              ".getBuffer(" +
                              N +
                              ")||" +
                              Ae +
                              ".getBuffer(" +
                              N +
                              ".buffer)||" +
                              xe +
                              "(" +
                              N +
                              '.buffer)||("constant" in ' +
                              N +
                              "&&(typeof " +
                              N +
                              '.constant==="number"||' +
                              oe.isArrayLike +
                              "(" +
                              N +
                              ".constant))))",
                            'invalid dynamic attribute "' + te + '"'
                          );
                        });
                        var Re = { isStream: Q.def(!1) },
                          je = new le();
                        (je.state = Jr),
                          Object.keys(je).forEach(function (Qe) {
                            Re[Qe] = Q.def("" + je[Qe]);
                          });
                        var it = Re.buffer,
                          tt = Re.type;
                        Q(
                          "if(",
                          xe,
                          "(",
                          N,
                          ")){",
                          Re.isStream,
                          "=true;",
                          it,
                          "=",
                          Ae,
                          ".createStream(",
                          rn,
                          ",",
                          N,
                          ");",
                          tt,
                          "=",
                          it,
                          ".dtype;",
                          "}else{",
                          it,
                          "=",
                          Ae,
                          ".getBuffer(",
                          N,
                          ");",
                          "if(",
                          it,
                          "){",
                          tt,
                          "=",
                          it,
                          ".dtype;",
                          '}else if("constant" in ',
                          N,
                          "){",
                          Re.state,
                          "=",
                          Ii,
                          ";",
                          "if(typeof " + N + '.constant === "number"){',
                          Re[Kr[0]],
                          "=",
                          N,
                          ".constant;",
                          Kr.slice(1)
                            .map(function (Qe) {
                              return Re[Qe];
                            })
                            .join("="),
                          "=0;",
                          "}else{",
                          Kr.map(function (Qe, Me) {
                            return (
                              Re[Qe] +
                              "=" +
                              N +
                              ".constant.length>" +
                              Me +
                              "?" +
                              N +
                              ".constant[" +
                              Me +
                              "]:0;"
                            );
                          }).join(""),
                          "}}else{",
                          "if(",
                          xe,
                          "(",
                          N,
                          ".buffer)){",
                          it,
                          "=",
                          Ae,
                          ".createStream(",
                          rn,
                          ",",
                          N,
                          ".buffer);",
                          "}else{",
                          it,
                          "=",
                          Ae,
                          ".getBuffer(",
                          N,
                          ".buffer);",
                          "}",
                          tt,
                          '="type" in ',
                          N,
                          "?",
                          fe.glTypes,
                          "[",
                          N,
                          ".type]:",
                          it,
                          ".dtype;",
                          Re.normalized,
                          "=!!",
                          N,
                          ".normalized;"
                        );
                        function Xe(Qe) {
                          Q(Re[Qe], "=", N, ".", Qe, "|0;");
                        }
                        return (
                          Xe("size"),
                          Xe("offset"),
                          Xe("stride"),
                          Xe("divisor"),
                          Q("}}"),
                          Q.exit(
                            "if(",
                            Re.isStream,
                            "){",
                            Ae,
                            ".destroyStream(",
                            it,
                            ");",
                            "}"
                          ),
                          Re
                        );
                      }
                      ie[te] = sr(ee, re);
                    }),
                    ie
                  );
                }
                function zt(G) {
                  var z = G.static,
                    K = G.dynamic,
                    ne = {};
                  return (
                    Object.keys(z).forEach(function (ie) {
                      var te = z[ie];
                      ne[ie] = jt(function (ee, re) {
                        return typeof te == "number" || typeof te == "boolean"
                          ? "" + te
                          : ee.link(te);
                      });
                    }),
                    Object.keys(K).forEach(function (ie) {
                      var te = K[ie];
                      ne[ie] = sr(te, function (ee, re) {
                        return ee.invoke(re, te);
                      });
                    }),
                    ne
                  );
                }
                function Ht(G, z, K, ne, ie) {
                  var te = G.static,
                    ee = G.dynamic;
                  V.optional(function () {
                    var Xe = [Rr, gn, yn, kr, Ir, Hn, zr, Wn, mn, _n].concat(
                      Ue
                    );
                    function Qe(Me) {
                      Object.keys(Me).forEach(function (ve) {
                        V.command(
                          Xe.indexOf(ve) >= 0,
                          'unknown parameter "' + ve + '"',
                          ie.commandStr
                        );
                      });
                    }
                    Qe(te), Qe(ee);
                  });
                  var re = pt(G, z),
                    U = Ge(G),
                    Q = st(G, U, ie),
                    N = Dt(G, ie),
                    oe = Nt(G, ie),
                    fe = Ct(G, ie, re);
                  function xe(Xe) {
                    var Qe = Q[Xe];
                    Qe && (oe[Xe] = Qe);
                  }
                  xe(xr), xe(Ye(qn));
                  var Ae = Object.keys(oe).length > 0,
                    Re = {
                      framebuffer: U,
                      draw: N,
                      shader: fe,
                      state: oe,
                      dirty: Ae,
                      scopeVAO: null,
                      drawVAO: null,
                      useVAO: !1,
                      attributes: {},
                    };
                  if (
                    ((Re.profile = Ve(G)),
                    (Re.uniforms = St(K, ie)),
                    (Re.drawVAO = Re.scopeVAO = N.vao),
                    !Re.drawVAO &&
                      fe.program &&
                      !re &&
                      Y.angle_instanced_arrays &&
                      N.static.elements)
                  ) {
                    var je = !0,
                      it = fe.program.attributes.map(function (Xe) {
                        var Qe = z.static[Xe];
                        return (je = je && !!Qe), Qe;
                      });
                    if (je && it.length > 0) {
                      var tt = Oe.getVAO(
                        Oe.createVAO({
                          attributes: it,
                          elements: N.static.elements,
                        })
                      );
                      (Re.drawVAO = new Zt(null, null, null, function (Xe, Qe) {
                        return Xe.link(tt);
                      })),
                        (Re.useVAO = !0);
                    }
                  }
                  return (
                    re ? (Re.useVAO = !0) : (Re.attributes = Yt(z, ie)),
                    (Re.context = zt(ne)),
                    Re
                  );
                }
                function Xt(G, z, K) {
                  var ne = G.shared,
                    ie = ne.context,
                    te = G.scope();
                  Object.keys(K).forEach(function (ee) {
                    z.save(ie, "." + ee);
                    var re = K[ee],
                      U = re.append(G, z);
                    Array.isArray(U)
                      ? te(ie, ".", ee, "=[", U.join(), "];")
                      : te(ie, ".", ee, "=", U, ";");
                  }),
                    z(te);
                }
                function Qt(G, z, K, ne) {
                  var ie = G.shared,
                    te = ie.gl,
                    ee = ie.framebuffer,
                    re;
                  We && (re = z.def(ie.extensions, ".webgl_draw_buffers"));
                  var U = G.constants,
                    Q = U.drawBuffer,
                    N = U.backBuffer,
                    oe;
                  K ? (oe = K.append(G, z)) : (oe = z.def(ee, ".next")),
                    ne || z("if(", oe, "!==", ee, ".cur){"),
                    z(
                      "if(",
                      oe,
                      "){",
                      te,
                      ".bindFramebuffer(",
                      No,
                      ",",
                      oe,
                      ".framebuffer);"
                    ),
                    We &&
                      z(
                        re,
                        ".drawBuffersWEBGL(",
                        Q,
                        "[",
                        oe,
                        ".colorAttachments.length]);"
                      ),
                    z("}else{", te, ".bindFramebuffer(", No, ",null);"),
                    We && z(re, ".drawBuffersWEBGL(", N, ");"),
                    z("}", ee, ".cur=", oe, ";"),
                    ne || z("}");
                }
                function Kt(G, z, K) {
                  var ne = G.shared,
                    ie = ne.gl,
                    te = G.current,
                    ee = G.next,
                    re = ne.current,
                    U = ne.next,
                    Q = G.cond(re, ".dirty");
                  Ue.forEach(function (N) {
                    var oe = Ye(N);
                    if (!(oe in K.state)) {
                      var fe, xe;
                      if (oe in ee) {
                        (fe = ee[oe]), (xe = te[oe]);
                        var Ae = at(nt[oe].length, function (je) {
                          return Q.def(fe, "[", je, "]");
                        });
                        Q(
                          G.cond(
                            Ae.map(function (je, it) {
                              return je + "!==" + xe + "[" + it + "]";
                            }).join("||")
                          ).then(
                            ie,
                            ".",
                            pe[oe],
                            "(",
                            Ae,
                            ");",
                            Ae.map(function (je, it) {
                              return xe + "[" + it + "]=" + je;
                            }).join(";"),
                            ";"
                          )
                        );
                      } else {
                        fe = Q.def(U, ".", oe);
                        var Re = G.cond(fe, "!==", re, ".", oe);
                        Q(Re),
                          oe in be
                            ? Re(
                                G.cond(fe)
                                  .then(ie, ".enable(", be[oe], ");")
                                  .else(ie, ".disable(", be[oe], ");"),
                                re,
                                ".",
                                oe,
                                "=",
                                fe,
                                ";"
                              )
                            : Re(
                                ie,
                                ".",
                                pe[oe],
                                "(",
                                fe,
                                ");",
                                re,
                                ".",
                                oe,
                                "=",
                                fe,
                                ";"
                              );
                      }
                    }
                  }),
                    Object.keys(K.state).length === 0 && Q(re, ".dirty=false;"),
                    z(Q);
                }
                function nr(G, z, K, ne) {
                  var ie = G.shared,
                    te = G.current,
                    ee = ie.current,
                    re = ie.gl;
                  la(Object.keys(K)).forEach(function (U) {
                    var Q = K[U];
                    if (!(ne && !ne(Q))) {
                      var N = Q.append(G, z);
                      if (be[U]) {
                        var oe = be[U];
                        Cr(Q)
                          ? N
                            ? z(re, ".enable(", oe, ");")
                            : z(re, ".disable(", oe, ");")
                          : z(
                              G.cond(N)
                                .then(re, ".enable(", oe, ");")
                                .else(re, ".disable(", oe, ");")
                            ),
                          z(ee, ".", U, "=", N, ";");
                      } else if (yt(N)) {
                        var fe = te[U];
                        z(
                          re,
                          ".",
                          pe[U],
                          "(",
                          N,
                          ");",
                          N.map(function (xe, Ae) {
                            return fe + "[" + Ae + "]=" + xe;
                          }).join(";"),
                          ";"
                        );
                      } else
                        z(
                          re,
                          ".",
                          pe[U],
                          "(",
                          N,
                          ");",
                          ee,
                          ".",
                          U,
                          "=",
                          N,
                          ";"
                        );
                    }
                  });
                }
                function Ut(G, z) {
                  Ce &&
                    (G.instancing = z.def(
                      G.shared.extensions,
                      ".angle_instanced_arrays"
                    ));
                }
                function _t(G, z, K, ne, ie) {
                  var te = G.shared,
                    ee = G.stats,
                    re = te.current,
                    U = te.timer,
                    Q = K.profile;
                  function N() {
                    return typeof performance == "undefined"
                      ? "Date.now()"
                      : "performance.now()";
                  }
                  var oe, fe;
                  function xe(Xe) {
                    (oe = z.def()),
                      Xe(oe, "=", N(), ";"),
                      typeof ie == "string"
                        ? Xe(ee, ".count+=", ie, ";")
                        : Xe(ee, ".count++;"),
                      Ie &&
                        (ne
                          ? ((fe = z.def()),
                            Xe(fe, "=", U, ".getNumPendingQueries();"))
                          : Xe(U, ".beginQuery(", ee, ");"));
                  }
                  function Ae(Xe) {
                    Xe(ee, ".cpuTime+=", N(), "-", oe, ";"),
                      Ie &&
                        (ne
                          ? Xe(
                              U,
                              ".pushScopeStats(",
                              fe,
                              ",",
                              U,
                              ".getNumPendingQueries(),",
                              ee,
                              ");"
                            )
                          : Xe(U, ".endQuery();"));
                  }
                  function Re(Xe) {
                    var Qe = z.def(re, ".profile");
                    z(re, ".profile=", Xe, ";"),
                      z.exit(re, ".profile=", Qe, ";");
                  }
                  var je;
                  if (Q) {
                    if (Cr(Q)) {
                      Q.enable ? (xe(z), Ae(z.exit), Re("true")) : Re("false");
                      return;
                    }
                    (je = Q.append(G, z)), Re(je);
                  } else je = z.def(re, ".profile");
                  var it = G.block();
                  xe(it), z("if(", je, "){", it, "}");
                  var tt = G.block();
                  Ae(tt), z.exit("if(", je, "){", tt, "}");
                }
                function ir(G, z, K, ne, ie) {
                  var te = G.shared;
                  function ee(U) {
                    switch (U) {
                      case Yn:
                      case Zn:
                      case ei:
                        return 2;
                      case Xn:
                      case Kn:
                      case ti:
                        return 3;
                      case Qn:
                      case Jn:
                      case ri:
                        return 4;
                      default:
                        return 1;
                    }
                  }
                  function re(U, Q, N) {
                    var oe = te.gl,
                      fe = z.def(U, ".location"),
                      xe = z.def(te.attributes, "[", fe, "]"),
                      Ae = N.state,
                      Re = N.buffer,
                      je = [N.x, N.y, N.z, N.w],
                      it = ["buffer", "normalized", "offset", "stride"];
                    function tt() {
                      z(
                        "if(!",
                        xe,
                        ".buffer){",
                        oe,
                        ".enableVertexAttribArray(",
                        fe,
                        ");}"
                      );
                      var Qe = N.type,
                        Me;
                      if (
                        (N.size ? (Me = z.def(N.size, "||", Q)) : (Me = Q),
                        z(
                          "if(",
                          xe,
                          ".type!==",
                          Qe,
                          "||",
                          xe,
                          ".size!==",
                          Me,
                          "||",
                          it
                            .map(function (ft) {
                              return xe + "." + ft + "!==" + N[ft];
                            })
                            .join("||"),
                          "){",
                          oe,
                          ".bindBuffer(",
                          rn,
                          ",",
                          Re,
                          ".buffer);",
                          oe,
                          ".vertexAttribPointer(",
                          [fe, Me, Qe, N.normalized, N.stride, N.offset],
                          ");",
                          xe,
                          ".type=",
                          Qe,
                          ";",
                          xe,
                          ".size=",
                          Me,
                          ";",
                          it
                            .map(function (ft) {
                              return xe + "." + ft + "=" + N[ft] + ";";
                            })
                            .join(""),
                          "}"
                        ),
                        Ce)
                      ) {
                        var ve = N.divisor;
                        z(
                          "if(",
                          xe,
                          ".divisor!==",
                          ve,
                          "){",
                          G.instancing,
                          ".vertexAttribDivisorANGLE(",
                          [fe, ve],
                          ");",
                          xe,
                          ".divisor=",
                          ve,
                          ";}"
                        );
                      }
                    }
                    function Xe() {
                      z(
                        "if(",
                        xe,
                        ".buffer){",
                        oe,
                        ".disableVertexAttribArray(",
                        fe,
                        ");",
                        xe,
                        ".buffer=null;",
                        "}if(",
                        Kr.map(function (Qe, Me) {
                          return xe + "." + Qe + "!==" + je[Me];
                        }).join("||"),
                        "){",
                        oe,
                        ".vertexAttrib4f(",
                        fe,
                        ",",
                        je,
                        ");",
                        Kr.map(function (Qe, Me) {
                          return xe + "." + Qe + "=" + je[Me] + ";";
                        }).join(""),
                        "}"
                      );
                    }
                    Ae === Jr
                      ? tt()
                      : Ae === Ii
                      ? Xe()
                      : (z("if(", Ae, "===", Jr, "){"),
                        tt(),
                        z("}else{"),
                        Xe(),
                        z("}"));
                  }
                  ne.forEach(function (U) {
                    var Q = U.name,
                      N = K.attributes[Q],
                      oe;
                    if (N) {
                      if (!ie(N)) return;
                      oe = N.append(G, z);
                    } else {
                      if (!ie(Uo)) return;
                      var fe = G.scopeAttrib(Q);
                      V.optional(function () {
                        G.assert(z, fe + ".state", "missing attribute " + Q);
                      }),
                        (oe = {}),
                        Object.keys(new le()).forEach(function (xe) {
                          oe[xe] = z.def(fe, ".", xe);
                        });
                    }
                    re(G.link(U), ee(U.info.type), oe);
                  });
                }
                function Tt(G, z, K, ne, ie, te) {
                  for (
                    var ee = function (fe) {
                        var xe = ne[fe],
                          Ae = xe.name,
                          Re = xe.info.type,
                          je = xe.info.size,
                          it = K.uniforms[Ae];
                        if (je > 1) {
                          if (!it) return "continue";
                          var tt = Ae.replace("[0]", "");
                          if (Q[tt]) return "continue";
                          Q[tt] = 1;
                        }
                        var Xe = G.link(xe),
                          Qe = Xe + ".location",
                          Me;
                        if (it) {
                          if (!ie(it)) return "continue";
                          if (Cr(it)) {
                            var ve = it.value;
                            if (
                              (V.command(
                                ve !== null && typeof ve != "undefined",
                                'missing uniform "' + Ae + '"',
                                G.commandStr
                              ),
                              Re === Sn || Re === wn)
                            ) {
                              V.command(
                                typeof ve == "function" &&
                                  ((Re === Sn &&
                                    (ve._reglType === "texture2d" ||
                                      ve._reglType === "framebuffer")) ||
                                    (Re === wn &&
                                      (ve._reglType === "textureCube" ||
                                        ve._reglType === "framebufferCube"))),
                                "invalid texture for uniform " + Ae,
                                G.commandStr
                              );
                              var ft = G.link(
                                ve._texture || ve.color[0]._texture
                              );
                              z(U, ".uniform1i(", Qe, ",", ft + ".bind());"),
                                z.exit(ft, ".unbind();");
                            } else if (Re === bn || Re === xn || Re === Cn) {
                              V.optional(function () {
                                V.command(
                                  yt(ve),
                                  "invalid matrix for uniform " + Ae,
                                  G.commandStr
                                ),
                                  V.command(
                                    (Re === bn && ve.length === 4) ||
                                      (Re === xn && ve.length === 9) ||
                                      (Re === Cn && ve.length === 16),
                                    "invalid length for matrix uniform " + Ae,
                                    G.commandStr
                                  );
                              });
                              var Ft = G.global.def(
                                  "new Float32Array([" +
                                    Array.prototype.slice.call(ve) +
                                    "])"
                                ),
                                er = 2;
                              Re === xn ? (er = 3) : Re === Cn && (er = 4),
                                z(
                                  U,
                                  ".uniformMatrix",
                                  er,
                                  "fv(",
                                  Qe,
                                  ",false,",
                                  Ft,
                                  ");"
                                );
                            } else {
                              switch (Re) {
                                case Ki:
                                  je === 1
                                    ? V.commandType(
                                        ve,
                                        "number",
                                        "uniform " + Ae,
                                        G.commandStr
                                      )
                                    : V.command(
                                        yt(ve) && ve.length === je,
                                        "uniform " + Ae,
                                        G.commandStr
                                      ),
                                    (N = "1f");
                                  break;
                                case Yn:
                                  V.command(
                                    yt(ve) &&
                                      ve.length &&
                                      ve.length % 2 === 0 &&
                                      ve.length <= je * 2,
                                    "uniform " + Ae,
                                    G.commandStr
                                  ),
                                    (N = "2f");
                                  break;
                                case Xn:
                                  V.command(
                                    yt(ve) &&
                                      ve.length &&
                                      ve.length % 3 === 0 &&
                                      ve.length <= je * 3,
                                    "uniform " + Ae,
                                    G.commandStr
                                  ),
                                    (N = "3f");
                                  break;
                                case Qn:
                                  V.command(
                                    yt(ve) &&
                                      ve.length &&
                                      ve.length % 4 === 0 &&
                                      ve.length <= je * 4,
                                    "uniform " + Ae,
                                    G.commandStr
                                  ),
                                    (N = "4f");
                                  break;
                                case ea:
                                  je === 1
                                    ? V.commandType(
                                        ve,
                                        "boolean",
                                        "uniform " + Ae,
                                        G.commandStr
                                      )
                                    : V.command(
                                        yt(ve) && ve.length === je,
                                        "uniform " + Ae,
                                        G.commandStr
                                      ),
                                    (N = "1i");
                                  break;
                                case Ji:
                                  je === 1
                                    ? V.commandType(
                                        ve,
                                        "number",
                                        "uniform " + Ae,
                                        G.commandStr
                                      )
                                    : V.command(
                                        yt(ve) && ve.length === je,
                                        "uniform " + Ae,
                                        G.commandStr
                                      ),
                                    (N = "1i");
                                  break;
                                case ei:
                                  V.command(
                                    yt(ve) &&
                                      ve.length &&
                                      ve.length % 2 === 0 &&
                                      ve.length <= je * 2,
                                    "uniform " + Ae,
                                    G.commandStr
                                  ),
                                    (N = "2i");
                                  break;
                                case Zn:
                                  V.command(
                                    yt(ve) &&
                                      ve.length &&
                                      ve.length % 2 === 0 &&
                                      ve.length <= je * 2,
                                    "uniform " + Ae,
                                    G.commandStr
                                  ),
                                    (N = "2i");
                                  break;
                                case ti:
                                  V.command(
                                    yt(ve) &&
                                      ve.length &&
                                      ve.length % 3 === 0 &&
                                      ve.length <= je * 3,
                                    "uniform " + Ae,
                                    G.commandStr
                                  ),
                                    (N = "3i");
                                  break;
                                case Kn:
                                  V.command(
                                    yt(ve) &&
                                      ve.length &&
                                      ve.length % 3 === 0 &&
                                      ve.length <= je * 3,
                                    "uniform " + Ae,
                                    G.commandStr
                                  ),
                                    (N = "3i");
                                  break;
                                case ri:
                                  V.command(
                                    yt(ve) &&
                                      ve.length &&
                                      ve.length % 4 === 0 &&
                                      ve.length <= je * 4,
                                    "uniform " + Ae,
                                    G.commandStr
                                  ),
                                    (N = "4i");
                                  break;
                                case Jn:
                                  V.command(
                                    yt(ve) &&
                                      ve.length &&
                                      ve.length % 4 === 0 &&
                                      ve.length <= je * 4,
                                    "uniform " + Ae,
                                    G.commandStr
                                  ),
                                    (N = "4i");
                                  break;
                              }
                              je > 1
                                ? ((N += "v"),
                                  (ve = G.global.def(
                                    "[" + Array.prototype.slice.call(ve) + "]"
                                  )))
                                : (ve = yt(ve)
                                    ? Array.prototype.slice.call(ve)
                                    : ve),
                                z(U, ".uniform", N, "(", Qe, ",", ve, ");");
                            }
                            return "continue";
                          } else Me = it.append(G, z);
                        } else {
                          if (!ie(Uo)) return "continue";
                          Me = z.def(re.uniforms, "[", B.id(Ae), "]");
                        }
                        Re === Sn
                          ? (V(
                              !Array.isArray(Me),
                              "must specify a scalar prop for textures"
                            ),
                            z(
                              "if(",
                              Me,
                              "&&",
                              Me,
                              '._reglType==="framebuffer"){',
                              Me,
                              "=",
                              Me,
                              ".color[0];",
                              "}"
                            ))
                          : Re === wn &&
                            (V(
                              !Array.isArray(Me),
                              "must specify a scalar prop for cube maps"
                            ),
                            z(
                              "if(",
                              Me,
                              "&&",
                              Me,
                              '._reglType==="framebufferCube"){',
                              Me,
                              "=",
                              Me,
                              ".color[0];",
                              "}"
                            )),
                          V.optional(function () {
                            function dr(lr, ii) {
                              G.assert(
                                z,
                                lr,
                                'bad data or missing for uniform "' +
                                  Ae +
                                  '".  ' +
                                  ii
                              );
                            }
                            function Vr(lr, ii) {
                              ii === 1 &&
                                V(
                                  !Array.isArray(Me),
                                  "must not specify an array type for uniform"
                                ),
                                dr(
                                  "Array.isArray(" +
                                    Me +
                                    ") && typeof " +
                                    Me +
                                    '[0]===" ' +
                                    lr +
                                    '" || typeof ' +
                                    Me +
                                    '==="' +
                                    lr +
                                    '"',
                                  "invalid type, expected " + lr
                                );
                            }
                            function vr(lr, ii, ai) {
                              Array.isArray(Me)
                                ? V(
                                    Me.length &&
                                      Me.length % lr === 0 &&
                                      Me.length <= lr * ai,
                                    "must have length of " +
                                      (ai === 1 ? "" : "n * ") +
                                      lr
                                  )
                                : dr(
                                    re.isArrayLike +
                                      "(" +
                                      Me +
                                      ")&&" +
                                      Me +
                                      ".length && " +
                                      Me +
                                      ".length % " +
                                      lr +
                                      " === 0 && " +
                                      Me +
                                      ".length<=" +
                                      lr * ai,
                                    "invalid vector, should have length of " +
                                      (ai === 1 ? "" : "n * ") +
                                      lr,
                                    G.commandStr
                                  );
                            }
                            function Xo(lr) {
                              V(
                                !Array.isArray(Me),
                                "must not specify a value type"
                              ),
                                dr(
                                  "typeof " +
                                    Me +
                                    '==="function"&&' +
                                    Me +
                                    '._reglType==="texture' +
                                    (lr === Io ? "2d" : "Cube") +
                                    '"',
                                  "invalid texture type",
                                  G.commandStr
                                );
                            }
                            switch (Re) {
                              case Ji:
                                Vr("number", je);
                                break;
                              case Zn:
                                vr(2, "number", je);
                                break;
                              case Kn:
                                vr(3, "number", je);
                                break;
                              case Jn:
                                vr(4, "number", je);
                                break;
                              case Ki:
                                Vr("number", je);
                                break;
                              case Yn:
                                vr(2, "number", je);
                                break;
                              case Xn:
                                vr(3, "number", je);
                                break;
                              case Qn:
                                vr(4, "number", je);
                                break;
                              case ea:
                                Vr("boolean", je);
                                break;
                              case ei:
                                vr(2, "boolean", je);
                                break;
                              case ti:
                                vr(3, "boolean", je);
                                break;
                              case ri:
                                vr(4, "boolean", je);
                                break;
                              case bn:
                                vr(4, "number", je);
                                break;
                              case xn:
                                vr(9, "number", je);
                                break;
                              case Cn:
                                vr(16, "number", je);
                                break;
                              case Sn:
                                Xo(Io);
                                break;
                              case wn:
                                Xo(Ru);
                                break;
                            }
                          });
                        var hr = 1;
                        switch (Re) {
                          case Sn:
                          case wn:
                            var Br = z.def(Me, "._texture");
                            return (
                              z(U, ".uniform1i(", Qe, ",", Br, ".bind());"),
                              z.exit(Br, ".unbind();"),
                              "continue"
                            );
                          case Ji:
                          case ea:
                            N = "1i";
                            break;
                          case Zn:
                          case ei:
                            (N = "2i"), (hr = 2);
                            break;
                          case Kn:
                          case ti:
                            (N = "3i"), (hr = 3);
                            break;
                          case Jn:
                          case ri:
                            (N = "4i"), (hr = 4);
                            break;
                          case Ki:
                            N = "1f";
                            break;
                          case Yn:
                            (N = "2f"), (hr = 2);
                            break;
                          case Xn:
                            (N = "3f"), (hr = 3);
                            break;
                          case Qn:
                            (N = "4f"), (hr = 4);
                            break;
                          case bn:
                            N = "Matrix2fv";
                            break;
                          case xn:
                            N = "Matrix3fv";
                            break;
                          case Cn:
                            N = "Matrix4fv";
                            break;
                        }
                        if (
                          (N.indexOf("Matrix") === -1 &&
                            je > 1 &&
                            ((N += "v"), (hr = 1)),
                          N.charAt(0) === "M")
                        ) {
                          z(U, ".uniform", N, "(", Qe, ",");
                          var _r = Math.pow(Re - bn + 2, 2),
                            Nr = G.global.def("new Float32Array(", _r, ")");
                          Array.isArray(Me)
                            ? z(
                                "false,(",
                                at(_r, function (dr) {
                                  return Nr + "[" + dr + "]=" + Me[dr];
                                }),
                                ",",
                                Nr,
                                ")"
                              )
                            : z(
                                "false,(Array.isArray(",
                                Me,
                                ")||",
                                Me,
                                " instanceof Float32Array)?",
                                Me,
                                ":(",
                                at(_r, function (dr) {
                                  return (
                                    Nr + "[" + dr + "]=" + Me + "[" + dr + "]"
                                  );
                                }),
                                ",",
                                Nr,
                                ")"
                              ),
                            z(");");
                        } else if (hr > 1) {
                          for (var an = [], Pn = [], ni = 0; ni < hr; ++ni)
                            Array.isArray(Me)
                              ? Pn.push(Me[ni])
                              : Pn.push(z.def(Me + "[" + ni + "]")),
                              te && an.push(z.def());
                          te &&
                            z(
                              "if(!",
                              G.batchId,
                              "||",
                              an
                                .map(function (dr, Vr) {
                                  return dr + "!==" + Pn[Vr];
                                })
                                .join("||"),
                              "){",
                              an
                                .map(function (dr, Vr) {
                                  return dr + "=" + Pn[Vr] + ";";
                                })
                                .join("")
                            ),
                            z(
                              U,
                              ".uniform",
                              N,
                              "(",
                              Qe,
                              ",",
                              Pn.join(","),
                              ");"
                            ),
                            te && z("}");
                        } else {
                          if (
                            (V(
                              !Array.isArray(Me),
                              "uniform value must not be an array"
                            ),
                            te)
                          ) {
                            var Yo = z.def();
                            z(
                              "if(!",
                              G.batchId,
                              "||",
                              Yo,
                              "!==",
                              Me,
                              "){",
                              Yo,
                              "=",
                              Me,
                              ";"
                            );
                          }
                          z(U, ".uniform", N, "(", Qe, ",", Me, ");"),
                            te && z("}");
                        }
                      },
                      re = G.shared,
                      U = re.gl,
                      Q = {},
                      N,
                      oe = 0;
                    oe < ne.length;
                    ++oe
                  )
                    ee(oe);
                }
                function lt(G, z, K, ne) {
                  var ie = G.shared,
                    te = ie.gl,
                    ee = ie.draw,
                    re = ne.draw;
                  function U() {
                    var Me = re.elements,
                      ve,
                      ft = z;
                    return (
                      Me
                        ? (((Me.contextDep && ne.contextDynamic) ||
                            Me.propDep) &&
                            (ft = K),
                          (ve = Me.append(G, ft)),
                          re.elementsActive &&
                            ft(
                              "if(" +
                                ve +
                                ")" +
                                te +
                                ".bindBuffer(" +
                                Zi +
                                "," +
                                ve +
                                ".buffer.buffer);"
                            ))
                        : ((ve = ft.def()),
                          ft(
                            ve,
                            "=",
                            ee,
                            ".",
                            kr,
                            ";",
                            "if(",
                            ve,
                            "){",
                            te,
                            ".bindBuffer(",
                            Zi,
                            ",",
                            ve,
                            ".buffer.buffer);}",
                            "else if(",
                            ie.vao,
                            ".currentVAO){",
                            ve,
                            "=",
                            G.shared.elements + ".getElements(" + ie.vao,
                            ".currentVAO.elements);",
                            ye
                              ? ""
                              : "if(" +
                                  ve +
                                  ")" +
                                  te +
                                  ".bindBuffer(" +
                                  Zi +
                                  "," +
                                  ve +
                                  ".buffer.buffer);",
                            "}"
                          )),
                      ve
                    );
                  }
                  function Q() {
                    var Me = re.count,
                      ve,
                      ft = z;
                    return (
                      Me
                        ? (((Me.contextDep && ne.contextDynamic) ||
                            Me.propDep) &&
                            (ft = K),
                          (ve = Me.append(G, ft)),
                          V.optional(function () {
                            Me.MISSING &&
                              G.assert(z, "false", "missing vertex count"),
                              Me.DYNAMIC &&
                                G.assert(
                                  ft,
                                  ve + ">=0",
                                  "missing vertex count"
                                );
                          }))
                        : ((ve = ft.def(ee, ".", zr)),
                          V.optional(function () {
                            G.assert(ft, ve + ">=0", "missing vertex count");
                          })),
                      ve
                    );
                  }
                  var N = U();
                  function oe(Me) {
                    var ve = re[Me];
                    return ve
                      ? (ve.contextDep && ne.contextDynamic) || ve.propDep
                        ? ve.append(G, K)
                        : ve.append(G, z)
                      : z.def(ee, ".", Me);
                  }
                  var fe = oe(Ir),
                    xe = oe(Hn),
                    Ae = Q();
                  if (typeof Ae == "number") {
                    if (Ae === 0) return;
                  } else K("if(", Ae, "){"), K.exit("}");
                  var Re, je;
                  Ce && ((Re = oe(Wn)), (je = G.instancing));
                  var it = N + ".type",
                    tt = re.elements && Cr(re.elements) && !re.vaoActive;
                  function Xe() {
                    function Me() {
                      K(
                        je,
                        ".drawElementsInstancedANGLE(",
                        [fe, Ae, it, xe + "<<((" + it + "-" + po + ")>>1)", Re],
                        ");"
                      );
                    }
                    function ve() {
                      K(
                        je,
                        ".drawArraysInstancedANGLE(",
                        [fe, xe, Ae, Re],
                        ");"
                      );
                    }
                    N && N !== "null"
                      ? tt
                        ? Me()
                        : (K("if(", N, "){"), Me(), K("}else{"), ve(), K("}"))
                      : ve();
                  }
                  function Qe() {
                    function Me() {
                      K(
                        te +
                          ".drawElements(" +
                          [fe, Ae, it, xe + "<<((" + it + "-" + po + ")>>1)"] +
                          ");"
                      );
                    }
                    function ve() {
                      K(te + ".drawArrays(" + [fe, xe, Ae] + ");");
                    }
                    N && N !== "null"
                      ? tt
                        ? Me()
                        : (K("if(", N, "){"), Me(), K("}else{"), ve(), K("}"))
                      : ve();
                  }
                  Ce && (typeof Re != "number" || Re >= 0)
                    ? typeof Re == "string"
                      ? (K("if(", Re, ">0){"),
                        Xe(),
                        K("}else if(", Re, "<0){"),
                        Qe(),
                        K("}"))
                      : Xe()
                    : Qe();
                }
                function gt(G, z, K, ne, ie) {
                  var te = ht(),
                    ee = te.proc("body", ie);
                  return (
                    V.optional(function () {
                      (te.commandStr = z.commandStr),
                        (te.command = te.link(z.commandStr));
                    }),
                    Ce &&
                      (te.instancing = ee.def(
                        te.shared.extensions,
                        ".angle_instanced_arrays"
                      )),
                    G(te, ee, K, ne),
                    te.compile().body
                  );
                }
                function Et(G, z, K, ne) {
                  Ut(G, z),
                    K.useVAO
                      ? K.drawVAO
                        ? z(
                            G.shared.vao,
                            ".setVAO(",
                            K.drawVAO.append(G, z),
                            ");"
                          )
                        : z(
                            G.shared.vao,
                            ".setVAO(",
                            G.shared.vao,
                            ".targetVAO);"
                          )
                      : (z(G.shared.vao, ".setVAO(null);"),
                        ir(G, z, K, ne.attributes, function () {
                          return !0;
                        })),
                    Tt(
                      G,
                      z,
                      K,
                      ne.uniforms,
                      function () {
                        return !0;
                      },
                      !1
                    ),
                    lt(G, z, z, K);
                }
                function Jt(G, z) {
                  var K = G.proc("draw", 1);
                  Ut(G, K),
                    Xt(G, K, z.context),
                    Qt(G, K, z.framebuffer),
                    Kt(G, K, z),
                    nr(G, K, z.state),
                    _t(G, K, z, !1, !0);
                  var ne = z.shader.progVar.append(G, K);
                  if (
                    (K(G.shared.gl, ".useProgram(", ne, ".program);"),
                    z.shader.program)
                  )
                    Et(G, K, z, z.shader.program);
                  else {
                    K(G.shared.vao, ".setVAO(null);");
                    var ie = G.global.def("{}"),
                      te = K.def(ne, ".id"),
                      ee = K.def(ie, "[", te, "]");
                    K(
                      G.cond(ee)
                        .then(ee, ".call(this,a0);")
                        .else(
                          ee,
                          "=",
                          ie,
                          "[",
                          te,
                          "]=",
                          G.link(function (re) {
                            return gt(Et, G, z, re, 1);
                          }),
                          "(",
                          ne,
                          ");",
                          ee,
                          ".call(this,a0);"
                        )
                    );
                  }
                  Object.keys(z.state).length > 0 &&
                    K(G.shared.current, ".dirty=true;"),
                    G.shared.vao && K(G.shared.vao, ".setVAO(null);");
                }
                function or(G, z, K, ne) {
                  (G.batchId = "a1"), Ut(G, z);
                  function ie() {
                    return !0;
                  }
                  ir(G, z, K, ne.attributes, ie),
                    Tt(G, z, K, ne.uniforms, ie, !1),
                    lt(G, z, z, K);
                }
                function Dr(G, z, K, ne) {
                  Ut(G, z);
                  var ie = K.contextDep,
                    te = z.def(),
                    ee = "a0",
                    re = "a1",
                    U = z.def();
                  (G.shared.props = U), (G.batchId = te);
                  var Q = G.scope(),
                    N = G.scope();
                  z(
                    Q.entry,
                    "for(",
                    te,
                    "=0;",
                    te,
                    "<",
                    re,
                    ";++",
                    te,
                    "){",
                    U,
                    "=",
                    ee,
                    "[",
                    te,
                    "];",
                    N,
                    "}",
                    Q.exit
                  );
                  function oe(it) {
                    return (it.contextDep && ie) || it.propDep;
                  }
                  function fe(it) {
                    return !oe(it);
                  }
                  if (
                    (K.needsContext && Xt(G, N, K.context),
                    K.needsFramebuffer && Qt(G, N, K.framebuffer),
                    nr(G, N, K.state, oe),
                    K.profile && oe(K.profile) && _t(G, N, K, !1, !0),
                    ne)
                  )
                    K.useVAO
                      ? K.drawVAO
                        ? oe(K.drawVAO)
                          ? N(
                              G.shared.vao,
                              ".setVAO(",
                              K.drawVAO.append(G, N),
                              ");"
                            )
                          : Q(
                              G.shared.vao,
                              ".setVAO(",
                              K.drawVAO.append(G, Q),
                              ");"
                            )
                        : Q(
                            G.shared.vao,
                            ".setVAO(",
                            G.shared.vao,
                            ".targetVAO);"
                          )
                      : (Q(G.shared.vao, ".setVAO(null);"),
                        ir(G, Q, K, ne.attributes, fe),
                        ir(G, N, K, ne.attributes, oe)),
                      Tt(G, Q, K, ne.uniforms, fe, !1),
                      Tt(G, N, K, ne.uniforms, oe, !0),
                      lt(G, Q, N, K);
                  else {
                    var xe = G.global.def("{}"),
                      Ae = K.shader.progVar.append(G, N),
                      Re = N.def(Ae, ".id"),
                      je = N.def(xe, "[", Re, "]");
                    N(
                      G.shared.gl,
                      ".useProgram(",
                      Ae,
                      ".program);",
                      "if(!",
                      je,
                      "){",
                      je,
                      "=",
                      xe,
                      "[",
                      Re,
                      "]=",
                      G.link(function (it) {
                        return gt(or, G, K, it, 2);
                      }),
                      "(",
                      Ae,
                      ");}",
                      je,
                      ".call(this,a0[",
                      te,
                      "],",
                      te,
                      ");"
                    );
                  }
                }
                function H(G, z) {
                  var K = G.proc("batch", 2);
                  (G.batchId = "0"), Ut(G, K);
                  var ne = !1,
                    ie = !0;
                  Object.keys(z.context).forEach(function (xe) {
                    ne = ne || z.context[xe].propDep;
                  }),
                    ne || (Xt(G, K, z.context), (ie = !1));
                  var te = z.framebuffer,
                    ee = !1;
                  te
                    ? (te.propDep
                        ? (ne = ee = !0)
                        : te.contextDep && ne && (ee = !0),
                      ee || Qt(G, K, te))
                    : Qt(G, K, null),
                    z.state.viewport && z.state.viewport.propDep && (ne = !0);
                  function re(xe) {
                    return (xe.contextDep && ne) || xe.propDep;
                  }
                  Kt(G, K, z),
                    nr(G, K, z.state, function (xe) {
                      return !re(xe);
                    }),
                    (!z.profile || !re(z.profile)) && _t(G, K, z, !1, "a1"),
                    (z.contextDep = ne),
                    (z.needsContext = ie),
                    (z.needsFramebuffer = ee);
                  var U = z.shader.progVar;
                  if ((U.contextDep && ne) || U.propDep) Dr(G, K, z, null);
                  else {
                    var Q = U.append(G, K);
                    if (
                      (K(G.shared.gl, ".useProgram(", Q, ".program);"),
                      z.shader.program)
                    )
                      Dr(G, K, z, z.shader.program);
                    else {
                      K(G.shared.vao, ".setVAO(null);");
                      var N = G.global.def("{}"),
                        oe = K.def(Q, ".id"),
                        fe = K.def(N, "[", oe, "]");
                      K(
                        G.cond(fe)
                          .then(fe, ".call(this,a0,a1);")
                          .else(
                            fe,
                            "=",
                            N,
                            "[",
                            oe,
                            "]=",
                            G.link(function (xe) {
                              return gt(Dr, G, z, xe, 2);
                            }),
                            "(",
                            Q,
                            ");",
                            fe,
                            ".call(this,a0,a1);"
                          )
                      );
                    }
                  }
                  Object.keys(z.state).length > 0 &&
                    K(G.shared.current, ".dirty=true;"),
                    G.shared.vao && K(G.shared.vao, ".setVAO(null);");
                }
                function ce(G, z) {
                  var K = G.proc("scope", 3);
                  G.batchId = "a2";
                  var ne = G.shared,
                    ie = ne.current;
                  Xt(G, K, z.context),
                    z.framebuffer && z.framebuffer.append(G, K),
                    la(Object.keys(z.state)).forEach(function (ee) {
                      var re = z.state[ee],
                        U = re.append(G, K);
                      yt(U)
                        ? U.forEach(function (Q, N) {
                            K.set(G.next[ee], "[" + N + "]", Q);
                          })
                        : K.set(ne.next, "." + ee, U);
                    }),
                    _t(G, K, z, !0, !0),
                    [kr, Hn, zr, Wn, Ir].forEach(function (ee) {
                      var re = z.draw[ee];
                      !re || K.set(ne.draw, "." + ee, "" + re.append(G, K));
                    }),
                    Object.keys(z.uniforms).forEach(function (ee) {
                      var re = z.uniforms[ee].append(G, K);
                      Array.isArray(re) && (re = "[" + re.join() + "]"),
                        K.set(ne.uniforms, "[" + B.id(ee) + "]", re);
                    }),
                    Object.keys(z.attributes).forEach(function (ee) {
                      var re = z.attributes[ee].append(G, K),
                        U = G.scopeAttrib(ee);
                      Object.keys(new le()).forEach(function (Q) {
                        K.set(U, "." + Q, re[Q]);
                      });
                    }),
                    z.scopeVAO &&
                      K.set(ne.vao, ".targetVAO", z.scopeVAO.append(G, K));
                  function te(ee) {
                    var re = z.shader[ee];
                    re && K.set(ne.shader, "." + ee, re.append(G, K));
                  }
                  te(gn),
                    te(yn),
                    Object.keys(z.state).length > 0 &&
                      (K(ie, ".dirty=true;"), K.exit(ie, ".dirty=true;")),
                    K("a1(", G.shared.context, ",a0,", G.batchId, ");");
                }
                function ae(G) {
                  if (!(typeof G != "object" || yt(G))) {
                    for (var z = Object.keys(G), K = 0; K < z.length; ++K)
                      if (fr.isDynamic(G[z[K]])) return !0;
                    return !1;
                  }
                }
                function Ze(G, z, K) {
                  var ne = z.static[K];
                  if (!ne || !ae(ne)) return;
                  var ie = G.global,
                    te = Object.keys(ne),
                    ee = !1,
                    re = !1,
                    U = !1,
                    Q = G.global.def("{}");
                  te.forEach(function (oe) {
                    var fe = ne[oe];
                    if (fr.isDynamic(fe)) {
                      typeof fe == "function" && (fe = ne[oe] = fr.unbox(fe));
                      var xe = sr(fe, null);
                      (ee = ee || xe.thisDep),
                        (U = U || xe.propDep),
                        (re = re || xe.contextDep);
                    } else {
                      switch (
                        (ie(Q, ".", oe, "="),
                        typeof fe == "undefined" ? "undefined" : _typeof$2(fe))
                      ) {
                        case "number":
                          ie(fe);
                          break;
                        case "string":
                          ie('"', fe, '"');
                          break;
                        case "object":
                          Array.isArray(fe) && ie("[", fe.join(), "]");
                          break;
                        default:
                          ie(G.link(fe));
                          break;
                      }
                      ie(";");
                    }
                  });
                  function N(oe, fe) {
                    te.forEach(function (xe) {
                      var Ae = ne[xe];
                      if (!!fr.isDynamic(Ae)) {
                        var Re = oe.invoke(fe, Ae);
                        fe(Q, ".", xe, "=", Re, ";");
                      }
                    });
                  }
                  (z.dynamic[K] = new fr.DynamicVariable(jn, {
                    thisDep: ee,
                    contextDep: re,
                    propDep: U,
                    ref: Q,
                    append: N,
                  })),
                    delete z.static[K];
                }
                function bt(G, z, K, ne, ie) {
                  var te = ht();
                  (te.stats = te.link(ie)),
                    Object.keys(z.static).forEach(function (re) {
                      Ze(te, z, re);
                    }),
                    Lu.forEach(function (re) {
                      Ze(te, G, re);
                    });
                  var ee = Ht(G, z, K, ne, te);
                  return (
                    Jt(te, ee),
                    ce(te, ee),
                    H(te, ee),
                    Gt(te.compile(), {
                      destroy: function () {
                        ee.shader.program.destroy();
                      },
                    })
                  );
                }
                return {
                  next: Je,
                  current: nt,
                  procs: (function () {
                    var G = ht(),
                      z = G.proc("poll"),
                      K = G.proc("refresh"),
                      ne = G.block();
                    z(ne), K(ne);
                    var ie = G.shared,
                      te = ie.gl,
                      ee = ie.next,
                      re = ie.current;
                    ne(re, ".dirty=false;"), Qt(G, z), Qt(G, K, null, !0);
                    var U;
                    Ce && (U = G.link(Ce)),
                      Y.oes_vertex_array_object &&
                        K(
                          G.link(Y.oes_vertex_array_object),
                          ".bindVertexArrayOES(null);"
                        );
                    for (var Q = 0; Q < ue.maxAttributes; ++Q) {
                      var N = K.def(ie.attributes, "[", Q, "]"),
                        oe = G.cond(N, ".buffer");
                      oe
                        .then(
                          te,
                          ".enableVertexAttribArray(",
                          Q,
                          ");",
                          te,
                          ".bindBuffer(",
                          rn,
                          ",",
                          N,
                          ".buffer.buffer);",
                          te,
                          ".vertexAttribPointer(",
                          Q,
                          ",",
                          N,
                          ".size,",
                          N,
                          ".type,",
                          N,
                          ".normalized,",
                          N,
                          ".stride,",
                          N,
                          ".offset);"
                        )
                        .else(
                          te,
                          ".disableVertexAttribArray(",
                          Q,
                          ");",
                          te,
                          ".vertexAttrib4f(",
                          Q,
                          ",",
                          N,
                          ".x,",
                          N,
                          ".y,",
                          N,
                          ".z,",
                          N,
                          ".w);",
                          N,
                          ".buffer=null;"
                        ),
                        K(oe),
                        Ce &&
                          K(
                            U,
                            ".vertexAttribDivisorANGLE(",
                            Q,
                            ",",
                            N,
                            ".divisor);"
                          );
                    }
                    return (
                      K(
                        G.shared.vao,
                        ".currentVAO=null;",
                        G.shared.vao,
                        ".setVAO(",
                        G.shared.vao,
                        ".targetVAO);"
                      ),
                      Object.keys(be).forEach(function (fe) {
                        var xe = be[fe],
                          Ae = ne.def(ee, ".", fe),
                          Re = G.block();
                        Re(
                          "if(",
                          Ae,
                          "){",
                          te,
                          ".enable(",
                          xe,
                          ")}else{",
                          te,
                          ".disable(",
                          xe,
                          ")}",
                          re,
                          ".",
                          fe,
                          "=",
                          Ae,
                          ";"
                        ),
                          K(Re),
                          z("if(", Ae, "!==", re, ".", fe, "){", Re, "}");
                      }),
                      Object.keys(pe).forEach(function (fe) {
                        var xe = pe[fe],
                          Ae = nt[fe],
                          Re,
                          je,
                          it = G.block();
                        if ((it(te, ".", xe, "("), yt(Ae))) {
                          var tt = Ae.length;
                          (Re = G.global.def(ee, ".", fe)),
                            (je = G.global.def(re, ".", fe)),
                            it(
                              at(tt, function (Xe) {
                                return Re + "[" + Xe + "]";
                              }),
                              ");",
                              at(tt, function (Xe) {
                                return (
                                  je + "[" + Xe + "]=" + Re + "[" + Xe + "];"
                                );
                              }).join("")
                            ),
                            z(
                              "if(",
                              at(tt, function (Xe) {
                                return (
                                  Re + "[" + Xe + "]!==" + je + "[" + Xe + "]"
                                );
                              }).join("||"),
                              "){",
                              it,
                              "}"
                            );
                        } else (Re = ne.def(ee, ".", fe)), (je = ne.def(re, ".", fe)), it(Re, ");", re, ".", fe, "=", Re, ";"), z("if(", Re, "!==", je, "){", it, "}");
                        K(it);
                      }),
                      G.compile()
                    );
                  })(),
                  compile: bt,
                };
              },
              ss = function () {
                return {
                  vaoCount: 0,
                  bufferCount: 0,
                  elementsCount: 0,
                  framebufferCount: 0,
                  shaderCount: 0,
                  textureCount: 0,
                  cubeCount: 0,
                  renderbufferCount: 0,
                  maxTextureUnits: 0,
                };
              },
              ua = function (C, B) {
                for (var Y = 0; Y < C.length; ++Y) if (C[Y] === B) return Y;
                return -1;
              },
              ls = function (C) {
                var B = Mt(C);
                if (!B) return null;
                var Y = B.gl,
                  ue = Y.getContextAttributes(),
                  me = Y.isContextLost(),
                  he = ot(Y, B);
                if (!he) return null;
                var _e = we(),
                  Pe = ss(),
                  Le = he.extensions,
                  Oe = Qu(Y, Le),
                  ze = ya(),
                  $e = Y.drawingBufferWidth,
                  ke = Y.drawingBufferHeight,
                  Ie = {
                    tick: 0,
                    time: 0,
                    viewportWidth: $e,
                    viewportHeight: ke,
                    framebufferWidth: $e,
                    framebufferHeight: ke,
                    drawingBufferWidth: $e,
                    drawingBufferHeight: ke,
                    pixelRatio: B.pixelRatio,
                  },
                  Ee = {},
                  le = {
                    elements: null,
                    primitive: 4,
                    count: -1,
                    offset: 0,
                    instances: -1,
                  },
                  se = ul(Y, Le),
                  Ce = Wt(Y, Pe, B, nt),
                  We = Vt(Y, Le, Ce, Pe),
                  ye = rs(Y, Le, se, Pe, Ce, We, le);
                function nt(lt) {
                  return ye.destroyBuffer(lt);
                }
                var Je = ns(Y, _e, Pe, B),
                  Ue = es(
                    Y,
                    Le,
                    se,
                    function () {
                      Ye.procs.poll();
                    },
                    Ie,
                    Pe,
                    B
                  ),
                  be = ru(Y, Le, se, Pe, B),
                  pe = ts(Y, Le, se, Ue, be, Pe),
                  Ye = os(
                    Y,
                    _e,
                    Le,
                    se,
                    Ce,
                    We,
                    Ue,
                    pe,
                    Ee,
                    ye,
                    Je,
                    le,
                    Ie,
                    Oe,
                    B
                  ),
                  Be = is(Y, pe, Ye.procs.poll, Ie, ue, Le, se),
                  Te = Ye.next,
                  De = Y.canvas,
                  Ne = [],
                  dt = [],
                  ht = [],
                  Ve = [B.onDestroy],
                  Ge = null;
                function st() {
                  if (Ne.length === 0) {
                    Oe && Oe.update(), (Ge = null);
                    return;
                  }
                  (Ge = ui.next(st)), nr();
                  for (var lt = Ne.length - 1; lt >= 0; --lt) {
                    var gt = Ne[lt];
                    gt && gt(Ie, null, 0);
                  }
                  Y.flush(), Oe && Oe.update();
                }
                function pt() {
                  !Ge && Ne.length > 0 && (Ge = ui.next(st));
                }
                function Ct() {
                  Ge && (ui.cancel(st), (Ge = null));
                }
                function Dt(lt) {
                  lt.preventDefault(),
                    (me = !0),
                    Ct(),
                    dt.forEach(function (gt) {
                      gt();
                    });
                }
                function Nt(lt) {
                  Y.getError(),
                    (me = !1),
                    he.restore(),
                    Je.restore(),
                    Ce.restore(),
                    Ue.restore(),
                    be.restore(),
                    pe.restore(),
                    ye.restore(),
                    Oe && Oe.restore(),
                    Ye.procs.refresh(),
                    pt(),
                    ht.forEach(function (gt) {
                      gt();
                    });
                }
                De &&
                  (De.addEventListener(qo, Dt, !1),
                  De.addEventListener(Ho, Nt, !1));
                function St() {
                  (Ne.length = 0),
                    Ct(),
                    De &&
                      (De.removeEventListener(qo, Dt),
                      De.removeEventListener(Ho, Nt)),
                    Je.clear(),
                    pe.clear(),
                    be.clear(),
                    ye.clear(),
                    Ue.clear(),
                    We.clear(),
                    Ce.clear(),
                    Oe && Oe.clear(),
                    Ve.forEach(function (lt) {
                      lt();
                    });
                }
                function Yt(lt) {
                  V(!!lt, "invalid args to regl({...})"),
                    V.type(lt, "object", "invalid args to regl({...})");
                  function gt(ie) {
                    var te = Gt({}, ie);
                    delete te.uniforms,
                      delete te.attributes,
                      delete te.context,
                      delete te.vao,
                      "stencil" in te &&
                        te.stencil.op &&
                        ((te.stencil.opBack = te.stencil.opFront =
                          te.stencil.op),
                        delete te.stencil.op);
                    function ee(re) {
                      if (re in te) {
                        var U = te[re];
                        delete te[re],
                          Object.keys(U).forEach(function (Q) {
                            te[re + "." + Q] = U[Q];
                          });
                      }
                    }
                    return (
                      ee("blend"),
                      ee("depth"),
                      ee("cull"),
                      ee("stencil"),
                      ee("polygonOffset"),
                      ee("scissor"),
                      ee("sample"),
                      "vao" in ie && (te.vao = ie.vao),
                      te
                    );
                  }
                  function Et(ie, te) {
                    var ee = {},
                      re = {};
                    return (
                      Object.keys(ie).forEach(function (U) {
                        var Q = ie[U];
                        if (fr.isDynamic(Q)) {
                          re[U] = fr.unbox(Q, U);
                          return;
                        } else if (te && Array.isArray(Q)) {
                          for (var N = 0; N < Q.length; ++N)
                            if (fr.isDynamic(Q[N])) {
                              re[U] = fr.unbox(Q, U);
                              return;
                            }
                        }
                        ee[U] = Q;
                      }),
                      { dynamic: re, static: ee }
                    );
                  }
                  var Jt = Et(lt.context || {}, !0),
                    or = Et(lt.uniforms || {}, !0),
                    Dr = Et(lt.attributes || {}, !1),
                    H = Et(gt(lt), !1),
                    ce = { gpuTime: 0, cpuTime: 0, count: 0 },
                    ae = Ye.compile(H, Dr, or, Jt, ce),
                    Ze = ae.draw,
                    bt = ae.batch,
                    G = ae.scope,
                    z = [];
                  function K(ie) {
                    for (; z.length < ie; ) z.push(null);
                    return z;
                  }
                  function ne(ie, te) {
                    var ee;
                    if (
                      (me && V.raise("context lost"), typeof ie == "function")
                    )
                      return G.call(this, null, ie, 0);
                    if (typeof te == "function")
                      if (typeof ie == "number")
                        for (ee = 0; ee < ie; ++ee) G.call(this, null, te, ee);
                      else if (Array.isArray(ie))
                        for (ee = 0; ee < ie.length; ++ee)
                          G.call(this, ie[ee], te, ee);
                      else return G.call(this, ie, te, 0);
                    else if (typeof ie == "number") {
                      if (ie > 0) return bt.call(this, K(ie | 0), ie | 0);
                    } else if (Array.isArray(ie)) {
                      if (ie.length) return bt.call(this, ie, ie.length);
                    } else return Ze.call(this, ie);
                  }
                  return Gt(ne, {
                    stats: ce,
                    destroy: function () {
                      ae.destroy();
                    },
                  });
                }
                var zt = (pe.setFBO = Yt({
                  framebuffer: fr.define.call(null, Wo, "framebuffer"),
                }));
                function Ht(lt, gt) {
                  var Et = 0;
                  Ye.procs.poll();
                  var Jt = gt.color;
                  Jt &&
                    (Y.clearColor(
                      +Jt[0] || 0,
                      +Jt[1] || 0,
                      +Jt[2] || 0,
                      +Jt[3] || 0
                    ),
                    (Et |= Zu)),
                    "depth" in gt && (Y.clearDepth(+gt.depth), (Et |= Ku)),
                    "stencil" in gt &&
                      (Y.clearStencil(gt.stencil | 0), (Et |= Ju)),
                    V(!!Et, "called regl.clear with no buffer specified"),
                    Y.clear(Et);
                }
                function Xt(lt) {
                  if (
                    (V(
                      typeof lt == "object" && lt,
                      "regl.clear() takes an object as input"
                    ),
                    "framebuffer" in lt)
                  )
                    if (
                      lt.framebuffer &&
                      lt.framebuffer_reglType === "framebufferCube"
                    )
                      for (var gt = 0; gt < 6; ++gt)
                        zt(
                          Gt({ framebuffer: lt.framebuffer.faces[gt] }, lt),
                          Ht
                        );
                    else zt(lt, Ht);
                  else Ht(null, lt);
                }
                function Qt(lt) {
                  V.type(
                    lt,
                    "function",
                    "regl.frame() callback must be a function"
                  ),
                    Ne.push(lt);
                  function gt() {
                    var Et = ua(Ne, lt);
                    V(Et >= 0, "cannot cancel a frame twice");
                    function Jt() {
                      var or = ua(Ne, Jt);
                      (Ne[or] = Ne[Ne.length - 1]),
                        (Ne.length -= 1),
                        Ne.length <= 0 && Ct();
                    }
                    Ne[Et] = Jt;
                  }
                  return pt(), { cancel: gt };
                }
                function Kt() {
                  var lt = Te.viewport,
                    gt = Te.scissor_box;
                  (lt[0] = lt[1] = gt[0] = gt[1] = 0),
                    (Ie.viewportWidth =
                      Ie.framebufferWidth =
                      Ie.drawingBufferWidth =
                      lt[2] =
                      gt[2] =
                        Y.drawingBufferWidth),
                    (Ie.viewportHeight =
                      Ie.framebufferHeight =
                      Ie.drawingBufferHeight =
                      lt[3] =
                      gt[3] =
                        Y.drawingBufferHeight);
                }
                function nr() {
                  (Ie.tick += 1), (Ie.time = _t()), Kt(), Ye.procs.poll();
                }
                function Ut() {
                  Ue.refresh(), Kt(), Ye.procs.refresh(), Oe && Oe.update();
                }
                function _t() {
                  return (ya() - ze) / 1e3;
                }
                Ut();
                function ir(lt, gt) {
                  V.type(
                    gt,
                    "function",
                    "listener callback must be a function"
                  );
                  var Et;
                  switch (lt) {
                    case "frame":
                      return Qt(gt);
                    case "lost":
                      Et = dt;
                      break;
                    case "restore":
                      Et = ht;
                      break;
                    case "destroy":
                      Et = Ve;
                      break;
                    default:
                      V.raise(
                        "invalid event, must be one of frame,lost,restore,destroy"
                      );
                  }
                  return (
                    Et.push(gt),
                    {
                      cancel: function () {
                        for (var or = 0; or < Et.length; ++or)
                          if (Et[or] === gt) {
                            (Et[or] = Et[Et.length - 1]), Et.pop();
                            return;
                          }
                      },
                    }
                  );
                }
                var Tt = Gt(Yt, {
                  clear: Xt,
                  prop: fr.define.bind(null, Wo),
                  context: fr.define.bind(null, tf),
                  this: fr.define.bind(null, rf),
                  draw: Yt({}),
                  buffer: function (gt) {
                    return Ce.create(gt, ef, !1, !1);
                  },
                  elements: function (gt) {
                    return We.create(gt, !1);
                  },
                  texture: Ue.create2D,
                  cube: Ue.createCube,
                  renderbuffer: be.create,
                  framebuffer: pe.create,
                  framebufferCube: pe.createCube,
                  vao: ye.createVAO,
                  attributes: ue,
                  frame: Qt,
                  on: ir,
                  limits: se,
                  hasExtension: function (gt) {
                    return se.extensions.indexOf(gt.toLowerCase()) >= 0;
                  },
                  read: Be,
                  destroy: St,
                  _gl: Y,
                  _refresh: Ut,
                  poll: function () {
                    nr(), Oe && Oe.update();
                  },
                  now: _t,
                  stats: Pe,
                });
                return B.onDone(null, Tt), Tt;
              },
              tr = function (C) {
                return (
                  _instanceof$2(C, Uint8Array) ||
                  _instanceof$2(C, Uint16Array) ||
                  _instanceof$2(C, Uint32Array) ||
                  _instanceof$2(C, Int8Array) ||
                  _instanceof$2(C, Int16Array) ||
                  _instanceof$2(C, Int32Array) ||
                  _instanceof$2(C, Float32Array) ||
                  _instanceof$2(C, Float64Array) ||
                  _instanceof$2(C, Uint8ClampedArray)
                );
              },
              Gt = function (C, B) {
                for (var Y = Object.keys(B), ue = 0; ue < Y.length; ++ue)
                  C[Y[ue]] = B[Y[ue]];
                return C;
              },
              $r = "\n",
              fa = [
                "gl",
                "canvas",
                "container",
                "attributes",
                "pixelRatio",
                "extensions",
                "optionalExtensions",
                "profile",
                "onDone",
              ],
              On = 33071,
              ca = 9728,
              us = 9984,
              fs = 9985,
              cs = 9986,
              hs = 9987,
              ds = 5120,
              ps = 5121,
              vs = 5122,
              ms = 5123,
              gs = 5124,
              ys = 5125,
              ha = 5126,
              da = 32819,
              pa = 32820,
              va = 33635,
              ma = 34042,
              _s = 36193,
              ur = {};
            (ur[ds] = ur[ps] = 1),
              (ur[vs] = ur[ms] = ur[_s] = ur[va] = ur[da] = ur[pa] = 2),
              (ur[gs] = ur[ys] = ur[ha] = ur[ma] = 4);
            var V = Gt(a, {
                optional: $,
                raise: s,
                commandRaise: j,
                command: L,
                parameter: l,
                commandParameter: T,
                constructor: d,
                type: c,
                commandType: A,
                isTypedArray: u,
                nni: h,
                oneOf: p,
                shaderError: F,
                linkError: X,
                callSite: b,
                saveCommandRef: W,
                saveDrawInfo: Z,
                framebufferFormat: R,
                guessCommand: _,
                texture2D: O,
                textureCube: E,
              }),
              bs = 0,
              xs = 0,
              Cs = 5,
              Ss = 6;
            function sn(ge) {
              if (ge.length === 0) return [];
              var C = ge.charAt(0),
                B = ge.charAt(ge.length - 1);
              if (ge.length > 1 && C === B && (C === '"' || C === "'"))
                return ['"' + D(ge.substr(1, ge.length - 2)) + '"'];
              var Y = /\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(ge);
              if (Y)
                return sn(ge.substr(0, Y.index))
                  .concat(sn(Y[1]))
                  .concat(sn(ge.substr(Y.index + Y[0].length)));
              var ue = ge.split(".");
              if (ue.length === 1) return ['"' + D(ge) + '"'];
              for (var me = [], he = 0; he < ue.length; ++he)
                me = me.concat(sn(ue[he]));
              return me;
            }
            function ga(ge, C) {
              if (typeof ge == "function") return new k(xs, ge);
              if (typeof ge == "number" || typeof ge == "boolean")
                return new k(Cs, ge);
              if (Array.isArray(ge))
                return new k(
                  Ss,
                  ge.map(function (B, Y) {
                    return ga(B, C + "[" + Y + "]");
                  })
                );
              if (_instanceof$2(ge, k)) return ge;
              V(!1, "invalid option type in uniform " + C);
            }
            var fr = {
                DynamicVariable: k,
                define: J,
                isDynamic: de,
                unbox: ga,
                accessor: q,
              },
              ui = {
                next:
                  typeof requestAnimationFrame == "function"
                    ? function (ge) {
                        return requestAnimationFrame(ge);
                      }
                    : function (ge) {
                        return setTimeout(ge, 16);
                      },
                cancel:
                  typeof cancelAnimationFrame == "function"
                    ? function (ge) {
                        return cancelAnimationFrame(ge);
                      }
                    : clearTimeout,
              },
              ya =
                typeof performance != "undefined" && performance.now
                  ? function () {
                      return performance.now();
                    }
                  : function () {
                      return +new Date();
                    },
              ws = 5120,
              As = 5121,
              Ps = 5122,
              Es = 5123,
              $s = 5124,
              Os = 5125,
              Ls = 5126,
              qt = Rt();
            qt.zero = Rt();
            var Ts = 3408,
              Ms = 3410,
              Rs = 3411,
              ks = 3412,
              Is = 3413,
              zs = 3414,
              Fs = 3415,
              Ds = 33901,
              Bs = 33902,
              Ns = 3379,
              Vs = 3386,
              Gs = 34921,
              Us = 36347,
              js = 36348,
              qs = 35661,
              Hs = 35660,
              Ws = 34930,
              Ys = 36349,
              Xs = 34076,
              Qs = 34024,
              Zs = 7936,
              Ks = 7937,
              Js = 7938,
              el = 35724,
              tl = 34047,
              rl = 36063,
              nl = 34852,
              Ln = 3553,
              _a = 34067,
              il = 34069,
              al = 33984,
              un = 6408,
              fi = 5126,
              ba = 5121,
              ci = 36160,
              ol = 36053,
              sl = 36064,
              ll = 16384,
              ul = function (C, B) {
                var Y = 1;
                B.ext_texture_filter_anisotropic && (Y = C.getParameter(tl));
                var ue = 1,
                  me = 1;
                B.webgl_draw_buffers &&
                  ((ue = C.getParameter(nl)), (me = C.getParameter(rl)));
                var he = !!B.oes_texture_float;
                if (he) {
                  var _e = C.createTexture();
                  C.bindTexture(Ln, _e),
                    C.texImage2D(Ln, 0, un, 1, 1, 0, un, fi, null);
                  var Pe = C.createFramebuffer();
                  if (
                    (C.bindFramebuffer(ci, Pe),
                    C.framebufferTexture2D(ci, sl, Ln, _e, 0),
                    C.bindTexture(Ln, null),
                    C.checkFramebufferStatus(ci) !== ol)
                  )
                    he = !1;
                  else {
                    C.viewport(0, 0, 1, 1),
                      C.clearColor(1, 0, 0, 1),
                      C.clear(ll);
                    var Le = qt.allocType(fi, 4);
                    C.readPixels(0, 0, 1, 1, un, fi, Le),
                      C.getError()
                        ? (he = !1)
                        : (C.deleteFramebuffer(Pe),
                          C.deleteTexture(_e),
                          (he = Le[0] === 1)),
                      qt.freeType(Le);
                  }
                }
                var Oe =
                    typeof navigator != "undefined" &&
                    (/MSIE/.test(navigator.userAgent) ||
                      /Trident\//.test(navigator.appVersion) ||
                      /Edge/.test(navigator.userAgent)),
                  ze = !0;
                if (!Oe) {
                  var $e = C.createTexture(),
                    ke = qt.allocType(ba, 36);
                  C.activeTexture(al),
                    C.bindTexture(_a, $e),
                    C.texImage2D(il, 0, un, 3, 3, 0, un, ba, ke),
                    qt.freeType(ke),
                    C.bindTexture(_a, null),
                    C.deleteTexture($e),
                    (ze = !C.getError());
                }
                return {
                  colorBits: [
                    C.getParameter(Ms),
                    C.getParameter(Rs),
                    C.getParameter(ks),
                    C.getParameter(Is),
                  ],
                  depthBits: C.getParameter(zs),
                  stencilBits: C.getParameter(Fs),
                  subpixelBits: C.getParameter(Ts),
                  extensions: Object.keys(B).filter(function (Ie) {
                    return !!B[Ie];
                  }),
                  maxAnisotropic: Y,
                  maxDrawbuffers: ue,
                  maxColorAttachments: me,
                  pointSizeDims: C.getParameter(Ds),
                  lineWidthDims: C.getParameter(Bs),
                  maxViewportDims: C.getParameter(Vs),
                  maxCombinedTextureUnits: C.getParameter(qs),
                  maxCubeMapSize: C.getParameter(Xs),
                  maxRenderbufferSize: C.getParameter(Qs),
                  maxTextureUnits: C.getParameter(Ws),
                  maxTextureSize: C.getParameter(Ns),
                  maxAttributes: C.getParameter(Gs),
                  maxVertexUniforms: C.getParameter(Us),
                  maxVertexTextureUnits: C.getParameter(Hs),
                  maxVaryingVectors: C.getParameter(js),
                  maxFragmentUniforms: C.getParameter(Ys),
                  glsl: C.getParameter(el),
                  renderer: C.getParameter(Ks),
                  vendor: C.getParameter(Zs),
                  version: C.getParameter(Js),
                  readFloat: he,
                  npotTextureCube: ze,
                };
              },
              cr = function (C) {
                return Object.keys(C).map(function (B) {
                  return C[B];
                });
              },
              Tn = { shape: ut, flatten: At };
            function xa(ge, C, B, Y, ue) {
              for (var me = 1, he = B + 1; he < C.length; ++he) me *= C[he];
              var _e = C[B];
              if (C.length - B === 4) {
                var Pe = C[B + 1],
                  Le = C[B + 2],
                  Oe = C[B + 3];
                for (he = 0; he < _e; ++he)
                  Pt(ge[he], Pe, Le, Oe, Y, ue), (ue += me);
              } else for (he = 0; he < _e; ++he) xa(ge[he], C, B + 1, Y, ue), (ue += me);
            }
            var hi = {
                "[object Int8Array]": 5120,
                "[object Int16Array]": 5122,
                "[object Int32Array]": 5124,
                "[object Uint8Array]": 5121,
                "[object Uint8ClampedArray]": 5121,
                "[object Uint16Array]": 5123,
                "[object Uint32Array]": 5125,
                "[object Float32Array]": 5126,
                "[object Float64Array]": 5121,
                "[object ArrayBuffer]": 5121,
              },
              fl = 5120,
              cl = 5122,
              hl = 5124,
              dl = 5121,
              pl = 5123,
              vl = 5125,
              ml = 5126,
              gl = 5126,
              Or = {
                int8: fl,
                int16: cl,
                int32: hl,
                uint8: dl,
                uint16: pl,
                uint32: vl,
                float: ml,
                float32: gl,
              },
              yl = 35048,
              _l = 35040,
              Mn = { dynamic: yl, stream: _l, static: 35044 },
              di = Tn.flatten,
              Ca = Tn.shape,
              Sa = 35044,
              bl = 35040,
              pi = 5121,
              vi = 5126,
              Sr = [];
            (Sr[5120] = 1),
              (Sr[5122] = 2),
              (Sr[5124] = 4),
              (Sr[5121] = 1),
              (Sr[5123] = 2),
              (Sr[5125] = 4),
              (Sr[5126] = 4);
            var xl = 0,
              Cl = 0,
              Sl = 1,
              wl = 1,
              Al = 4,
              Pl = 4,
              wr = {
                points: xl,
                point: Cl,
                lines: Sl,
                line: wl,
                triangles: Al,
                triangle: Pl,
                "line loop": 2,
                "line strip": 3,
                "triangle strip": 5,
                "triangle fan": 6,
              },
              El = 0,
              $l = 1,
              fn = 4,
              Ol = 5120,
              Hr = 5121,
              wa = 5122,
              Wr = 5123,
              Aa = 5124,
              Lr = 5125,
              mi = 34963,
              Ll = 35040,
              Tl = 35044,
              Pa = new Float32Array(1),
              Ml = new Uint32Array(Pa.buffer),
              Rl = 5123,
              Ea = function (C) {
                return !(C & (C - 1)) && !!C;
              },
              kl = 34467,
              gr = 3553,
              gi = 34067,
              Rn = 34069,
              Tr = 6408,
              yi = 6406,
              kn = 6407,
              cn = 6409,
              In = 6410,
              $a = 32854,
              _i = 32855,
              Oa = 36194,
              Il = 32819,
              zl = 32820,
              Fl = 33635,
              Dl = 34042,
              bi = 6402,
              zn = 34041,
              xi = 35904,
              Ci = 35906,
              Yr = 36193,
              Si = 33776,
              wi = 33777,
              Ai = 33778,
              Pi = 33779,
              La = 35986,
              Ta = 35987,
              Ma = 34798,
              Ra = 35840,
              ka = 35841,
              Ia = 35842,
              za = 35843,
              Fa = 36196,
              Xr = 5121,
              Ei = 5123,
              $i = 5125,
              hn = 5126,
              Bl = 10242,
              Nl = 10243,
              Vl = 10497,
              Oi = 33071,
              Gl = 33648,
              Ul = 10240,
              jl = 10241,
              Li = 9728,
              ql = 9729,
              Ti = 9984,
              Da = 9985,
              Ba = 9986,
              Mi = 9987,
              Hl = 33170,
              Fn = 4352,
              Wl = 4353,
              Yl = 4354,
              Xl = 34046,
              Ql = 3317,
              Zl = 37440,
              Kl = 37441,
              Jl = 37443,
              Na = 37444,
              dn = 33984,
              eu = [Ti, Ba, Da, Mi],
              Dn = [0, cn, In, kn, Tr],
              pr = {};
            (pr[cn] = pr[yi] = pr[bi] = 1),
              (pr[zn] = pr[In] = 2),
              (pr[kn] = pr[xi] = 3),
              (pr[Tr] = pr[Ci] = 4);
            var Va = xt("HTMLCanvasElement"),
              Ga = xt("OffscreenCanvas"),
              Ua = xt("CanvasRenderingContext2D"),
              ja = xt("ImageBitmap"),
              qa = xt("HTMLImageElement"),
              Ha = xt("HTMLVideoElement"),
              tu = Object.keys(hi).concat([Va, Ga, Ua, ja, qa, Ha]),
              Qr = [];
            (Qr[Xr] = 1),
              (Qr[hn] = 4),
              (Qr[Yr] = 2),
              (Qr[Ei] = 2),
              (Qr[$i] = 4);
            var rr = [];
            (rr[$a] = 2),
              (rr[_i] = 2),
              (rr[Oa] = 2),
              (rr[zn] = 4),
              (rr[Si] = 0.5),
              (rr[wi] = 0.5),
              (rr[Ai] = 1),
              (rr[Pi] = 1),
              (rr[La] = 0.5),
              (rr[Ta] = 1),
              (rr[Ma] = 1),
              (rr[Ra] = 0.5),
              (rr[ka] = 0.25),
              (rr[Ia] = 0.5),
              (rr[za] = 0.25),
              (rr[Fa] = 0.5);
            var Ar = 36161,
              Bn = 32854,
              Wa = 32855,
              Ya = 36194,
              Xa = 33189,
              Qa = 36168,
              Za = 34041,
              Ka = 35907,
              Ja = 34836,
              eo = 34842,
              to = 34843,
              mr = [];
            (mr[Bn] = 2),
              (mr[Wa] = 2),
              (mr[Ya] = 2),
              (mr[Xa] = 2),
              (mr[Qa] = 1),
              (mr[Za] = 4),
              (mr[Ka] = 4),
              (mr[Ja] = 16),
              (mr[eo] = 8),
              (mr[to] = 6);
            var ru = function (C, B, Y, ue, me) {
                var he = function (Ee) {
                    (this.id = $e++),
                      (this.refCount = 1),
                      (this.renderbuffer = Ee),
                      (this.format = Bn),
                      (this.width = 0),
                      (this.height = 0),
                      me.profile && (this.stats = { size: 0 });
                  },
                  _e = function (Ee) {
                    var le = Ee.renderbuffer;
                    V(le, "must not double destroy renderbuffer"),
                      C.bindRenderbuffer(Ar, null),
                      C.deleteRenderbuffer(le),
                      (Ee.renderbuffer = null),
                      (Ee.refCount = 0),
                      delete ke[Ee.id],
                      ue.renderbufferCount--;
                  },
                  Pe = function (Ee, le) {
                    var se = new he(C.createRenderbuffer());
                    (ke[se.id] = se), ue.renderbufferCount++;
                    function Ce(ye, nt) {
                      var Je = 0,
                        Ue = 0,
                        be = Bn;
                      if (typeof ye == "object" && ye) {
                        var pe = ye;
                        if ("shape" in pe) {
                          var Ye = pe.shape;
                          V(
                            Array.isArray(Ye) && Ye.length >= 2,
                            "invalid renderbuffer shape"
                          ),
                            (Je = Ye[0] | 0),
                            (Ue = Ye[1] | 0);
                        } else
                          "radius" in pe && (Je = Ue = pe.radius | 0),
                            "width" in pe && (Je = pe.width | 0),
                            "height" in pe && (Ue = pe.height | 0);
                        "format" in pe &&
                          (V.parameter(
                            pe.format,
                            Oe,
                            "invalid renderbuffer format"
                          ),
                          (be = Oe[pe.format]));
                      } else
                        typeof ye == "number"
                          ? ((Je = ye | 0),
                            typeof nt == "number" ? (Ue = nt | 0) : (Ue = Je))
                          : ye
                          ? V.raise(
                              "invalid arguments to renderbuffer constructor"
                            )
                          : (Je = Ue = 1);
                      if (
                        (V(
                          Je > 0 &&
                            Ue > 0 &&
                            Je <= Y.maxRenderbufferSize &&
                            Ue <= Y.maxRenderbufferSize,
                          "invalid renderbuffer size"
                        ),
                        !(
                          Je === se.width &&
                          Ue === se.height &&
                          be === se.format
                        ))
                      )
                        return (
                          (Ce.width = se.width = Je),
                          (Ce.height = se.height = Ue),
                          (se.format = be),
                          C.bindRenderbuffer(Ar, se.renderbuffer),
                          C.renderbufferStorage(Ar, be, Je, Ue),
                          V(C.getError() === 0, "invalid render buffer format"),
                          me.profile &&
                            (se.stats.size = sa(
                              se.format,
                              se.width,
                              se.height
                            )),
                          (Ce.format = ze[se.format]),
                          Ce
                        );
                    }
                    function We(ye, nt) {
                      var Je = ye | 0,
                        Ue = nt | 0 || Je;
                      return (
                        (Je === se.width && Ue === se.height) ||
                          (V(
                            Je > 0 &&
                              Ue > 0 &&
                              Je <= Y.maxRenderbufferSize &&
                              Ue <= Y.maxRenderbufferSize,
                            "invalid renderbuffer size"
                          ),
                          (Ce.width = se.width = Je),
                          (Ce.height = se.height = Ue),
                          C.bindRenderbuffer(Ar, se.renderbuffer),
                          C.renderbufferStorage(Ar, se.format, Je, Ue),
                          V(C.getError() === 0, "invalid render buffer format"),
                          me.profile &&
                            (se.stats.size = sa(
                              se.format,
                              se.width,
                              se.height
                            ))),
                        Ce
                      );
                    }
                    return (
                      Ce(Ee, le),
                      (Ce.resize = We),
                      (Ce._reglType = "renderbuffer"),
                      (Ce._renderbuffer = se),
                      me.profile && (Ce.stats = se.stats),
                      (Ce.destroy = function () {
                        se.decRef();
                      }),
                      Ce
                    );
                  },
                  Le = function () {
                    cr(ke).forEach(function (Ee) {
                      (Ee.renderbuffer = C.createRenderbuffer()),
                        C.bindRenderbuffer(Ar, Ee.renderbuffer),
                        C.renderbufferStorage(
                          Ar,
                          Ee.format,
                          Ee.width,
                          Ee.height
                        );
                    }),
                      C.bindRenderbuffer(Ar, null);
                  },
                  Oe = {
                    rgba4: Bn,
                    rgb565: Ya,
                    "rgb5 a1": Wa,
                    depth: Xa,
                    stencil: Qa,
                    "depth stencil": Za,
                  };
                B.ext_srgb && (Oe.srgba = Ka),
                  B.ext_color_buffer_half_float &&
                    ((Oe.rgba16f = eo), (Oe.rgb16f = to)),
                  B.webgl_color_buffer_float && (Oe.rgba32f = Ja);
                var ze = [];
                Object.keys(Oe).forEach(function (Ie) {
                  var Ee = Oe[Ie];
                  ze[Ee] = Ie;
                });
                var $e = 0,
                  ke = {};
                return (
                  (he.prototype.decRef = function () {
                    --this.refCount <= 0 && _e(this);
                  }),
                  me.profile &&
                    (ue.getTotalRenderbufferSize = function () {
                      var Ie = 0;
                      return (
                        Object.keys(ke).forEach(function (Ee) {
                          Ie += ke[Ee].stats.size;
                        }),
                        Ie
                      );
                    }),
                  {
                    create: Pe,
                    clear: function () {
                      cr(ke).forEach(_e);
                    },
                    restore: Le,
                  }
                );
              },
              br = 36160,
              Ri = 36161,
              Mr = 3553,
              Nn = 34069,
              ro = 36064,
              no = 36096,
              io = 36128,
              ao = 33306,
              oo = 36053,
              nu = 36054,
              iu = 36055,
              au = 36057,
              ou = 36061,
              su = 36193,
              lu = 5121,
              uu = 5126,
              so = 6407,
              lo = 6408,
              fu = 6402,
              cu = [so, lo],
              ki = [];
            (ki[lo] = 4), (ki[so] = 3);
            var Vn = [];
            (Vn[lu] = 1), (Vn[uu] = 4), (Vn[su] = 2);
            var hu = 32854,
              du = 32855,
              pu = 36194,
              vu = 33189,
              mu = 36168,
              uo = 34041,
              gu = 35907,
              yu = 34836,
              _u = 34842,
              bu = 34843,
              xu = [hu, du, pu, gu, _u, bu, yu],
              Zr = {};
            (Zr[oo] = "complete"),
              (Zr[nu] = "incomplete attachment"),
              (Zr[au] = "incomplete dimensions"),
              (Zr[iu] = "incomplete, missing attachment"),
              (Zr[ou] = "unsupported");
            var Cu = 5126,
              fo = 34962,
              Gn = 34963,
              co = [
                "attributes",
                "elements",
                "offset",
                "count",
                "primitive",
                "instances",
              ],
              ho = 35632,
              Su = 35633,
              wu = 35718,
              Au = 35721,
              Pu = 6408,
              pn = 5121,
              Eu = 3333,
              Un = 5126,
              Kr = "xyzw".split(""),
              po = 5121,
              Jr = 1,
              Ii = 2,
              zi = 0,
              Fi = 1,
              Di = 2,
              Bi = 3,
              jn = 4,
              vo = 5,
              mo = 6,
              go = "dither",
              yo = "blend.enable",
              _o = "blend.color",
              Ni = "blend.equation",
              Vi = "blend.func",
              bo = "depth.enable",
              xo = "depth.func",
              Co = "depth.range",
              So = "depth.mask",
              Gi = "colorMask",
              wo = "cull.enable",
              Ao = "cull.face",
              Ui = "frontFace",
              ji = "lineWidth",
              Po = "polygonOffset.enable",
              qi = "polygonOffset.offset",
              Eo = "sample.alpha",
              $o = "sample.enable",
              Hi = "sample.coverage",
              Oo = "stencil.enable",
              Lo = "stencil.mask",
              Wi = "stencil.func",
              Yi = "stencil.opFront",
              vn = "stencil.opBack",
              To = "scissor.enable",
              qn = "scissor.box",
              xr = "viewport",
              mn = "profile",
              Rr = "framebuffer",
              gn = "vert",
              yn = "frag",
              kr = "elements",
              Ir = "primitive",
              zr = "count",
              Hn = "offset",
              Wn = "instances",
              _n = "vao",
              Xi = "Width",
              Qi = "Height",
              en = Rr + Xi,
              tn = Rr + Qi,
              $u = xr + Xi,
              Ou = xr + Qi,
              Mo = "drawingBuffer",
              Ro = Mo + Xi,
              ko = Mo + Qi,
              Lu = [Vi, Ni, Wi, Yi, vn, Hi, xr, qn, qi],
              rn = 34962,
              Zi = 34963,
              Tu = 35632,
              Mu = 35633,
              Io = 3553,
              Ru = 34067,
              ku = 2884,
              Iu = 3042,
              zu = 3024,
              Fu = 2960,
              Du = 2929,
              Bu = 3089,
              Nu = 32823,
              Vu = 32926,
              Gu = 32928,
              Ki = 5126,
              Yn = 35664,
              Xn = 35665,
              Qn = 35666,
              Ji = 5124,
              Zn = 35667,
              Kn = 35668,
              Jn = 35669,
              ea = 35670,
              ei = 35671,
              ti = 35672,
              ri = 35673,
              bn = 35674,
              xn = 35675,
              Cn = 35676,
              Sn = 35678,
              wn = 35680,
              ta = 4,
              An = 1028,
              Fr = 1029,
              zo = 2304,
              ra = 2305,
              Uu = 32775,
              ju = 32776,
              qu = 519,
              Pr = 7680,
              Fo = 0,
              Do = 1,
              Bo = 32774,
              Hu = 513,
              No = 36160,
              Wu = 36064,
              yr = {
                0: 0,
                1: 1,
                zero: 0,
                one: 1,
                "src color": 768,
                "one minus src color": 769,
                "src alpha": 770,
                "one minus src alpha": 771,
                "dst color": 774,
                "one minus dst color": 775,
                "dst alpha": 772,
                "one minus dst alpha": 773,
                "constant color": 32769,
                "one minus constant color": 32770,
                "constant alpha": 32771,
                "one minus constant alpha": 32772,
                "src alpha saturate": 776,
              },
              Vo = [
                "constant color, constant alpha",
                "one minus constant color, constant alpha",
                "constant color, one minus constant alpha",
                "one minus constant color, one minus constant alpha",
                "constant alpha, constant color",
                "constant alpha, one minus constant color",
                "one minus constant alpha, constant color",
                "one minus constant alpha, one minus constant color",
              ],
              nn = {
                never: 512,
                less: 513,
                "<": 513,
                equal: 514,
                "=": 514,
                "==": 514,
                "===": 514,
                lequal: 515,
                "<=": 515,
                greater: 516,
                ">": 516,
                notequal: 517,
                "!=": 517,
                "!==": 517,
                gequal: 518,
                ">=": 518,
                always: 519,
              },
              Er = {
                0: 0,
                zero: 0,
                keep: 7680,
                replace: 7681,
                increment: 7682,
                decrement: 7683,
                "increment wrap": 34055,
                "decrement wrap": 34056,
                invert: 5386,
              },
              Go = { frag: Tu, vert: Mu },
              na = { cw: zo, ccw: ra },
              Uo = new Zt(!1, !1, !1, function () {}),
              Yu = 34918,
              Xu = 34919,
              jo = 35007,
              Qu = function (C, B) {
                var Y = function () {
                    return (
                      $e.pop() || B.ext_disjoint_timer_query.createQueryEXT()
                    );
                  },
                  ue = function (We) {
                    $e.push(We);
                  },
                  me = function (We) {
                    var ye = Y();
                    B.ext_disjoint_timer_query.beginQueryEXT(jo, ye),
                      ke.push(ye),
                      Oe(ke.length - 1, ke.length, We);
                  },
                  he = function () {
                    B.ext_disjoint_timer_query.endQueryEXT(jo);
                  },
                  _e = function () {
                    (this.startQueryIndex = -1),
                      (this.endQueryIndex = -1),
                      (this.sum = 0),
                      (this.stats = null);
                  },
                  Pe = function () {
                    return Ie.pop() || new _e();
                  },
                  Le = function (We) {
                    Ie.push(We);
                  },
                  Oe = function (We, ye, nt) {
                    var Je = Pe();
                    (Je.startQueryIndex = We),
                      (Je.endQueryIndex = ye),
                      (Je.sum = 0),
                      (Je.stats = nt),
                      Ee.push(Je);
                  },
                  ze = function () {
                    var We,
                      ye,
                      nt = ke.length;
                    if (nt !== 0) {
                      (se.length = Math.max(se.length, nt + 1)),
                        (le.length = Math.max(le.length, nt + 1)),
                        (le[0] = 0),
                        (se[0] = 0);
                      var Je = 0;
                      for (We = 0, ye = 0; ye < ke.length; ++ye) {
                        var Ue = ke[ye];
                        B.ext_disjoint_timer_query.getQueryObjectEXT(Ue, Xu)
                          ? ((Je +=
                              B.ext_disjoint_timer_query.getQueryObjectEXT(
                                Ue,
                                Yu
                              )),
                            ue(Ue))
                          : (ke[We++] = Ue),
                          (le[ye + 1] = Je),
                          (se[ye + 1] = We);
                      }
                      for (
                        ke.length = We, We = 0, ye = 0;
                        ye < Ee.length;
                        ++ye
                      ) {
                        var be = Ee[ye],
                          pe = be.startQueryIndex,
                          Ye = be.endQueryIndex;
                        be.sum += le[Ye] - le[pe];
                        var Be = se[pe],
                          Te = se[Ye];
                        Te === Be
                          ? ((be.stats.gpuTime += be.sum / 1e6), Le(be))
                          : ((be.startQueryIndex = Be),
                            (be.endQueryIndex = Te),
                            (Ee[We++] = be));
                      }
                      Ee.length = We;
                    }
                  };
                if (!B.ext_disjoint_timer_query) return null;
                var $e = [],
                  ke = [],
                  Ie = [],
                  Ee = [],
                  le = [],
                  se = [];
                return {
                  beginQuery: me,
                  endQuery: he,
                  pushScopeStats: Oe,
                  update: ze,
                  getNumPendingQueries: function () {
                    return ke.length;
                  },
                  clear: function () {
                    $e.push.apply($e, ke);
                    for (var We = 0; We < $e.length; We++)
                      B.ext_disjoint_timer_query.deleteQueryEXT($e[We]);
                    (ke.length = 0), ($e.length = 0);
                  },
                  restore: function () {
                    (ke.length = 0), ($e.length = 0);
                  },
                };
              },
              Zu = 16384,
              Ku = 256,
              Ju = 1024,
              ef = 34962,
              qo = "webglcontextlost",
              Ho = "webglcontextrestored",
              Wo = 1,
              tf = 2,
              rf = 3;
            return ls;
          });
        })(regl)),
      regl.exports
    );
  }
  var EPSILON = 1e-6,
    ARRAY_TYPE = typeof Float32Array != "undefined" ? Float32Array : Array,
    RANDOM = Math.random;
  function setMatrixArrayType(r) {
    ARRAY_TYPE = r;
  }
  var degree = Math.PI / 180;
  function toRadian(r) {
    return r * degree;
  }
  function equals$9(r, n) {
    return Math.abs(r - n) <= EPSILON * Math.max(1, Math.abs(r), Math.abs(n));
  }
  Math.hypot ||
    (Math.hypot = function () {
      for (var r = 0, n = arguments.length; n--; )
        r += arguments[n] * arguments[n];
      return Math.sqrt(r);
    });
  var common = Object.freeze({
    __proto__: null,
    EPSILON: EPSILON,
    get ARRAY_TYPE() {
      return ARRAY_TYPE;
    },
    RANDOM: RANDOM,
    setMatrixArrayType: setMatrixArrayType,
    toRadian: toRadian,
    equals: equals$9,
  });
  function create$8() {
    var r = new ARRAY_TYPE(4);
    return (
      ARRAY_TYPE != Float32Array && ((r[1] = 0), (r[2] = 0)),
      (r[0] = 1),
      (r[3] = 1),
      r
    );
  }
  function clone$8(r) {
    var n = new ARRAY_TYPE(4);
    return (n[0] = r[0]), (n[1] = r[1]), (n[2] = r[2]), (n[3] = r[3]), n;
  }
  function copy$8(r, n) {
    return (r[0] = n[0]), (r[1] = n[1]), (r[2] = n[2]), (r[3] = n[3]), r;
  }
  function identity$5(r) {
    return (r[0] = 1), (r[1] = 0), (r[2] = 0), (r[3] = 1), r;
  }
  function fromValues$8(r, n, i, s) {
    var a = new ARRAY_TYPE(4);
    return (a[0] = r), (a[1] = n), (a[2] = i), (a[3] = s), a;
  }
  function set$8(r, n, i, s, a) {
    return (r[0] = n), (r[1] = i), (r[2] = s), (r[3] = a), r;
  }
  function transpose$2(r, n) {
    if (r === n) {
      var i = n[1];
      (r[1] = n[2]), (r[2] = i);
    } else (r[0] = n[0]), (r[1] = n[2]), (r[2] = n[1]), (r[3] = n[3]);
    return r;
  }
  function invert$5(r, n) {
    var i = n[0],
      s = n[1],
      a = n[2],
      o = n[3],
      l = i * o - a * s;
    return l
      ? ((l = 1 / l),
        (r[0] = o * l),
        (r[1] = -s * l),
        (r[2] = -a * l),
        (r[3] = i * l),
        r)
      : null;
  }
  function adjoint$2(r, n) {
    var i = n[0];
    return (r[0] = n[3]), (r[1] = -n[1]), (r[2] = -n[2]), (r[3] = i), r;
  }
  function determinant$3(r) {
    return r[0] * r[3] - r[2] * r[1];
  }
  function multiply$8(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3],
      u = i[0],
      f = i[1],
      c = i[2],
      h = i[3];
    return (
      (r[0] = s * u + o * f),
      (r[1] = a * u + l * f),
      (r[2] = s * c + o * h),
      (r[3] = a * c + l * h),
      r
    );
  }
  function rotate$4(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3],
      u = Math.sin(i),
      f = Math.cos(i);
    return (
      (r[0] = s * f + o * u),
      (r[1] = a * f + l * u),
      (r[2] = s * -u + o * f),
      (r[3] = a * -u + l * f),
      r
    );
  }
  function scale$8(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3],
      u = i[0],
      f = i[1];
    return (r[0] = s * u), (r[1] = a * u), (r[2] = o * f), (r[3] = l * f), r;
  }
  function fromRotation$4(r, n) {
    var i = Math.sin(n),
      s = Math.cos(n);
    return (r[0] = s), (r[1] = i), (r[2] = -i), (r[3] = s), r;
  }
  function fromScaling$3(r, n) {
    return (r[0] = n[0]), (r[1] = 0), (r[2] = 0), (r[3] = n[1]), r;
  }
  function str$8(r) {
    return "mat2(" + r[0] + ", " + r[1] + ", " + r[2] + ", " + r[3] + ")";
  }
  function frob$3(r) {
    return Math.hypot(r[0], r[1], r[2], r[3]);
  }
  function LDU(r, n, i, s) {
    return (
      (r[2] = s[2] / s[0]),
      (i[0] = s[0]),
      (i[1] = s[1]),
      (i[3] = s[3] - r[2] * i[1]),
      [r, n, i]
    );
  }
  function add$8(r, n, i) {
    return (
      (r[0] = n[0] + i[0]),
      (r[1] = n[1] + i[1]),
      (r[2] = n[2] + i[2]),
      (r[3] = n[3] + i[3]),
      r
    );
  }
  function subtract$6(r, n, i) {
    return (
      (r[0] = n[0] - i[0]),
      (r[1] = n[1] - i[1]),
      (r[2] = n[2] - i[2]),
      (r[3] = n[3] - i[3]),
      r
    );
  }
  function exactEquals$8(r, n) {
    return r[0] === n[0] && r[1] === n[1] && r[2] === n[2] && r[3] === n[3];
  }
  function equals$8(r, n) {
    var i = r[0],
      s = r[1],
      a = r[2],
      o = r[3],
      l = n[0],
      u = n[1],
      f = n[2],
      c = n[3];
    return (
      Math.abs(i - l) <= EPSILON * Math.max(1, Math.abs(i), Math.abs(l)) &&
      Math.abs(s - u) <= EPSILON * Math.max(1, Math.abs(s), Math.abs(u)) &&
      Math.abs(a - f) <= EPSILON * Math.max(1, Math.abs(a), Math.abs(f)) &&
      Math.abs(o - c) <= EPSILON * Math.max(1, Math.abs(o), Math.abs(c))
    );
  }
  function multiplyScalar$3(r, n, i) {
    return (
      (r[0] = n[0] * i),
      (r[1] = n[1] * i),
      (r[2] = n[2] * i),
      (r[3] = n[3] * i),
      r
    );
  }
  function multiplyScalarAndAdd$3(r, n, i, s) {
    return (
      (r[0] = n[0] + i[0] * s),
      (r[1] = n[1] + i[1] * s),
      (r[2] = n[2] + i[2] * s),
      (r[3] = n[3] + i[3] * s),
      r
    );
  }
  var mul$8 = multiply$8,
    sub$6 = subtract$6,
    mat2 = Object.freeze({
      __proto__: null,
      create: create$8,
      clone: clone$8,
      copy: copy$8,
      identity: identity$5,
      fromValues: fromValues$8,
      set: set$8,
      transpose: transpose$2,
      invert: invert$5,
      adjoint: adjoint$2,
      determinant: determinant$3,
      multiply: multiply$8,
      rotate: rotate$4,
      scale: scale$8,
      fromRotation: fromRotation$4,
      fromScaling: fromScaling$3,
      str: str$8,
      frob: frob$3,
      LDU: LDU,
      add: add$8,
      subtract: subtract$6,
      exactEquals: exactEquals$8,
      equals: equals$8,
      multiplyScalar: multiplyScalar$3,
      multiplyScalarAndAdd: multiplyScalarAndAdd$3,
      mul: mul$8,
      sub: sub$6,
    });
  function create$7() {
    var r = new ARRAY_TYPE(6);
    return (
      ARRAY_TYPE != Float32Array &&
        ((r[1] = 0), (r[2] = 0), (r[4] = 0), (r[5] = 0)),
      (r[0] = 1),
      (r[3] = 1),
      r
    );
  }
  function clone$7(r) {
    var n = new ARRAY_TYPE(6);
    return (
      (n[0] = r[0]),
      (n[1] = r[1]),
      (n[2] = r[2]),
      (n[3] = r[3]),
      (n[4] = r[4]),
      (n[5] = r[5]),
      n
    );
  }
  function copy$7(r, n) {
    return (
      (r[0] = n[0]),
      (r[1] = n[1]),
      (r[2] = n[2]),
      (r[3] = n[3]),
      (r[4] = n[4]),
      (r[5] = n[5]),
      r
    );
  }
  function identity$4(r) {
    return (
      (r[0] = 1), (r[1] = 0), (r[2] = 0), (r[3] = 1), (r[4] = 0), (r[5] = 0), r
    );
  }
  function fromValues$7(r, n, i, s, a, o) {
    var l = new ARRAY_TYPE(6);
    return (
      (l[0] = r), (l[1] = n), (l[2] = i), (l[3] = s), (l[4] = a), (l[5] = o), l
    );
  }
  function set$7(r, n, i, s, a, o, l) {
    return (
      (r[0] = n), (r[1] = i), (r[2] = s), (r[3] = a), (r[4] = o), (r[5] = l), r
    );
  }
  function invert$4(r, n) {
    var i = n[0],
      s = n[1],
      a = n[2],
      o = n[3],
      l = n[4],
      u = n[5],
      f = i * o - s * a;
    return f
      ? ((f = 1 / f),
        (r[0] = o * f),
        (r[1] = -s * f),
        (r[2] = -a * f),
        (r[3] = i * f),
        (r[4] = (a * u - o * l) * f),
        (r[5] = (s * l - i * u) * f),
        r)
      : null;
  }
  function determinant$2(r) {
    return r[0] * r[3] - r[1] * r[2];
  }
  function multiply$7(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3],
      u = n[4],
      f = n[5],
      c = i[0],
      h = i[1],
      p = i[2],
      d = i[3],
      m = i[4],
      g = i[5];
    return (
      (r[0] = s * c + o * h),
      (r[1] = a * c + l * h),
      (r[2] = s * p + o * d),
      (r[3] = a * p + l * d),
      (r[4] = s * m + o * g + u),
      (r[5] = a * m + l * g + f),
      r
    );
  }
  function rotate$3(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3],
      u = n[4],
      f = n[5],
      c = Math.sin(i),
      h = Math.cos(i);
    return (
      (r[0] = s * h + o * c),
      (r[1] = a * h + l * c),
      (r[2] = s * -c + o * h),
      (r[3] = a * -c + l * h),
      (r[4] = u),
      (r[5] = f),
      r
    );
  }
  function scale$7(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3],
      u = n[4],
      f = n[5],
      c = i[0],
      h = i[1];
    return (
      (r[0] = s * c),
      (r[1] = a * c),
      (r[2] = o * h),
      (r[3] = l * h),
      (r[4] = u),
      (r[5] = f),
      r
    );
  }
  function translate$3(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3],
      u = n[4],
      f = n[5],
      c = i[0],
      h = i[1];
    return (
      (r[0] = s),
      (r[1] = a),
      (r[2] = o),
      (r[3] = l),
      (r[4] = s * c + o * h + u),
      (r[5] = a * c + l * h + f),
      r
    );
  }
  function fromRotation$3(r, n) {
    var i = Math.sin(n),
      s = Math.cos(n);
    return (
      (r[0] = s), (r[1] = i), (r[2] = -i), (r[3] = s), (r[4] = 0), (r[5] = 0), r
    );
  }
  function fromScaling$2(r, n) {
    return (
      (r[0] = n[0]),
      (r[1] = 0),
      (r[2] = 0),
      (r[3] = n[1]),
      (r[4] = 0),
      (r[5] = 0),
      r
    );
  }
  function fromTranslation$3(r, n) {
    return (
      (r[0] = 1),
      (r[1] = 0),
      (r[2] = 0),
      (r[3] = 1),
      (r[4] = n[0]),
      (r[5] = n[1]),
      r
    );
  }
  function str$7(r) {
    return (
      "mat2d(" +
      r[0] +
      ", " +
      r[1] +
      ", " +
      r[2] +
      ", " +
      r[3] +
      ", " +
      r[4] +
      ", " +
      r[5] +
      ")"
    );
  }
  function frob$2(r) {
    return Math.hypot(r[0], r[1], r[2], r[3], r[4], r[5], 1);
  }
  function add$7(r, n, i) {
    return (
      (r[0] = n[0] + i[0]),
      (r[1] = n[1] + i[1]),
      (r[2] = n[2] + i[2]),
      (r[3] = n[3] + i[3]),
      (r[4] = n[4] + i[4]),
      (r[5] = n[5] + i[5]),
      r
    );
  }
  function subtract$5(r, n, i) {
    return (
      (r[0] = n[0] - i[0]),
      (r[1] = n[1] - i[1]),
      (r[2] = n[2] - i[2]),
      (r[3] = n[3] - i[3]),
      (r[4] = n[4] - i[4]),
      (r[5] = n[5] - i[5]),
      r
    );
  }
  function multiplyScalar$2(r, n, i) {
    return (
      (r[0] = n[0] * i),
      (r[1] = n[1] * i),
      (r[2] = n[2] * i),
      (r[3] = n[3] * i),
      (r[4] = n[4] * i),
      (r[5] = n[5] * i),
      r
    );
  }
  function multiplyScalarAndAdd$2(r, n, i, s) {
    return (
      (r[0] = n[0] + i[0] * s),
      (r[1] = n[1] + i[1] * s),
      (r[2] = n[2] + i[2] * s),
      (r[3] = n[3] + i[3] * s),
      (r[4] = n[4] + i[4] * s),
      (r[5] = n[5] + i[5] * s),
      r
    );
  }
  function exactEquals$7(r, n) {
    return (
      r[0] === n[0] &&
      r[1] === n[1] &&
      r[2] === n[2] &&
      r[3] === n[3] &&
      r[4] === n[4] &&
      r[5] === n[5]
    );
  }
  function equals$7(r, n) {
    var i = r[0],
      s = r[1],
      a = r[2],
      o = r[3],
      l = r[4],
      u = r[5],
      f = n[0],
      c = n[1],
      h = n[2],
      p = n[3],
      d = n[4],
      m = n[5];
    return (
      Math.abs(i - f) <= EPSILON * Math.max(1, Math.abs(i), Math.abs(f)) &&
      Math.abs(s - c) <= EPSILON * Math.max(1, Math.abs(s), Math.abs(c)) &&
      Math.abs(a - h) <= EPSILON * Math.max(1, Math.abs(a), Math.abs(h)) &&
      Math.abs(o - p) <= EPSILON * Math.max(1, Math.abs(o), Math.abs(p)) &&
      Math.abs(l - d) <= EPSILON * Math.max(1, Math.abs(l), Math.abs(d)) &&
      Math.abs(u - m) <= EPSILON * Math.max(1, Math.abs(u), Math.abs(m))
    );
  }
  var mul$7 = multiply$7,
    sub$5 = subtract$5,
    mat2d = Object.freeze({
      __proto__: null,
      create: create$7,
      clone: clone$7,
      copy: copy$7,
      identity: identity$4,
      fromValues: fromValues$7,
      set: set$7,
      invert: invert$4,
      determinant: determinant$2,
      multiply: multiply$7,
      rotate: rotate$3,
      scale: scale$7,
      translate: translate$3,
      fromRotation: fromRotation$3,
      fromScaling: fromScaling$2,
      fromTranslation: fromTranslation$3,
      str: str$7,
      frob: frob$2,
      add: add$7,
      subtract: subtract$5,
      multiplyScalar: multiplyScalar$2,
      multiplyScalarAndAdd: multiplyScalarAndAdd$2,
      exactEquals: exactEquals$7,
      equals: equals$7,
      mul: mul$7,
      sub: sub$5,
    });
  function create$6() {
    var r = new ARRAY_TYPE(9);
    return (
      ARRAY_TYPE != Float32Array &&
        ((r[1] = 0),
        (r[2] = 0),
        (r[3] = 0),
        (r[5] = 0),
        (r[6] = 0),
        (r[7] = 0)),
      (r[0] = 1),
      (r[4] = 1),
      (r[8] = 1),
      r
    );
  }
  function fromMat4$1(r, n) {
    return (
      (r[0] = n[0]),
      (r[1] = n[1]),
      (r[2] = n[2]),
      (r[3] = n[4]),
      (r[4] = n[5]),
      (r[5] = n[6]),
      (r[6] = n[8]),
      (r[7] = n[9]),
      (r[8] = n[10]),
      r
    );
  }
  function clone$6(r) {
    var n = new ARRAY_TYPE(9);
    return (
      (n[0] = r[0]),
      (n[1] = r[1]),
      (n[2] = r[2]),
      (n[3] = r[3]),
      (n[4] = r[4]),
      (n[5] = r[5]),
      (n[6] = r[6]),
      (n[7] = r[7]),
      (n[8] = r[8]),
      n
    );
  }
  function copy$6(r, n) {
    return (
      (r[0] = n[0]),
      (r[1] = n[1]),
      (r[2] = n[2]),
      (r[3] = n[3]),
      (r[4] = n[4]),
      (r[5] = n[5]),
      (r[6] = n[6]),
      (r[7] = n[7]),
      (r[8] = n[8]),
      r
    );
  }
  function fromValues$6(r, n, i, s, a, o, l, u, f) {
    var c = new ARRAY_TYPE(9);
    return (
      (c[0] = r),
      (c[1] = n),
      (c[2] = i),
      (c[3] = s),
      (c[4] = a),
      (c[5] = o),
      (c[6] = l),
      (c[7] = u),
      (c[8] = f),
      c
    );
  }
  function set$6(r, n, i, s, a, o, l, u, f, c) {
    return (
      (r[0] = n),
      (r[1] = i),
      (r[2] = s),
      (r[3] = a),
      (r[4] = o),
      (r[5] = l),
      (r[6] = u),
      (r[7] = f),
      (r[8] = c),
      r
    );
  }
  function identity$3(r) {
    return (
      (r[0] = 1),
      (r[1] = 0),
      (r[2] = 0),
      (r[3] = 0),
      (r[4] = 1),
      (r[5] = 0),
      (r[6] = 0),
      (r[7] = 0),
      (r[8] = 1),
      r
    );
  }
  function transpose$1(r, n) {
    if (r === n) {
      var i = n[1],
        s = n[2],
        a = n[5];
      (r[1] = n[3]),
        (r[2] = n[6]),
        (r[3] = i),
        (r[5] = n[7]),
        (r[6] = s),
        (r[7] = a);
    } else (r[0] = n[0]), (r[1] = n[3]), (r[2] = n[6]), (r[3] = n[1]), (r[4] = n[4]), (r[5] = n[7]), (r[6] = n[2]), (r[7] = n[5]), (r[8] = n[8]);
    return r;
  }
  function invert$3(r, n) {
    var i = n[0],
      s = n[1],
      a = n[2],
      o = n[3],
      l = n[4],
      u = n[5],
      f = n[6],
      c = n[7],
      h = n[8],
      p = h * l - u * c,
      d = -h * o + u * f,
      m = c * o - l * f,
      g = i * p + s * d + a * m;
    return g
      ? ((g = 1 / g),
        (r[0] = p * g),
        (r[1] = (-h * s + a * c) * g),
        (r[2] = (u * s - a * l) * g),
        (r[3] = d * g),
        (r[4] = (h * i - a * f) * g),
        (r[5] = (-u * i + a * o) * g),
        (r[6] = m * g),
        (r[7] = (-c * i + s * f) * g),
        (r[8] = (l * i - s * o) * g),
        r)
      : null;
  }
  function adjoint$1(r, n) {
    var i = n[0],
      s = n[1],
      a = n[2],
      o = n[3],
      l = n[4],
      u = n[5],
      f = n[6],
      c = n[7],
      h = n[8];
    return (
      (r[0] = l * h - u * c),
      (r[1] = a * c - s * h),
      (r[2] = s * u - a * l),
      (r[3] = u * f - o * h),
      (r[4] = i * h - a * f),
      (r[5] = a * o - i * u),
      (r[6] = o * c - l * f),
      (r[7] = s * f - i * c),
      (r[8] = i * l - s * o),
      r
    );
  }
  function determinant$1(r) {
    var n = r[0],
      i = r[1],
      s = r[2],
      a = r[3],
      o = r[4],
      l = r[5],
      u = r[6],
      f = r[7],
      c = r[8];
    return n * (c * o - l * f) + i * (-c * a + l * u) + s * (f * a - o * u);
  }
  function multiply$6(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3],
      u = n[4],
      f = n[5],
      c = n[6],
      h = n[7],
      p = n[8],
      d = i[0],
      m = i[1],
      g = i[2],
      v = i[3],
      y = i[4],
      _ = i[5],
      b = i[6],
      S = i[7],
      P = i[8];
    return (
      (r[0] = d * s + m * l + g * c),
      (r[1] = d * a + m * u + g * h),
      (r[2] = d * o + m * f + g * p),
      (r[3] = v * s + y * l + _ * c),
      (r[4] = v * a + y * u + _ * h),
      (r[5] = v * o + y * f + _ * p),
      (r[6] = b * s + S * l + P * c),
      (r[7] = b * a + S * u + P * h),
      (r[8] = b * o + S * f + P * p),
      r
    );
  }
  function translate$2(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3],
      u = n[4],
      f = n[5],
      c = n[6],
      h = n[7],
      p = n[8],
      d = i[0],
      m = i[1];
    return (
      (r[0] = s),
      (r[1] = a),
      (r[2] = o),
      (r[3] = l),
      (r[4] = u),
      (r[5] = f),
      (r[6] = d * s + m * l + c),
      (r[7] = d * a + m * u + h),
      (r[8] = d * o + m * f + p),
      r
    );
  }
  function rotate$2(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3],
      u = n[4],
      f = n[5],
      c = n[6],
      h = n[7],
      p = n[8],
      d = Math.sin(i),
      m = Math.cos(i);
    return (
      (r[0] = m * s + d * l),
      (r[1] = m * a + d * u),
      (r[2] = m * o + d * f),
      (r[3] = m * l - d * s),
      (r[4] = m * u - d * a),
      (r[5] = m * f - d * o),
      (r[6] = c),
      (r[7] = h),
      (r[8] = p),
      r
    );
  }
  function scale$6(r, n, i) {
    var s = i[0],
      a = i[1];
    return (
      (r[0] = s * n[0]),
      (r[1] = s * n[1]),
      (r[2] = s * n[2]),
      (r[3] = a * n[3]),
      (r[4] = a * n[4]),
      (r[5] = a * n[5]),
      (r[6] = n[6]),
      (r[7] = n[7]),
      (r[8] = n[8]),
      r
    );
  }
  function fromTranslation$2(r, n) {
    return (
      (r[0] = 1),
      (r[1] = 0),
      (r[2] = 0),
      (r[3] = 0),
      (r[4] = 1),
      (r[5] = 0),
      (r[6] = n[0]),
      (r[7] = n[1]),
      (r[8] = 1),
      r
    );
  }
  function fromRotation$2(r, n) {
    var i = Math.sin(n),
      s = Math.cos(n);
    return (
      (r[0] = s),
      (r[1] = i),
      (r[2] = 0),
      (r[3] = -i),
      (r[4] = s),
      (r[5] = 0),
      (r[6] = 0),
      (r[7] = 0),
      (r[8] = 1),
      r
    );
  }
  function fromScaling$1(r, n) {
    return (
      (r[0] = n[0]),
      (r[1] = 0),
      (r[2] = 0),
      (r[3] = 0),
      (r[4] = n[1]),
      (r[5] = 0),
      (r[6] = 0),
      (r[7] = 0),
      (r[8] = 1),
      r
    );
  }
  function fromMat2d(r, n) {
    return (
      (r[0] = n[0]),
      (r[1] = n[1]),
      (r[2] = 0),
      (r[3] = n[2]),
      (r[4] = n[3]),
      (r[5] = 0),
      (r[6] = n[4]),
      (r[7] = n[5]),
      (r[8] = 1),
      r
    );
  }
  function fromQuat$1(r, n) {
    var i = n[0],
      s = n[1],
      a = n[2],
      o = n[3],
      l = i + i,
      u = s + s,
      f = a + a,
      c = i * l,
      h = s * l,
      p = s * u,
      d = a * l,
      m = a * u,
      g = a * f,
      v = o * l,
      y = o * u,
      _ = o * f;
    return (
      (r[0] = 1 - p - g),
      (r[3] = h - _),
      (r[6] = d + y),
      (r[1] = h + _),
      (r[4] = 1 - c - g),
      (r[7] = m - v),
      (r[2] = d - y),
      (r[5] = m + v),
      (r[8] = 1 - c - p),
      r
    );
  }
  function normalFromMat4(r, n) {
    var i = n[0],
      s = n[1],
      a = n[2],
      o = n[3],
      l = n[4],
      u = n[5],
      f = n[6],
      c = n[7],
      h = n[8],
      p = n[9],
      d = n[10],
      m = n[11],
      g = n[12],
      v = n[13],
      y = n[14],
      _ = n[15],
      b = i * u - s * l,
      S = i * f - a * l,
      P = i * c - o * l,
      I = s * f - a * u,
      F = s * c - o * u,
      X = a * c - o * f,
      W = h * v - p * g,
      Z = h * y - d * g,
      j = h * _ - m * g,
      L = p * y - d * v,
      T = p * _ - m * v,
      A = d * _ - m * y,
      $ = b * A - S * T + P * L + I * j - F * Z + X * W;
    return $
      ? (($ = 1 / $),
        (r[0] = (u * A - f * T + c * L) * $),
        (r[1] = (f * j - l * A - c * Z) * $),
        (r[2] = (l * T - u * j + c * W) * $),
        (r[3] = (a * T - s * A - o * L) * $),
        (r[4] = (i * A - a * j + o * Z) * $),
        (r[5] = (s * j - i * T - o * W) * $),
        (r[6] = (v * X - y * F + _ * I) * $),
        (r[7] = (y * P - g * X - _ * S) * $),
        (r[8] = (g * F - v * P + _ * b) * $),
        r)
      : null;
  }
  function projection(r, n, i) {
    return (
      (r[0] = 2 / n),
      (r[1] = 0),
      (r[2] = 0),
      (r[3] = 0),
      (r[4] = -2 / i),
      (r[5] = 0),
      (r[6] = -1),
      (r[7] = 1),
      (r[8] = 1),
      r
    );
  }
  function str$6(r) {
    return (
      "mat3(" +
      r[0] +
      ", " +
      r[1] +
      ", " +
      r[2] +
      ", " +
      r[3] +
      ", " +
      r[4] +
      ", " +
      r[5] +
      ", " +
      r[6] +
      ", " +
      r[7] +
      ", " +
      r[8] +
      ")"
    );
  }
  function frob$1(r) {
    return Math.hypot(r[0], r[1], r[2], r[3], r[4], r[5], r[6], r[7], r[8]);
  }
  function add$6(r, n, i) {
    return (
      (r[0] = n[0] + i[0]),
      (r[1] = n[1] + i[1]),
      (r[2] = n[2] + i[2]),
      (r[3] = n[3] + i[3]),
      (r[4] = n[4] + i[4]),
      (r[5] = n[5] + i[5]),
      (r[6] = n[6] + i[6]),
      (r[7] = n[7] + i[7]),
      (r[8] = n[8] + i[8]),
      r
    );
  }
  function subtract$4(r, n, i) {
    return (
      (r[0] = n[0] - i[0]),
      (r[1] = n[1] - i[1]),
      (r[2] = n[2] - i[2]),
      (r[3] = n[3] - i[3]),
      (r[4] = n[4] - i[4]),
      (r[5] = n[5] - i[5]),
      (r[6] = n[6] - i[6]),
      (r[7] = n[7] - i[7]),
      (r[8] = n[8] - i[8]),
      r
    );
  }
  function multiplyScalar$1(r, n, i) {
    return (
      (r[0] = n[0] * i),
      (r[1] = n[1] * i),
      (r[2] = n[2] * i),
      (r[3] = n[3] * i),
      (r[4] = n[4] * i),
      (r[5] = n[5] * i),
      (r[6] = n[6] * i),
      (r[7] = n[7] * i),
      (r[8] = n[8] * i),
      r
    );
  }
  function multiplyScalarAndAdd$1(r, n, i, s) {
    return (
      (r[0] = n[0] + i[0] * s),
      (r[1] = n[1] + i[1] * s),
      (r[2] = n[2] + i[2] * s),
      (r[3] = n[3] + i[3] * s),
      (r[4] = n[4] + i[4] * s),
      (r[5] = n[5] + i[5] * s),
      (r[6] = n[6] + i[6] * s),
      (r[7] = n[7] + i[7] * s),
      (r[8] = n[8] + i[8] * s),
      r
    );
  }
  function exactEquals$6(r, n) {
    return (
      r[0] === n[0] &&
      r[1] === n[1] &&
      r[2] === n[2] &&
      r[3] === n[3] &&
      r[4] === n[4] &&
      r[5] === n[5] &&
      r[6] === n[6] &&
      r[7] === n[7] &&
      r[8] === n[8]
    );
  }
  function equals$6(r, n) {
    var i = r[0],
      s = r[1],
      a = r[2],
      o = r[3],
      l = r[4],
      u = r[5],
      f = r[6],
      c = r[7],
      h = r[8],
      p = n[0],
      d = n[1],
      m = n[2],
      g = n[3],
      v = n[4],
      y = n[5],
      _ = n[6],
      b = n[7],
      S = n[8];
    return (
      Math.abs(i - p) <= EPSILON * Math.max(1, Math.abs(i), Math.abs(p)) &&
      Math.abs(s - d) <= EPSILON * Math.max(1, Math.abs(s), Math.abs(d)) &&
      Math.abs(a - m) <= EPSILON * Math.max(1, Math.abs(a), Math.abs(m)) &&
      Math.abs(o - g) <= EPSILON * Math.max(1, Math.abs(o), Math.abs(g)) &&
      Math.abs(l - v) <= EPSILON * Math.max(1, Math.abs(l), Math.abs(v)) &&
      Math.abs(u - y) <= EPSILON * Math.max(1, Math.abs(u), Math.abs(y)) &&
      Math.abs(f - _) <= EPSILON * Math.max(1, Math.abs(f), Math.abs(_)) &&
      Math.abs(c - b) <= EPSILON * Math.max(1, Math.abs(c), Math.abs(b)) &&
      Math.abs(h - S) <= EPSILON * Math.max(1, Math.abs(h), Math.abs(S))
    );
  }
  var mul$6 = multiply$6,
    sub$4 = subtract$4,
    mat3 = Object.freeze({
      __proto__: null,
      create: create$6,
      fromMat4: fromMat4$1,
      clone: clone$6,
      copy: copy$6,
      fromValues: fromValues$6,
      set: set$6,
      identity: identity$3,
      transpose: transpose$1,
      invert: invert$3,
      adjoint: adjoint$1,
      determinant: determinant$1,
      multiply: multiply$6,
      translate: translate$2,
      rotate: rotate$2,
      scale: scale$6,
      fromTranslation: fromTranslation$2,
      fromRotation: fromRotation$2,
      fromScaling: fromScaling$1,
      fromMat2d: fromMat2d,
      fromQuat: fromQuat$1,
      normalFromMat4: normalFromMat4,
      projection: projection,
      str: str$6,
      frob: frob$1,
      add: add$6,
      subtract: subtract$4,
      multiplyScalar: multiplyScalar$1,
      multiplyScalarAndAdd: multiplyScalarAndAdd$1,
      exactEquals: exactEquals$6,
      equals: equals$6,
      mul: mul$6,
      sub: sub$4,
    });
  function create$5() {
    var r = new ARRAY_TYPE(16);
    return (
      ARRAY_TYPE != Float32Array &&
        ((r[1] = 0),
        (r[2] = 0),
        (r[3] = 0),
        (r[4] = 0),
        (r[6] = 0),
        (r[7] = 0),
        (r[8] = 0),
        (r[9] = 0),
        (r[11] = 0),
        (r[12] = 0),
        (r[13] = 0),
        (r[14] = 0)),
      (r[0] = 1),
      (r[5] = 1),
      (r[10] = 1),
      (r[15] = 1),
      r
    );
  }
  function clone$5(r) {
    var n = new ARRAY_TYPE(16);
    return (
      (n[0] = r[0]),
      (n[1] = r[1]),
      (n[2] = r[2]),
      (n[3] = r[3]),
      (n[4] = r[4]),
      (n[5] = r[5]),
      (n[6] = r[6]),
      (n[7] = r[7]),
      (n[8] = r[8]),
      (n[9] = r[9]),
      (n[10] = r[10]),
      (n[11] = r[11]),
      (n[12] = r[12]),
      (n[13] = r[13]),
      (n[14] = r[14]),
      (n[15] = r[15]),
      n
    );
  }
  function copy$5(r, n) {
    return (
      (r[0] = n[0]),
      (r[1] = n[1]),
      (r[2] = n[2]),
      (r[3] = n[3]),
      (r[4] = n[4]),
      (r[5] = n[5]),
      (r[6] = n[6]),
      (r[7] = n[7]),
      (r[8] = n[8]),
      (r[9] = n[9]),
      (r[10] = n[10]),
      (r[11] = n[11]),
      (r[12] = n[12]),
      (r[13] = n[13]),
      (r[14] = n[14]),
      (r[15] = n[15]),
      r
    );
  }
  function fromValues$5(r, n, i, s, a, o, l, u, f, c, h, p, d, m, g, v) {
    var y = new ARRAY_TYPE(16);
    return (
      (y[0] = r),
      (y[1] = n),
      (y[2] = i),
      (y[3] = s),
      (y[4] = a),
      (y[5] = o),
      (y[6] = l),
      (y[7] = u),
      (y[8] = f),
      (y[9] = c),
      (y[10] = h),
      (y[11] = p),
      (y[12] = d),
      (y[13] = m),
      (y[14] = g),
      (y[15] = v),
      y
    );
  }
  function set$5(r, n, i, s, a, o, l, u, f, c, h, p, d, m, g, v, y) {
    return (
      (r[0] = n),
      (r[1] = i),
      (r[2] = s),
      (r[3] = a),
      (r[4] = o),
      (r[5] = l),
      (r[6] = u),
      (r[7] = f),
      (r[8] = c),
      (r[9] = h),
      (r[10] = p),
      (r[11] = d),
      (r[12] = m),
      (r[13] = g),
      (r[14] = v),
      (r[15] = y),
      r
    );
  }
  function identity$2(r) {
    return (
      (r[0] = 1),
      (r[1] = 0),
      (r[2] = 0),
      (r[3] = 0),
      (r[4] = 0),
      (r[5] = 1),
      (r[6] = 0),
      (r[7] = 0),
      (r[8] = 0),
      (r[9] = 0),
      (r[10] = 1),
      (r[11] = 0),
      (r[12] = 0),
      (r[13] = 0),
      (r[14] = 0),
      (r[15] = 1),
      r
    );
  }
  function transpose(r, n) {
    if (r === n) {
      var i = n[1],
        s = n[2],
        a = n[3],
        o = n[6],
        l = n[7],
        u = n[11];
      (r[1] = n[4]),
        (r[2] = n[8]),
        (r[3] = n[12]),
        (r[4] = i),
        (r[6] = n[9]),
        (r[7] = n[13]),
        (r[8] = s),
        (r[9] = o),
        (r[11] = n[14]),
        (r[12] = a),
        (r[13] = l),
        (r[14] = u);
    } else (r[0] = n[0]), (r[1] = n[4]), (r[2] = n[8]), (r[3] = n[12]), (r[4] = n[1]), (r[5] = n[5]), (r[6] = n[9]), (r[7] = n[13]), (r[8] = n[2]), (r[9] = n[6]), (r[10] = n[10]), (r[11] = n[14]), (r[12] = n[3]), (r[13] = n[7]), (r[14] = n[11]), (r[15] = n[15]);
    return r;
  }
  function invert$2(r, n) {
    var i = n[0],
      s = n[1],
      a = n[2],
      o = n[3],
      l = n[4],
      u = n[5],
      f = n[6],
      c = n[7],
      h = n[8],
      p = n[9],
      d = n[10],
      m = n[11],
      g = n[12],
      v = n[13],
      y = n[14],
      _ = n[15],
      b = i * u - s * l,
      S = i * f - a * l,
      P = i * c - o * l,
      I = s * f - a * u,
      F = s * c - o * u,
      X = a * c - o * f,
      W = h * v - p * g,
      Z = h * y - d * g,
      j = h * _ - m * g,
      L = p * y - d * v,
      T = p * _ - m * v,
      A = d * _ - m * y,
      $ = b * A - S * T + P * L + I * j - F * Z + X * W;
    return $
      ? (($ = 1 / $),
        (r[0] = (u * A - f * T + c * L) * $),
        (r[1] = (a * T - s * A - o * L) * $),
        (r[2] = (v * X - y * F + _ * I) * $),
        (r[3] = (d * F - p * X - m * I) * $),
        (r[4] = (f * j - l * A - c * Z) * $),
        (r[5] = (i * A - a * j + o * Z) * $),
        (r[6] = (y * P - g * X - _ * S) * $),
        (r[7] = (h * X - d * P + m * S) * $),
        (r[8] = (l * T - u * j + c * W) * $),
        (r[9] = (s * j - i * T - o * W) * $),
        (r[10] = (g * F - v * P + _ * b) * $),
        (r[11] = (p * P - h * F - m * b) * $),
        (r[12] = (u * Z - l * L - f * W) * $),
        (r[13] = (i * L - s * Z + a * W) * $),
        (r[14] = (v * S - g * I - y * b) * $),
        (r[15] = (h * I - p * S + d * b) * $),
        r)
      : null;
  }
  function adjoint(r, n) {
    var i = n[0],
      s = n[1],
      a = n[2],
      o = n[3],
      l = n[4],
      u = n[5],
      f = n[6],
      c = n[7],
      h = n[8],
      p = n[9],
      d = n[10],
      m = n[11],
      g = n[12],
      v = n[13],
      y = n[14],
      _ = n[15];
    return (
      (r[0] = u * (d * _ - m * y) - p * (f * _ - c * y) + v * (f * m - c * d)),
      (r[1] = -(
        s * (d * _ - m * y) -
        p * (a * _ - o * y) +
        v * (a * m - o * d)
      )),
      (r[2] = s * (f * _ - c * y) - u * (a * _ - o * y) + v * (a * c - o * f)),
      (r[3] = -(
        s * (f * m - c * d) -
        u * (a * m - o * d) +
        p * (a * c - o * f)
      )),
      (r[4] = -(
        l * (d * _ - m * y) -
        h * (f * _ - c * y) +
        g * (f * m - c * d)
      )),
      (r[5] = i * (d * _ - m * y) - h * (a * _ - o * y) + g * (a * m - o * d)),
      (r[6] = -(
        i * (f * _ - c * y) -
        l * (a * _ - o * y) +
        g * (a * c - o * f)
      )),
      (r[7] = i * (f * m - c * d) - l * (a * m - o * d) + h * (a * c - o * f)),
      (r[8] = l * (p * _ - m * v) - h * (u * _ - c * v) + g * (u * m - c * p)),
      (r[9] = -(
        i * (p * _ - m * v) -
        h * (s * _ - o * v) +
        g * (s * m - o * p)
      )),
      (r[10] = i * (u * _ - c * v) - l * (s * _ - o * v) + g * (s * c - o * u)),
      (r[11] = -(
        i * (u * m - c * p) -
        l * (s * m - o * p) +
        h * (s * c - o * u)
      )),
      (r[12] = -(
        l * (p * y - d * v) -
        h * (u * y - f * v) +
        g * (u * d - f * p)
      )),
      (r[13] = i * (p * y - d * v) - h * (s * y - a * v) + g * (s * d - a * p)),
      (r[14] = -(
        i * (u * y - f * v) -
        l * (s * y - a * v) +
        g * (s * f - a * u)
      )),
      (r[15] = i * (u * d - f * p) - l * (s * d - a * p) + h * (s * f - a * u)),
      r
    );
  }
  function determinant(r) {
    var n = r[0],
      i = r[1],
      s = r[2],
      a = r[3],
      o = r[4],
      l = r[5],
      u = r[6],
      f = r[7],
      c = r[8],
      h = r[9],
      p = r[10],
      d = r[11],
      m = r[12],
      g = r[13],
      v = r[14],
      y = r[15],
      _ = n * l - i * o,
      b = n * u - s * o,
      S = n * f - a * o,
      P = i * u - s * l,
      I = i * f - a * l,
      F = s * f - a * u,
      X = c * g - h * m,
      W = c * v - p * m,
      Z = c * y - d * m,
      j = h * v - p * g,
      L = h * y - d * g,
      T = p * y - d * v;
    return _ * T - b * L + S * j + P * Z - I * W + F * X;
  }
  function multiply$5(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3],
      u = n[4],
      f = n[5],
      c = n[6],
      h = n[7],
      p = n[8],
      d = n[9],
      m = n[10],
      g = n[11],
      v = n[12],
      y = n[13],
      _ = n[14],
      b = n[15],
      S = i[0],
      P = i[1],
      I = i[2],
      F = i[3];
    return (
      (r[0] = S * s + P * u + I * p + F * v),
      (r[1] = S * a + P * f + I * d + F * y),
      (r[2] = S * o + P * c + I * m + F * _),
      (r[3] = S * l + P * h + I * g + F * b),
      (S = i[4]),
      (P = i[5]),
      (I = i[6]),
      (F = i[7]),
      (r[4] = S * s + P * u + I * p + F * v),
      (r[5] = S * a + P * f + I * d + F * y),
      (r[6] = S * o + P * c + I * m + F * _),
      (r[7] = S * l + P * h + I * g + F * b),
      (S = i[8]),
      (P = i[9]),
      (I = i[10]),
      (F = i[11]),
      (r[8] = S * s + P * u + I * p + F * v),
      (r[9] = S * a + P * f + I * d + F * y),
      (r[10] = S * o + P * c + I * m + F * _),
      (r[11] = S * l + P * h + I * g + F * b),
      (S = i[12]),
      (P = i[13]),
      (I = i[14]),
      (F = i[15]),
      (r[12] = S * s + P * u + I * p + F * v),
      (r[13] = S * a + P * f + I * d + F * y),
      (r[14] = S * o + P * c + I * m + F * _),
      (r[15] = S * l + P * h + I * g + F * b),
      r
    );
  }
  function translate$1(r, n, i) {
    var s = i[0],
      a = i[1],
      o = i[2],
      l,
      u,
      f,
      c,
      h,
      p,
      d,
      m,
      g,
      v,
      y,
      _;
    return (
      n === r
        ? ((r[12] = n[0] * s + n[4] * a + n[8] * o + n[12]),
          (r[13] = n[1] * s + n[5] * a + n[9] * o + n[13]),
          (r[14] = n[2] * s + n[6] * a + n[10] * o + n[14]),
          (r[15] = n[3] * s + n[7] * a + n[11] * o + n[15]))
        : ((l = n[0]),
          (u = n[1]),
          (f = n[2]),
          (c = n[3]),
          (h = n[4]),
          (p = n[5]),
          (d = n[6]),
          (m = n[7]),
          (g = n[8]),
          (v = n[9]),
          (y = n[10]),
          (_ = n[11]),
          (r[0] = l),
          (r[1] = u),
          (r[2] = f),
          (r[3] = c),
          (r[4] = h),
          (r[5] = p),
          (r[6] = d),
          (r[7] = m),
          (r[8] = g),
          (r[9] = v),
          (r[10] = y),
          (r[11] = _),
          (r[12] = l * s + h * a + g * o + n[12]),
          (r[13] = u * s + p * a + v * o + n[13]),
          (r[14] = f * s + d * a + y * o + n[14]),
          (r[15] = c * s + m * a + _ * o + n[15])),
      r
    );
  }
  function scale$5(r, n, i) {
    var s = i[0],
      a = i[1],
      o = i[2];
    return (
      (r[0] = n[0] * s),
      (r[1] = n[1] * s),
      (r[2] = n[2] * s),
      (r[3] = n[3] * s),
      (r[4] = n[4] * a),
      (r[5] = n[5] * a),
      (r[6] = n[6] * a),
      (r[7] = n[7] * a),
      (r[8] = n[8] * o),
      (r[9] = n[9] * o),
      (r[10] = n[10] * o),
      (r[11] = n[11] * o),
      (r[12] = n[12]),
      (r[13] = n[13]),
      (r[14] = n[14]),
      (r[15] = n[15]),
      r
    );
  }
  function rotate$1(r, n, i, s) {
    var a = s[0],
      o = s[1],
      l = s[2],
      u = Math.hypot(a, o, l),
      f,
      c,
      h,
      p,
      d,
      m,
      g,
      v,
      y,
      _,
      b,
      S,
      P,
      I,
      F,
      X,
      W,
      Z,
      j,
      L,
      T,
      A,
      $,
      R;
    return u < EPSILON
      ? null
      : ((u = 1 / u),
        (a *= u),
        (o *= u),
        (l *= u),
        (f = Math.sin(i)),
        (c = Math.cos(i)),
        (h = 1 - c),
        (p = n[0]),
        (d = n[1]),
        (m = n[2]),
        (g = n[3]),
        (v = n[4]),
        (y = n[5]),
        (_ = n[6]),
        (b = n[7]),
        (S = n[8]),
        (P = n[9]),
        (I = n[10]),
        (F = n[11]),
        (X = a * a * h + c),
        (W = o * a * h + l * f),
        (Z = l * a * h - o * f),
        (j = a * o * h - l * f),
        (L = o * o * h + c),
        (T = l * o * h + a * f),
        (A = a * l * h + o * f),
        ($ = o * l * h - a * f),
        (R = l * l * h + c),
        (r[0] = p * X + v * W + S * Z),
        (r[1] = d * X + y * W + P * Z),
        (r[2] = m * X + _ * W + I * Z),
        (r[3] = g * X + b * W + F * Z),
        (r[4] = p * j + v * L + S * T),
        (r[5] = d * j + y * L + P * T),
        (r[6] = m * j + _ * L + I * T),
        (r[7] = g * j + b * L + F * T),
        (r[8] = p * A + v * $ + S * R),
        (r[9] = d * A + y * $ + P * R),
        (r[10] = m * A + _ * $ + I * R),
        (r[11] = g * A + b * $ + F * R),
        n !== r &&
          ((r[12] = n[12]), (r[13] = n[13]), (r[14] = n[14]), (r[15] = n[15])),
        r);
  }
  function rotateX$3(r, n, i) {
    var s = Math.sin(i),
      a = Math.cos(i),
      o = n[4],
      l = n[5],
      u = n[6],
      f = n[7],
      c = n[8],
      h = n[9],
      p = n[10],
      d = n[11];
    return (
      n !== r &&
        ((r[0] = n[0]),
        (r[1] = n[1]),
        (r[2] = n[2]),
        (r[3] = n[3]),
        (r[12] = n[12]),
        (r[13] = n[13]),
        (r[14] = n[14]),
        (r[15] = n[15])),
      (r[4] = o * a + c * s),
      (r[5] = l * a + h * s),
      (r[6] = u * a + p * s),
      (r[7] = f * a + d * s),
      (r[8] = c * a - o * s),
      (r[9] = h * a - l * s),
      (r[10] = p * a - u * s),
      (r[11] = d * a - f * s),
      r
    );
  }
  function rotateY$3(r, n, i) {
    var s = Math.sin(i),
      a = Math.cos(i),
      o = n[0],
      l = n[1],
      u = n[2],
      f = n[3],
      c = n[8],
      h = n[9],
      p = n[10],
      d = n[11];
    return (
      n !== r &&
        ((r[4] = n[4]),
        (r[5] = n[5]),
        (r[6] = n[6]),
        (r[7] = n[7]),
        (r[12] = n[12]),
        (r[13] = n[13]),
        (r[14] = n[14]),
        (r[15] = n[15])),
      (r[0] = o * a - c * s),
      (r[1] = l * a - h * s),
      (r[2] = u * a - p * s),
      (r[3] = f * a - d * s),
      (r[8] = o * s + c * a),
      (r[9] = l * s + h * a),
      (r[10] = u * s + p * a),
      (r[11] = f * s + d * a),
      r
    );
  }
  function rotateZ$3(r, n, i) {
    var s = Math.sin(i),
      a = Math.cos(i),
      o = n[0],
      l = n[1],
      u = n[2],
      f = n[3],
      c = n[4],
      h = n[5],
      p = n[6],
      d = n[7];
    return (
      n !== r &&
        ((r[8] = n[8]),
        (r[9] = n[9]),
        (r[10] = n[10]),
        (r[11] = n[11]),
        (r[12] = n[12]),
        (r[13] = n[13]),
        (r[14] = n[14]),
        (r[15] = n[15])),
      (r[0] = o * a + c * s),
      (r[1] = l * a + h * s),
      (r[2] = u * a + p * s),
      (r[3] = f * a + d * s),
      (r[4] = c * a - o * s),
      (r[5] = h * a - l * s),
      (r[6] = p * a - u * s),
      (r[7] = d * a - f * s),
      r
    );
  }
  function fromTranslation$1(r, n) {
    return (
      (r[0] = 1),
      (r[1] = 0),
      (r[2] = 0),
      (r[3] = 0),
      (r[4] = 0),
      (r[5] = 1),
      (r[6] = 0),
      (r[7] = 0),
      (r[8] = 0),
      (r[9] = 0),
      (r[10] = 1),
      (r[11] = 0),
      (r[12] = n[0]),
      (r[13] = n[1]),
      (r[14] = n[2]),
      (r[15] = 1),
      r
    );
  }
  function fromScaling(r, n) {
    return (
      (r[0] = n[0]),
      (r[1] = 0),
      (r[2] = 0),
      (r[3] = 0),
      (r[4] = 0),
      (r[5] = n[1]),
      (r[6] = 0),
      (r[7] = 0),
      (r[8] = 0),
      (r[9] = 0),
      (r[10] = n[2]),
      (r[11] = 0),
      (r[12] = 0),
      (r[13] = 0),
      (r[14] = 0),
      (r[15] = 1),
      r
    );
  }
  function fromRotation$1(r, n, i) {
    var s = i[0],
      a = i[1],
      o = i[2],
      l = Math.hypot(s, a, o),
      u,
      f,
      c;
    return l < EPSILON
      ? null
      : ((l = 1 / l),
        (s *= l),
        (a *= l),
        (o *= l),
        (u = Math.sin(n)),
        (f = Math.cos(n)),
        (c = 1 - f),
        (r[0] = s * s * c + f),
        (r[1] = a * s * c + o * u),
        (r[2] = o * s * c - a * u),
        (r[3] = 0),
        (r[4] = s * a * c - o * u),
        (r[5] = a * a * c + f),
        (r[6] = o * a * c + s * u),
        (r[7] = 0),
        (r[8] = s * o * c + a * u),
        (r[9] = a * o * c - s * u),
        (r[10] = o * o * c + f),
        (r[11] = 0),
        (r[12] = 0),
        (r[13] = 0),
        (r[14] = 0),
        (r[15] = 1),
        r);
  }
  function fromXRotation(r, n) {
    var i = Math.sin(n),
      s = Math.cos(n);
    return (
      (r[0] = 1),
      (r[1] = 0),
      (r[2] = 0),
      (r[3] = 0),
      (r[4] = 0),
      (r[5] = s),
      (r[6] = i),
      (r[7] = 0),
      (r[8] = 0),
      (r[9] = -i),
      (r[10] = s),
      (r[11] = 0),
      (r[12] = 0),
      (r[13] = 0),
      (r[14] = 0),
      (r[15] = 1),
      r
    );
  }
  function fromYRotation(r, n) {
    var i = Math.sin(n),
      s = Math.cos(n);
    return (
      (r[0] = s),
      (r[1] = 0),
      (r[2] = -i),
      (r[3] = 0),
      (r[4] = 0),
      (r[5] = 1),
      (r[6] = 0),
      (r[7] = 0),
      (r[8] = i),
      (r[9] = 0),
      (r[10] = s),
      (r[11] = 0),
      (r[12] = 0),
      (r[13] = 0),
      (r[14] = 0),
      (r[15] = 1),
      r
    );
  }
  function fromZRotation(r, n) {
    var i = Math.sin(n),
      s = Math.cos(n);
    return (
      (r[0] = s),
      (r[1] = i),
      (r[2] = 0),
      (r[3] = 0),
      (r[4] = -i),
      (r[5] = s),
      (r[6] = 0),
      (r[7] = 0),
      (r[8] = 0),
      (r[9] = 0),
      (r[10] = 1),
      (r[11] = 0),
      (r[12] = 0),
      (r[13] = 0),
      (r[14] = 0),
      (r[15] = 1),
      r
    );
  }
  function fromRotationTranslation$1(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3],
      u = s + s,
      f = a + a,
      c = o + o,
      h = s * u,
      p = s * f,
      d = s * c,
      m = a * f,
      g = a * c,
      v = o * c,
      y = l * u,
      _ = l * f,
      b = l * c;
    return (
      (r[0] = 1 - (m + v)),
      (r[1] = p + b),
      (r[2] = d - _),
      (r[3] = 0),
      (r[4] = p - b),
      (r[5] = 1 - (h + v)),
      (r[6] = g + y),
      (r[7] = 0),
      (r[8] = d + _),
      (r[9] = g - y),
      (r[10] = 1 - (h + m)),
      (r[11] = 0),
      (r[12] = i[0]),
      (r[13] = i[1]),
      (r[14] = i[2]),
      (r[15] = 1),
      r
    );
  }
  function fromQuat2(r, n) {
    var i = new ARRAY_TYPE(3),
      s = -n[0],
      a = -n[1],
      o = -n[2],
      l = n[3],
      u = n[4],
      f = n[5],
      c = n[6],
      h = n[7],
      p = s * s + a * a + o * o + l * l;
    return (
      p > 0
        ? ((i[0] = ((u * l + h * s + f * o - c * a) * 2) / p),
          (i[1] = ((f * l + h * a + c * s - u * o) * 2) / p),
          (i[2] = ((c * l + h * o + u * a - f * s) * 2) / p))
        : ((i[0] = (u * l + h * s + f * o - c * a) * 2),
          (i[1] = (f * l + h * a + c * s - u * o) * 2),
          (i[2] = (c * l + h * o + u * a - f * s) * 2)),
      fromRotationTranslation$1(r, n, i),
      r
    );
  }
  function getTranslation$1(r, n) {
    return (r[0] = n[12]), (r[1] = n[13]), (r[2] = n[14]), r;
  }
  function getScaling(r, n) {
    var i = n[0],
      s = n[1],
      a = n[2],
      o = n[4],
      l = n[5],
      u = n[6],
      f = n[8],
      c = n[9],
      h = n[10];
    return (
      (r[0] = Math.hypot(i, s, a)),
      (r[1] = Math.hypot(o, l, u)),
      (r[2] = Math.hypot(f, c, h)),
      r
    );
  }
  function getRotation(r, n) {
    var i = new ARRAY_TYPE(3);
    getScaling(i, n);
    var s = 1 / i[0],
      a = 1 / i[1],
      o = 1 / i[2],
      l = n[0] * s,
      u = n[1] * a,
      f = n[2] * o,
      c = n[4] * s,
      h = n[5] * a,
      p = n[6] * o,
      d = n[8] * s,
      m = n[9] * a,
      g = n[10] * o,
      v = l + h + g,
      y = 0;
    return (
      v > 0
        ? ((y = Math.sqrt(v + 1) * 2),
          (r[3] = 0.25 * y),
          (r[0] = (p - m) / y),
          (r[1] = (d - f) / y),
          (r[2] = (u - c) / y))
        : l > h && l > g
        ? ((y = Math.sqrt(1 + l - h - g) * 2),
          (r[3] = (p - m) / y),
          (r[0] = 0.25 * y),
          (r[1] = (u + c) / y),
          (r[2] = (d + f) / y))
        : h > g
        ? ((y = Math.sqrt(1 + h - l - g) * 2),
          (r[3] = (d - f) / y),
          (r[0] = (u + c) / y),
          (r[1] = 0.25 * y),
          (r[2] = (p + m) / y))
        : ((y = Math.sqrt(1 + g - l - h) * 2),
          (r[3] = (u - c) / y),
          (r[0] = (d + f) / y),
          (r[1] = (p + m) / y),
          (r[2] = 0.25 * y)),
      r
    );
  }
  function fromRotationTranslationScale(r, n, i, s) {
    var a = n[0],
      o = n[1],
      l = n[2],
      u = n[3],
      f = a + a,
      c = o + o,
      h = l + l,
      p = a * f,
      d = a * c,
      m = a * h,
      g = o * c,
      v = o * h,
      y = l * h,
      _ = u * f,
      b = u * c,
      S = u * h,
      P = s[0],
      I = s[1],
      F = s[2];
    return (
      (r[0] = (1 - (g + y)) * P),
      (r[1] = (d + S) * P),
      (r[2] = (m - b) * P),
      (r[3] = 0),
      (r[4] = (d - S) * I),
      (r[5] = (1 - (p + y)) * I),
      (r[6] = (v + _) * I),
      (r[7] = 0),
      (r[8] = (m + b) * F),
      (r[9] = (v - _) * F),
      (r[10] = (1 - (p + g)) * F),
      (r[11] = 0),
      (r[12] = i[0]),
      (r[13] = i[1]),
      (r[14] = i[2]),
      (r[15] = 1),
      r
    );
  }
  function fromRotationTranslationScaleOrigin(r, n, i, s, a) {
    var o = n[0],
      l = n[1],
      u = n[2],
      f = n[3],
      c = o + o,
      h = l + l,
      p = u + u,
      d = o * c,
      m = o * h,
      g = o * p,
      v = l * h,
      y = l * p,
      _ = u * p,
      b = f * c,
      S = f * h,
      P = f * p,
      I = s[0],
      F = s[1],
      X = s[2],
      W = a[0],
      Z = a[1],
      j = a[2],
      L = (1 - (v + _)) * I,
      T = (m + P) * I,
      A = (g - S) * I,
      $ = (m - P) * F,
      R = (1 - (d + _)) * F,
      M = (y + b) * F,
      w = (g + S) * X,
      O = (y - b) * X,
      E = (1 - (d + v)) * X;
    return (
      (r[0] = L),
      (r[1] = T),
      (r[2] = A),
      (r[3] = 0),
      (r[4] = $),
      (r[5] = R),
      (r[6] = M),
      (r[7] = 0),
      (r[8] = w),
      (r[9] = O),
      (r[10] = E),
      (r[11] = 0),
      (r[12] = i[0] + W - (L * W + $ * Z + w * j)),
      (r[13] = i[1] + Z - (T * W + R * Z + O * j)),
      (r[14] = i[2] + j - (A * W + M * Z + E * j)),
      (r[15] = 1),
      r
    );
  }
  function fromQuat(r, n) {
    var i = n[0],
      s = n[1],
      a = n[2],
      o = n[3],
      l = i + i,
      u = s + s,
      f = a + a,
      c = i * l,
      h = s * l,
      p = s * u,
      d = a * l,
      m = a * u,
      g = a * f,
      v = o * l,
      y = o * u,
      _ = o * f;
    return (
      (r[0] = 1 - p - g),
      (r[1] = h + _),
      (r[2] = d - y),
      (r[3] = 0),
      (r[4] = h - _),
      (r[5] = 1 - c - g),
      (r[6] = m + v),
      (r[7] = 0),
      (r[8] = d + y),
      (r[9] = m - v),
      (r[10] = 1 - c - p),
      (r[11] = 0),
      (r[12] = 0),
      (r[13] = 0),
      (r[14] = 0),
      (r[15] = 1),
      r
    );
  }
  function frustum(r, n, i, s, a, o, l) {
    var u = 1 / (i - n),
      f = 1 / (a - s),
      c = 1 / (o - l);
    return (
      (r[0] = o * 2 * u),
      (r[1] = 0),
      (r[2] = 0),
      (r[3] = 0),
      (r[4] = 0),
      (r[5] = o * 2 * f),
      (r[6] = 0),
      (r[7] = 0),
      (r[8] = (i + n) * u),
      (r[9] = (a + s) * f),
      (r[10] = (l + o) * c),
      (r[11] = -1),
      (r[12] = 0),
      (r[13] = 0),
      (r[14] = l * o * 2 * c),
      (r[15] = 0),
      r
    );
  }
  function perspectiveNO(r, n, i, s, a) {
    var o = 1 / Math.tan(n / 2),
      l;
    return (
      (r[0] = o / i),
      (r[1] = 0),
      (r[2] = 0),
      (r[3] = 0),
      (r[4] = 0),
      (r[5] = o),
      (r[6] = 0),
      (r[7] = 0),
      (r[8] = 0),
      (r[9] = 0),
      (r[11] = -1),
      (r[12] = 0),
      (r[13] = 0),
      (r[15] = 0),
      a != null && a !== 1 / 0
        ? ((l = 1 / (s - a)), (r[10] = (a + s) * l), (r[14] = 2 * a * s * l))
        : ((r[10] = -1), (r[14] = -2 * s)),
      r
    );
  }
  var perspective = perspectiveNO;
  function perspectiveZO(r, n, i, s, a) {
    var o = 1 / Math.tan(n / 2),
      l;
    return (
      (r[0] = o / i),
      (r[1] = 0),
      (r[2] = 0),
      (r[3] = 0),
      (r[4] = 0),
      (r[5] = o),
      (r[6] = 0),
      (r[7] = 0),
      (r[8] = 0),
      (r[9] = 0),
      (r[11] = -1),
      (r[12] = 0),
      (r[13] = 0),
      (r[15] = 0),
      a != null && a !== 1 / 0
        ? ((l = 1 / (s - a)), (r[10] = a * l), (r[14] = a * s * l))
        : ((r[10] = -1), (r[14] = -s)),
      r
    );
  }
  function perspectiveFromFieldOfView(r, n, i, s) {
    var a = Math.tan((n.upDegrees * Math.PI) / 180),
      o = Math.tan((n.downDegrees * Math.PI) / 180),
      l = Math.tan((n.leftDegrees * Math.PI) / 180),
      u = Math.tan((n.rightDegrees * Math.PI) / 180),
      f = 2 / (l + u),
      c = 2 / (a + o);
    return (
      (r[0] = f),
      (r[1] = 0),
      (r[2] = 0),
      (r[3] = 0),
      (r[4] = 0),
      (r[5] = c),
      (r[6] = 0),
      (r[7] = 0),
      (r[8] = -((l - u) * f * 0.5)),
      (r[9] = (a - o) * c * 0.5),
      (r[10] = s / (i - s)),
      (r[11] = -1),
      (r[12] = 0),
      (r[13] = 0),
      (r[14] = (s * i) / (i - s)),
      (r[15] = 0),
      r
    );
  }
  function orthoNO(r, n, i, s, a, o, l) {
    var u = 1 / (n - i),
      f = 1 / (s - a),
      c = 1 / (o - l);
    return (
      (r[0] = -2 * u),
      (r[1] = 0),
      (r[2] = 0),
      (r[3] = 0),
      (r[4] = 0),
      (r[5] = -2 * f),
      (r[6] = 0),
      (r[7] = 0),
      (r[8] = 0),
      (r[9] = 0),
      (r[10] = 2 * c),
      (r[11] = 0),
      (r[12] = (n + i) * u),
      (r[13] = (a + s) * f),
      (r[14] = (l + o) * c),
      (r[15] = 1),
      r
    );
  }
  var ortho = orthoNO;
  function orthoZO(r, n, i, s, a, o, l) {
    var u = 1 / (n - i),
      f = 1 / (s - a),
      c = 1 / (o - l);
    return (
      (r[0] = -2 * u),
      (r[1] = 0),
      (r[2] = 0),
      (r[3] = 0),
      (r[4] = 0),
      (r[5] = -2 * f),
      (r[6] = 0),
      (r[7] = 0),
      (r[8] = 0),
      (r[9] = 0),
      (r[10] = c),
      (r[11] = 0),
      (r[12] = (n + i) * u),
      (r[13] = (a + s) * f),
      (r[14] = o * c),
      (r[15] = 1),
      r
    );
  }
  function lookAt(r, n, i, s) {
    var a,
      o,
      l,
      u,
      f,
      c,
      h,
      p,
      d,
      m,
      g = n[0],
      v = n[1],
      y = n[2],
      _ = s[0],
      b = s[1],
      S = s[2],
      P = i[0],
      I = i[1],
      F = i[2];
    return Math.abs(g - P) < EPSILON &&
      Math.abs(v - I) < EPSILON &&
      Math.abs(y - F) < EPSILON
      ? identity$2(r)
      : ((h = g - P),
        (p = v - I),
        (d = y - F),
        (m = 1 / Math.hypot(h, p, d)),
        (h *= m),
        (p *= m),
        (d *= m),
        (a = b * d - S * p),
        (o = S * h - _ * d),
        (l = _ * p - b * h),
        (m = Math.hypot(a, o, l)),
        m
          ? ((m = 1 / m), (a *= m), (o *= m), (l *= m))
          : ((a = 0), (o = 0), (l = 0)),
        (u = p * l - d * o),
        (f = d * a - h * l),
        (c = h * o - p * a),
        (m = Math.hypot(u, f, c)),
        m
          ? ((m = 1 / m), (u *= m), (f *= m), (c *= m))
          : ((u = 0), (f = 0), (c = 0)),
        (r[0] = a),
        (r[1] = u),
        (r[2] = h),
        (r[3] = 0),
        (r[4] = o),
        (r[5] = f),
        (r[6] = p),
        (r[7] = 0),
        (r[8] = l),
        (r[9] = c),
        (r[10] = d),
        (r[11] = 0),
        (r[12] = -(a * g + o * v + l * y)),
        (r[13] = -(u * g + f * v + c * y)),
        (r[14] = -(h * g + p * v + d * y)),
        (r[15] = 1),
        r);
  }
  function targetTo(r, n, i, s) {
    var a = n[0],
      o = n[1],
      l = n[2],
      u = s[0],
      f = s[1],
      c = s[2],
      h = a - i[0],
      p = o - i[1],
      d = l - i[2],
      m = h * h + p * p + d * d;
    m > 0 && ((m = 1 / Math.sqrt(m)), (h *= m), (p *= m), (d *= m));
    var g = f * d - c * p,
      v = c * h - u * d,
      y = u * p - f * h;
    return (
      (m = g * g + v * v + y * y),
      m > 0 && ((m = 1 / Math.sqrt(m)), (g *= m), (v *= m), (y *= m)),
      (r[0] = g),
      (r[1] = v),
      (r[2] = y),
      (r[3] = 0),
      (r[4] = p * y - d * v),
      (r[5] = d * g - h * y),
      (r[6] = h * v - p * g),
      (r[7] = 0),
      (r[8] = h),
      (r[9] = p),
      (r[10] = d),
      (r[11] = 0),
      (r[12] = a),
      (r[13] = o),
      (r[14] = l),
      (r[15] = 1),
      r
    );
  }
  function str$5(r) {
    return (
      "mat4(" +
      r[0] +
      ", " +
      r[1] +
      ", " +
      r[2] +
      ", " +
      r[3] +
      ", " +
      r[4] +
      ", " +
      r[5] +
      ", " +
      r[6] +
      ", " +
      r[7] +
      ", " +
      r[8] +
      ", " +
      r[9] +
      ", " +
      r[10] +
      ", " +
      r[11] +
      ", " +
      r[12] +
      ", " +
      r[13] +
      ", " +
      r[14] +
      ", " +
      r[15] +
      ")"
    );
  }
  function frob(r) {
    return Math.hypot(
      r[0],
      r[1],
      r[2],
      r[3],
      r[4],
      r[5],
      r[6],
      r[7],
      r[8],
      r[9],
      r[10],
      r[11],
      r[12],
      r[13],
      r[14],
      r[15]
    );
  }
  function add$5(r, n, i) {
    return (
      (r[0] = n[0] + i[0]),
      (r[1] = n[1] + i[1]),
      (r[2] = n[2] + i[2]),
      (r[3] = n[3] + i[3]),
      (r[4] = n[4] + i[4]),
      (r[5] = n[5] + i[5]),
      (r[6] = n[6] + i[6]),
      (r[7] = n[7] + i[7]),
      (r[8] = n[8] + i[8]),
      (r[9] = n[9] + i[9]),
      (r[10] = n[10] + i[10]),
      (r[11] = n[11] + i[11]),
      (r[12] = n[12] + i[12]),
      (r[13] = n[13] + i[13]),
      (r[14] = n[14] + i[14]),
      (r[15] = n[15] + i[15]),
      r
    );
  }
  function subtract$3(r, n, i) {
    return (
      (r[0] = n[0] - i[0]),
      (r[1] = n[1] - i[1]),
      (r[2] = n[2] - i[2]),
      (r[3] = n[3] - i[3]),
      (r[4] = n[4] - i[4]),
      (r[5] = n[5] - i[5]),
      (r[6] = n[6] - i[6]),
      (r[7] = n[7] - i[7]),
      (r[8] = n[8] - i[8]),
      (r[9] = n[9] - i[9]),
      (r[10] = n[10] - i[10]),
      (r[11] = n[11] - i[11]),
      (r[12] = n[12] - i[12]),
      (r[13] = n[13] - i[13]),
      (r[14] = n[14] - i[14]),
      (r[15] = n[15] - i[15]),
      r
    );
  }
  function multiplyScalar(r, n, i) {
    return (
      (r[0] = n[0] * i),
      (r[1] = n[1] * i),
      (r[2] = n[2] * i),
      (r[3] = n[3] * i),
      (r[4] = n[4] * i),
      (r[5] = n[5] * i),
      (r[6] = n[6] * i),
      (r[7] = n[7] * i),
      (r[8] = n[8] * i),
      (r[9] = n[9] * i),
      (r[10] = n[10] * i),
      (r[11] = n[11] * i),
      (r[12] = n[12] * i),
      (r[13] = n[13] * i),
      (r[14] = n[14] * i),
      (r[15] = n[15] * i),
      r
    );
  }
  function multiplyScalarAndAdd(r, n, i, s) {
    return (
      (r[0] = n[0] + i[0] * s),
      (r[1] = n[1] + i[1] * s),
      (r[2] = n[2] + i[2] * s),
      (r[3] = n[3] + i[3] * s),
      (r[4] = n[4] + i[4] * s),
      (r[5] = n[5] + i[5] * s),
      (r[6] = n[6] + i[6] * s),
      (r[7] = n[7] + i[7] * s),
      (r[8] = n[8] + i[8] * s),
      (r[9] = n[9] + i[9] * s),
      (r[10] = n[10] + i[10] * s),
      (r[11] = n[11] + i[11] * s),
      (r[12] = n[12] + i[12] * s),
      (r[13] = n[13] + i[13] * s),
      (r[14] = n[14] + i[14] * s),
      (r[15] = n[15] + i[15] * s),
      r
    );
  }
  function exactEquals$5(r, n) {
    return (
      r[0] === n[0] &&
      r[1] === n[1] &&
      r[2] === n[2] &&
      r[3] === n[3] &&
      r[4] === n[4] &&
      r[5] === n[5] &&
      r[6] === n[6] &&
      r[7] === n[7] &&
      r[8] === n[8] &&
      r[9] === n[9] &&
      r[10] === n[10] &&
      r[11] === n[11] &&
      r[12] === n[12] &&
      r[13] === n[13] &&
      r[14] === n[14] &&
      r[15] === n[15]
    );
  }
  function equals$5(r, n) {
    var i = r[0],
      s = r[1],
      a = r[2],
      o = r[3],
      l = r[4],
      u = r[5],
      f = r[6],
      c = r[7],
      h = r[8],
      p = r[9],
      d = r[10],
      m = r[11],
      g = r[12],
      v = r[13],
      y = r[14],
      _ = r[15],
      b = n[0],
      S = n[1],
      P = n[2],
      I = n[3],
      F = n[4],
      X = n[5],
      W = n[6],
      Z = n[7],
      j = n[8],
      L = n[9],
      T = n[10],
      A = n[11],
      $ = n[12],
      R = n[13],
      M = n[14],
      w = n[15];
    return (
      Math.abs(i - b) <= EPSILON * Math.max(1, Math.abs(i), Math.abs(b)) &&
      Math.abs(s - S) <= EPSILON * Math.max(1, Math.abs(s), Math.abs(S)) &&
      Math.abs(a - P) <= EPSILON * Math.max(1, Math.abs(a), Math.abs(P)) &&
      Math.abs(o - I) <= EPSILON * Math.max(1, Math.abs(o), Math.abs(I)) &&
      Math.abs(l - F) <= EPSILON * Math.max(1, Math.abs(l), Math.abs(F)) &&
      Math.abs(u - X) <= EPSILON * Math.max(1, Math.abs(u), Math.abs(X)) &&
      Math.abs(f - W) <= EPSILON * Math.max(1, Math.abs(f), Math.abs(W)) &&
      Math.abs(c - Z) <= EPSILON * Math.max(1, Math.abs(c), Math.abs(Z)) &&
      Math.abs(h - j) <= EPSILON * Math.max(1, Math.abs(h), Math.abs(j)) &&
      Math.abs(p - L) <= EPSILON * Math.max(1, Math.abs(p), Math.abs(L)) &&
      Math.abs(d - T) <= EPSILON * Math.max(1, Math.abs(d), Math.abs(T)) &&
      Math.abs(m - A) <= EPSILON * Math.max(1, Math.abs(m), Math.abs(A)) &&
      Math.abs(g - $) <= EPSILON * Math.max(1, Math.abs(g), Math.abs($)) &&
      Math.abs(v - R) <= EPSILON * Math.max(1, Math.abs(v), Math.abs(R)) &&
      Math.abs(y - M) <= EPSILON * Math.max(1, Math.abs(y), Math.abs(M)) &&
      Math.abs(_ - w) <= EPSILON * Math.max(1, Math.abs(_), Math.abs(w))
    );
  }
  var mul$5 = multiply$5,
    sub$3 = subtract$3,
    mat4 = Object.freeze({
      __proto__: null,
      create: create$5,
      clone: clone$5,
      copy: copy$5,
      fromValues: fromValues$5,
      set: set$5,
      identity: identity$2,
      transpose: transpose,
      invert: invert$2,
      adjoint: adjoint,
      determinant: determinant,
      multiply: multiply$5,
      translate: translate$1,
      scale: scale$5,
      rotate: rotate$1,
      rotateX: rotateX$3,
      rotateY: rotateY$3,
      rotateZ: rotateZ$3,
      fromTranslation: fromTranslation$1,
      fromScaling: fromScaling,
      fromRotation: fromRotation$1,
      fromXRotation: fromXRotation,
      fromYRotation: fromYRotation,
      fromZRotation: fromZRotation,
      fromRotationTranslation: fromRotationTranslation$1,
      fromQuat2: fromQuat2,
      getTranslation: getTranslation$1,
      getScaling: getScaling,
      getRotation: getRotation,
      fromRotationTranslationScale: fromRotationTranslationScale,
      fromRotationTranslationScaleOrigin: fromRotationTranslationScaleOrigin,
      fromQuat: fromQuat,
      frustum: frustum,
      perspectiveNO: perspectiveNO,
      perspective: perspective,
      perspectiveZO: perspectiveZO,
      perspectiveFromFieldOfView: perspectiveFromFieldOfView,
      orthoNO: orthoNO,
      ortho: ortho,
      orthoZO: orthoZO,
      lookAt: lookAt,
      targetTo: targetTo,
      str: str$5,
      frob: frob,
      add: add$5,
      subtract: subtract$3,
      multiplyScalar: multiplyScalar,
      multiplyScalarAndAdd: multiplyScalarAndAdd,
      exactEquals: exactEquals$5,
      equals: equals$5,
      mul: mul$5,
      sub: sub$3,
    });
  function create$4() {
    var r = new ARRAY_TYPE(3);
    return (
      ARRAY_TYPE != Float32Array && ((r[0] = 0), (r[1] = 0), (r[2] = 0)), r
    );
  }
  function clone$4(r) {
    var n = new ARRAY_TYPE(3);
    return (n[0] = r[0]), (n[1] = r[1]), (n[2] = r[2]), n;
  }
  function length$4(r) {
    var n = r[0],
      i = r[1],
      s = r[2];
    return Math.hypot(n, i, s);
  }
  function fromValues$4(r, n, i) {
    var s = new ARRAY_TYPE(3);
    return (s[0] = r), (s[1] = n), (s[2] = i), s;
  }
  function copy$4(r, n) {
    return (r[0] = n[0]), (r[1] = n[1]), (r[2] = n[2]), r;
  }
  function set$4(r, n, i, s) {
    return (r[0] = n), (r[1] = i), (r[2] = s), r;
  }
  function add$4(r, n, i) {
    return (r[0] = n[0] + i[0]), (r[1] = n[1] + i[1]), (r[2] = n[2] + i[2]), r;
  }
  function subtract$2(r, n, i) {
    return (r[0] = n[0] - i[0]), (r[1] = n[1] - i[1]), (r[2] = n[2] - i[2]), r;
  }
  function multiply$4(r, n, i) {
    return (r[0] = n[0] * i[0]), (r[1] = n[1] * i[1]), (r[2] = n[2] * i[2]), r;
  }
  function divide$2(r, n, i) {
    return (r[0] = n[0] / i[0]), (r[1] = n[1] / i[1]), (r[2] = n[2] / i[2]), r;
  }
  function ceil$2(r, n) {
    return (
      (r[0] = Math.ceil(n[0])),
      (r[1] = Math.ceil(n[1])),
      (r[2] = Math.ceil(n[2])),
      r
    );
  }
  function floor$2(r, n) {
    return (
      (r[0] = Math.floor(n[0])),
      (r[1] = Math.floor(n[1])),
      (r[2] = Math.floor(n[2])),
      r
    );
  }
  function min$2(r, n, i) {
    return (
      (r[0] = Math.min(n[0], i[0])),
      (r[1] = Math.min(n[1], i[1])),
      (r[2] = Math.min(n[2], i[2])),
      r
    );
  }
  function max$2(r, n, i) {
    return (
      (r[0] = Math.max(n[0], i[0])),
      (r[1] = Math.max(n[1], i[1])),
      (r[2] = Math.max(n[2], i[2])),
      r
    );
  }
  function round$2(r, n) {
    return (
      (r[0] = Math.round(n[0])),
      (r[1] = Math.round(n[1])),
      (r[2] = Math.round(n[2])),
      r
    );
  }
  function scale$4(r, n, i) {
    return (r[0] = n[0] * i), (r[1] = n[1] * i), (r[2] = n[2] * i), r;
  }
  function scaleAndAdd$2(r, n, i, s) {
    return (
      (r[0] = n[0] + i[0] * s),
      (r[1] = n[1] + i[1] * s),
      (r[2] = n[2] + i[2] * s),
      r
    );
  }
  function distance$2(r, n) {
    var i = n[0] - r[0],
      s = n[1] - r[1],
      a = n[2] - r[2];
    return Math.hypot(i, s, a);
  }
  function squaredDistance$2(r, n) {
    var i = n[0] - r[0],
      s = n[1] - r[1],
      a = n[2] - r[2];
    return i * i + s * s + a * a;
  }
  function squaredLength$4(r) {
    var n = r[0],
      i = r[1],
      s = r[2];
    return n * n + i * i + s * s;
  }
  function negate$2(r, n) {
    return (r[0] = -n[0]), (r[1] = -n[1]), (r[2] = -n[2]), r;
  }
  function inverse$2(r, n) {
    return (r[0] = 1 / n[0]), (r[1] = 1 / n[1]), (r[2] = 1 / n[2]), r;
  }
  function normalize$4(r, n) {
    var i = n[0],
      s = n[1],
      a = n[2],
      o = i * i + s * s + a * a;
    return (
      o > 0 && (o = 1 / Math.sqrt(o)),
      (r[0] = n[0] * o),
      (r[1] = n[1] * o),
      (r[2] = n[2] * o),
      r
    );
  }
  function dot$4(r, n) {
    return r[0] * n[0] + r[1] * n[1] + r[2] * n[2];
  }
  function cross$2(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = i[0],
      u = i[1],
      f = i[2];
    return (
      (r[0] = a * f - o * u), (r[1] = o * l - s * f), (r[2] = s * u - a * l), r
    );
  }
  function lerp$4(r, n, i, s) {
    var a = n[0],
      o = n[1],
      l = n[2];
    return (
      (r[0] = a + s * (i[0] - a)),
      (r[1] = o + s * (i[1] - o)),
      (r[2] = l + s * (i[2] - l)),
      r
    );
  }
  function hermite(r, n, i, s, a, o) {
    var l = o * o,
      u = l * (2 * o - 3) + 1,
      f = l * (o - 2) + o,
      c = l * (o - 1),
      h = l * (3 - 2 * o);
    return (
      (r[0] = n[0] * u + i[0] * f + s[0] * c + a[0] * h),
      (r[1] = n[1] * u + i[1] * f + s[1] * c + a[1] * h),
      (r[2] = n[2] * u + i[2] * f + s[2] * c + a[2] * h),
      r
    );
  }
  function bezier(r, n, i, s, a, o) {
    var l = 1 - o,
      u = l * l,
      f = o * o,
      c = u * l,
      h = 3 * o * u,
      p = 3 * f * l,
      d = f * o;
    return (
      (r[0] = n[0] * c + i[0] * h + s[0] * p + a[0] * d),
      (r[1] = n[1] * c + i[1] * h + s[1] * p + a[1] * d),
      (r[2] = n[2] * c + i[2] * h + s[2] * p + a[2] * d),
      r
    );
  }
  function random$3(r, n) {
    n = n || 1;
    var i = RANDOM() * 2 * Math.PI,
      s = RANDOM() * 2 - 1,
      a = Math.sqrt(1 - s * s) * n;
    return (
      (r[0] = Math.cos(i) * a), (r[1] = Math.sin(i) * a), (r[2] = s * n), r
    );
  }
  function transformMat4$2(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = i[3] * s + i[7] * a + i[11] * o + i[15];
    return (
      (l = l || 1),
      (r[0] = (i[0] * s + i[4] * a + i[8] * o + i[12]) / l),
      (r[1] = (i[1] * s + i[5] * a + i[9] * o + i[13]) / l),
      (r[2] = (i[2] * s + i[6] * a + i[10] * o + i[14]) / l),
      r
    );
  }
  function transformMat3$1(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2];
    return (
      (r[0] = s * i[0] + a * i[3] + o * i[6]),
      (r[1] = s * i[1] + a * i[4] + o * i[7]),
      (r[2] = s * i[2] + a * i[5] + o * i[8]),
      r
    );
  }
  function transformQuat$1(r, n, i) {
    var s = i[0],
      a = i[1],
      o = i[2],
      l = i[3],
      u = n[0],
      f = n[1],
      c = n[2],
      h = a * c - o * f,
      p = o * u - s * c,
      d = s * f - a * u,
      m = a * d - o * p,
      g = o * h - s * d,
      v = s * p - a * h,
      y = l * 2;
    return (
      (h *= y),
      (p *= y),
      (d *= y),
      (m *= 2),
      (g *= 2),
      (v *= 2),
      (r[0] = u + h + m),
      (r[1] = f + p + g),
      (r[2] = c + d + v),
      r
    );
  }
  function rotateX$2(r, n, i, s) {
    var a = [],
      o = [];
    return (
      (a[0] = n[0] - i[0]),
      (a[1] = n[1] - i[1]),
      (a[2] = n[2] - i[2]),
      (o[0] = a[0]),
      (o[1] = a[1] * Math.cos(s) - a[2] * Math.sin(s)),
      (o[2] = a[1] * Math.sin(s) + a[2] * Math.cos(s)),
      (r[0] = o[0] + i[0]),
      (r[1] = o[1] + i[1]),
      (r[2] = o[2] + i[2]),
      r
    );
  }
  function rotateY$2(r, n, i, s) {
    var a = [],
      o = [];
    return (
      (a[0] = n[0] - i[0]),
      (a[1] = n[1] - i[1]),
      (a[2] = n[2] - i[2]),
      (o[0] = a[2] * Math.sin(s) + a[0] * Math.cos(s)),
      (o[1] = a[1]),
      (o[2] = a[2] * Math.cos(s) - a[0] * Math.sin(s)),
      (r[0] = o[0] + i[0]),
      (r[1] = o[1] + i[1]),
      (r[2] = o[2] + i[2]),
      r
    );
  }
  function rotateZ$2(r, n, i, s) {
    var a = [],
      o = [];
    return (
      (a[0] = n[0] - i[0]),
      (a[1] = n[1] - i[1]),
      (a[2] = n[2] - i[2]),
      (o[0] = a[0] * Math.cos(s) - a[1] * Math.sin(s)),
      (o[1] = a[0] * Math.sin(s) + a[1] * Math.cos(s)),
      (o[2] = a[2]),
      (r[0] = o[0] + i[0]),
      (r[1] = o[1] + i[1]),
      (r[2] = o[2] + i[2]),
      r
    );
  }
  function angle$1(r, n) {
    var i = r[0],
      s = r[1],
      a = r[2],
      o = n[0],
      l = n[1],
      u = n[2],
      f = Math.sqrt(i * i + s * s + a * a),
      c = Math.sqrt(o * o + l * l + u * u),
      h = f * c,
      p = h && dot$4(r, n) / h;
    return Math.acos(Math.min(Math.max(p, -1), 1));
  }
  function zero$2(r) {
    return (r[0] = 0), (r[1] = 0), (r[2] = 0), r;
  }
  function str$4(r) {
    return "vec3(" + r[0] + ", " + r[1] + ", " + r[2] + ")";
  }
  function exactEquals$4(r, n) {
    return r[0] === n[0] && r[1] === n[1] && r[2] === n[2];
  }
  function equals$4(r, n) {
    var i = r[0],
      s = r[1],
      a = r[2],
      o = n[0],
      l = n[1],
      u = n[2];
    return (
      Math.abs(i - o) <= EPSILON * Math.max(1, Math.abs(i), Math.abs(o)) &&
      Math.abs(s - l) <= EPSILON * Math.max(1, Math.abs(s), Math.abs(l)) &&
      Math.abs(a - u) <= EPSILON * Math.max(1, Math.abs(a), Math.abs(u))
    );
  }
  var sub$2 = subtract$2,
    mul$4 = multiply$4,
    div$2 = divide$2,
    dist$2 = distance$2,
    sqrDist$2 = squaredDistance$2,
    len$4 = length$4,
    sqrLen$4 = squaredLength$4,
    forEach$2 = (function () {
      var r = create$4();
      return function (n, i, s, a, o, l) {
        var u, f;
        for (
          i || (i = 3),
            s || (s = 0),
            a ? (f = Math.min(a * i + s, n.length)) : (f = n.length),
            u = s;
          u < f;
          u += i
        )
          (r[0] = n[u]),
            (r[1] = n[u + 1]),
            (r[2] = n[u + 2]),
            o(r, r, l),
            (n[u] = r[0]),
            (n[u + 1] = r[1]),
            (n[u + 2] = r[2]);
        return n;
      };
    })(),
    vec3 = Object.freeze({
      __proto__: null,
      create: create$4,
      clone: clone$4,
      length: length$4,
      fromValues: fromValues$4,
      copy: copy$4,
      set: set$4,
      add: add$4,
      subtract: subtract$2,
      multiply: multiply$4,
      divide: divide$2,
      ceil: ceil$2,
      floor: floor$2,
      min: min$2,
      max: max$2,
      round: round$2,
      scale: scale$4,
      scaleAndAdd: scaleAndAdd$2,
      distance: distance$2,
      squaredDistance: squaredDistance$2,
      squaredLength: squaredLength$4,
      negate: negate$2,
      inverse: inverse$2,
      normalize: normalize$4,
      dot: dot$4,
      cross: cross$2,
      lerp: lerp$4,
      hermite: hermite,
      bezier: bezier,
      random: random$3,
      transformMat4: transformMat4$2,
      transformMat3: transformMat3$1,
      transformQuat: transformQuat$1,
      rotateX: rotateX$2,
      rotateY: rotateY$2,
      rotateZ: rotateZ$2,
      angle: angle$1,
      zero: zero$2,
      str: str$4,
      exactEquals: exactEquals$4,
      equals: equals$4,
      sub: sub$2,
      mul: mul$4,
      div: div$2,
      dist: dist$2,
      sqrDist: sqrDist$2,
      len: len$4,
      sqrLen: sqrLen$4,
      forEach: forEach$2,
    });
  function create$3() {
    var r = new ARRAY_TYPE(4);
    return (
      ARRAY_TYPE != Float32Array &&
        ((r[0] = 0), (r[1] = 0), (r[2] = 0), (r[3] = 0)),
      r
    );
  }
  function clone$3(r) {
    var n = new ARRAY_TYPE(4);
    return (n[0] = r[0]), (n[1] = r[1]), (n[2] = r[2]), (n[3] = r[3]), n;
  }
  function fromValues$3(r, n, i, s) {
    var a = new ARRAY_TYPE(4);
    return (a[0] = r), (a[1] = n), (a[2] = i), (a[3] = s), a;
  }
  function copy$3(r, n) {
    return (r[0] = n[0]), (r[1] = n[1]), (r[2] = n[2]), (r[3] = n[3]), r;
  }
  function set$3(r, n, i, s, a) {
    return (r[0] = n), (r[1] = i), (r[2] = s), (r[3] = a), r;
  }
  function add$3(r, n, i) {
    return (
      (r[0] = n[0] + i[0]),
      (r[1] = n[1] + i[1]),
      (r[2] = n[2] + i[2]),
      (r[3] = n[3] + i[3]),
      r
    );
  }
  function subtract$1(r, n, i) {
    return (
      (r[0] = n[0] - i[0]),
      (r[1] = n[1] - i[1]),
      (r[2] = n[2] - i[2]),
      (r[3] = n[3] - i[3]),
      r
    );
  }
  function multiply$3(r, n, i) {
    return (
      (r[0] = n[0] * i[0]),
      (r[1] = n[1] * i[1]),
      (r[2] = n[2] * i[2]),
      (r[3] = n[3] * i[3]),
      r
    );
  }
  function divide$1(r, n, i) {
    return (
      (r[0] = n[0] / i[0]),
      (r[1] = n[1] / i[1]),
      (r[2] = n[2] / i[2]),
      (r[3] = n[3] / i[3]),
      r
    );
  }
  function ceil$1(r, n) {
    return (
      (r[0] = Math.ceil(n[0])),
      (r[1] = Math.ceil(n[1])),
      (r[2] = Math.ceil(n[2])),
      (r[3] = Math.ceil(n[3])),
      r
    );
  }
  function floor$1(r, n) {
    return (
      (r[0] = Math.floor(n[0])),
      (r[1] = Math.floor(n[1])),
      (r[2] = Math.floor(n[2])),
      (r[3] = Math.floor(n[3])),
      r
    );
  }
  function min$1(r, n, i) {
    return (
      (r[0] = Math.min(n[0], i[0])),
      (r[1] = Math.min(n[1], i[1])),
      (r[2] = Math.min(n[2], i[2])),
      (r[3] = Math.min(n[3], i[3])),
      r
    );
  }
  function max$1(r, n, i) {
    return (
      (r[0] = Math.max(n[0], i[0])),
      (r[1] = Math.max(n[1], i[1])),
      (r[2] = Math.max(n[2], i[2])),
      (r[3] = Math.max(n[3], i[3])),
      r
    );
  }
  function round$1(r, n) {
    return (
      (r[0] = Math.round(n[0])),
      (r[1] = Math.round(n[1])),
      (r[2] = Math.round(n[2])),
      (r[3] = Math.round(n[3])),
      r
    );
  }
  function scale$3(r, n, i) {
    return (
      (r[0] = n[0] * i),
      (r[1] = n[1] * i),
      (r[2] = n[2] * i),
      (r[3] = n[3] * i),
      r
    );
  }
  function scaleAndAdd$1(r, n, i, s) {
    return (
      (r[0] = n[0] + i[0] * s),
      (r[1] = n[1] + i[1] * s),
      (r[2] = n[2] + i[2] * s),
      (r[3] = n[3] + i[3] * s),
      r
    );
  }
  function distance$1(r, n) {
    var i = n[0] - r[0],
      s = n[1] - r[1],
      a = n[2] - r[2],
      o = n[3] - r[3];
    return Math.hypot(i, s, a, o);
  }
  function squaredDistance$1(r, n) {
    var i = n[0] - r[0],
      s = n[1] - r[1],
      a = n[2] - r[2],
      o = n[3] - r[3];
    return i * i + s * s + a * a + o * o;
  }
  function length$3(r) {
    var n = r[0],
      i = r[1],
      s = r[2],
      a = r[3];
    return Math.hypot(n, i, s, a);
  }
  function squaredLength$3(r) {
    var n = r[0],
      i = r[1],
      s = r[2],
      a = r[3];
    return n * n + i * i + s * s + a * a;
  }
  function negate$1(r, n) {
    return (r[0] = -n[0]), (r[1] = -n[1]), (r[2] = -n[2]), (r[3] = -n[3]), r;
  }
  function inverse$1(r, n) {
    return (
      (r[0] = 1 / n[0]),
      (r[1] = 1 / n[1]),
      (r[2] = 1 / n[2]),
      (r[3] = 1 / n[3]),
      r
    );
  }
  function normalize$3(r, n) {
    var i = n[0],
      s = n[1],
      a = n[2],
      o = n[3],
      l = i * i + s * s + a * a + o * o;
    return (
      l > 0 && (l = 1 / Math.sqrt(l)),
      (r[0] = i * l),
      (r[1] = s * l),
      (r[2] = a * l),
      (r[3] = o * l),
      r
    );
  }
  function dot$3(r, n) {
    return r[0] * n[0] + r[1] * n[1] + r[2] * n[2] + r[3] * n[3];
  }
  function cross$1(r, n, i, s) {
    var a = i[0] * s[1] - i[1] * s[0],
      o = i[0] * s[2] - i[2] * s[0],
      l = i[0] * s[3] - i[3] * s[0],
      u = i[1] * s[2] - i[2] * s[1],
      f = i[1] * s[3] - i[3] * s[1],
      c = i[2] * s[3] - i[3] * s[2],
      h = n[0],
      p = n[1],
      d = n[2],
      m = n[3];
    return (
      (r[0] = p * c - d * f + m * u),
      (r[1] = -(h * c) + d * l - m * o),
      (r[2] = h * f - p * l + m * a),
      (r[3] = -(h * u) + p * o - d * a),
      r
    );
  }
  function lerp$3(r, n, i, s) {
    var a = n[0],
      o = n[1],
      l = n[2],
      u = n[3];
    return (
      (r[0] = a + s * (i[0] - a)),
      (r[1] = o + s * (i[1] - o)),
      (r[2] = l + s * (i[2] - l)),
      (r[3] = u + s * (i[3] - u)),
      r
    );
  }
  function random$2(r, n) {
    n = n || 1;
    var i, s, a, o, l, u;
    do (i = RANDOM() * 2 - 1), (s = RANDOM() * 2 - 1), (l = i * i + s * s);
    while (l >= 1);
    do (a = RANDOM() * 2 - 1), (o = RANDOM() * 2 - 1), (u = a * a + o * o);
    while (u >= 1);
    var f = Math.sqrt((1 - l) / u);
    return (
      (r[0] = n * i), (r[1] = n * s), (r[2] = n * a * f), (r[3] = n * o * f), r
    );
  }
  function transformMat4$1(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3];
    return (
      (r[0] = i[0] * s + i[4] * a + i[8] * o + i[12] * l),
      (r[1] = i[1] * s + i[5] * a + i[9] * o + i[13] * l),
      (r[2] = i[2] * s + i[6] * a + i[10] * o + i[14] * l),
      (r[3] = i[3] * s + i[7] * a + i[11] * o + i[15] * l),
      r
    );
  }
  function transformQuat(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = i[0],
      u = i[1],
      f = i[2],
      c = i[3],
      h = c * s + u * o - f * a,
      p = c * a + f * s - l * o,
      d = c * o + l * a - u * s,
      m = -l * s - u * a - f * o;
    return (
      (r[0] = h * c + m * -l + p * -f - d * -u),
      (r[1] = p * c + m * -u + d * -l - h * -f),
      (r[2] = d * c + m * -f + h * -u - p * -l),
      (r[3] = n[3]),
      r
    );
  }
  function zero$1(r) {
    return (r[0] = 0), (r[1] = 0), (r[2] = 0), (r[3] = 0), r;
  }
  function str$3(r) {
    return "vec4(" + r[0] + ", " + r[1] + ", " + r[2] + ", " + r[3] + ")";
  }
  function exactEquals$3(r, n) {
    return r[0] === n[0] && r[1] === n[1] && r[2] === n[2] && r[3] === n[3];
  }
  function equals$3(r, n) {
    var i = r[0],
      s = r[1],
      a = r[2],
      o = r[3],
      l = n[0],
      u = n[1],
      f = n[2],
      c = n[3];
    return (
      Math.abs(i - l) <= EPSILON * Math.max(1, Math.abs(i), Math.abs(l)) &&
      Math.abs(s - u) <= EPSILON * Math.max(1, Math.abs(s), Math.abs(u)) &&
      Math.abs(a - f) <= EPSILON * Math.max(1, Math.abs(a), Math.abs(f)) &&
      Math.abs(o - c) <= EPSILON * Math.max(1, Math.abs(o), Math.abs(c))
    );
  }
  var sub$1 = subtract$1,
    mul$3 = multiply$3,
    div$1 = divide$1,
    dist$1 = distance$1,
    sqrDist$1 = squaredDistance$1,
    len$3 = length$3,
    sqrLen$3 = squaredLength$3,
    forEach$1 = (function () {
      var r = create$3();
      return function (n, i, s, a, o, l) {
        var u, f;
        for (
          i || (i = 4),
            s || (s = 0),
            a ? (f = Math.min(a * i + s, n.length)) : (f = n.length),
            u = s;
          u < f;
          u += i
        )
          (r[0] = n[u]),
            (r[1] = n[u + 1]),
            (r[2] = n[u + 2]),
            (r[3] = n[u + 3]),
            o(r, r, l),
            (n[u] = r[0]),
            (n[u + 1] = r[1]),
            (n[u + 2] = r[2]),
            (n[u + 3] = r[3]);
        return n;
      };
    })(),
    vec4 = Object.freeze({
      __proto__: null,
      create: create$3,
      clone: clone$3,
      fromValues: fromValues$3,
      copy: copy$3,
      set: set$3,
      add: add$3,
      subtract: subtract$1,
      multiply: multiply$3,
      divide: divide$1,
      ceil: ceil$1,
      floor: floor$1,
      min: min$1,
      max: max$1,
      round: round$1,
      scale: scale$3,
      scaleAndAdd: scaleAndAdd$1,
      distance: distance$1,
      squaredDistance: squaredDistance$1,
      length: length$3,
      squaredLength: squaredLength$3,
      negate: negate$1,
      inverse: inverse$1,
      normalize: normalize$3,
      dot: dot$3,
      cross: cross$1,
      lerp: lerp$3,
      random: random$2,
      transformMat4: transformMat4$1,
      transformQuat: transformQuat,
      zero: zero$1,
      str: str$3,
      exactEquals: exactEquals$3,
      equals: equals$3,
      sub: sub$1,
      mul: mul$3,
      div: div$1,
      dist: dist$1,
      sqrDist: sqrDist$1,
      len: len$3,
      sqrLen: sqrLen$3,
      forEach: forEach$1,
    });
  function create$2() {
    var r = new ARRAY_TYPE(4);
    return (
      ARRAY_TYPE != Float32Array && ((r[0] = 0), (r[1] = 0), (r[2] = 0)),
      (r[3] = 1),
      r
    );
  }
  function identity$1(r) {
    return (r[0] = 0), (r[1] = 0), (r[2] = 0), (r[3] = 1), r;
  }
  function setAxisAngle(r, n, i) {
    i = i * 0.5;
    var s = Math.sin(i);
    return (
      (r[0] = s * n[0]),
      (r[1] = s * n[1]),
      (r[2] = s * n[2]),
      (r[3] = Math.cos(i)),
      r
    );
  }
  function getAxisAngle(r, n) {
    var i = Math.acos(n[3]) * 2,
      s = Math.sin(i / 2);
    return (
      s > EPSILON
        ? ((r[0] = n[0] / s), (r[1] = n[1] / s), (r[2] = n[2] / s))
        : ((r[0] = 1), (r[1] = 0), (r[2] = 0)),
      i
    );
  }
  function getAngle(r, n) {
    var i = dot$2(r, n);
    return Math.acos(2 * i * i - 1);
  }
  function multiply$2(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3],
      u = i[0],
      f = i[1],
      c = i[2],
      h = i[3];
    return (
      (r[0] = s * h + l * u + a * c - o * f),
      (r[1] = a * h + l * f + o * u - s * c),
      (r[2] = o * h + l * c + s * f - a * u),
      (r[3] = l * h - s * u - a * f - o * c),
      r
    );
  }
  function rotateX$1(r, n, i) {
    i *= 0.5;
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3],
      u = Math.sin(i),
      f = Math.cos(i);
    return (
      (r[0] = s * f + l * u),
      (r[1] = a * f + o * u),
      (r[2] = o * f - a * u),
      (r[3] = l * f - s * u),
      r
    );
  }
  function rotateY$1(r, n, i) {
    i *= 0.5;
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3],
      u = Math.sin(i),
      f = Math.cos(i);
    return (
      (r[0] = s * f - o * u),
      (r[1] = a * f + l * u),
      (r[2] = o * f + s * u),
      (r[3] = l * f - a * u),
      r
    );
  }
  function rotateZ$1(r, n, i) {
    i *= 0.5;
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3],
      u = Math.sin(i),
      f = Math.cos(i);
    return (
      (r[0] = s * f + a * u),
      (r[1] = a * f - s * u),
      (r[2] = o * f + l * u),
      (r[3] = l * f - o * u),
      r
    );
  }
  function calculateW(r, n) {
    var i = n[0],
      s = n[1],
      a = n[2];
    return (
      (r[0] = i),
      (r[1] = s),
      (r[2] = a),
      (r[3] = Math.sqrt(Math.abs(1 - i * i - s * s - a * a))),
      r
    );
  }
  function exp(r, n) {
    var i = n[0],
      s = n[1],
      a = n[2],
      o = n[3],
      l = Math.sqrt(i * i + s * s + a * a),
      u = Math.exp(o),
      f = l > 0 ? (u * Math.sin(l)) / l : 0;
    return (
      (r[0] = i * f),
      (r[1] = s * f),
      (r[2] = a * f),
      (r[3] = u * Math.cos(l)),
      r
    );
  }
  function ln(r, n) {
    var i = n[0],
      s = n[1],
      a = n[2],
      o = n[3],
      l = Math.sqrt(i * i + s * s + a * a),
      u = l > 0 ? Math.atan2(l, o) / l : 0;
    return (
      (r[0] = i * u),
      (r[1] = s * u),
      (r[2] = a * u),
      (r[3] = 0.5 * Math.log(i * i + s * s + a * a + o * o)),
      r
    );
  }
  function pow(r, n, i) {
    return ln(r, n), scale$2(r, r, i), exp(r, r), r;
  }
  function slerp(r, n, i, s) {
    var a = n[0],
      o = n[1],
      l = n[2],
      u = n[3],
      f = i[0],
      c = i[1],
      h = i[2],
      p = i[3],
      d,
      m,
      g,
      v,
      y;
    return (
      (m = a * f + o * c + l * h + u * p),
      m < 0 && ((m = -m), (f = -f), (c = -c), (h = -h), (p = -p)),
      1 - m > EPSILON
        ? ((d = Math.acos(m)),
          (g = Math.sin(d)),
          (v = Math.sin((1 - s) * d) / g),
          (y = Math.sin(s * d) / g))
        : ((v = 1 - s), (y = s)),
      (r[0] = v * a + y * f),
      (r[1] = v * o + y * c),
      (r[2] = v * l + y * h),
      (r[3] = v * u + y * p),
      r
    );
  }
  function random$1(r) {
    var n = RANDOM(),
      i = RANDOM(),
      s = RANDOM(),
      a = Math.sqrt(1 - n),
      o = Math.sqrt(n);
    return (
      (r[0] = a * Math.sin(2 * Math.PI * i)),
      (r[1] = a * Math.cos(2 * Math.PI * i)),
      (r[2] = o * Math.sin(2 * Math.PI * s)),
      (r[3] = o * Math.cos(2 * Math.PI * s)),
      r
    );
  }
  function invert$1(r, n) {
    var i = n[0],
      s = n[1],
      a = n[2],
      o = n[3],
      l = i * i + s * s + a * a + o * o,
      u = l ? 1 / l : 0;
    return (r[0] = -i * u), (r[1] = -s * u), (r[2] = -a * u), (r[3] = o * u), r;
  }
  function conjugate$1(r, n) {
    return (r[0] = -n[0]), (r[1] = -n[1]), (r[2] = -n[2]), (r[3] = n[3]), r;
  }
  function fromMat3(r, n) {
    var i = n[0] + n[4] + n[8],
      s;
    if (i > 0)
      (s = Math.sqrt(i + 1)),
        (r[3] = 0.5 * s),
        (s = 0.5 / s),
        (r[0] = (n[5] - n[7]) * s),
        (r[1] = (n[6] - n[2]) * s),
        (r[2] = (n[1] - n[3]) * s);
    else {
      var a = 0;
      n[4] > n[0] && (a = 1), n[8] > n[a * 3 + a] && (a = 2);
      var o = (a + 1) % 3,
        l = (a + 2) % 3;
      (s = Math.sqrt(n[a * 3 + a] - n[o * 3 + o] - n[l * 3 + l] + 1)),
        (r[a] = 0.5 * s),
        (s = 0.5 / s),
        (r[3] = (n[o * 3 + l] - n[l * 3 + o]) * s),
        (r[o] = (n[o * 3 + a] + n[a * 3 + o]) * s),
        (r[l] = (n[l * 3 + a] + n[a * 3 + l]) * s);
    }
    return r;
  }
  function fromEuler(r, n, i, s) {
    var a = (0.5 * Math.PI) / 180;
    (n *= a), (i *= a), (s *= a);
    var o = Math.sin(n),
      l = Math.cos(n),
      u = Math.sin(i),
      f = Math.cos(i),
      c = Math.sin(s),
      h = Math.cos(s);
    return (
      (r[0] = o * f * h - l * u * c),
      (r[1] = l * u * h + o * f * c),
      (r[2] = l * f * c - o * u * h),
      (r[3] = l * f * h + o * u * c),
      r
    );
  }
  function str$2(r) {
    return "quat(" + r[0] + ", " + r[1] + ", " + r[2] + ", " + r[3] + ")";
  }
  var clone$2 = clone$3,
    fromValues$2 = fromValues$3,
    copy$2 = copy$3,
    set$2 = set$3,
    add$2 = add$3,
    mul$2 = multiply$2,
    scale$2 = scale$3,
    dot$2 = dot$3,
    lerp$2 = lerp$3,
    length$2 = length$3,
    len$2 = length$2,
    squaredLength$2 = squaredLength$3,
    sqrLen$2 = squaredLength$2,
    normalize$2 = normalize$3,
    exactEquals$2 = exactEquals$3,
    equals$2 = equals$3,
    rotationTo = (function () {
      var r = create$4(),
        n = fromValues$4(1, 0, 0),
        i = fromValues$4(0, 1, 0);
      return function (s, a, o) {
        var l = dot$4(a, o);
        return l < -0.999999
          ? (cross$2(r, n, a),
            len$4(r) < 1e-6 && cross$2(r, i, a),
            normalize$4(r, r),
            setAxisAngle(s, r, Math.PI),
            s)
          : l > 0.999999
          ? ((s[0] = 0), (s[1] = 0), (s[2] = 0), (s[3] = 1), s)
          : (cross$2(r, a, o),
            (s[0] = r[0]),
            (s[1] = r[1]),
            (s[2] = r[2]),
            (s[3] = 1 + l),
            normalize$2(s, s));
      };
    })(),
    sqlerp = (function () {
      var r = create$2(),
        n = create$2();
      return function (i, s, a, o, l, u) {
        return (
          slerp(r, s, l, u),
          slerp(n, a, o, u),
          slerp(i, r, n, 2 * u * (1 - u)),
          i
        );
      };
    })(),
    setAxes = (function () {
      var r = create$6();
      return function (n, i, s, a) {
        return (
          (r[0] = s[0]),
          (r[3] = s[1]),
          (r[6] = s[2]),
          (r[1] = a[0]),
          (r[4] = a[1]),
          (r[7] = a[2]),
          (r[2] = -i[0]),
          (r[5] = -i[1]),
          (r[8] = -i[2]),
          normalize$2(n, fromMat3(n, r))
        );
      };
    })(),
    quat = Object.freeze({
      __proto__: null,
      create: create$2,
      identity: identity$1,
      setAxisAngle: setAxisAngle,
      getAxisAngle: getAxisAngle,
      getAngle: getAngle,
      multiply: multiply$2,
      rotateX: rotateX$1,
      rotateY: rotateY$1,
      rotateZ: rotateZ$1,
      calculateW: calculateW,
      exp: exp,
      ln: ln,
      pow: pow,
      slerp: slerp,
      random: random$1,
      invert: invert$1,
      conjugate: conjugate$1,
      fromMat3: fromMat3,
      fromEuler: fromEuler,
      str: str$2,
      clone: clone$2,
      fromValues: fromValues$2,
      copy: copy$2,
      set: set$2,
      add: add$2,
      mul: mul$2,
      scale: scale$2,
      dot: dot$2,
      lerp: lerp$2,
      length: length$2,
      len: len$2,
      squaredLength: squaredLength$2,
      sqrLen: sqrLen$2,
      normalize: normalize$2,
      exactEquals: exactEquals$2,
      equals: equals$2,
      rotationTo: rotationTo,
      sqlerp: sqlerp,
      setAxes: setAxes,
    });
  function create$1() {
    var r = new ARRAY_TYPE(8);
    return (
      ARRAY_TYPE != Float32Array &&
        ((r[0] = 0),
        (r[1] = 0),
        (r[2] = 0),
        (r[4] = 0),
        (r[5] = 0),
        (r[6] = 0),
        (r[7] = 0)),
      (r[3] = 1),
      r
    );
  }
  function clone$1(r) {
    var n = new ARRAY_TYPE(8);
    return (
      (n[0] = r[0]),
      (n[1] = r[1]),
      (n[2] = r[2]),
      (n[3] = r[3]),
      (n[4] = r[4]),
      (n[5] = r[5]),
      (n[6] = r[6]),
      (n[7] = r[7]),
      n
    );
  }
  function fromValues$1(r, n, i, s, a, o, l, u) {
    var f = new ARRAY_TYPE(8);
    return (
      (f[0] = r),
      (f[1] = n),
      (f[2] = i),
      (f[3] = s),
      (f[4] = a),
      (f[5] = o),
      (f[6] = l),
      (f[7] = u),
      f
    );
  }
  function fromRotationTranslationValues(r, n, i, s, a, o, l) {
    var u = new ARRAY_TYPE(8);
    (u[0] = r), (u[1] = n), (u[2] = i), (u[3] = s);
    var f = a * 0.5,
      c = o * 0.5,
      h = l * 0.5;
    return (
      (u[4] = f * s + c * i - h * n),
      (u[5] = c * s + h * r - f * i),
      (u[6] = h * s + f * n - c * r),
      (u[7] = -f * r - c * n - h * i),
      u
    );
  }
  function fromRotationTranslation(r, n, i) {
    var s = i[0] * 0.5,
      a = i[1] * 0.5,
      o = i[2] * 0.5,
      l = n[0],
      u = n[1],
      f = n[2],
      c = n[3];
    return (
      (r[0] = l),
      (r[1] = u),
      (r[2] = f),
      (r[3] = c),
      (r[4] = s * c + a * f - o * u),
      (r[5] = a * c + o * l - s * f),
      (r[6] = o * c + s * u - a * l),
      (r[7] = -s * l - a * u - o * f),
      r
    );
  }
  function fromTranslation(r, n) {
    return (
      (r[0] = 0),
      (r[1] = 0),
      (r[2] = 0),
      (r[3] = 1),
      (r[4] = n[0] * 0.5),
      (r[5] = n[1] * 0.5),
      (r[6] = n[2] * 0.5),
      (r[7] = 0),
      r
    );
  }
  function fromRotation(r, n) {
    return (
      (r[0] = n[0]),
      (r[1] = n[1]),
      (r[2] = n[2]),
      (r[3] = n[3]),
      (r[4] = 0),
      (r[5] = 0),
      (r[6] = 0),
      (r[7] = 0),
      r
    );
  }
  function fromMat4(r, n) {
    var i = create$2();
    getRotation(i, n);
    var s = new ARRAY_TYPE(3);
    return getTranslation$1(s, n), fromRotationTranslation(r, i, s), r;
  }
  function copy$1(r, n) {
    return (
      (r[0] = n[0]),
      (r[1] = n[1]),
      (r[2] = n[2]),
      (r[3] = n[3]),
      (r[4] = n[4]),
      (r[5] = n[5]),
      (r[6] = n[6]),
      (r[7] = n[7]),
      r
    );
  }
  function identity(r) {
    return (
      (r[0] = 0),
      (r[1] = 0),
      (r[2] = 0),
      (r[3] = 1),
      (r[4] = 0),
      (r[5] = 0),
      (r[6] = 0),
      (r[7] = 0),
      r
    );
  }
  function set$1(r, n, i, s, a, o, l, u, f) {
    return (
      (r[0] = n),
      (r[1] = i),
      (r[2] = s),
      (r[3] = a),
      (r[4] = o),
      (r[5] = l),
      (r[6] = u),
      (r[7] = f),
      r
    );
  }
  var getReal = copy$2;
  function getDual(r, n) {
    return (r[0] = n[4]), (r[1] = n[5]), (r[2] = n[6]), (r[3] = n[7]), r;
  }
  var setReal = copy$2;
  function setDual(r, n) {
    return (r[4] = n[0]), (r[5] = n[1]), (r[6] = n[2]), (r[7] = n[3]), r;
  }
  function getTranslation(r, n) {
    var i = n[4],
      s = n[5],
      a = n[6],
      o = n[7],
      l = -n[0],
      u = -n[1],
      f = -n[2],
      c = n[3];
    return (
      (r[0] = (i * c + o * l + s * f - a * u) * 2),
      (r[1] = (s * c + o * u + a * l - i * f) * 2),
      (r[2] = (a * c + o * f + i * u - s * l) * 2),
      r
    );
  }
  function translate(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3],
      u = i[0] * 0.5,
      f = i[1] * 0.5,
      c = i[2] * 0.5,
      h = n[4],
      p = n[5],
      d = n[6],
      m = n[7];
    return (
      (r[0] = s),
      (r[1] = a),
      (r[2] = o),
      (r[3] = l),
      (r[4] = l * u + a * c - o * f + h),
      (r[5] = l * f + o * u - s * c + p),
      (r[6] = l * c + s * f - a * u + d),
      (r[7] = -s * u - a * f - o * c + m),
      r
    );
  }
  function rotateX(r, n, i) {
    var s = -n[0],
      a = -n[1],
      o = -n[2],
      l = n[3],
      u = n[4],
      f = n[5],
      c = n[6],
      h = n[7],
      p = u * l + h * s + f * o - c * a,
      d = f * l + h * a + c * s - u * o,
      m = c * l + h * o + u * a - f * s,
      g = h * l - u * s - f * a - c * o;
    return (
      rotateX$1(r, n, i),
      (s = r[0]),
      (a = r[1]),
      (o = r[2]),
      (l = r[3]),
      (r[4] = p * l + g * s + d * o - m * a),
      (r[5] = d * l + g * a + m * s - p * o),
      (r[6] = m * l + g * o + p * a - d * s),
      (r[7] = g * l - p * s - d * a - m * o),
      r
    );
  }
  function rotateY(r, n, i) {
    var s = -n[0],
      a = -n[1],
      o = -n[2],
      l = n[3],
      u = n[4],
      f = n[5],
      c = n[6],
      h = n[7],
      p = u * l + h * s + f * o - c * a,
      d = f * l + h * a + c * s - u * o,
      m = c * l + h * o + u * a - f * s,
      g = h * l - u * s - f * a - c * o;
    return (
      rotateY$1(r, n, i),
      (s = r[0]),
      (a = r[1]),
      (o = r[2]),
      (l = r[3]),
      (r[4] = p * l + g * s + d * o - m * a),
      (r[5] = d * l + g * a + m * s - p * o),
      (r[6] = m * l + g * o + p * a - d * s),
      (r[7] = g * l - p * s - d * a - m * o),
      r
    );
  }
  function rotateZ(r, n, i) {
    var s = -n[0],
      a = -n[1],
      o = -n[2],
      l = n[3],
      u = n[4],
      f = n[5],
      c = n[6],
      h = n[7],
      p = u * l + h * s + f * o - c * a,
      d = f * l + h * a + c * s - u * o,
      m = c * l + h * o + u * a - f * s,
      g = h * l - u * s - f * a - c * o;
    return (
      rotateZ$1(r, n, i),
      (s = r[0]),
      (a = r[1]),
      (o = r[2]),
      (l = r[3]),
      (r[4] = p * l + g * s + d * o - m * a),
      (r[5] = d * l + g * a + m * s - p * o),
      (r[6] = m * l + g * o + p * a - d * s),
      (r[7] = g * l - p * s - d * a - m * o),
      r
    );
  }
  function rotateByQuatAppend(r, n, i) {
    var s = i[0],
      a = i[1],
      o = i[2],
      l = i[3],
      u = n[0],
      f = n[1],
      c = n[2],
      h = n[3];
    return (
      (r[0] = u * l + h * s + f * o - c * a),
      (r[1] = f * l + h * a + c * s - u * o),
      (r[2] = c * l + h * o + u * a - f * s),
      (r[3] = h * l - u * s - f * a - c * o),
      (u = n[4]),
      (f = n[5]),
      (c = n[6]),
      (h = n[7]),
      (r[4] = u * l + h * s + f * o - c * a),
      (r[5] = f * l + h * a + c * s - u * o),
      (r[6] = c * l + h * o + u * a - f * s),
      (r[7] = h * l - u * s - f * a - c * o),
      r
    );
  }
  function rotateByQuatPrepend(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3],
      u = i[0],
      f = i[1],
      c = i[2],
      h = i[3];
    return (
      (r[0] = s * h + l * u + a * c - o * f),
      (r[1] = a * h + l * f + o * u - s * c),
      (r[2] = o * h + l * c + s * f - a * u),
      (r[3] = l * h - s * u - a * f - o * c),
      (u = i[4]),
      (f = i[5]),
      (c = i[6]),
      (h = i[7]),
      (r[4] = s * h + l * u + a * c - o * f),
      (r[5] = a * h + l * f + o * u - s * c),
      (r[6] = o * h + l * c + s * f - a * u),
      (r[7] = l * h - s * u - a * f - o * c),
      r
    );
  }
  function rotateAroundAxis(r, n, i, s) {
    if (Math.abs(s) < EPSILON) return copy$1(r, n);
    var a = Math.hypot(i[0], i[1], i[2]);
    s = s * 0.5;
    var o = Math.sin(s),
      l = (o * i[0]) / a,
      u = (o * i[1]) / a,
      f = (o * i[2]) / a,
      c = Math.cos(s),
      h = n[0],
      p = n[1],
      d = n[2],
      m = n[3];
    (r[0] = h * c + m * l + p * f - d * u),
      (r[1] = p * c + m * u + d * l - h * f),
      (r[2] = d * c + m * f + h * u - p * l),
      (r[3] = m * c - h * l - p * u - d * f);
    var g = n[4],
      v = n[5],
      y = n[6],
      _ = n[7];
    return (
      (r[4] = g * c + _ * l + v * f - y * u),
      (r[5] = v * c + _ * u + y * l - g * f),
      (r[6] = y * c + _ * f + g * u - v * l),
      (r[7] = _ * c - g * l - v * u - y * f),
      r
    );
  }
  function add$1(r, n, i) {
    return (
      (r[0] = n[0] + i[0]),
      (r[1] = n[1] + i[1]),
      (r[2] = n[2] + i[2]),
      (r[3] = n[3] + i[3]),
      (r[4] = n[4] + i[4]),
      (r[5] = n[5] + i[5]),
      (r[6] = n[6] + i[6]),
      (r[7] = n[7] + i[7]),
      r
    );
  }
  function multiply$1(r, n, i) {
    var s = n[0],
      a = n[1],
      o = n[2],
      l = n[3],
      u = i[4],
      f = i[5],
      c = i[6],
      h = i[7],
      p = n[4],
      d = n[5],
      m = n[6],
      g = n[7],
      v = i[0],
      y = i[1],
      _ = i[2],
      b = i[3];
    return (
      (r[0] = s * b + l * v + a * _ - o * y),
      (r[1] = a * b + l * y + o * v - s * _),
      (r[2] = o * b + l * _ + s * y - a * v),
      (r[3] = l * b - s * v - a * y - o * _),
      (r[4] = s * h + l * u + a * c - o * f + p * b + g * v + d * _ - m * y),
      (r[5] = a * h + l * f + o * u - s * c + d * b + g * y + m * v - p * _),
      (r[6] = o * h + l * c + s * f - a * u + m * b + g * _ + p * y - d * v),
      (r[7] = l * h - s * u - a * f - o * c + g * b - p * v - d * y - m * _),
      r
    );
  }
  var mul$1 = multiply$1;
  function scale$1(r, n, i) {
    return (
      (r[0] = n[0] * i),
      (r[1] = n[1] * i),
      (r[2] = n[2] * i),
      (r[3] = n[3] * i),
      (r[4] = n[4] * i),
      (r[5] = n[5] * i),
      (r[6] = n[6] * i),
      (r[7] = n[7] * i),
      r
    );
  }
  var dot$1 = dot$2;
  function lerp$1(r, n, i, s) {
    var a = 1 - s;
    return (
      dot$1(n, i) < 0 && (s = -s),
      (r[0] = n[0] * a + i[0] * s),
      (r[1] = n[1] * a + i[1] * s),
      (r[2] = n[2] * a + i[2] * s),
      (r[3] = n[3] * a + i[3] * s),
      (r[4] = n[4] * a + i[4] * s),
      (r[5] = n[5] * a + i[5] * s),
      (r[6] = n[6] * a + i[6] * s),
      (r[7] = n[7] * a + i[7] * s),
      r
    );
  }
  function invert(r, n) {
    var i = squaredLength$1(n);
    return (
      (r[0] = -n[0] / i),
      (r[1] = -n[1] / i),
      (r[2] = -n[2] / i),
      (r[3] = n[3] / i),
      (r[4] = -n[4] / i),
      (r[5] = -n[5] / i),
      (r[6] = -n[6] / i),
      (r[7] = n[7] / i),
      r
    );
  }
  function conjugate(r, n) {
    return (
      (r[0] = -n[0]),
      (r[1] = -n[1]),
      (r[2] = -n[2]),
      (r[3] = n[3]),
      (r[4] = -n[4]),
      (r[5] = -n[5]),
      (r[6] = -n[6]),
      (r[7] = n[7]),
      r
    );
  }
  var length$1 = length$2,
    len$1 = length$1,
    squaredLength$1 = squaredLength$2,
    sqrLen$1 = squaredLength$1;
  function normalize$1(r, n) {
    var i = squaredLength$1(n);
    if (i > 0) {
      i = Math.sqrt(i);
      var s = n[0] / i,
        a = n[1] / i,
        o = n[2] / i,
        l = n[3] / i,
        u = n[4],
        f = n[5],
        c = n[6],
        h = n[7],
        p = s * u + a * f + o * c + l * h;
      (r[0] = s),
        (r[1] = a),
        (r[2] = o),
        (r[3] = l),
        (r[4] = (u - s * p) / i),
        (r[5] = (f - a * p) / i),
        (r[6] = (c - o * p) / i),
        (r[7] = (h - l * p) / i);
    }
    return r;
  }
  function str$1(r) {
    return (
      "quat2(" +
      r[0] +
      ", " +
      r[1] +
      ", " +
      r[2] +
      ", " +
      r[3] +
      ", " +
      r[4] +
      ", " +
      r[5] +
      ", " +
      r[6] +
      ", " +
      r[7] +
      ")"
    );
  }
  function exactEquals$1(r, n) {
    return (
      r[0] === n[0] &&
      r[1] === n[1] &&
      r[2] === n[2] &&
      r[3] === n[3] &&
      r[4] === n[4] &&
      r[5] === n[5] &&
      r[6] === n[6] &&
      r[7] === n[7]
    );
  }
  function equals$1(r, n) {
    var i = r[0],
      s = r[1],
      a = r[2],
      o = r[3],
      l = r[4],
      u = r[5],
      f = r[6],
      c = r[7],
      h = n[0],
      p = n[1],
      d = n[2],
      m = n[3],
      g = n[4],
      v = n[5],
      y = n[6],
      _ = n[7];
    return (
      Math.abs(i - h) <= EPSILON * Math.max(1, Math.abs(i), Math.abs(h)) &&
      Math.abs(s - p) <= EPSILON * Math.max(1, Math.abs(s), Math.abs(p)) &&
      Math.abs(a - d) <= EPSILON * Math.max(1, Math.abs(a), Math.abs(d)) &&
      Math.abs(o - m) <= EPSILON * Math.max(1, Math.abs(o), Math.abs(m)) &&
      Math.abs(l - g) <= EPSILON * Math.max(1, Math.abs(l), Math.abs(g)) &&
      Math.abs(u - v) <= EPSILON * Math.max(1, Math.abs(u), Math.abs(v)) &&
      Math.abs(f - y) <= EPSILON * Math.max(1, Math.abs(f), Math.abs(y)) &&
      Math.abs(c - _) <= EPSILON * Math.max(1, Math.abs(c), Math.abs(_))
    );
  }
  var quat2 = Object.freeze({
    __proto__: null,
    create: create$1,
    clone: clone$1,
    fromValues: fromValues$1,
    fromRotationTranslationValues: fromRotationTranslationValues,
    fromRotationTranslation: fromRotationTranslation,
    fromTranslation: fromTranslation,
    fromRotation: fromRotation,
    fromMat4: fromMat4,
    copy: copy$1,
    identity: identity,
    set: set$1,
    getReal: getReal,
    getDual: getDual,
    setReal: setReal,
    setDual: setDual,
    getTranslation: getTranslation,
    translate: translate,
    rotateX: rotateX,
    rotateY: rotateY,
    rotateZ: rotateZ,
    rotateByQuatAppend: rotateByQuatAppend,
    rotateByQuatPrepend: rotateByQuatPrepend,
    rotateAroundAxis: rotateAroundAxis,
    add: add$1,
    multiply: multiply$1,
    mul: mul$1,
    scale: scale$1,
    dot: dot$1,
    lerp: lerp$1,
    invert: invert,
    conjugate: conjugate,
    length: length$1,
    len: len$1,
    squaredLength: squaredLength$1,
    sqrLen: sqrLen$1,
    normalize: normalize$1,
    str: str$1,
    exactEquals: exactEquals$1,
    equals: equals$1,
  });
  function create() {
    var r = new ARRAY_TYPE(2);
    return ARRAY_TYPE != Float32Array && ((r[0] = 0), (r[1] = 0)), r;
  }
  function clone(r) {
    var n = new ARRAY_TYPE(2);
    return (n[0] = r[0]), (n[1] = r[1]), n;
  }
  function fromValues(r, n) {
    var i = new ARRAY_TYPE(2);
    return (i[0] = r), (i[1] = n), i;
  }
  function copy(r, n) {
    return (r[0] = n[0]), (r[1] = n[1]), r;
  }
  function set(r, n, i) {
    return (r[0] = n), (r[1] = i), r;
  }
  function add(r, n, i) {
    return (r[0] = n[0] + i[0]), (r[1] = n[1] + i[1]), r;
  }
  function subtract(r, n, i) {
    return (r[0] = n[0] - i[0]), (r[1] = n[1] - i[1]), r;
  }
  function multiply(r, n, i) {
    return (r[0] = n[0] * i[0]), (r[1] = n[1] * i[1]), r;
  }
  function divide(r, n, i) {
    return (r[0] = n[0] / i[0]), (r[1] = n[1] / i[1]), r;
  }
  function ceil(r, n) {
    return (r[0] = Math.ceil(n[0])), (r[1] = Math.ceil(n[1])), r;
  }
  function floor(r, n) {
    return (r[0] = Math.floor(n[0])), (r[1] = Math.floor(n[1])), r;
  }
  function min(r, n, i) {
    return (r[0] = Math.min(n[0], i[0])), (r[1] = Math.min(n[1], i[1])), r;
  }
  function max(r, n, i) {
    return (r[0] = Math.max(n[0], i[0])), (r[1] = Math.max(n[1], i[1])), r;
  }
  function round(r, n) {
    return (r[0] = Math.round(n[0])), (r[1] = Math.round(n[1])), r;
  }
  function scale(r, n, i) {
    return (r[0] = n[0] * i), (r[1] = n[1] * i), r;
  }
  function scaleAndAdd(r, n, i, s) {
    return (r[0] = n[0] + i[0] * s), (r[1] = n[1] + i[1] * s), r;
  }
  function distance(r, n) {
    var i = n[0] - r[0],
      s = n[1] - r[1];
    return Math.hypot(i, s);
  }
  function squaredDistance(r, n) {
    var i = n[0] - r[0],
      s = n[1] - r[1];
    return i * i + s * s;
  }
  function length(r) {
    var n = r[0],
      i = r[1];
    return Math.hypot(n, i);
  }
  function squaredLength(r) {
    var n = r[0],
      i = r[1];
    return n * n + i * i;
  }
  function negate(r, n) {
    return (r[0] = -n[0]), (r[1] = -n[1]), r;
  }
  function inverse(r, n) {
    return (r[0] = 1 / n[0]), (r[1] = 1 / n[1]), r;
  }
  function normalize(r, n) {
    var i = n[0],
      s = n[1],
      a = i * i + s * s;
    return (
      a > 0 && (a = 1 / Math.sqrt(a)), (r[0] = n[0] * a), (r[1] = n[1] * a), r
    );
  }
  function dot(r, n) {
    return r[0] * n[0] + r[1] * n[1];
  }
  function cross(r, n, i) {
    var s = n[0] * i[1] - n[1] * i[0];
    return (r[0] = r[1] = 0), (r[2] = s), r;
  }
  function lerp(r, n, i, s) {
    var a = n[0],
      o = n[1];
    return (r[0] = a + s * (i[0] - a)), (r[1] = o + s * (i[1] - o)), r;
  }
  function random(r, n) {
    n = n || 1;
    var i = RANDOM() * 2 * Math.PI;
    return (r[0] = Math.cos(i) * n), (r[1] = Math.sin(i) * n), r;
  }
  function transformMat2(r, n, i) {
    var s = n[0],
      a = n[1];
    return (r[0] = i[0] * s + i[2] * a), (r[1] = i[1] * s + i[3] * a), r;
  }
  function transformMat2d(r, n, i) {
    var s = n[0],
      a = n[1];
    return (
      (r[0] = i[0] * s + i[2] * a + i[4]),
      (r[1] = i[1] * s + i[3] * a + i[5]),
      r
    );
  }
  function transformMat3(r, n, i) {
    var s = n[0],
      a = n[1];
    return (
      (r[0] = i[0] * s + i[3] * a + i[6]),
      (r[1] = i[1] * s + i[4] * a + i[7]),
      r
    );
  }
  function transformMat4(r, n, i) {
    var s = n[0],
      a = n[1];
    return (
      (r[0] = i[0] * s + i[4] * a + i[12]),
      (r[1] = i[1] * s + i[5] * a + i[13]),
      r
    );
  }
  function rotate(r, n, i, s) {
    var a = n[0] - i[0],
      o = n[1] - i[1],
      l = Math.sin(s),
      u = Math.cos(s);
    return (r[0] = a * u - o * l + i[0]), (r[1] = a * l + o * u + i[1]), r;
  }
  function angle(r, n) {
    var i = r[0],
      s = r[1],
      a = n[0],
      o = n[1],
      l = Math.sqrt(i * i + s * s) * Math.sqrt(a * a + o * o),
      u = l && (i * a + s * o) / l;
    return Math.acos(Math.min(Math.max(u, -1), 1));
  }
  function zero(r) {
    return (r[0] = 0), (r[1] = 0), r;
  }
  function str(r) {
    return "vec2(" + r[0] + ", " + r[1] + ")";
  }
  function exactEquals(r, n) {
    return r[0] === n[0] && r[1] === n[1];
  }
  function equals(r, n) {
    var i = r[0],
      s = r[1],
      a = n[0],
      o = n[1];
    return (
      Math.abs(i - a) <= EPSILON * Math.max(1, Math.abs(i), Math.abs(a)) &&
      Math.abs(s - o) <= EPSILON * Math.max(1, Math.abs(s), Math.abs(o))
    );
  }
  var len = length,
    sub = subtract,
    mul = multiply,
    div = divide,
    dist = distance,
    sqrDist = squaredDistance,
    sqrLen = squaredLength,
    forEach = (function () {
      var r = create();
      return function (n, i, s, a, o, l) {
        var u, f;
        for (
          i || (i = 2),
            s || (s = 0),
            a ? (f = Math.min(a * i + s, n.length)) : (f = n.length),
            u = s;
          u < f;
          u += i
        )
          (r[0] = n[u]),
            (r[1] = n[u + 1]),
            o(r, r, l),
            (n[u] = r[0]),
            (n[u + 1] = r[1]);
        return n;
      };
    })(),
    vec2 = Object.freeze({
      __proto__: null,
      create: create,
      clone: clone,
      fromValues: fromValues,
      copy: copy,
      set: set,
      add: add,
      subtract: subtract,
      multiply: multiply,
      divide: divide,
      ceil: ceil,
      floor: floor,
      min: min,
      max: max,
      round: round,
      scale: scale,
      scaleAndAdd: scaleAndAdd,
      distance: distance,
      squaredDistance: squaredDistance,
      length: length,
      squaredLength: squaredLength,
      negate: negate,
      inverse: inverse,
      normalize: normalize,
      dot: dot,
      cross: cross,
      lerp: lerp,
      random: random,
      transformMat2: transformMat2,
      transformMat2d: transformMat2d,
      transformMat3: transformMat3,
      transformMat4: transformMat4,
      rotate: rotate,
      angle: angle,
      zero: zero,
      str: str,
      exactEquals: exactEquals,
      equals: equals,
      len: len,
      sub: sub,
      mul: mul,
      div: div,
      dist: dist,
      sqrDist: sqrDist,
      sqrLen: sqrLen,
      forEach: forEach,
    }),
    esm = Object.freeze({
      __proto__: null,
      glMatrix: common,
      mat2: mat2,
      mat2d: mat2d,
      mat3: mat3,
      mat4: mat4,
      quat: quat,
      quat2: quat2,
      vec2: vec2,
      vec3: vec3,
      vec4: vec4,
    }),
    require$$6 = getAugmentedNamespace(esm);
  function _instanceof$1(r, n) {
    return n != null && typeof Symbol != "undefined" && n[Symbol.hasInstance]
      ? !!n[Symbol.hasInstance](r)
      : r instanceof n;
  }
  var _typeof$1 = function (r) {
    return r && typeof Symbol != "undefined" && r.constructor === Symbol
      ? "symbol"
      : typeof r;
  };
  function ___$insertStyle(r) {
    if (!!r && typeof window != "undefined") {
      var n = document.createElement("style");
      return (
        n.setAttribute("type", "text/css"),
        (n.innerHTML = r),
        document.head.appendChild(n),
        r
      );
    }
  }
  function colorToString(r, n) {
    var i = r.__state.conversionName.toString(),
      s = Math.round(r.r),
      a = Math.round(r.g),
      o = Math.round(r.b),
      l = r.a,
      u = Math.round(r.h),
      f = r.s.toFixed(1),
      c = r.v.toFixed(1);
    if (n || i === "THREE_CHAR_HEX" || i === "SIX_CHAR_HEX") {
      for (var h = r.hex.toString(16); h.length < 6; ) h = "0" + h;
      return "#" + h;
    } else {
      if (i === "CSS_RGB") return "rgb(" + s + "," + a + "," + o + ")";
      if (i === "CSS_RGBA")
        return "rgba(" + s + "," + a + "," + o + "," + l + ")";
      if (i === "HEX") return "0x" + r.hex.toString(16);
      if (i === "RGB_ARRAY") return "[" + s + "," + a + "," + o + "]";
      if (i === "RGBA_ARRAY")
        return "[" + s + "," + a + "," + o + "," + l + "]";
      if (i === "RGB_OBJ") return "{r:" + s + ",g:" + a + ",b:" + o + "}";
      if (i === "RGBA_OBJ")
        return "{r:" + s + ",g:" + a + ",b:" + o + ",a:" + l + "}";
      if (i === "HSV_OBJ") return "{h:" + u + ",s:" + f + ",v:" + c + "}";
      if (i === "HSVA_OBJ")
        return "{h:" + u + ",s:" + f + ",v:" + c + ",a:" + l + "}";
    }
    return "unknown format";
  }
  var ARR_EACH = Array.prototype.forEach,
    ARR_SLICE = Array.prototype.slice,
    Common = {
      BREAK: {},
      extend: function (n) {
        return (
          this.each(
            ARR_SLICE.call(arguments, 1),
            function (i) {
              var s = this.isObject(i) ? Object.keys(i) : [];
              s.forEach(
                function (a) {
                  this.isUndefined(i[a]) || (n[a] = i[a]);
                }.bind(this)
              );
            },
            this
          ),
          n
        );
      },
      defaults: function (n) {
        return (
          this.each(
            ARR_SLICE.call(arguments, 1),
            function (i) {
              var s = this.isObject(i) ? Object.keys(i) : [];
              s.forEach(
                function (a) {
                  this.isUndefined(n[a]) && (n[a] = i[a]);
                }.bind(this)
              );
            },
            this
          ),
          n
        );
      },
      compose: function () {
        var n = ARR_SLICE.call(arguments);
        return function () {
          for (var i = ARR_SLICE.call(arguments), s = n.length - 1; s >= 0; s--)
            i = [n[s].apply(this, i)];
          return i[0];
        };
      },
      each: function (n, i, s) {
        if (!!n) {
          if (ARR_EACH && n.forEach && n.forEach === ARR_EACH) n.forEach(i, s);
          else if (n.length === n.length + 0) {
            var a = void 0,
              o = void 0;
            for (a = 0, o = n.length; a < o; a++)
              if (a in n && i.call(s, n[a], a) === this.BREAK) return;
          } else for (var l in n) if (i.call(s, n[l], l) === this.BREAK) return;
        }
      },
      defer: function (n) {
        setTimeout(n, 0);
      },
      debounce: function (n, i, s) {
        var a = void 0;
        return function () {
          var o = function () {
              (a = null), s || n.apply(l, u);
            },
            l = this,
            u = arguments,
            f = s || !a;
          clearTimeout(a), (a = setTimeout(o, i)), f && n.apply(l, u);
        };
      },
      toArray: function (n) {
        return n.toArray ? n.toArray() : ARR_SLICE.call(n);
      },
      isUndefined: function (n) {
        return n === void 0;
      },
      isNull: function (n) {
        return n === null;
      },
      isNaN: (function (r) {
        var n = function (s) {
          return r.apply(this, arguments);
        };
        return (
          (n.toString = function () {
            return r.toString();
          }),
          n
        );
      })(function (r) {
        return isNaN(r);
      }),
      isArray:
        Array.isArray ||
        function (r) {
          return r.constructor === Array;
        },
      isObject: function (n) {
        return n === Object(n);
      },
      isNumber: function (n) {
        return n === n + 0;
      },
      isString: function (n) {
        return n === n + "";
      },
      isBoolean: function (n) {
        return n === !1 || n === !0;
      },
      isFunction: function (n) {
        return _instanceof$1(n, Function);
      },
    },
    INTERPRETATIONS = [
      {
        litmus: Common.isString,
        conversions: {
          THREE_CHAR_HEX: {
            read: function (n) {
              var i = n.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);
              return i === null
                ? !1
                : {
                    space: "HEX",
                    hex: parseInt(
                      "0x" +
                        i[1].toString() +
                        i[1].toString() +
                        i[2].toString() +
                        i[2].toString() +
                        i[3].toString() +
                        i[3].toString(),
                      0
                    ),
                  };
            },
            write: colorToString,
          },
          SIX_CHAR_HEX: {
            read: function (n) {
              var i = n.match(/^#([A-F0-9]{6})$/i);
              return i === null
                ? !1
                : { space: "HEX", hex: parseInt("0x" + i[1].toString(), 0) };
            },
            write: colorToString,
          },
          CSS_RGB: {
            read: function (n) {
              var i = n.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);
              return i === null
                ? !1
                : {
                    space: "RGB",
                    r: parseFloat(i[1]),
                    g: parseFloat(i[2]),
                    b: parseFloat(i[3]),
                  };
            },
            write: colorToString,
          },
          CSS_RGBA: {
            read: function (n) {
              var i = n.match(
                /^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/
              );
              return i === null
                ? !1
                : {
                    space: "RGB",
                    r: parseFloat(i[1]),
                    g: parseFloat(i[2]),
                    b: parseFloat(i[3]),
                    a: parseFloat(i[4]),
                  };
            },
            write: colorToString,
          },
        },
      },
      {
        litmus: Common.isNumber,
        conversions: {
          HEX: {
            read: function (n) {
              return { space: "HEX", hex: n, conversionName: "HEX" };
            },
            write: function (n) {
              return n.hex;
            },
          },
        },
      },
      {
        litmus: Common.isArray,
        conversions: {
          RGB_ARRAY: {
            read: function (n) {
              return n.length !== 3
                ? !1
                : { space: "RGB", r: n[0], g: n[1], b: n[2] };
            },
            write: function (n) {
              return [n.r, n.g, n.b];
            },
          },
          RGBA_ARRAY: {
            read: function (n) {
              return n.length !== 4
                ? !1
                : { space: "RGB", r: n[0], g: n[1], b: n[2], a: n[3] };
            },
            write: function (n) {
              return [n.r, n.g, n.b, n.a];
            },
          },
        },
      },
      {
        litmus: Common.isObject,
        conversions: {
          RGBA_OBJ: {
            read: function (n) {
              return Common.isNumber(n.r) &&
                Common.isNumber(n.g) &&
                Common.isNumber(n.b) &&
                Common.isNumber(n.a)
                ? { space: "RGB", r: n.r, g: n.g, b: n.b, a: n.a }
                : !1;
            },
            write: function (n) {
              return { r: n.r, g: n.g, b: n.b, a: n.a };
            },
          },
          RGB_OBJ: {
            read: function (n) {
              return Common.isNumber(n.r) &&
                Common.isNumber(n.g) &&
                Common.isNumber(n.b)
                ? { space: "RGB", r: n.r, g: n.g, b: n.b }
                : !1;
            },
            write: function (n) {
              return { r: n.r, g: n.g, b: n.b };
            },
          },
          HSVA_OBJ: {
            read: function (n) {
              return Common.isNumber(n.h) &&
                Common.isNumber(n.s) &&
                Common.isNumber(n.v) &&
                Common.isNumber(n.a)
                ? { space: "HSV", h: n.h, s: n.s, v: n.v, a: n.a }
                : !1;
            },
            write: function (n) {
              return { h: n.h, s: n.s, v: n.v, a: n.a };
            },
          },
          HSV_OBJ: {
            read: function (n) {
              return Common.isNumber(n.h) &&
                Common.isNumber(n.s) &&
                Common.isNumber(n.v)
                ? { space: "HSV", h: n.h, s: n.s, v: n.v }
                : !1;
            },
            write: function (n) {
              return { h: n.h, s: n.s, v: n.v };
            },
          },
        },
      },
    ],
    result = void 0,
    toReturn = void 0,
    interpret = function () {
      toReturn = !1;
      var n = arguments.length > 1 ? Common.toArray(arguments) : arguments[0];
      return (
        Common.each(INTERPRETATIONS, function (i) {
          if (i.litmus(n))
            return (
              Common.each(i.conversions, function (s, a) {
                if (((result = s.read(n)), toReturn === !1 && result !== !1))
                  return (
                    (toReturn = result),
                    (result.conversionName = a),
                    (result.conversion = s),
                    Common.BREAK
                  );
              }),
              Common.BREAK
            );
        }),
        toReturn
      );
    },
    tmpComponent = void 0,
    ColorMath = {
      hsv_to_rgb: function (n, i, s) {
        var a = Math.floor(n / 60) % 6,
          o = n / 60 - Math.floor(n / 60),
          l = s * (1 - i),
          u = s * (1 - o * i),
          f = s * (1 - (1 - o) * i),
          c = [
            [s, f, l],
            [u, s, l],
            [l, s, f],
            [l, u, s],
            [f, l, s],
            [s, l, u],
          ][a];
        return { r: c[0] * 255, g: c[1] * 255, b: c[2] * 255 };
      },
      rgb_to_hsv: function (n, i, s) {
        var a = Math.min(n, i, s),
          o = Math.max(n, i, s),
          l = o - a,
          u = void 0,
          f = void 0;
        if (o !== 0) f = l / o;
        else return { h: NaN, s: 0, v: 0 };
        return (
          n === o
            ? (u = (i - s) / l)
            : i === o
            ? (u = 2 + (s - n) / l)
            : (u = 4 + (n - i) / l),
          (u /= 6),
          u < 0 && (u += 1),
          { h: u * 360, s: f, v: o / 255 }
        );
      },
      rgb_to_hex: function (n, i, s) {
        var a = this.hex_with_component(0, 2, n);
        return (
          (a = this.hex_with_component(a, 1, i)),
          (a = this.hex_with_component(a, 0, s)),
          a
        );
      },
      component_from_hex: function (n, i) {
        return (n >> (i * 8)) & 255;
      },
      hex_with_component: function (n, i, s) {
        return (s << (tmpComponent = i * 8)) | (n & ~(255 << tmpComponent));
      },
    },
    _$_typeof =
      typeof Symbol == "function" && _typeof$1(Symbol.iterator) === "symbol"
        ? function (n) {
            return typeof n == "undefined" ? "undefined" : _typeof$1(n);
          }
        : function (r) {
            return r &&
              typeof Symbol == "function" &&
              r.constructor === Symbol &&
              r !== Symbol.prototype
              ? "symbol"
              : typeof r == "undefined"
              ? "undefined"
              : _typeof$1(r);
          },
    classCallCheck = function (n, i) {
      if (!_instanceof$1(n, i))
        throw new TypeError("Cannot call a class as a function");
    },
    createClass = (function () {
      var r = function (i, s) {
        for (var a = 0; a < s.length; a++) {
          var o = s[a];
          (o.enumerable = o.enumerable || !1),
            (o.configurable = !0),
            "value" in o && (o.writable = !0),
            Object.defineProperty(i, o.key, o);
        }
      };
      return function (n, i, s) {
        return i && r(n.prototype, i), s && r(n, s), n;
      };
    })(),
    get = function r(n, i, s) {
      n === null && (n = Function.prototype);
      var a = Object.getOwnPropertyDescriptor(n, i);
      if (a === void 0) {
        var o = Object.getPrototypeOf(n);
        return o === null ? void 0 : r(o, i, s);
      } else {
        if ("value" in a) return a.value;
        var l = a.get;
        return l === void 0 ? void 0 : l.call(s);
      }
    },
    inherits = function (n, i) {
      if (typeof i != "function" && i !== null)
        throw new TypeError(
          "Super expression must either be null or a function, not " +
            (typeof i == "undefined" ? "undefined" : _typeof$1(i))
        );
      (n.prototype = Object.create(i && i.prototype, {
        constructor: {
          value: n,
          enumerable: !1,
          writable: !0,
          configurable: !0,
        },
      })),
        i &&
          (Object.setPrototypeOf
            ? Object.setPrototypeOf(n, i)
            : (n.__proto__ = i));
    },
    possibleConstructorReturn = function (n, i) {
      if (!n)
        throw new ReferenceError(
          "this hasn't been initialised - super() hasn't been called"
        );
      return i && (typeof i == "object" || typeof i == "function") ? i : n;
    },
    Color = (function () {
      function r() {
        if (
          (classCallCheck(this, r),
          (this.__state = interpret.apply(this, arguments)),
          this.__state === !1)
        )
          throw new Error("Failed to interpret color arguments");
        this.__state.a = this.__state.a || 1;
      }
      return (
        createClass(r, [
          {
            key: "toString",
            value: function () {
              return colorToString(this);
            },
          },
          {
            key: "toHexString",
            value: function () {
              return colorToString(this, !0);
            },
          },
          {
            key: "toOriginal",
            value: function () {
              return this.__state.conversion.write(this);
            },
          },
        ]),
        r
      );
    })();
  function defineRGBComponent(r, n, i) {
    Object.defineProperty(r, n, {
      get: function () {
        return this.__state.space === "RGB"
          ? this.__state[n]
          : (Color.recalculateRGB(this, n, i), this.__state[n]);
      },
      set: function (a) {
        this.__state.space !== "RGB" &&
          (Color.recalculateRGB(this, n, i), (this.__state.space = "RGB")),
          (this.__state[n] = a);
      },
    });
  }
  function defineHSVComponent(r, n) {
    Object.defineProperty(r, n, {
      get: function () {
        return this.__state.space === "HSV"
          ? this.__state[n]
          : (Color.recalculateHSV(this), this.__state[n]);
      },
      set: function (s) {
        this.__state.space !== "HSV" &&
          (Color.recalculateHSV(this), (this.__state.space = "HSV")),
          (this.__state[n] = s);
      },
    });
  }
  (Color.recalculateRGB = function (r, n, i) {
    if (r.__state.space === "HEX")
      r.__state[n] = ColorMath.component_from_hex(r.__state.hex, i);
    else if (r.__state.space === "HSV")
      Common.extend(
        r.__state,
        ColorMath.hsv_to_rgb(r.__state.h, r.__state.s, r.__state.v)
      );
    else throw new Error("Corrupted color state");
  }),
    (Color.recalculateHSV = function (r) {
      var n = ColorMath.rgb_to_hsv(r.r, r.g, r.b);
      Common.extend(r.__state, { s: n.s, v: n.v }),
        Common.isNaN(n.h)
          ? Common.isUndefined(r.__state.h) && (r.__state.h = 0)
          : (r.__state.h = n.h);
    }),
    (Color.COMPONENTS = ["r", "g", "b", "h", "s", "v", "hex", "a"]),
    defineRGBComponent(Color.prototype, "r", 2),
    defineRGBComponent(Color.prototype, "g", 1),
    defineRGBComponent(Color.prototype, "b", 0),
    defineHSVComponent(Color.prototype, "h"),
    defineHSVComponent(Color.prototype, "s"),
    defineHSVComponent(Color.prototype, "v"),
    Object.defineProperty(Color.prototype, "a", {
      get: function () {
        return this.__state.a;
      },
      set: function (n) {
        this.__state.a = n;
      },
    }),
    Object.defineProperty(Color.prototype, "hex", {
      get: function () {
        return (
          this.__state.space !== "HEX" &&
            ((this.__state.hex = ColorMath.rgb_to_hex(this.r, this.g, this.b)),
            (this.__state.space = "HEX")),
          this.__state.hex
        );
      },
      set: function (n) {
        (this.__state.space = "HEX"), (this.__state.hex = n);
      },
    });
  var Controller = (function () {
      function r(n, i) {
        classCallCheck(this, r),
          (this.initialValue = n[i]),
          (this.domElement = document.createElement("div")),
          (this.object = n),
          (this.property = i),
          (this.__onChange = void 0),
          (this.__onFinishChange = void 0);
      }
      return (
        createClass(r, [
          {
            key: "onChange",
            value: function (i) {
              return (this.__onChange = i), this;
            },
          },
          {
            key: "onFinishChange",
            value: function (i) {
              return (this.__onFinishChange = i), this;
            },
          },
          {
            key: "setValue",
            value: function (i) {
              return (
                (this.object[this.property] = i),
                this.__onChange && this.__onChange.call(this, i),
                this.updateDisplay(),
                this
              );
            },
          },
          {
            key: "getValue",
            value: function () {
              return this.object[this.property];
            },
          },
          {
            key: "updateDisplay",
            value: function () {
              return this;
            },
          },
          {
            key: "isModified",
            value: function () {
              return this.initialValue !== this.getValue();
            },
          },
        ]),
        r
      );
    })(),
    EVENT_MAP = {
      HTMLEvents: ["change"],
      MouseEvents: ["click", "mousemove", "mousedown", "mouseup", "mouseover"],
      KeyboardEvents: ["keydown"],
    },
    EVENT_MAP_INV = {};
  Common.each(EVENT_MAP, function (r, n) {
    Common.each(r, function (i) {
      EVENT_MAP_INV[i] = n;
    });
  });
  var CSS_VALUE_PIXELS = /(\d+(\.\d+)?)px/;
  function cssValueToPixels(r) {
    if (r === "0" || Common.isUndefined(r)) return 0;
    var n = r.match(CSS_VALUE_PIXELS);
    return Common.isNull(n) ? 0 : parseFloat(n[1]);
  }
  var dom = {
      makeSelectable: function (n, i) {
        n === void 0 ||
          n.style === void 0 ||
          ((n.onselectstart = i
            ? function () {
                return !1;
              }
            : function () {}),
          (n.style.MozUserSelect = i ? "auto" : "none"),
          (n.style.KhtmlUserSelect = i ? "auto" : "none"),
          (n.unselectable = i ? "on" : "off"));
      },
      makeFullscreen: function (n, i, s) {
        var a = s,
          o = i;
        Common.isUndefined(o) && (o = !0),
          Common.isUndefined(a) && (a = !0),
          (n.style.position = "absolute"),
          o && ((n.style.left = 0), (n.style.right = 0)),
          a && ((n.style.top = 0), (n.style.bottom = 0));
      },
      fakeEvent: function (n, i, s, a) {
        var o = s || {},
          l = EVENT_MAP_INV[i];
        if (!l) throw new Error("Event type " + i + " not supported.");
        var u = document.createEvent(l);
        switch (l) {
          case "MouseEvents": {
            var f = o.x || o.clientX || 0,
              c = o.y || o.clientY || 0;
            u.initMouseEvent(
              i,
              o.bubbles || !1,
              o.cancelable || !0,
              window,
              o.clickCount || 1,
              0,
              0,
              f,
              c,
              !1,
              !1,
              !1,
              !1,
              0,
              null
            );
            break;
          }
          case "KeyboardEvents": {
            var h = u.initKeyboardEvent || u.initKeyEvent;
            Common.defaults(o, {
              cancelable: !0,
              ctrlKey: !1,
              altKey: !1,
              shiftKey: !1,
              metaKey: !1,
              keyCode: void 0,
              charCode: void 0,
            }),
              h(
                i,
                o.bubbles || !1,
                o.cancelable,
                window,
                o.ctrlKey,
                o.altKey,
                o.shiftKey,
                o.metaKey,
                o.keyCode,
                o.charCode
              );
            break;
          }
          default: {
            u.initEvent(i, o.bubbles || !1, o.cancelable || !0);
            break;
          }
        }
        Common.defaults(u, a), n.dispatchEvent(u);
      },
      bind: function (n, i, s, a) {
        var o = a || !1;
        return (
          n.addEventListener
            ? n.addEventListener(i, s, o)
            : n.attachEvent && n.attachEvent("on" + i, s),
          dom
        );
      },
      unbind: function (n, i, s, a) {
        var o = a || !1;
        return (
          n.removeEventListener
            ? n.removeEventListener(i, s, o)
            : n.detachEvent && n.detachEvent("on" + i, s),
          dom
        );
      },
      addClass: function (n, i) {
        if (n.className === void 0) n.className = i;
        else if (n.className !== i) {
          var s = n.className.split(/ +/);
          s.indexOf(i) === -1 &&
            (s.push(i),
            (n.className = s
              .join(" ")
              .replace(/^\s+/, "")
              .replace(/\s+$/, "")));
        }
        return dom;
      },
      removeClass: function (n, i) {
        if (i)
          if (n.className === i) n.removeAttribute("class");
          else {
            var s = n.className.split(/ +/),
              a = s.indexOf(i);
            a !== -1 && (s.splice(a, 1), (n.className = s.join(" ")));
          }
        else n.className = void 0;
        return dom;
      },
      hasClass: function (n, i) {
        return (
          new RegExp("(?:^|\\s+)" + i + "(?:\\s+|$)").test(n.className) || !1
        );
      },
      getWidth: function (n) {
        var i = getComputedStyle(n);
        return (
          cssValueToPixels(i["border-left-width"]) +
          cssValueToPixels(i["border-right-width"]) +
          cssValueToPixels(i["padding-left"]) +
          cssValueToPixels(i["padding-right"]) +
          cssValueToPixels(i.width)
        );
      },
      getHeight: function (n) {
        var i = getComputedStyle(n);
        return (
          cssValueToPixels(i["border-top-width"]) +
          cssValueToPixels(i["border-bottom-width"]) +
          cssValueToPixels(i["padding-top"]) +
          cssValueToPixels(i["padding-bottom"]) +
          cssValueToPixels(i.height)
        );
      },
      getOffset: function (n) {
        var i = n,
          s = { left: 0, top: 0 };
        if (i.offsetParent)
          do
            (s.left += i.offsetLeft),
              (s.top += i.offsetTop),
              (i = i.offsetParent);
          while (i);
        return s;
      },
      isActive: function (n) {
        return n === document.activeElement && (n.type || n.href);
      },
    },
    BooleanController = (function (r) {
      inherits(n, r);
      function n(i, s) {
        classCallCheck(this, n);
        var a = possibleConstructorReturn(
            this,
            (n.__proto__ || Object.getPrototypeOf(n)).call(this, i, s)
          ),
          o = a;
        (a.__prev = a.getValue()),
          (a.__checkbox = document.createElement("input")),
          a.__checkbox.setAttribute("type", "checkbox");
        function l() {
          o.setValue(!o.__prev);
        }
        return (
          dom.bind(a.__checkbox, "change", l, !1),
          a.domElement.appendChild(a.__checkbox),
          a.updateDisplay(),
          a
        );
      }
      return (
        createClass(n, [
          {
            key: "setValue",
            value: function (s) {
              var a = get(
                n.prototype.__proto__ || Object.getPrototypeOf(n.prototype),
                "setValue",
                this
              ).call(this, s);
              return (
                this.__onFinishChange &&
                  this.__onFinishChange.call(this, this.getValue()),
                (this.__prev = this.getValue()),
                a
              );
            },
          },
          {
            key: "updateDisplay",
            value: function () {
              return (
                this.getValue() === !0
                  ? (this.__checkbox.setAttribute("checked", "checked"),
                    (this.__checkbox.checked = !0),
                    (this.__prev = !0))
                  : ((this.__checkbox.checked = !1), (this.__prev = !1)),
                get(
                  n.prototype.__proto__ || Object.getPrototypeOf(n.prototype),
                  "updateDisplay",
                  this
                ).call(this)
              );
            },
          },
        ]),
        n
      );
    })(Controller),
    OptionController = (function (r) {
      inherits(n, r);
      function n(i, s, a) {
        classCallCheck(this, n);
        var o = possibleConstructorReturn(
            this,
            (n.__proto__ || Object.getPrototypeOf(n)).call(this, i, s)
          ),
          l = a,
          u = o;
        if (
          ((o.__select = document.createElement("select")), Common.isArray(l))
        ) {
          var f = {};
          Common.each(l, function (c) {
            f[c] = c;
          }),
            (l = f);
        }
        return (
          Common.each(l, function (c, h) {
            var p = document.createElement("option");
            (p.innerHTML = h),
              p.setAttribute("value", c),
              u.__select.appendChild(p);
          }),
          o.updateDisplay(),
          dom.bind(o.__select, "change", function () {
            var c = this.options[this.selectedIndex].value;
            u.setValue(c);
          }),
          o.domElement.appendChild(o.__select),
          o
        );
      }
      return (
        createClass(n, [
          {
            key: "setValue",
            value: function (s) {
              var a = get(
                n.prototype.__proto__ || Object.getPrototypeOf(n.prototype),
                "setValue",
                this
              ).call(this, s);
              return (
                this.__onFinishChange &&
                  this.__onFinishChange.call(this, this.getValue()),
                a
              );
            },
          },
          {
            key: "updateDisplay",
            value: function () {
              return dom.isActive(this.__select)
                ? this
                : ((this.__select.value = this.getValue()),
                  get(
                    n.prototype.__proto__ || Object.getPrototypeOf(n.prototype),
                    "updateDisplay",
                    this
                  ).call(this));
            },
          },
        ]),
        n
      );
    })(Controller),
    StringController = (function (r) {
      inherits(n, r);
      function n(i, s) {
        classCallCheck(this, n);
        var a = possibleConstructorReturn(
            this,
            (n.__proto__ || Object.getPrototypeOf(n)).call(this, i, s)
          ),
          o = a;
        function l() {
          o.setValue(o.__input.value);
        }
        function u() {
          o.__onFinishChange && o.__onFinishChange.call(o, o.getValue());
        }
        return (
          (a.__input = document.createElement("input")),
          a.__input.setAttribute("type", "text"),
          dom.bind(a.__input, "keyup", l),
          dom.bind(a.__input, "change", l),
          dom.bind(a.__input, "blur", u),
          dom.bind(a.__input, "keydown", function (f) {
            f.keyCode === 13 && this.blur();
          }),
          a.updateDisplay(),
          a.domElement.appendChild(a.__input),
          a
        );
      }
      return (
        createClass(n, [
          {
            key: "updateDisplay",
            value: function () {
              return (
                dom.isActive(this.__input) ||
                  (this.__input.value = this.getValue()),
                get(
                  n.prototype.__proto__ || Object.getPrototypeOf(n.prototype),
                  "updateDisplay",
                  this
                ).call(this)
              );
            },
          },
        ]),
        n
      );
    })(Controller);
  function numDecimals(r) {
    var n = r.toString();
    return n.indexOf(".") > -1 ? n.length - n.indexOf(".") - 1 : 0;
  }
  var NumberController = (function (r) {
    inherits(n, r);
    function n(i, s, a) {
      classCallCheck(this, n);
      var o = possibleConstructorReturn(
          this,
          (n.__proto__ || Object.getPrototypeOf(n)).call(this, i, s)
        ),
        l = a || {};
      return (
        (o.__min = l.min),
        (o.__max = l.max),
        (o.__step = l.step),
        Common.isUndefined(o.__step)
          ? o.initialValue === 0
            ? (o.__impliedStep = 1)
            : (o.__impliedStep =
                Math.pow(
                  10,
                  Math.floor(Math.log(Math.abs(o.initialValue)) / Math.LN10)
                ) / 10)
          : (o.__impliedStep = o.__step),
        (o.__precision = numDecimals(o.__impliedStep)),
        o
      );
    }
    return (
      createClass(n, [
        {
          key: "setValue",
          value: function (s) {
            var a = s;
            return (
              this.__min !== void 0 && a < this.__min
                ? (a = this.__min)
                : this.__max !== void 0 && a > this.__max && (a = this.__max),
              this.__step !== void 0 &&
                a % this.__step !== 0 &&
                (a = Math.round(a / this.__step) * this.__step),
              get(
                n.prototype.__proto__ || Object.getPrototypeOf(n.prototype),
                "setValue",
                this
              ).call(this, a)
            );
          },
        },
        {
          key: "min",
          value: function (s) {
            return (this.__min = s), this;
          },
        },
        {
          key: "max",
          value: function (s) {
            return (this.__max = s), this;
          },
        },
        {
          key: "step",
          value: function (s) {
            return (
              (this.__step = s),
              (this.__impliedStep = s),
              (this.__precision = numDecimals(s)),
              this
            );
          },
        },
      ]),
      n
    );
  })(Controller);
  function roundToDecimal(r, n) {
    var i = Math.pow(10, n);
    return Math.round(r * i) / i;
  }
  var NumberControllerBox = (function (r) {
    inherits(n, r);
    function n(i, s, a) {
      classCallCheck(this, n);
      var o = possibleConstructorReturn(
        this,
        (n.__proto__ || Object.getPrototypeOf(n)).call(this, i, s, a)
      );
      o.__truncationSuspended = !1;
      var l = o,
        u = void 0;
      function f() {
        var g = parseFloat(l.__input.value);
        Common.isNaN(g) || l.setValue(g);
      }
      function c() {
        l.__onFinishChange && l.__onFinishChange.call(l, l.getValue());
      }
      function h() {
        c();
      }
      function p(g) {
        var v = u - g.clientY;
        l.setValue(l.getValue() + v * l.__impliedStep), (u = g.clientY);
      }
      function d() {
        dom.unbind(window, "mousemove", p),
          dom.unbind(window, "mouseup", d),
          c();
      }
      function m(g) {
        dom.bind(window, "mousemove", p),
          dom.bind(window, "mouseup", d),
          (u = g.clientY);
      }
      return (
        (o.__input = document.createElement("input")),
        o.__input.setAttribute("type", "text"),
        dom.bind(o.__input, "change", f),
        dom.bind(o.__input, "blur", h),
        dom.bind(o.__input, "mousedown", m),
        dom.bind(o.__input, "keydown", function (g) {
          g.keyCode === 13 &&
            ((l.__truncationSuspended = !0),
            this.blur(),
            (l.__truncationSuspended = !1),
            c());
        }),
        o.updateDisplay(),
        o.domElement.appendChild(o.__input),
        o
      );
    }
    return (
      createClass(n, [
        {
          key: "updateDisplay",
          value: function () {
            return (
              (this.__input.value = this.__truncationSuspended
                ? this.getValue()
                : roundToDecimal(this.getValue(), this.__precision)),
              get(
                n.prototype.__proto__ || Object.getPrototypeOf(n.prototype),
                "updateDisplay",
                this
              ).call(this)
            );
          },
        },
      ]),
      n
    );
  })(NumberController);
  function map(r, n, i, s, a) {
    return s + (a - s) * ((r - n) / (i - n));
  }
  var NumberControllerSlider = (function (r) {
      inherits(n, r);
      function n(i, s, a, o, l) {
        classCallCheck(this, n);
        var u = possibleConstructorReturn(
            this,
            (n.__proto__ || Object.getPrototypeOf(n)).call(this, i, s, {
              min: a,
              max: o,
              step: l,
            })
          ),
          f = u;
        (u.__background = document.createElement("div")),
          (u.__foreground = document.createElement("div")),
          dom.bind(u.__background, "mousedown", c),
          dom.bind(u.__background, "touchstart", d),
          dom.addClass(u.__background, "slider"),
          dom.addClass(u.__foreground, "slider-fg");
        function c(v) {
          document.activeElement.blur(),
            dom.bind(window, "mousemove", h),
            dom.bind(window, "mouseup", p),
            h(v);
        }
        function h(v) {
          v.preventDefault();
          var y = f.__background.getBoundingClientRect();
          return (
            f.setValue(map(v.clientX, y.left, y.right, f.__min, f.__max)), !1
          );
        }
        function p() {
          dom.unbind(window, "mousemove", h),
            dom.unbind(window, "mouseup", p),
            f.__onFinishChange && f.__onFinishChange.call(f, f.getValue());
        }
        function d(v) {
          v.touches.length === 1 &&
            (dom.bind(window, "touchmove", m),
            dom.bind(window, "touchend", g),
            m(v));
        }
        function m(v) {
          var y = v.touches[0].clientX,
            _ = f.__background.getBoundingClientRect();
          f.setValue(map(y, _.left, _.right, f.__min, f.__max));
        }
        function g() {
          dom.unbind(window, "touchmove", m),
            dom.unbind(window, "touchend", g),
            f.__onFinishChange && f.__onFinishChange.call(f, f.getValue());
        }
        return (
          u.updateDisplay(),
          u.__background.appendChild(u.__foreground),
          u.domElement.appendChild(u.__background),
          u
        );
      }
      return (
        createClass(n, [
          {
            key: "updateDisplay",
            value: function () {
              var s =
                (this.getValue() - this.__min) / (this.__max - this.__min);
              return (
                (this.__foreground.style.width = s * 100 + "%"),
                get(
                  n.prototype.__proto__ || Object.getPrototypeOf(n.prototype),
                  "updateDisplay",
                  this
                ).call(this)
              );
            },
          },
        ]),
        n
      );
    })(NumberController),
    FunctionController = (function (r) {
      inherits(n, r);
      function n(i, s, a) {
        classCallCheck(this, n);
        var o = possibleConstructorReturn(
            this,
            (n.__proto__ || Object.getPrototypeOf(n)).call(this, i, s)
          ),
          l = o;
        return (
          (o.__button = document.createElement("div")),
          (o.__button.innerHTML = a === void 0 ? "Fire" : a),
          dom.bind(o.__button, "click", function (u) {
            return u.preventDefault(), l.fire(), !1;
          }),
          dom.addClass(o.__button, "button"),
          o.domElement.appendChild(o.__button),
          o
        );
      }
      return (
        createClass(n, [
          {
            key: "fire",
            value: function () {
              this.__onChange && this.__onChange.call(this),
                this.getValue().call(this.object),
                this.__onFinishChange &&
                  this.__onFinishChange.call(this, this.getValue());
            },
          },
        ]),
        n
      );
    })(Controller),
    ColorController = (function (r) {
      inherits(n, r);
      function n(i, s) {
        classCallCheck(this, n);
        var a = possibleConstructorReturn(
          this,
          (n.__proto__ || Object.getPrototypeOf(n)).call(this, i, s)
        );
        (a.__color = new Color(a.getValue())), (a.__temp = new Color(0));
        var o = a;
        (a.domElement = document.createElement("div")),
          dom.makeSelectable(a.domElement, !1),
          (a.__selector = document.createElement("div")),
          (a.__selector.className = "selector"),
          (a.__saturation_field = document.createElement("div")),
          (a.__saturation_field.className = "saturation-field"),
          (a.__field_knob = document.createElement("div")),
          (a.__field_knob.className = "field-knob"),
          (a.__field_knob_border = "2px solid "),
          (a.__hue_knob = document.createElement("div")),
          (a.__hue_knob.className = "hue-knob"),
          (a.__hue_field = document.createElement("div")),
          (a.__hue_field.className = "hue-field"),
          (a.__input = document.createElement("input")),
          (a.__input.type = "text"),
          (a.__input_textShadow = "0 1px 1px "),
          dom.bind(a.__input, "keydown", function (v) {
            v.keyCode === 13 && p.call(this);
          }),
          dom.bind(a.__input, "blur", p),
          dom.bind(a.__selector, "mousedown", function () {
            dom.addClass(this, "drag").bind(window, "mouseup", function () {
              dom.removeClass(o.__selector, "drag");
            });
          }),
          dom.bind(a.__selector, "touchstart", function () {
            dom.addClass(this, "drag").bind(window, "touchend", function () {
              dom.removeClass(o.__selector, "drag");
            });
          });
        var l = document.createElement("div");
        Common.extend(a.__selector.style, {
          width: "122px",
          height: "102px",
          padding: "3px",
          backgroundColor: "#222",
          boxShadow: "0px 1px 3px rgba(0,0,0,0.3)",
        }),
          Common.extend(a.__field_knob.style, {
            position: "absolute",
            width: "12px",
            height: "12px",
            border:
              a.__field_knob_border + (a.__color.v < 0.5 ? "#fff" : "#000"),
            boxShadow: "0px 1px 3px rgba(0,0,0,0.5)",
            borderRadius: "12px",
            zIndex: 1,
          }),
          Common.extend(a.__hue_knob.style, {
            position: "absolute",
            width: "15px",
            height: "2px",
            borderRight: "4px solid #fff",
            zIndex: 1,
          }),
          Common.extend(a.__saturation_field.style, {
            width: "100px",
            height: "100px",
            border: "1px solid #555",
            marginRight: "3px",
            display: "inline-block",
            cursor: "pointer",
          }),
          Common.extend(l.style, {
            width: "100%",
            height: "100%",
            background: "none",
          }),
          linearGradient(l, "top", "rgba(0,0,0,0)", "#000"),
          Common.extend(a.__hue_field.style, {
            width: "15px",
            height: "100px",
            border: "1px solid #555",
            cursor: "ns-resize",
            position: "absolute",
            top: "3px",
            right: "3px",
          }),
          hueGradient(a.__hue_field),
          Common.extend(a.__input.style, {
            outline: "none",
            textAlign: "center",
            color: "#fff",
            border: 0,
            fontWeight: "bold",
            textShadow: a.__input_textShadow + "rgba(0,0,0,0.7)",
          }),
          dom.bind(a.__saturation_field, "mousedown", u),
          dom.bind(a.__saturation_field, "touchstart", u),
          dom.bind(a.__field_knob, "mousedown", u),
          dom.bind(a.__field_knob, "touchstart", u),
          dom.bind(a.__hue_field, "mousedown", f),
          dom.bind(a.__hue_field, "touchstart", f);
        function u(v) {
          m(v),
            dom.bind(window, "mousemove", m),
            dom.bind(window, "touchmove", m),
            dom.bind(window, "mouseup", c),
            dom.bind(window, "touchend", c);
        }
        function f(v) {
          g(v),
            dom.bind(window, "mousemove", g),
            dom.bind(window, "touchmove", g),
            dom.bind(window, "mouseup", h),
            dom.bind(window, "touchend", h);
        }
        function c() {
          dom.unbind(window, "mousemove", m),
            dom.unbind(window, "touchmove", m),
            dom.unbind(window, "mouseup", c),
            dom.unbind(window, "touchend", c),
            d();
        }
        function h() {
          dom.unbind(window, "mousemove", g),
            dom.unbind(window, "touchmove", g),
            dom.unbind(window, "mouseup", h),
            dom.unbind(window, "touchend", h),
            d();
        }
        function p() {
          var v = interpret(this.value);
          v !== !1
            ? ((o.__color.__state = v), o.setValue(o.__color.toOriginal()))
            : (this.value = o.__color.toString());
        }
        function d() {
          o.__onFinishChange &&
            o.__onFinishChange.call(o, o.__color.toOriginal());
        }
        a.__saturation_field.appendChild(l),
          a.__selector.appendChild(a.__field_knob),
          a.__selector.appendChild(a.__saturation_field),
          a.__selector.appendChild(a.__hue_field),
          a.__hue_field.appendChild(a.__hue_knob),
          a.domElement.appendChild(a.__input),
          a.domElement.appendChild(a.__selector),
          a.updateDisplay();
        function m(v) {
          v.type.indexOf("touch") === -1 && v.preventDefault();
          var y = o.__saturation_field.getBoundingClientRect(),
            _ = (v.touches && v.touches[0]) || v,
            b = _.clientX,
            S = _.clientY,
            P = (b - y.left) / (y.right - y.left),
            I = 1 - (S - y.top) / (y.bottom - y.top);
          return (
            I > 1 ? (I = 1) : I < 0 && (I = 0),
            P > 1 ? (P = 1) : P < 0 && (P = 0),
            (o.__color.v = I),
            (o.__color.s = P),
            o.setValue(o.__color.toOriginal()),
            !1
          );
        }
        function g(v) {
          v.type.indexOf("touch") === -1 && v.preventDefault();
          var y = o.__hue_field.getBoundingClientRect(),
            _ = (v.touches && v.touches[0]) || v,
            b = _.clientY,
            S = 1 - (b - y.top) / (y.bottom - y.top);
          return (
            S > 1 ? (S = 1) : S < 0 && (S = 0),
            (o.__color.h = S * 360),
            o.setValue(o.__color.toOriginal()),
            !1
          );
        }
        return a;
      }
      return (
        createClass(n, [
          {
            key: "updateDisplay",
            value: function () {
              var s = interpret(this.getValue());
              if (s !== !1) {
                var a = !1;
                Common.each(
                  Color.COMPONENTS,
                  function (u) {
                    if (
                      !Common.isUndefined(s[u]) &&
                      !Common.isUndefined(this.__color.__state[u]) &&
                      s[u] !== this.__color.__state[u]
                    )
                      return (a = !0), {};
                  },
                  this
                ),
                  a && Common.extend(this.__color.__state, s);
              }
              Common.extend(this.__temp.__state, this.__color.__state),
                (this.__temp.a = 1);
              var o = this.__color.v < 0.5 || this.__color.s > 0.5 ? 255 : 0,
                l = 255 - o;
              Common.extend(this.__field_knob.style, {
                marginLeft: 100 * this.__color.s - 7 + "px",
                marginTop: 100 * (1 - this.__color.v) - 7 + "px",
                backgroundColor: this.__temp.toHexString(),
                border:
                  this.__field_knob_border +
                  "rgb(" +
                  o +
                  "," +
                  o +
                  "," +
                  o +
                  ")",
              }),
                (this.__hue_knob.style.marginTop =
                  (1 - this.__color.h / 360) * 100 + "px"),
                (this.__temp.s = 1),
                (this.__temp.v = 1),
                linearGradient(
                  this.__saturation_field,
                  "left",
                  "#fff",
                  this.__temp.toHexString()
                ),
                (this.__input.value = this.__color.toString()),
                Common.extend(this.__input.style, {
                  backgroundColor: this.__color.toHexString(),
                  color: "rgb(" + o + "," + o + "," + o + ")",
                  textShadow:
                    this.__input_textShadow +
                    "rgba(" +
                    l +
                    "," +
                    l +
                    "," +
                    l +
                    ",.7)",
                });
            },
          },
        ]),
        n
      );
    })(Controller),
    vendors = ["-moz-", "-o-", "-webkit-", "-ms-", ""];
  function linearGradient(r, n, i, s) {
    (r.style.background = ""),
      Common.each(vendors, function (a) {
        r.style.cssText +=
          "background: " +
          a +
          "linear-gradient(" +
          n +
          ", " +
          i +
          " 0%, " +
          s +
          " 100%); ";
      });
  }
  function hueGradient(r) {
    (r.style.background = ""),
      (r.style.cssText +=
        "background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);"),
      (r.style.cssText +=
        "background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"),
      (r.style.cssText +=
        "background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"),
      (r.style.cssText +=
        "background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"),
      (r.style.cssText +=
        "background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);");
  }
  var css = {
      load: function (n, i) {
        var s = i || document,
          a = s.createElement("link");
        (a.type = "text/css"),
          (a.rel = "stylesheet"),
          (a.href = n),
          s.getElementsByTagName("head")[0].appendChild(a);
      },
      inject: function (n, i) {
        var s = i || document,
          a = document.createElement("style");
        (a.type = "text/css"), (a.innerHTML = n);
        var o = s.getElementsByTagName("head")[0];
        try {
          o.appendChild(a);
        } catch (l) {}
      },
    },
    saveDialogContents =
      '<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>',
    ControllerFactory = function (n, i) {
      var s = n[i];
      return Common.isArray(arguments[2]) || Common.isObject(arguments[2])
        ? new OptionController(n, i, arguments[2])
        : Common.isNumber(s)
        ? Common.isNumber(arguments[2]) && Common.isNumber(arguments[3])
          ? Common.isNumber(arguments[4])
            ? new NumberControllerSlider(
                n,
                i,
                arguments[2],
                arguments[3],
                arguments[4]
              )
            : new NumberControllerSlider(n, i, arguments[2], arguments[3])
          : Common.isNumber(arguments[4])
          ? new NumberControllerBox(n, i, {
              min: arguments[2],
              max: arguments[3],
              step: arguments[4],
            })
          : new NumberControllerBox(n, i, {
              min: arguments[2],
              max: arguments[3],
            })
        : Common.isString(s)
        ? new StringController(n, i)
        : Common.isFunction(s)
        ? new FunctionController(n, i, "")
        : Common.isBoolean(s)
        ? new BooleanController(n, i)
        : null;
    };
  function requestAnimationFrame$1(r) {
    setTimeout(r, 1e3 / 60);
  }
  var requestAnimationFrame$1$1 =
      window.requestAnimationFrame ||
      window.webkitRequestAnimationFrame ||
      window.mozRequestAnimationFrame ||
      window.oRequestAnimationFrame ||
      window.msRequestAnimationFrame ||
      requestAnimationFrame$1,
    CenteredDiv = (function () {
      function r() {
        classCallCheck(this, r),
          (this.backgroundElement = document.createElement("div")),
          Common.extend(this.backgroundElement.style, {
            backgroundColor: "rgba(0,0,0,0.8)",
            top: 0,
            left: 0,
            display: "none",
            zIndex: "1000",
            opacity: 0,
            WebkitTransition: "opacity 0.2s linear",
            transition: "opacity 0.2s linear",
          }),
          dom.makeFullscreen(this.backgroundElement),
          (this.backgroundElement.style.position = "fixed"),
          (this.domElement = document.createElement("div")),
          Common.extend(this.domElement.style, {
            position: "fixed",
            display: "none",
            zIndex: "1001",
            opacity: 0,
            WebkitTransition:
              "-webkit-transform 0.2s ease-out, opacity 0.2s linear",
            transition: "transform 0.2s ease-out, opacity 0.2s linear",
          }),
          document.body.appendChild(this.backgroundElement),
          document.body.appendChild(this.domElement);
        var n = this;
        dom.bind(this.backgroundElement, "click", function () {
          n.hide();
        });
      }
      return (
        createClass(r, [
          {
            key: "show",
            value: function () {
              var i = this;
              (this.backgroundElement.style.display = "block"),
                (this.domElement.style.display = "block"),
                (this.domElement.style.opacity = 0),
                (this.domElement.style.webkitTransform = "scale(1.1)"),
                this.layout(),
                Common.defer(function () {
                  (i.backgroundElement.style.opacity = 1),
                    (i.domElement.style.opacity = 1),
                    (i.domElement.style.webkitTransform = "scale(1)");
                });
            },
          },
          {
            key: "hide",
            value: function () {
              var i = this,
                s = function a() {
                  (i.domElement.style.display = "none"),
                    (i.backgroundElement.style.display = "none"),
                    dom.unbind(i.domElement, "webkitTransitionEnd", a),
                    dom.unbind(i.domElement, "transitionend", a),
                    dom.unbind(i.domElement, "oTransitionEnd", a);
                };
              dom.bind(this.domElement, "webkitTransitionEnd", s),
                dom.bind(this.domElement, "transitionend", s),
                dom.bind(this.domElement, "oTransitionEnd", s),
                (this.backgroundElement.style.opacity = 0),
                (this.domElement.style.opacity = 0),
                (this.domElement.style.webkitTransform = "scale(1.1)");
            },
          },
          {
            key: "layout",
            value: function () {
              (this.domElement.style.left =
                window.innerWidth / 2 -
                dom.getWidth(this.domElement) / 2 +
                "px"),
                (this.domElement.style.top =
                  window.innerHeight / 2 -
                  dom.getHeight(this.domElement) / 2 +
                  "px");
            },
          },
        ]),
        r
      );
    })(),
    styleSheet = ___$insertStyle(
      ".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"
    );
  css.inject(styleSheet);
  var CSS_NAMESPACE = "dg",
    HIDE_KEY_CODE = 72,
    CLOSE_BUTTON_HEIGHT = 20,
    DEFAULT_DEFAULT_PRESET_NAME = "Default",
    SUPPORTS_LOCAL_STORAGE = (function () {
      try {
        return !!window.localStorage;
      } catch (r) {
        return !1;
      }
    })(),
    SAVE_DIALOGUE = void 0,
    autoPlaceVirgin = !0,
    autoPlaceContainer = void 0,
    hide = !1,
    hideableGuis = [],
    GUI = function r(n) {
      var i = function () {
          var d = s.getRoot();
          (d.width += 1),
            Common.defer(function () {
              d.width -= 1;
            });
        },
        s = this,
        a = n || {};
      (this.domElement = document.createElement("div")),
        (this.__ul = document.createElement("ul")),
        this.domElement.appendChild(this.__ul),
        dom.addClass(this.domElement, CSS_NAMESPACE),
        (this.__folders = {}),
        (this.__controllers = []),
        (this.__rememberedObjects = []),
        (this.__rememberedObjectIndecesToControllers = []),
        (this.__listening = []),
        (a = Common.defaults(a, {
          closeOnTop: !1,
          autoPlace: !0,
          width: r.DEFAULT_WIDTH,
        })),
        (a = Common.defaults(a, {
          resizable: a.autoPlace,
          hideable: a.autoPlace,
        })),
        Common.isUndefined(a.load)
          ? (a.load = { preset: DEFAULT_DEFAULT_PRESET_NAME })
          : a.preset && (a.load.preset = a.preset),
        Common.isUndefined(a.parent) && a.hideable && hideableGuis.push(this),
        (a.resizable = Common.isUndefined(a.parent) && a.resizable),
        a.autoPlace && Common.isUndefined(a.scrollable) && (a.scrollable = !0);
      var o =
          SUPPORTS_LOCAL_STORAGE &&
          localStorage.getItem(getLocalStorageHash(this, "isLocal")) === "true",
        l = void 0,
        u = void 0;
      if (
        (Object.defineProperties(this, {
          parent: {
            get: function () {
              return a.parent;
            },
          },
          scrollable: {
            get: function () {
              return a.scrollable;
            },
          },
          autoPlace: {
            get: function () {
              return a.autoPlace;
            },
          },
          closeOnTop: {
            get: function () {
              return a.closeOnTop;
            },
          },
          preset: {
            get: function () {
              return s.parent ? s.getRoot().preset : a.load.preset;
            },
            set: function (d) {
              s.parent ? (s.getRoot().preset = d) : (a.load.preset = d),
                setPresetSelectIndex(this),
                s.revert();
            },
          },
          width: {
            get: function () {
              return a.width;
            },
            set: function (d) {
              (a.width = d), setWidth(s, d);
            },
          },
          name: {
            get: function () {
              return a.name;
            },
            set: function (d) {
              (a.name = d), u && (u.innerHTML = a.name);
            },
          },
          closed: {
            get: function () {
              return a.closed;
            },
            set: function (d) {
              (a.closed = d),
                a.closed
                  ? dom.addClass(s.__ul, r.CLASS_CLOSED)
                  : dom.removeClass(s.__ul, r.CLASS_CLOSED),
                this.onResize(),
                s.__closeButton &&
                  (s.__closeButton.innerHTML = d ? r.TEXT_OPEN : r.TEXT_CLOSED);
            },
          },
          load: {
            get: function () {
              return a.load;
            },
          },
          useLocalStorage: {
            get: function () {
              return o;
            },
            set: function (d) {
              SUPPORTS_LOCAL_STORAGE &&
                ((o = d),
                d
                  ? dom.bind(window, "unload", l)
                  : dom.unbind(window, "unload", l),
                localStorage.setItem(getLocalStorageHash(s, "isLocal"), d));
            },
          },
        }),
        Common.isUndefined(a.parent))
      ) {
        if (
          ((this.closed = a.closed || !1),
          dom.addClass(this.domElement, r.CLASS_MAIN),
          dom.makeSelectable(this.domElement, !1),
          SUPPORTS_LOCAL_STORAGE && o)
        ) {
          s.useLocalStorage = !0;
          var f = localStorage.getItem(getLocalStorageHash(this, "gui"));
          f && (a.load = JSON.parse(f));
        }
        (this.__closeButton = document.createElement("div")),
          (this.__closeButton.innerHTML = r.TEXT_CLOSED),
          dom.addClass(this.__closeButton, r.CLASS_CLOSE_BUTTON),
          a.closeOnTop
            ? (dom.addClass(this.__closeButton, r.CLASS_CLOSE_TOP),
              this.domElement.insertBefore(
                this.__closeButton,
                this.domElement.childNodes[0]
              ))
            : (dom.addClass(this.__closeButton, r.CLASS_CLOSE_BOTTOM),
              this.domElement.appendChild(this.__closeButton)),
          dom.bind(this.__closeButton, "click", function () {
            s.closed = !s.closed;
          });
      } else {
        a.closed === void 0 && (a.closed = !0);
        var c = document.createTextNode(a.name);
        dom.addClass(c, "controller-name"), (u = addRow(s, c));
        var h = function (d) {
          return d.preventDefault(), (s.closed = !s.closed), !1;
        };
        dom.addClass(this.__ul, r.CLASS_CLOSED),
          dom.addClass(u, "title"),
          dom.bind(u, "click", h),
          a.closed || (this.closed = !1);
      }
      a.autoPlace &&
        (Common.isUndefined(a.parent) &&
          (autoPlaceVirgin &&
            ((autoPlaceContainer = document.createElement("div")),
            dom.addClass(autoPlaceContainer, CSS_NAMESPACE),
            dom.addClass(autoPlaceContainer, r.CLASS_AUTO_PLACE_CONTAINER),
            document.body.appendChild(autoPlaceContainer),
            (autoPlaceVirgin = !1)),
          autoPlaceContainer.appendChild(this.domElement),
          dom.addClass(this.domElement, r.CLASS_AUTO_PLACE)),
        this.parent || setWidth(s, a.width)),
        (this.__resizeHandler = function () {
          s.onResizeDebounced();
        }),
        dom.bind(window, "resize", this.__resizeHandler),
        dom.bind(this.__ul, "webkitTransitionEnd", this.__resizeHandler),
        dom.bind(this.__ul, "transitionend", this.__resizeHandler),
        dom.bind(this.__ul, "oTransitionEnd", this.__resizeHandler),
        this.onResize(),
        a.resizable && addResizeHandle(this),
        (l = function () {
          SUPPORTS_LOCAL_STORAGE &&
            localStorage.getItem(getLocalStorageHash(s, "isLocal")) ===
              "true" &&
            localStorage.setItem(
              getLocalStorageHash(s, "gui"),
              JSON.stringify(s.getSaveObject())
            );
        }),
        (this.saveToLocalStorageIfPossible = l),
        a.parent || i();
    };
  (GUI.toggleHide = function () {
    (hide = !hide),
      Common.each(hideableGuis, function (r) {
        r.domElement.style.display = hide ? "none" : "";
      });
  }),
    (GUI.CLASS_AUTO_PLACE = "a"),
    (GUI.CLASS_AUTO_PLACE_CONTAINER = "ac"),
    (GUI.CLASS_MAIN = "main"),
    (GUI.CLASS_CONTROLLER_ROW = "cr"),
    (GUI.CLASS_TOO_TALL = "taller-than-window"),
    (GUI.CLASS_CLOSED = "closed"),
    (GUI.CLASS_CLOSE_BUTTON = "close-button"),
    (GUI.CLASS_CLOSE_TOP = "close-top"),
    (GUI.CLASS_CLOSE_BOTTOM = "close-bottom"),
    (GUI.CLASS_DRAG = "drag"),
    (GUI.DEFAULT_WIDTH = 245),
    (GUI.TEXT_CLOSED = "Close Controls"),
    (GUI.TEXT_OPEN = "Open Controls"),
    (GUI._keydownHandler = function (r) {
      document.activeElement.type !== "text" &&
        (r.which === HIDE_KEY_CODE || r.keyCode === HIDE_KEY_CODE) &&
        GUI.toggleHide();
    }),
    dom.bind(window, "keydown", GUI._keydownHandler, !1),
    Common.extend(GUI.prototype, {
      add: function (n, i) {
        return _add(this, n, i, {
          factoryArgs: Array.prototype.slice.call(arguments, 2),
        });
      },
      addColor: function (n, i) {
        return _add(this, n, i, { color: !0 });
      },
      remove: function (n) {
        this.__ul.removeChild(n.__li),
          this.__controllers.splice(this.__controllers.indexOf(n), 1);
        var i = this;
        Common.defer(function () {
          i.onResize();
        });
      },
      destroy: function () {
        if (this.parent)
          throw new Error(
            "Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead."
          );
        this.autoPlace && autoPlaceContainer.removeChild(this.domElement);
        var n = this;
        Common.each(this.__folders, function (i) {
          n.removeFolder(i);
        }),
          dom.unbind(window, "keydown", GUI._keydownHandler, !1),
          removeListeners(this);
      },
      addFolder: function (n) {
        if (this.__folders[n] !== void 0)
          throw new Error(
            'You already have a folder in this GUI by the name "' + n + '"'
          );
        var i = { name: n, parent: this };
        (i.autoPlace = this.autoPlace),
          this.load &&
            this.load.folders &&
            this.load.folders[n] &&
            ((i.closed = this.load.folders[n].closed),
            (i.load = this.load.folders[n]));
        var s = new GUI(i);
        this.__folders[n] = s;
        var a = addRow(this, s.domElement);
        return dom.addClass(a, "folder"), s;
      },
      removeFolder: function (n) {
        this.__ul.removeChild(n.domElement.parentElement),
          delete this.__folders[n.name],
          this.load &&
            this.load.folders &&
            this.load.folders[n.name] &&
            delete this.load.folders[n.name],
          removeListeners(n);
        var i = this;
        Common.each(n.__folders, function (s) {
          n.removeFolder(s);
        }),
          Common.defer(function () {
            i.onResize();
          });
      },
      open: function () {
        this.closed = !1;
      },
      close: function () {
        this.closed = !0;
      },
      hide: function () {
        this.domElement.style.display = "none";
      },
      show: function () {
        this.domElement.style.display = "";
      },
      onResize: function () {
        var n = this.getRoot();
        if (n.scrollable) {
          var i = dom.getOffset(n.__ul).top,
            s = 0;
          Common.each(n.__ul.childNodes, function (a) {
            (n.autoPlace && a === n.__save_row) || (s += dom.getHeight(a));
          }),
            window.innerHeight - i - CLOSE_BUTTON_HEIGHT < s
              ? (dom.addClass(n.domElement, GUI.CLASS_TOO_TALL),
                (n.__ul.style.height =
                  window.innerHeight - i - CLOSE_BUTTON_HEIGHT + "px"))
              : (dom.removeClass(n.domElement, GUI.CLASS_TOO_TALL),
                (n.__ul.style.height = "auto"));
        }
        n.__resize_handle &&
          Common.defer(function () {
            n.__resize_handle.style.height = n.__ul.offsetHeight + "px";
          }),
          n.__closeButton && (n.__closeButton.style.width = n.width + "px");
      },
      onResizeDebounced: Common.debounce(function () {
        this.onResize();
      }, 50),
      remember: function () {
        if (
          (Common.isUndefined(SAVE_DIALOGUE) &&
            ((SAVE_DIALOGUE = new CenteredDiv()),
            (SAVE_DIALOGUE.domElement.innerHTML = saveDialogContents)),
          this.parent)
        )
          throw new Error("You can only call remember on a top level GUI.");
        var n = this;
        Common.each(Array.prototype.slice.call(arguments), function (i) {
          n.__rememberedObjects.length === 0 && addSaveMenu(n),
            n.__rememberedObjects.indexOf(i) === -1 &&
              n.__rememberedObjects.push(i);
        }),
          this.autoPlace && setWidth(this, this.width);
      },
      getRoot: function () {
        for (var n = this; n.parent; ) n = n.parent;
        return n;
      },
      getSaveObject: function () {
        var n = this.load;
        return (
          (n.closed = this.closed),
          this.__rememberedObjects.length > 0 &&
            ((n.preset = this.preset),
            n.remembered || (n.remembered = {}),
            (n.remembered[this.preset] = getCurrentPreset(this))),
          (n.folders = {}),
          Common.each(this.__folders, function (i, s) {
            n.folders[s] = i.getSaveObject();
          }),
          n
        );
      },
      save: function () {
        this.load.remembered || (this.load.remembered = {}),
          (this.load.remembered[this.preset] = getCurrentPreset(this)),
          markPresetModified(this, !1),
          this.saveToLocalStorageIfPossible();
      },
      saveAs: function (n) {
        this.load.remembered ||
          ((this.load.remembered = {}),
          (this.load.remembered[DEFAULT_DEFAULT_PRESET_NAME] = getCurrentPreset(
            this,
            !0
          ))),
          (this.load.remembered[n] = getCurrentPreset(this)),
          (this.preset = n),
          addPresetOption(this, n, !0),
          this.saveToLocalStorageIfPossible();
      },
      revert: function (n) {
        Common.each(
          this.__controllers,
          function (i) {
            this.getRoot().load.remembered
              ? recallSavedValue(n || this.getRoot(), i)
              : i.setValue(i.initialValue),
              i.__onFinishChange && i.__onFinishChange.call(i, i.getValue());
          },
          this
        ),
          Common.each(this.__folders, function (i) {
            i.revert(i);
          }),
          n || markPresetModified(this.getRoot(), !1);
      },
      listen: function (n) {
        var i = this.__listening.length === 0;
        this.__listening.push(n), i && updateDisplays(this.__listening);
      },
      updateDisplay: function () {
        Common.each(this.__controllers, function (n) {
          n.updateDisplay();
        }),
          Common.each(this.__folders, function (n) {
            n.updateDisplay();
          });
      },
    });
  function addRow(r, n, i) {
    var s = document.createElement("li");
    return (
      n && s.appendChild(n),
      i ? r.__ul.insertBefore(s, i) : r.__ul.appendChild(s),
      r.onResize(),
      s
    );
  }
  function removeListeners(r) {
    dom.unbind(window, "resize", r.__resizeHandler),
      r.saveToLocalStorageIfPossible &&
        dom.unbind(window, "unload", r.saveToLocalStorageIfPossible);
  }
  function markPresetModified(r, n) {
    var i = r.__preset_select[r.__preset_select.selectedIndex];
    n ? (i.innerHTML = i.value + "*") : (i.innerHTML = i.value);
  }
  function augmentController(r, n, i) {
    if (
      ((i.__li = n),
      (i.__gui = r),
      Common.extend(i, {
        options: function (l) {
          if (arguments.length > 1) {
            var u = i.__li.nextElementSibling;
            return (
              i.remove(),
              _add(r, i.object, i.property, {
                before: u,
                factoryArgs: [Common.toArray(arguments)],
              })
            );
          }
          if (Common.isArray(l) || Common.isObject(l)) {
            var f = i.__li.nextElementSibling;
            return (
              i.remove(),
              _add(r, i.object, i.property, { before: f, factoryArgs: [l] })
            );
          }
        },
        name: function (l) {
          return (i.__li.firstElementChild.firstElementChild.innerHTML = l), i;
        },
        listen: function () {
          return i.__gui.listen(i), i;
        },
        remove: function () {
          return i.__gui.remove(i), i;
        },
      }),
      _instanceof$1(i, NumberControllerSlider))
    ) {
      var s = new NumberControllerBox(i.object, i.property, {
        min: i.__min,
        max: i.__max,
        step: i.__step,
      });
      Common.each(
        ["updateDisplay", "onChange", "onFinishChange", "step", "min", "max"],
        function (o) {
          var l = i[o],
            u = s[o];
          i[o] = s[o] = function () {
            var f = Array.prototype.slice.call(arguments);
            return u.apply(s, f), l.apply(i, f);
          };
        }
      ),
        dom.addClass(n, "has-slider"),
        i.domElement.insertBefore(s.domElement, i.domElement.firstElementChild);
    } else if (_instanceof$1(i, NumberControllerBox)) {
      var a = function (l) {
        if (Common.isNumber(i.__min) && Common.isNumber(i.__max)) {
          var u = i.__li.firstElementChild.firstElementChild.innerHTML,
            f = i.__gui.__listening.indexOf(i) > -1;
          i.remove();
          var c = _add(r, i.object, i.property, {
            before: i.__li.nextElementSibling,
            factoryArgs: [i.__min, i.__max, i.__step],
          });
          return c.name(u), f && c.listen(), c;
        }
        return l;
      };
      (i.min = Common.compose(a, i.min)), (i.max = Common.compose(a, i.max));
    } else
      _instanceof$1(i, BooleanController)
        ? (dom.bind(n, "click", function () {
            dom.fakeEvent(i.__checkbox, "click");
          }),
          dom.bind(i.__checkbox, "click", function (o) {
            o.stopPropagation();
          }))
        : _instanceof$1(i, FunctionController)
        ? (dom.bind(n, "click", function () {
            dom.fakeEvent(i.__button, "click");
          }),
          dom.bind(n, "mouseover", function () {
            dom.addClass(i.__button, "hover");
          }),
          dom.bind(n, "mouseout", function () {
            dom.removeClass(i.__button, "hover");
          }))
        : _instanceof$1(i, ColorController) &&
          (dom.addClass(n, "color"),
          (i.updateDisplay = Common.compose(function (o) {
            return (n.style.borderLeftColor = i.__color.toString()), o;
          }, i.updateDisplay)),
          i.updateDisplay());
    i.setValue = Common.compose(function (o) {
      return (
        r.getRoot().__preset_select &&
          i.isModified() &&
          markPresetModified(r.getRoot(), !0),
        o
      );
    }, i.setValue);
  }
  function recallSavedValue(r, n) {
    var i = r.getRoot(),
      s = i.__rememberedObjects.indexOf(n.object);
    if (s !== -1) {
      var a = i.__rememberedObjectIndecesToControllers[s];
      if (
        (a === void 0 &&
          ((a = {}), (i.__rememberedObjectIndecesToControllers[s] = a)),
        (a[n.property] = n),
        i.load && i.load.remembered)
      ) {
        var o = i.load.remembered,
          l = void 0;
        if (o[r.preset]) l = o[r.preset];
        else if (o[DEFAULT_DEFAULT_PRESET_NAME])
          l = o[DEFAULT_DEFAULT_PRESET_NAME];
        else return;
        if (l[s] && l[s][n.property] !== void 0) {
          var u = l[s][n.property];
          (n.initialValue = u), n.setValue(u);
        }
      }
    }
  }
  function _add(r, n, i, s) {
    if (n[i] === void 0)
      throw new Error('Object "' + n + '" has no property "' + i + '"');
    var a = void 0;
    if (s.color) a = new ColorController(n, i);
    else {
      var o = [n, i].concat(s.factoryArgs);
      a = ControllerFactory.apply(r, o);
    }
    _instanceof$1(s.before, Controller) && (s.before = s.before.__li),
      recallSavedValue(r, a),
      dom.addClass(a.domElement, "c");
    var l = document.createElement("span");
    dom.addClass(l, "property-name"), (l.innerHTML = a.property);
    var u = document.createElement("div");
    u.appendChild(l), u.appendChild(a.domElement);
    var f = addRow(r, u, s.before);
    return (
      dom.addClass(f, GUI.CLASS_CONTROLLER_ROW),
      _instanceof$1(a, ColorController)
        ? dom.addClass(f, "color")
        : dom.addClass(f, _$_typeof(a.getValue())),
      augmentController(r, f, a),
      r.__controllers.push(a),
      a
    );
  }
  function getLocalStorageHash(r, n) {
    return document.location.href + "." + n;
  }
  function addPresetOption(r, n, i) {
    var s = document.createElement("option");
    (s.innerHTML = n),
      (s.value = n),
      r.__preset_select.appendChild(s),
      i && (r.__preset_select.selectedIndex = r.__preset_select.length - 1);
  }
  function showHideExplain(r, n) {
    n.style.display = r.useLocalStorage ? "block" : "none";
  }
  function addSaveMenu(r) {
    var n = (r.__save_row = document.createElement("li"));
    dom.addClass(r.domElement, "has-save"),
      r.__ul.insertBefore(n, r.__ul.firstChild),
      dom.addClass(n, "save-row");
    var i = document.createElement("span");
    (i.innerHTML = "&nbsp;"), dom.addClass(i, "button gears");
    var s = document.createElement("span");
    (s.innerHTML = "Save"), dom.addClass(s, "button"), dom.addClass(s, "save");
    var a = document.createElement("span");
    (a.innerHTML = "New"),
      dom.addClass(a, "button"),
      dom.addClass(a, "save-as");
    var o = document.createElement("span");
    (o.innerHTML = "Revert"),
      dom.addClass(o, "button"),
      dom.addClass(o, "revert");
    var l = (r.__preset_select = document.createElement("select"));
    if (
      (r.load && r.load.remembered
        ? Common.each(r.load.remembered, function (p, d) {
            addPresetOption(r, d, d === r.preset);
          })
        : addPresetOption(r, DEFAULT_DEFAULT_PRESET_NAME, !1),
      dom.bind(l, "change", function () {
        for (var p = 0; p < r.__preset_select.length; p++)
          r.__preset_select[p].innerHTML = r.__preset_select[p].value;
        r.preset = this.value;
      }),
      n.appendChild(l),
      n.appendChild(i),
      n.appendChild(s),
      n.appendChild(a),
      n.appendChild(o),
      SUPPORTS_LOCAL_STORAGE)
    ) {
      var u = document.getElementById("dg-local-explain"),
        f = document.getElementById("dg-local-storage"),
        c = document.getElementById("dg-save-locally");
      (c.style.display = "block"),
        localStorage.getItem(getLocalStorageHash(r, "isLocal")) === "true" &&
          f.setAttribute("checked", "checked"),
        showHideExplain(r, u),
        dom.bind(f, "change", function () {
          (r.useLocalStorage = !r.useLocalStorage), showHideExplain(r, u);
        });
    }
    var h = document.getElementById("dg-new-constructor");
    dom.bind(h, "keydown", function (p) {
      p.metaKey && (p.which === 67 || p.keyCode === 67) && SAVE_DIALOGUE.hide();
    }),
      dom.bind(i, "click", function () {
        (h.innerHTML = JSON.stringify(r.getSaveObject(), void 0, 2)),
          SAVE_DIALOGUE.show(),
          h.focus(),
          h.select();
      }),
      dom.bind(s, "click", function () {
        r.save();
      }),
      dom.bind(a, "click", function () {
        var p = prompt("Enter a new preset name.");
        p && r.saveAs(p);
      }),
      dom.bind(o, "click", function () {
        r.revert();
      });
  }
  function addResizeHandle(r) {
    var n = function (l) {
        return (
          l.preventDefault(),
          (r.width += s - l.clientX),
          r.onResize(),
          (s = l.clientX),
          !1
        );
      },
      i = function (l) {
        return (
          l.preventDefault(),
          (s = l.clientX),
          dom.addClass(r.__closeButton, GUI.CLASS_DRAG),
          dom.bind(window, "mousemove", n),
          dom.bind(window, "mouseup", a),
          !1
        );
      },
      s = void 0;
    (r.__resize_handle = document.createElement("div")),
      Common.extend(r.__resize_handle.style, {
        width: "6px",
        marginLeft: "-3px",
        height: "200px",
        cursor: "ew-resize",
        position: "absolute",
      });
    function a() {
      dom.removeClass(r.__closeButton, GUI.CLASS_DRAG),
        dom.unbind(window, "mousemove", n),
        dom.unbind(window, "mouseup", a);
    }
    dom.bind(r.__resize_handle, "mousedown", i),
      dom.bind(r.__closeButton, "mousedown", i),
      r.domElement.insertBefore(
        r.__resize_handle,
        r.domElement.firstElementChild
      );
  }
  function setWidth(r, n) {
    (r.domElement.style.width = n + "px"),
      r.__save_row && r.autoPlace && (r.__save_row.style.width = n + "px"),
      r.__closeButton && (r.__closeButton.style.width = n + "px");
  }
  function getCurrentPreset(r, n) {
    var i = {};
    return (
      Common.each(r.__rememberedObjects, function (s, a) {
        var o = {},
          l = r.__rememberedObjectIndecesToControllers[a];
        Common.each(l, function (u, f) {
          o[f] = n ? u.initialValue : u.getValue();
        }),
          (i[a] = o);
      }),
      i
    );
  }
  function setPresetSelectIndex(r) {
    for (var n = 0; n < r.__preset_select.length; n++)
      r.__preset_select[n].value === r.preset &&
        (r.__preset_select.selectedIndex = n);
  }
  function updateDisplays(r) {
    r.length !== 0 &&
      requestAnimationFrame$1$1.call(window, function () {
        updateDisplays(r);
      }),
      Common.each(r, function (n) {
        n.updateDisplay();
      });
  }
  var color = { Color: Color, math: ColorMath, interpret: interpret },
    controllers = {
      Controller: Controller,
      BooleanController: BooleanController,
      OptionController: OptionController,
      StringController: StringController,
      NumberController: NumberController,
      NumberControllerBox: NumberControllerBox,
      NumberControllerSlider: NumberControllerSlider,
      FunctionController: FunctionController,
      ColorController: ColorController,
    },
    dom$1 = { dom: dom },
    gui = { GUI: GUI },
    GUI$1 = GUI,
    index = {
      color: color,
      controllers: controllers,
      dom: dom$1,
      gui: gui,
      GUI: GUI$1,
    },
    dat_gui_module = Object.freeze({
      __proto__: null,
      color: color,
      controllers: controllers,
      dom: dom$1,
      gui: gui,
      GUI: GUI$1,
      default: index,
    }),
    require$$7 = getAugmentedNamespace(dat_gui_module);
  function _arrayLikeToArray(r, n) {
    (n == null || n > r.length) && (n = r.length);
    for (var i = 0, s = new Array(n); i < n; i++) s[i] = r[i];
    return s;
  }
  function _arrayWithHoles(r) {
    if (Array.isArray(r)) return r;
  }
  function _arrayWithoutHoles(r) {
    if (Array.isArray(r)) return _arrayLikeToArray(r);
  }
  function _assertThisInitialized(r) {
    if (r === void 0)
      throw new ReferenceError(
        "this hasn't been initialised - super() hasn't been called"
      );
    return r;
  }
  function _classCallCheck(r, n) {
    if (!(r instanceof n))
      throw new TypeError("Cannot call a class as a function");
  }
  function isNativeReflectConstruct() {
    if (
      typeof Reflect == "undefined" ||
      !Reflect.construct ||
      Reflect.construct.sham
    )
      return !1;
    if (typeof Proxy == "function") return !0;
    try {
      return (
        Date.prototype.toString.call(
          Reflect.construct(Date, [], function () {})
        ),
        !0
      );
    } catch (r) {
      return !1;
    }
  }
  function _construct(r, n, i) {
    return (
      isNativeReflectConstruct()
        ? (_construct = Reflect.construct)
        : (_construct = function (s, a, o) {
            var l = [null];
            l.push.apply(l, a);
            var u = Function.bind.apply(s, l),
              f = new u();
            return o && _setPrototypeOf(f, o.prototype), f;
          }),
      _construct.apply(null, arguments)
    );
  }
  function _defineProperties(r, n) {
    for (var i = 0; i < n.length; i++) {
      var s = n[i];
      (s.enumerable = s.enumerable || !1),
        (s.configurable = !0),
        "value" in s && (s.writable = !0),
        Object.defineProperty(r, s.key, s);
    }
  }
  function _createClass(r, n, i) {
    return (
      n && _defineProperties(r.prototype, n), i && _defineProperties(r, i), r
    );
  }
  function _defineProperty(r, n, i) {
    return (
      n in r
        ? Object.defineProperty(r, n, {
            value: i,
            enumerable: !0,
            configurable: !0,
            writable: !0,
          })
        : (r[n] = i),
      r
    );
  }
  function _get(r, n, i) {
    return (
      typeof Reflect != "undefined" && Reflect.get
        ? (_get = Reflect.get)
        : (_get = function (s, a, o) {
            var l = _superPropBase(s, a);
            if (l) {
              var u = Object.getOwnPropertyDescriptor(l, a);
              return u.get ? u.get.call(o) : u.value;
            }
          }),
      _get(r, n, i || r)
    );
  }
  function _getPrototypeOf(r) {
    return (
      (_getPrototypeOf = Object.setPrototypeOf
        ? Object.getPrototypeOf
        : function (n) {
            return n.__proto__ || Object.getPrototypeOf(n);
          }),
      _getPrototypeOf(r)
    );
  }
  function _inherits(r, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Super expression must either be null or a function");
    (r.prototype = Object.create(n && n.prototype, {
      constructor: { value: r, writable: !0, configurable: !0 },
    })),
      n && _setPrototypeOf(r, n);
  }
  function _instanceof(r, n) {
    return n != null && typeof Symbol != "undefined" && n[Symbol.hasInstance]
      ? !!n[Symbol.hasInstance](r)
      : r instanceof n;
  }
  function _isNativeFunction(r) {
    return Function.toString.call(r).indexOf("[native code]") !== -1;
  }
  function _iterableToArray(r) {
    if (
      (typeof Symbol != "undefined" && r[Symbol.iterator] != null) ||
      r["@@iterator"] != null
    )
      return Array.from(r);
  }
  function _iterableToArrayLimit(r, n) {
    var i =
      r == null
        ? null
        : (typeof Symbol != "undefined" && r[Symbol.iterator]) ||
          r["@@iterator"];
    if (i != null) {
      var s = [],
        a = !0,
        o = !1,
        l,
        u;
      try {
        for (
          i = i.call(r);
          !(a = (l = i.next()).done) &&
          (s.push(l.value), !(n && s.length === n));
          a = !0
        );
      } catch (f) {
        (o = !0), (u = f);
      } finally {
        try {
          !a && i.return != null && i.return();
        } finally {
          if (o) throw u;
        }
      }
      return s;
    }
  }
  function _nonIterableRest() {
    throw new TypeError(
      "Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."
    );
  }
  function _nonIterableSpread() {
    throw new TypeError(
      "Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."
    );
  }
  function _possibleConstructorReturn(r, n) {
    return n && (_typeof(n) === "object" || typeof n == "function")
      ? n
      : _assertThisInitialized(r);
  }
  function _setPrototypeOf(r, n) {
    return (
      (_setPrototypeOf =
        Object.setPrototypeOf ||
        function (i, s) {
          return (i.__proto__ = s), i;
        }),
      _setPrototypeOf(r, n)
    );
  }
  function _slicedToArray(r, n) {
    return (
      _arrayWithHoles(r) ||
      _iterableToArrayLimit(r, n) ||
      _unsupportedIterableToArray(r, n) ||
      _nonIterableRest()
    );
  }
  function _superPropBase(r, n) {
    for (
      ;
      !Object.prototype.hasOwnProperty.call(r, n) &&
      ((r = _getPrototypeOf(r)), r !== null);

    );
    return r;
  }
  function _toConsumableArray(r) {
    return (
      _arrayWithoutHoles(r) ||
      _iterableToArray(r) ||
      _unsupportedIterableToArray(r) ||
      _nonIterableSpread()
    );
  }
  var _typeof = function (r) {
    return r && typeof Symbol != "undefined" && r.constructor === Symbol
      ? "symbol"
      : typeof r;
  };
  function _unsupportedIterableToArray(r, n) {
    if (r) {
      if (typeof r == "string") return _arrayLikeToArray(r, n);
      var i = Object.prototype.toString.call(r).slice(8, -1);
      if (
        (i === "Object" && r.constructor && (i = r.constructor.name),
        i === "Map" || i === "Set")
      )
        return Array.from(i);
      if (
        i === "Arguments" ||
        /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)
      )
        return _arrayLikeToArray(r, n);
    }
  }
  function _wrapNativeSuper(r) {
    var n = typeof Map == "function" ? new Map() : void 0;
    return (
      (_wrapNativeSuper = function (i) {
        if (i === null || !_isNativeFunction(i)) return i;
        if (typeof i != "function")
          throw new TypeError(
            "Super expression must either be null or a function"
          );
        if (typeof n != "undefined") {
          if (n.has(i)) return n.get(i);
          n.set(i, s);
        }
        function s() {
          return _construct(i, arguments, _getPrototypeOf(this).constructor);
        }
        return (
          (s.prototype = Object.create(i.prototype, {
            constructor: {
              value: s,
              enumerable: !1,
              writable: !0,
              configurable: !0,
            },
          })),
          _setPrototypeOf(s, i)
        );
      }),
      _wrapNativeSuper(r)
    );
  }
  function _isNativeReflectConstruct() {
    if (
      typeof Reflect == "undefined" ||
      !Reflect.construct ||
      Reflect.construct.sham
    )
      return !1;
    if (typeof Proxy == "function") return !0;
    try {
      return (
        Boolean.prototype.valueOf.call(
          Reflect.construct(Boolean, [], function () {})
        ),
        !0
      );
    } catch (r) {
      return !1;
    }
  }
  function _createSuper(r) {
    var n = _isNativeReflectConstruct();
    return function () {
      var i = _getPrototypeOf(r),
        s;
      if (n) {
        var a = _getPrototypeOf(this).constructor;
        s = Reflect.construct(i, arguments, a);
      } else s = i.apply(this, arguments);
      return _possibleConstructorReturn(this, s);
    };
  }
  (function (module, exports) {
    (function (r, n) {
      n(
        exports,
        requireUaParser(),
        requireChito(),
        requireBezier(),
        requireSrc(),
        requireEarcut(),
        requireRegl(),
        require$$6,
        require$$7
      );
    })(
      commonjsGlobal,
      function (
        exports,
        uaParserJs,
        chito,
        bezierJs,
        BezierEasing,
        earcut,
        REGL,
        glMatrix,
        dat
      ) {
        var _interopDefaultLegacy = function (r) {
            return r && typeof r == "object" && "default" in r
              ? r
              : { default: r };
          },
          _interopNamespace = function (r) {
            if (r && r.i) return r;
            var n = Object.create(null);
            return (
              r &&
                Object.keys(r).forEach(function (i) {
                  if (i !== "default") {
                    var s = Object.getOwnPropertyDescriptor(r, i);
                    Object.defineProperty(
                      n,
                      i,
                      s.get
                        ? s
                        : {
                            Fr: !0,
                            get: function () {
                              return r[i];
                            },
                          }
                    );
                  }
                }),
              (n.default = r),
              Object.freeze(n)
            );
          },
          getAugmentedNamespace = function (r) {
            var n = r.default;
            if (typeof n == "function") {
              var i = function () {
                return n.apply(this, arguments);
              };
              i.prototype = n.prototype;
            } else i = {};
            return (
              Object.defineProperty(i, "i", { value: !0 }),
              Object.keys(r).forEach(function (s) {
                var a = Object.getOwnPropertyDescriptor(r, s);
                Object.defineProperty(
                  i,
                  s,
                  a.get
                    ? a
                    : {
                        Fr: !0,
                        get: function () {
                          return r[s];
                        },
                      }
                );
              }),
              i
            );
          },
          defaultCompare = function (r, n) {
            return r < n ? -1 : r > n ? 1 : 0;
          },
          polylabel = function (r, n, i) {
            n = n || 1;
            for (var s, a, o, l, u = 0; u < r[0].length; u++) {
              var f = r[0][u];
              (!u || f[0] < s) && (s = f[0]),
                (!u || f[1] < a) && (a = f[1]),
                (!u || f[0] > o) && (o = f[0]),
                (!u || f[1] > l) && (l = f[1]);
            }
            var c = o - s,
              h = l - a,
              p = Math.min(c, h),
              d = p / 2;
            if (p === 0) {
              var m = [s, a];
              return (m.distance = 0), m;
            }
            for (var g = new Queue(void 0, compareMax), v = s; v < o; v += p)
              for (var y = a; y < l; y += p)
                g.push(new Cell(v + d, y + d, d, r));
            var _ = getCentroidCell(r),
              b = new Cell(s + c / 2, a + h / 2, 0, r);
            b.d > _.d && (_ = b);
            for (var S = g.length; g.length; ) {
              var P = g.pop();
              P.d > _.d &&
                ((_ = P),
                i &&
                  console.log(
                    "found best %d after %d probes",
                    Math.round(1e4 * P.d) / 1e4,
                    S
                  )),
                !(P.max - _.d <= n) &&
                  ((d = P.Eb / 2),
                  g.push(new Cell(P.x - d, P.y - d, d, r)),
                  g.push(new Cell(P.x + d, P.y - d, d, r)),
                  g.push(new Cell(P.x - d, P.y + d, d, r)),
                  g.push(new Cell(P.x + d, P.y + d, d, r)),
                  (S += 4));
            }
            i &&
              (console.log("num probes: " + S),
              console.log("best distance: " + _.d));
            var I = [_.x, _.y];
            return (I.distance = _.d), I;
          },
          compareMax = function (r, n) {
            return n.max - r.max;
          },
          Cell = function (r, n, i, s) {
            (this.x = r),
              (this.y = n),
              (this.Eb = i),
              (this.d = pointToPolygonDist(r, n, s)),
              (this.max = this.d + this.Eb * Math.SQRT2);
          },
          pointToPolygonDist = function (r, n, i) {
            for (var s = !1, a = 1 / 0, o = 0; o < i.length; o++)
              for (
                var l = i[o], u = 0, f = l.length, c = f - 1;
                u < f;
                c = u++
              ) {
                var h = l[u],
                  p = l[c];
                h[1] > n != p[1] > n &&
                  r < ((p[0] - h[0]) * (n - h[1])) / (p[1] - h[1]) + h[0] &&
                  (s = !s),
                  (a = Math.min(a, getSegDistSq(r, n, h, p)));
              }
            return a === 0 ? 0 : (s ? 1 : -1) * Math.sqrt(a);
          },
          getCentroidCell = function (r) {
            for (
              var n = 0, i = 0, s = 0, a = r[0], o = 0, l = a.length, u = l - 1;
              o < l;
              u = o++
            ) {
              var f = a[o],
                c = a[u],
                h = f[0] * c[1] - c[0] * f[1];
              (i += (f[0] + c[0]) * h), (s += (f[1] + c[1]) * h), (n += h * 3);
            }
            return n === 0
              ? new Cell(a[0][0], a[0][1], 0, r)
              : new Cell(i / n, s / n, 0, r);
          },
          getSegDistSq = function (r, n, i, s) {
            var a = i[0],
              o = i[1],
              l = s[0] - a,
              u = s[1] - o;
            if (l !== 0 || u !== 0) {
              var f = ((r - a) * l + (n - o) * u) / (l * l + u * u);
              f > 1
                ? ((a = s[0]), (o = s[1]))
                : f > 0 && ((a += l * f), (o += u * f));
            }
            return (l = r - a), (u = n - o), l * l + u * u;
          },
          encode = function (r, n) {
            (keys$1 = {}),
              (keysArr = []),
              (keysNum = 0),
              (dim$1 = 0),
              (e$1 = 1),
              analyze(r),
              (e$1 = Math.min(e$1, maxPrecision));
            for (
              var i = Math.ceil(Math.log(e$1) / Math.LN10), s = 0;
              s < keysArr.length;
              s++
            )
              n.nP(1, keysArr[s]);
            return (
              dim$1 !== 2 && n.tP(2, dim$1),
              i !== 6 && n.tP(3, i),
              r.type === "FeatureCollection"
                ? n.Az(4, writeFeatureCollection, r)
                : r.type === "Feature"
                ? n.Az(5, writeFeature, r)
                : n.Az(6, writeGeometry, r),
              (keys$1 = null),
              n.finish()
            );
          },
          analyzeMultiLine = function (r) {
            for (var n = 0; n < r.length; n++) analyzePoints(r[n]);
          },
          analyzePoints = function (r) {
            for (var n = 0; n < r.length; n++) analyzePoint(r[n]);
          },
          analyzePoint = function (r) {
            dim$1 = Math.max(dim$1, r.length);
            for (var n = 0; n < r.length; n++)
              for (
                ;
                Math.round(r[n] * e$1) / e$1 !== r[n] && e$1 < maxPrecision;

              )
                e$1 *= 10;
          },
          saveKey = function (r) {
            keys$1[r] === void 0 && (keysArr.push(r), (keys$1[r] = keysNum++));
          },
          writeFeatureCollection = function (r, n) {
            for (var i = 0; i < r.features.length; i++)
              n.Az(1, writeFeature, r.features[i]);
            writeProps(r, n, !0);
          },
          writeFeature = function (r, n) {
            r.geometry !== null && n.Az(1, writeGeometry, r.geometry),
              r.id !== void 0 &&
                (typeof r.id == "number" && r.id % 1 === 0
                  ? n.iP(12, r.id)
                  : n.nP(11, r.id)),
              r.properties && writeProps(r.properties, n),
              writeProps(r, n, !0);
          },
          writeProps = function (r, n, i) {
            var s = [],
              a = 0;
            for (var o in r)
              (i && isSpecialKey(o, r.type)) ||
                (n.Az(13, writeValue, r[o]), s.push(keys$1[o]), s.push(a++));
            n.Wz(i ? 15 : 14, s);
          },
          writeValue = function (r, n) {
            if (r !== null) {
              var i = typeof r == "undefined" ? "undefined" : _typeof(r);
              i === "string"
                ? n.nP(1, r)
                : i === "boolean"
                ? n.oP(5, r)
                : i === "object"
                ? n.nP(6, JSON.stringify(r))
                : i === "number" &&
                  (r % 1 !== 0
                    ? n.rP(2, r)
                    : r >= 0
                    ? n.tP(3, r)
                    : n.tP(4, -r));
            }
          },
          writePoint = function (r, n) {
            for (var i = [], s = 0; s < dim$1; s++)
              i.push(Math.round(r[s] * e$1));
            n.Nz(3, i);
          },
          writeLine = function (r, n) {
            var i = [];
            populateLine(i, r), n.Nz(3, i);
          },
          writeMultiLine = function (r, n, i) {
            var s = r.length,
              a;
            if (s !== 1) {
              var o = [];
              for (a = 0; a < s; a++) o.push(r[a].length - (i ? 1 : 0));
              n.Wz(2, o);
            }
            var l = [];
            for (a = 0; a < s; a++) populateLine(l, r[a], i);
            n.Nz(3, l);
          },
          writeMultiPolygon = function (r, n) {
            var i = r.length,
              s,
              a;
            if (i !== 1 || r[0].length !== 1) {
              var o = [i];
              for (s = 0; s < i; s++)
                for (o.push(r[s].length), a = 0; a < r[s].length; a++)
                  o.push(r[s][a].length - 1);
              n.Wz(2, o);
            }
            var l = [];
            for (s = 0; s < i; s++)
              for (a = 0; a < r[s].length; a++) populateLine(l, r[s][a], !0);
            n.Nz(3, l);
          },
          populateLine = function (r, n, i) {
            var s,
              a,
              o = n.length - (i ? 1 : 0),
              l = new Array(dim$1);
            for (a = 0; a < dim$1; a++) l[a] = 0;
            for (s = 0; s < o; s++)
              for (a = 0; a < dim$1; a++) {
                var u = Math.round(n[s][a] * e$1) - l[a];
                r.push(u), (l[a] += u);
              }
          },
          isSpecialKey = function (r, n) {
            if (r === "type") return !0;
            if (n === "FeatureCollection") {
              if (r === "features") return !0;
            } else if (n === "Feature") {
              if (r === "id" || r === "properties" || r === "geometry")
                return !0;
            } else if (n === "GeometryCollection") {
              if (r === "geometries") return !0;
            } else if (r === "coordinates") return !0;
            return !1;
          },
          decode = function (r) {
            (dim = 2),
              (e = Math.pow(10, 6)),
              (lengths = null),
              (keys = []),
              (values = []);
            var n = r.ez(readDataField, {});
            return (keys = null), n;
          },
          readDataField = function (r, n, i) {
            r === 1
              ? keys.push(i.JC())
              : r === 2
              ? (dim = i.YC())
              : r === 3
              ? (e = Math.pow(10, i.YC()))
              : r === 4
              ? readFeatureCollection(i, n)
              : r === 5
              ? readFeature(i, n)
              : r === 6 && readGeometry(i, n);
          },
          readFeatureCollection = function (r, n) {
            return (
              (n.type = "FeatureCollection"),
              (n.features = []),
              r.$C(readFeatureCollectionField, n)
            );
          },
          readFeature = function (r, n) {
            n.type = "Feature";
            var i = r.$C(readFeatureField, n);
            return "geometry" in i || (i.geometry = null), i;
          },
          readGeometry = function (r, n) {
            return (n.type = "Point"), r.$C(readGeometryField, n);
          },
          readFeatureCollectionField = function (r, n, i) {
            r === 1
              ? n.features.push(readFeature(i, {}))
              : r === 13
              ? values.push(readValue(i))
              : r === 15 && readProps(i, n);
          },
          readFeatureField = function (r, n, i) {
            r === 1
              ? (n.geometry = readGeometry(i, {}))
              : r === 11
              ? (n.id = i.JC())
              : r === 12
              ? (n.id = i.ZC())
              : r === 13
              ? values.push(readValue(i))
              : r === 14
              ? (n.properties = readProps(i, {}))
              : r === 15 && readProps(i, n);
          },
          readGeometryField = function (r, n, i) {
            r === 1
              ? (n.type = geometryTypes[i.YC()])
              : r === 2
              ? (lengths = i.KC())
              : r === 3
              ? readCoords(n, i, n.type)
              : r === 4
              ? ((n.tz = n.tz || []), n.tz.push(readGeometry(i, {})))
              : r === 13
              ? values.push(readValue(i))
              : r === 15 && readProps(i, n);
          },
          readCoords = function (r, n, i) {
            i === "Point"
              ? (r.coordinates = readPoint(n))
              : i === "MultiPoint" || i === "LineString"
              ? (r.coordinates = readLine(n))
              : i === "MultiLineString"
              ? (r.coordinates = readMultiLine(n))
              : i === "Polygon"
              ? (r.coordinates = readMultiLine(n, !0))
              : i === "MultiPolygon" && (r.coordinates = readMultiPolygon(n));
          },
          readValue = function (r) {
            for (var n = r.YC() + r.Br, i = null; r.Br < n; ) {
              var s = r.YC(),
                a = s >> 3;
              a === 1
                ? (i = r.JC())
                : a === 2
                ? (i = r.iz())
                : a === 3
                ? (i = r.YC())
                : a === 4
                ? (i = -r.YC())
                : a === 5
                ? (i = r.nz())
                : a === 6 && (i = JSON.parse(r.JC()));
            }
            return i;
          },
          readProps = function (r, n) {
            for (var i = r.YC() + r.Br; r.Br < i; )
              n[keys[r.YC()]] = values[r.YC()];
            return (values = []), n;
          },
          readPoint = function (r) {
            for (var n = r.YC() + r.Br, i = []; r.Br < n; ) i.push(r.ZC() / e);
            return i;
          },
          readLinePart = function (r, n, i, s) {
            var a = 0,
              o = [],
              l,
              u,
              f = [];
            for (u = 0; u < dim; u++) f[u] = 0;
            for (; i ? a < i : r.Br < n; ) {
              for (l = [], u = 0; u < dim; u++)
                (f[u] += r.ZC()), (l[u] = f[u] / e);
              o.push(l), a++;
            }
            return s && o.push(o[0]), o;
          },
          readLine = function (r) {
            return readLinePart(r, r.YC() + r.Br);
          },
          readMultiLine = function (r, n) {
            var i = r.YC() + r.Br;
            if (!lengths) return [readLinePart(r, i, null, n)];
            for (var s = [], a = 0; a < lengths.length; a++)
              s.push(readLinePart(r, i, lengths[a], n));
            return (lengths = null), s;
          },
          readMultiPolygon = function (r) {
            var n = r.YC() + r.Br;
            if (!lengths) return [[readLinePart(r, n, null, !0)]];
            for (var i = [], s = 1, a = 0; a < lengths[0]; a++) {
              for (var o = [], l = 0; l < lengths[s]; l++)
                o.push(readLinePart(r, n, lengths[s + 1 + l], !0));
              (s += lengths[s] + 1), i.push(o);
            }
            return (lengths = null), i;
          },
          Pbf = function (r) {
            (this.rz =
              ArrayBuffer.isView && ArrayBuffer.isView(r)
                ? r
                : new Uint8Array(r || 0)),
              (this.Br = 0),
              (this.type = 0),
              (this.length = this.rz.length);
          },
          readVarintRemainder = function (r, n, i) {
            var s = i.rz,
              a,
              o;
            if (
              ((o = s[i.Br++]),
              (a = (o & 112) >> 4),
              o < 128 ||
                ((o = s[i.Br++]), (a |= (o & 127) << 3), o < 128) ||
                ((o = s[i.Br++]), (a |= (o & 127) << 10), o < 128) ||
                ((o = s[i.Br++]), (a |= (o & 127) << 17), o < 128) ||
                ((o = s[i.Br++]), (a |= (o & 127) << 24), o < 128) ||
                ((o = s[i.Br++]), (a |= (o & 1) << 31), o < 128))
            )
              return toNum(r, a, n);
            throw new Error("Expected varint not more than 10 bytes");
          },
          readPackedEnd = function (r) {
            return r.type === Pbf.az ? r.YC() + r.Br : r.Br + 1;
          },
          toNum = function (r, n, i) {
            return i
              ? n * 4294967296 + (r >>> 0)
              : (n >>> 0) * 4294967296 + (r >>> 0);
          },
          writeBigVarint = function (r, n) {
            var i, s;
            if (
              (r >= 0
                ? ((i = r % 4294967296 | 0), (s = (r / 4294967296) | 0))
                : ((i = ~(-r % 4294967296)),
                  (s = ~(-r / 4294967296)),
                  i ^ 4294967295
                    ? (i = (i + 1) | 0)
                    : ((i = 0), (s = (s + 1) | 0))),
              r >= 18446744073709552e3 || r < -18446744073709552e3)
            )
              throw new Error("Given varint doesn't fit into 10 bytes");
            n.hz(10), writeBigVarintLow(i, s, n), writeBigVarintHigh(s, n);
          },
          writeBigVarintLow = function (r, n, i) {
            (i.rz[i.Br++] = (r & 127) | 128),
              (r >>>= 7),
              (i.rz[i.Br++] = (r & 127) | 128),
              (r >>>= 7),
              (i.rz[i.Br++] = (r & 127) | 128),
              (r >>>= 7),
              (i.rz[i.Br++] = (r & 127) | 128),
              (r >>>= 7),
              (i.rz[i.Br] = r & 127);
          },
          writeBigVarintHigh = function (r, n) {
            var i = (r & 7) << 4;
            (n.rz[n.Br++] |= i | ((r >>>= 3) ? 128 : 0)),
              r &&
                ((n.rz[n.Br++] = (r & 127) | ((r >>>= 7) ? 128 : 0)),
                r &&
                  ((n.rz[n.Br++] = (r & 127) | ((r >>>= 7) ? 128 : 0)),
                  r &&
                    ((n.rz[n.Br++] = (r & 127) | ((r >>>= 7) ? 128 : 0)),
                    r &&
                      ((n.rz[n.Br++] = (r & 127) | ((r >>>= 7) ? 128 : 0)),
                      r && (n.rz[n.Br++] = r & 127)))));
          },
          makeRoomForExtraLength = function (r, n, i) {
            var s =
              n <= 16383
                ? 1
                : n <= 2097151
                ? 2
                : n <= 268435455
                ? 3
                : Math.floor(Math.log(n) / (Math.LN2 * 7));
            i.hz(s);
            for (var a = i.Br - 1; a >= r; a--) i.rz[a + s] = i.rz[a];
          },
          writePackedVarint = function (r, n) {
            for (var i = 0; i < r.length; i++) n.lz(r[i]);
          },
          writePackedSVarint = function (r, n) {
            for (var i = 0; i < r.length; i++) n.fz(r[i]);
          },
          writePackedFloat = function (r, n) {
            for (var i = 0; i < r.length; i++) n.cz(r[i]);
          },
          writePackedDouble = function (r, n) {
            for (var i = 0; i < r.length; i++) n.vz(r[i]);
          },
          writePackedBoolean = function (r, n) {
            for (var i = 0; i < r.length; i++) n.dz(r[i]);
          },
          writePackedFixed32 = function (r, n) {
            for (var i = 0; i < r.length; i++) n.pz(r[i]);
          },
          writePackedSFixed32 = function (r, n) {
            for (var i = 0; i < r.length; i++) n.mz(r[i]);
          },
          writePackedFixed64 = function (r, n) {
            for (var i = 0; i < r.length; i++) n.gz(r[i]);
          },
          writePackedSFixed64 = function (r, n) {
            for (var i = 0; i < r.length; i++) n.bz(r[i]);
          },
          readUInt32 = function (r, n) {
            return (
              (r[n] | (r[n + 1] << 8) | (r[n + 2] << 16)) + r[n + 3] * 16777216
            );
          },
          writeInt32 = function (r, n, i) {
            (r[i] = n),
              (r[i + 1] = n >>> 8),
              (r[i + 2] = n >>> 16),
              (r[i + 3] = n >>> 24);
          },
          readInt32 = function (r, n) {
            return (
              (r[n] | (r[n + 1] << 8) | (r[n + 2] << 16)) + (r[n + 3] << 24)
            );
          },
          readUtf8 = function (r, n, i) {
            for (var s = "", a = n; a < i; ) {
              var o = r[a],
                l = null,
                u = o > 239 ? 4 : o > 223 ? 3 : o > 191 ? 2 : 1;
              if (a + u > i) break;
              var f, c, h;
              u === 1
                ? o < 128 && (l = o)
                : u === 2
                ? ((f = r[a + 1]),
                  (f & 192) === 128 &&
                    ((l = ((o & 31) << 6) | (f & 63)), l <= 127 && (l = null)))
                : u === 3
                ? ((f = r[a + 1]),
                  (c = r[a + 2]),
                  (f & 192) === 128 &&
                    (c & 192) === 128 &&
                    ((l = ((o & 15) << 12) | ((f & 63) << 6) | (c & 63)),
                    (l <= 2047 || (l >= 55296 && l <= 57343)) && (l = null)))
                : u === 4 &&
                  ((f = r[a + 1]),
                  (c = r[a + 2]),
                  (h = r[a + 3]),
                  (f & 192) === 128 &&
                    (c & 192) === 128 &&
                    (h & 192) === 128 &&
                    ((l =
                      ((o & 15) << 18) |
                      ((f & 63) << 12) |
                      ((c & 63) << 6) |
                      (h & 63)),
                    (l <= 65535 || l >= 1114112) && (l = null))),
                l === null
                  ? ((l = 65533), (u = 1))
                  : l > 65535 &&
                    ((l -= 65536),
                    (s += String.fromCharCode(((l >>> 10) & 1023) | 55296)),
                    (l = 56320 | (l & 1023))),
                (s += String.fromCharCode(l)),
                (a += u);
            }
            return s;
          },
          readUtf8TextDecoder = function (r, n, i) {
            return utf8TextDecoder.decode(r.subarray(n, i));
          },
          writeUtf8 = function (r, n, i) {
            for (var s = 0, a, o; s < n.length; s++) {
              if (((a = n.charCodeAt(s)), a > 55295 && a < 57344))
                if (o)
                  if (a < 56320) {
                    (r[i++] = 239), (r[i++] = 191), (r[i++] = 189), (o = a);
                    continue;
                  } else
                    (a = ((o - 55296) << 10) | (a - 56320) | 65536), (o = null);
                else {
                  a > 56319 || s + 1 === n.length
                    ? ((r[i++] = 239), (r[i++] = 191), (r[i++] = 189))
                    : (o = a);
                  continue;
                }
              else
                o &&
                  ((r[i++] = 239), (r[i++] = 191), (r[i++] = 189), (o = null));
              a < 128
                ? (r[i++] = a)
                : (a < 2048
                    ? (r[i++] = (a >> 6) | 192)
                    : (a < 65536
                        ? (r[i++] = (a >> 12) | 224)
                        : ((r[i++] = (a >> 18) | 240),
                          (r[i++] = ((a >> 12) & 63) | 128)),
                      (r[i++] = ((a >> 6) & 63) | 128)),
                  (r[i++] = (a & 63) | 128));
            }
            return i;
          },
          feature = function (r, n, i) {
            i === void 0 && (i = {});
            var s = { type: "Feature" };
            return (
              (i.id === 0 || i.id) && (s.id = i.id),
              i.bbox && (s.bbox = i.bbox),
              (s.properties = n || {}),
              (s.geometry = r),
              s
            );
          },
          point$1 = function (r, n, i) {
            if ((i === void 0 && (i = {}), !r))
              throw new Error("coordinates is required");
            if (!Array.isArray(r))
              throw new Error("coordinates must be an Array");
            if (r.length < 2)
              throw new Error("coordinates must be at least 2 numbers long");
            if (!isNumber(r[0]) || !isNumber(r[1]))
              throw new Error("coordinates must contain numbers");
            var s = { type: "Point", coordinates: r };
            return feature(s, n, i);
          },
          multiPoint = function (r, n, i) {
            i === void 0 && (i = {});
            var s = { type: "MultiPoint", coordinates: r };
            return feature(s, n, i);
          },
          isNumber = function (r) {
            return !isNaN(r) && r !== null && !Array.isArray(r);
          },
          getMaximumPolygon = function (r) {
            var n = 0,
              i,
              s = !0,
              a = !1,
              o = void 0;
            try {
              for (
                var l = r[Symbol.iterator](), u;
                !(s = (u = l.next()).done);
                s = !0
              ) {
                var f = u.value,
                  c = GeometryUtil.s$(f);
                c > n && ((n = c), (i = f));
              }
            } catch (h) {
              (a = !0), (o = h);
            } finally {
              try {
                !s && l.return != null && l.return();
              } finally {
                if (a) throw o;
              }
            }
            return i;
          },
          nestParse = function nestParse(nestString) {
            function string2function(x) {
              return (
                x &&
                (Array.isArray(x)
                  ? x.map(function (r) {
                      return string2function(r);
                    })
                  : typeof x == "object"
                  ? Object.keys(x).reduce(function (r, n) {
                      return (r[n] = string2function(x[n])), r;
                    }, {})
                  : typeof x == "string" &&
                    (x.startsWith("(") || x.startsWith("function"))
                  ? eval(x)
                  : x)
              );
            }
            return string2function(JSON.parse(nestString));
          },
          nestStringify = function r(n) {
            function i(s) {
              return (
                s &&
                (Array.isArray(s)
                  ? s.map(function (a) {
                      return i(a);
                    })
                  : typeof s == "object"
                  ? Object.keys(s).reduce(function (a, o) {
                      return (a[o] = i(s[o])), a;
                    }, {})
                  : typeof s == "function"
                  ? s.toString()
                  : s)
              );
            }
            return JSON.stringify(i(n));
          },
          getABC = function r() {
            var n =
                arguments.length > 0 && arguments[0] !== void 0
                  ? arguments[0]
                  : 2,
              i = arguments.length > 1 ? arguments[1] : void 0,
              s = arguments.length > 2 ? arguments[2] : void 0,
              a = arguments.length > 3 ? arguments[3] : void 0,
              o =
                arguments.length > 4 && arguments[4] !== void 0
                  ? arguments[4]
                  : 0.5,
              l = bezierJs.Bezier.getUtils(),
              u = l.projectionratio(o, n),
              f = 1 - u,
              c = {
                x: u * i.x + f * a.x,
                y: u * i.y + f * a.y,
                z: u * i.z + f * a.z,
              },
              h = l.abcratio(o, n),
              p = {
                x: s.x + (s.x - c.x) / h,
                y: s.y + (s.y - c.y) / h,
                z: s.y + (s.z - c.z) / h,
              };
            return { rs: p, ps: s, Ju: c, bs: i, E: a };
          },
          cubicBezier = function r(n, i, s, a, o) {
            typeof a == "undefined" && (a = 0.5);
            var l;
            a === 0 && (l = new bezierJs.Bezier(i, i, s)),
              a === 1 && (l = new bezierJs.Bezier(n, i, i));
            var u = getABC(2, n, i, s, a);
            l = new bezierJs.Bezier(n, u.rs, s);
            var f = 100;
            o && (o <= 3 ? (f = 4) : (f = Math.floor(o) + 1));
            var c = l.getLUT(f);
            return c;
          },
          Linear$1 = function r(n, i, s) {
            var a = (i - n) * s + n;
            return a;
          },
          LinearSplit = function r(n, i) {
            for (
              var s =
                  arguments.length > 2 && arguments[2] !== void 0
                    ? arguments[2]
                    : 1,
                a = [],
                o = 0;
              o <= s - 1;
              o++
            ) {
              var l = n.x,
                u = n.y,
                f = n.z,
                c = i.x,
                h = i.y,
                p = i.z,
                d = o / (s - 1),
                m = {
                  x: +Linear$1(l, c, d),
                  y: +Linear$1(u, h, d),
                  z: +Linear$1(f, p, d),
                  t: d,
                };
              a.push(m);
            }
            return a;
          },
          Linear = function r(n, i, s) {
            return (i - n) * s + n;
          },
          linearGradient = function r(n) {
            var i =
                arguments.length > 1 && arguments[1] !== void 0
                  ? arguments[1]
                  : 0,
              s =
                arguments.length > 2 && arguments[2] !== void 0
                  ? arguments[2]
                  : Linear,
              a = n.length - 1,
              o = a * i,
              l = o >> 0,
              u = s,
              f = function (d, m, g) {
                var v = _slicedToArray(d, 4),
                  y = v[0],
                  _ = v[1],
                  b = v[2],
                  S = v[3],
                  P = _slicedToArray(m, 4),
                  I = P[0],
                  F = P[1],
                  X = P[2],
                  W = P[3],
                  Z = [u(y, I, g), u(_, F, g), u(b, X, g), u(S, W, g)];
                return Z;
              },
              c = n[l],
              h = n[l + 1 > a ? a : l + 1],
              p = o - l;
            return f(c, h, p);
          },
          svgToBlobUrl = function r(n) {
            var i = n.outerHTML,
              s = new Blob([i], { type: "image/svg+xml;charset=utf-8" }),
              a = window.URL || window.webkitURL || window,
              o = a.createObjectURL(s);
            return o;
          },
          concatImages = function r(n, i) {
            var s = n.images,
              a = n.wx,
              o = a === void 0 ? [64, 64] : a,
              l = o[0],
              u = o[1],
              f = s.reduce(function (_) {
                return _ + l;
              }, 0),
              c = document.createElement("canvas");
            (c.width = f), (c.height = u);
            for (
              var h = c.getContext("2d"), p = 0, d = 0, m = [], g = 0;
              g < s.length;
              g++
            ) {
              var v = s[g];
              h.drawImage(v, p, d, l, u);
              var y = { width: l, height: u, xx: v, x: p, y: d };
              (p += l), m.push(y);
            }
            c.toBlob(function (_) {
              var b = document.createElement("img"),
                S = URL.createObjectURL(_);
              (b.onload = function () {
                URL.revokeObjectURL(S), i({ blob: _, xx: b, canvas: c, Mx: m });
              }),
                (b.src = S);
            });
          },
          concatSprites = function r(n, i, s) {
            var a = n.images,
              o = n.wx,
              l = o === void 0 ? [64, 64] : o;
            if (!Array.isArray(a))
              throw new Error(
                "must be called with an array of iconSrcs to concatenate"
              );
            var u = a
                .map(function (c) {
                  try {
                    if (_instanceof(c, SVGSVGElement)) {
                      var h = svgToBlobUrl(c),
                        p = new Image();
                      return (p.crossOrigin = "anonymous"), (p.src = h), p;
                    } else {
                      if (_instanceof(c, Image))
                        return (c.crossOrigin = "anonymous"), c;
                      var d = new Image();
                      return (d.crossOrigin = "anonymous"), (d.src = c), d;
                    }
                  } catch (m) {
                    throw m;
                  }
                })
                .filter(function (c) {
                  return c && _instanceof(c, Image);
                }),
              f = u.map(function (c) {
                return new Promise(function (h, p) {
                  try {
                    (c.onerror = function (d) {
                      h(d);
                    }),
                      (c.onload = function () {
                        h(c);
                      }),
                      c.complete && h(c);
                  } catch (d) {
                    p(d);
                  }
                });
              });
            return Promise.all(f)
              .then(function (c) {
                return c.filter(function (h) {
                  return _instanceof(h, Image);
                });
              })
              .then(function (c) {
                c.length
                  ? concatImages({ images: c, wx: l }, function (h) {
                      i(h);
                    })
                  : i();
              })
              .catch(function (c) {
                s && s(c);
              });
          },
          getIconIndex = function r(n, i, s) {
            var a = -1,
              o = n;
            if (i.has(o)) a = i.get(o);
            else {
              if (((o = n), _instanceof(n, SVGSVGElement))) {
                var l = new XMLSerializer();
                o = l.serializeToString(n);
              } else _instanceof(n, Image) && (o = n.src);
              i.has(o)
                ? (a = i.get(o))
                : (s.push(n), (a = s.length - 1), i.set(o, a));
            }
            return a;
          },
          mergeImages = function r(n, i, s) {
            var a = n.images,
              o = n.wx,
              l = o === void 0 ? [64, 64] : o,
              u = new Map(),
              f = [],
              c = a.map(function (h) {
                var p = getIconIndex(h, u, f);
                return p;
              });
            concatSprites(
              { images: f, wx: l },
              function (h) {
                if (h) {
                  var p = h.Mx,
                    d = c.map(function (m) {
                      return p[m];
                    });
                  h.Mx = d;
                }
                i && i(h);
              },
              function (h) {
                s && s(h);
              }
            );
          },
          toSvg = function r(n, i) {
            return (
              (i = i || {}),
              copyOptions(i),
              Promise.resolve(n)
                .then(function (a) {
                  return cloneNode(a, i.filter, !0);
                })
                .then(embedFonts)
                .then(inlineImages)
                .then(s)
                .then(function (a) {
                  return makeSvgDataUri(
                    a,
                    i.width || util.width(n),
                    i.height || util.height(n)
                  );
                })
            );
            function s(a) {
              return (
                i.hM && (a.style.backgroundColor = i.hM),
                i.width && (a.style.width = i.width + "px"),
                i.height && (a.style.height = i.height + "px"),
                i.style &&
                  Object.keys(i.style).forEach(function (o) {
                    a.style[o] = i.style[o];
                  }),
                a
              );
            }
          },
          toPixelData = function r(n, i) {
            return draw(n, i || {}).then(function (s) {
              return s
                .getContext("2d")
                .getImageData(0, 0, util.width(n), util.height(n)).data;
            });
          },
          toPng = function r(n, i) {
            return draw(n, i || {}).then(function (s) {
              return s.toDataURL();
            });
          },
          toCanvas = function r(n, i) {
            return draw(n, i || {}).then(function (s) {
              return s;
            });
          },
          toJpeg = function r(n, i) {
            return (
              (i = i || {}),
              draw(n, i).then(function (s) {
                return s.toDataURL("image/jpeg", i.dM || 1);
              })
            );
          },
          toBlob = function r(n, i) {
            return draw(n, i || {}).then(util.vM);
          },
          copyOptions = function r(n) {
            typeof n.iM == "undefined"
              ? (domtoimage.sM.options.iM = defaultOptions.iM)
              : (domtoimage.sM.options.iM = n.iM),
              typeof n.rM == "undefined"
                ? (domtoimage.sM.options.rM = defaultOptions.rM)
                : (domtoimage.sM.options.rM = n.rM);
          },
          draw = function r(n, i) {
            return toSvg(n, i)
              .then(util.pM)
              .then(util.delay(100))
              .then(function (a) {
                var o = s(n);
                return o.getContext("2d").drawImage(a, 0, 0), o;
              });
            function s(a) {
              var o = document.createElement("canvas");
              if (
                ((o.width = i.width || util.width(a)),
                (o.height = i.height || util.height(a)),
                i.hM)
              ) {
                var l = o.getContext("2d");
                (l.fillStyle = i.hM), l.fillRect(0, 0, o.width, o.height);
              }
              return o;
            }
          },
          embedFonts = function r(n) {
            return fontFaces.gM().then(function (i) {
              var s = document.createElement("style");
              return (
                n.appendChild(s), s.appendChild(document.createTextNode(i)), n
              );
            });
          },
          inlineImages = function r(n) {
            return images.yM(n).then(function () {
              return n;
            });
          },
          makeSvgDataUri = function r(n, i, s) {
            return Promise.resolve(n)
              .then(function (a) {
                return (
                  a.setAttribute("xmlns", "http://www.w3.org/1999/xhtml"),
                  new XMLSerializer().serializeToString(a)
                );
              })
              .then(util.wM)
              .then(function (a) {
                return (
                  '<foreignObject x="0" y="0" width="100%" height="100%">' +
                  a +
                  "</foreignObject>"
                );
              })
              .then(function (a) {
                return (
                  '<svg xmlns="http://www.w3.org/2000/svg" width="' +
                  i +
                  '" height="' +
                  s +
                  '">' +
                  a +
                  "</svg>"
                );
              })
              .then(function (a) {
                return "data:image/svg+xml;charset=utf-8," + a;
              });
          },
          newUtil = function r() {
            return {
              escape: d,
              xM: i,
              mimeType: s,
              MM: p,
              kM: a,
              vM: l,
              CM: u,
              AM: h,
              bM: f(),
              delay: m,
              mM: g,
              wM: v,
              pM: c,
              width: y,
              height: _,
            };
            function n() {
              var S = "application/font-woff",
                P = "image/jpeg";
              return {
                woff: S,
                woff2: S,
                ttf: "application/font-truetype",
                eot: "application/vnd.ms-fontobject",
                png: "image/png",
                jpg: P,
                jpeg: P,
                gif: "image/gif",
                tiff: "image/tiff",
                svg: "image/svg+xml",
              };
            }
            function i(S) {
              var P = /\.([^\.\/]*?)$/g.exec(S);
              return P ? P[1] : "";
            }
            function s(S) {
              var P = i(S).toLowerCase();
              return n()[P] || "";
            }
            function a(S) {
              return S.search(/^(data:)/) !== -1;
            }
            function o(S) {
              return new Promise(function (P) {
                for (
                  var I = window.atob(S.toDataURL().split(",")[1]),
                    F = I.length,
                    X = new Uint8Array(F),
                    W = 0;
                  W < F;
                  W++
                )
                  X[W] = I.charCodeAt(W);
                P(new Blob([X], { type: "image/png" }));
              });
            }
            function l(S) {
              return S.toBlob
                ? new Promise(function (P) {
                    S.toBlob(P);
                  })
                : o(S);
            }
            function u(S, P) {
              var I = document.implementation.createHTMLDocument(),
                F = I.createElement("base");
              I.head.appendChild(F);
              var X = I.createElement("a");
              return I.body.appendChild(X), (F.href = P), (X.href = S), X.href;
            }
            function f() {
              var S = 0;
              return function () {
                return "u" + P() + S++;
                function P() {
                  return (
                    "0000" +
                    ((Math.random() * Math.pow(36, 4)) << 0).toString(36)
                  ).slice(-4);
                }
              };
            }
            function c(S) {
              return new Promise(function (P, I) {
                var F = new Image();
                (F.onload = function () {
                  P(F);
                }),
                  (F.onerror = I),
                  (F.src = S);
              });
            }
            function h(S) {
              var P = 3e4;
              return (
                domtoimage.sM.options.rM &&
                  (S += (/\?/.test(S) ? "&" : "?") + new Date().getTime()),
                new Promise(function (I) {
                  var F = new XMLHttpRequest();
                  (F.onreadystatechange = Z),
                    (F.ontimeout = j),
                    (F.responseType = "blob"),
                    (F.timeout = P),
                    F.open("GET", S, !0),
                    F.send();
                  var X;
                  if (domtoimage.sM.options.iM) {
                    var W = domtoimage.sM.options.iM.split(/,/);
                    W && W[1] && (X = W[1]);
                  }
                  function Z() {
                    if (F.readyState === 4) {
                      if (F.status !== 200) {
                        X
                          ? I(X)
                          : L(
                              "cannot fetch resource: " +
                                S +
                                ", status: " +
                                F.status
                            );
                        return;
                      }
                      var T = new FileReader();
                      (T.onloadend = function () {
                        var A = T.result.split(/,/)[1];
                        I(A);
                      }),
                        T.readAsDataURL(F.response);
                    }
                  }
                  function j() {
                    X
                      ? I(X)
                      : L(
                          "timeout of " +
                            P +
                            "ms occured while fetching resource: " +
                            S
                        );
                  }
                  function L(T) {
                    console.error(T), I("");
                  }
                })
              );
            }
            function p(S, P) {
              return "data:" + P + ";base64," + S;
            }
            function d(S) {
              return S.replace(/([.*+?^${}()|\[\]\/\\])/g, "\\$1");
            }
            function m(S) {
              return function (P) {
                return new Promise(function (I) {
                  setTimeout(function () {
                    I(P);
                  }, S);
                });
              };
            }
            function g(S) {
              for (var P = [], I = S.length, F = 0; F < I; F++) P.push(S[F]);
              return P;
            }
            function v(S) {
              return S.replace(/#/g, "%23").replace(/\n/g, "%0A");
            }
            function y(S) {
              var P = b(S, "border-left-width"),
                I = b(S, "border-right-width");
              return S.scrollWidth + P + I;
            }
            function _(S) {
              var P = b(S, "border-top-width"),
                I = b(S, "border-bottom-width");
              return S.scrollHeight + P + I;
            }
            function b(S, P) {
              var I = window.getComputedStyle(S).getPropertyValue(P);
              return parseFloat(I.replace("px", ""));
            }
          },
          newInliner = function r() {
            var n = /url\(['"]?([^'"]+?)['"]?\)/g;
            return { yM: o, OM: i, sM: { zM: s, _M: a } };
            function i(l) {
              return l.search(n) !== -1;
            }
            function s(l) {
              for (var u = [], f; (f = n.exec(l)) !== null; ) u.push(f[1]);
              return u.filter(function (c) {
                return !util.kM(c);
              });
            }
            function a(l, u, f, c) {
              return Promise.resolve(u)
                .then(function (p) {
                  return f ? util.CM(p, f) : p;
                })
                .then(c || util.AM)
                .then(function (p) {
                  return util.MM(p, util.mimeType(u));
                })
                .then(function (p) {
                  return l.replace(h(u), "$1" + p + "$3");
                });
              function h(p) {
                return new RegExp(
                  "(url\\(['\"]?)(" + util.escape(p) + ")(['\"]?\\))",
                  "g"
                );
              }
            }
            function o(l, u, f) {
              if (c()) return Promise.resolve(l);
              return Promise.resolve(l)
                .then(s)
                .then(function (h) {
                  var p = Promise.resolve(l);
                  return (
                    h.forEach(function (d) {
                      p = p.then(function (m) {
                        return a(m, d, u, f);
                      });
                    }),
                    p
                  );
                });
              function c() {
                return !i(l);
              }
            }
          },
          newFontFaces = function r() {
            return { gM: n, sM: { SM: i } };
            function n() {
              return i()
                .then(function (s) {
                  return Promise.all(
                    s.map(function (a) {
                      return a.resolve();
                    })
                  );
                })
                .then(function (s) {
                  return s.join("\n");
                });
            }
            function i() {
              return Promise.resolve(util.mM(document.styleSheets))
                .then(a)
                .then(s)
                .then(function (l) {
                  return l.map(o);
                });
              function s(l) {
                return l
                  .filter(function (u) {
                    return u.type === CSSRule.FONT_FACE_RULE;
                  })
                  .filter(function (u) {
                    return inliner.OM(u.style.getPropertyValue("src"));
                  });
              }
              function a(l) {
                var u = [];
                return (
                  l.forEach(function (f) {
                    try {
                      util.mM(f.cssRules || []).forEach(u.push.bind(u));
                    } catch (c) {
                      console.log(
                        "Error while reading CSS rules from " + f.href,
                        c.toString()
                      );
                    }
                  }),
                  u
                );
              }
              function o(l) {
                return {
                  resolve: function () {
                    var u = (l.parentStyleSheet || {}).href;
                    return inliner.yM(l.cssText, u);
                  },
                  src: function () {
                    return l.style.getPropertyValue("src");
                  },
                };
              }
            }
          },
          newImages = function r() {
            return { yM: i, sM: { IM: n } };
            function n(s) {
              return { _M: a };
              function a(o) {
                return util.kM(s.src)
                  ? Promise.resolve()
                  : Promise.resolve(s.src)
                      .then(o || util.AM)
                      .then(function (l) {
                        return util.MM(l, util.mimeType(s.src));
                      })
                      .then(function (l) {
                        return new Promise(function (u, f) {
                          (s.onload = u), (s.onerror = f), (s.src = l);
                        });
                      });
              }
            }
            function i(s) {
              if (!_instanceof(s, Element)) return Promise.resolve(s);
              return a(s).then(function () {
                return _instanceof(s, HTMLImageElement)
                  ? n(s)._M()
                  : Promise.all(
                      util.mM(s.childNodes).map(function (o) {
                        return i(o);
                      })
                    );
              });
              function a(o) {
                var l = o.style.getPropertyValue("background");
                return l
                  ? inliner
                      .yM(l)
                      .then(function (u) {
                        o.style.setProperty(
                          "background",
                          u,
                          o.style.getPropertyPriority("background")
                        );
                      })
                      .then(function () {
                        return o;
                      })
                  : Promise.resolve(o);
              }
            }
          },
          _arrayBuffer2TypedArray = function r(n, i, s, a) {
            switch (a) {
              case 5122:
                return new Int16Array(n, i, s);
              case 5123:
                return new Uint16Array(n, i, s);
              case 5124:
                return new Int32Array(n, i, s);
              case 5125:
                return new Uint32Array(n, i, s);
              case 5126:
                return new Float32Array(n, i, s);
              default:
                return null;
            }
          },
          _getAccessorData = function r(n) {
            return _arrayBuffer2TypedArray(
              n.bufferView.data,
              n.byteOffset,
              n.count * Type2NumOfComponent[n.type],
              n.componentType
            );
          },
          _getBaseUri = function r(n) {
            var i = "",
              s = n.lastIndexOf("/");
            return s !== -1 && (i = n.substring(0, s + 1)), i;
          },
          _loadGlb = function r(n, i) {
            var s = new XMLHttpRequest();
            s.overrideMimeType("model/gltf-binary"),
              (s.responseType = "arraybuffer"),
              s.open("GET", n, !0),
              (s.onload = function () {
                var a = s.response;
                if (a) {
                  var o = new GLTFBinaryExtension(a);
                  if (o.content) {
                    JSON.parse(o.content), i(o, this);
                    debugger;
                  }
                }
              }),
              s.send(null);
          },
          _loadJSON = function r(n, i) {
            var s = new XMLHttpRequest();
            s.overrideMimeType("application/json"),
              s.open("GET", n, !0),
              (s.onreadystatechange = function () {
                s.readyState == 4 &&
                  s.status === 200 &&
                  i(s.responseText, this);
              }),
              s.send(null);
          },
          _loadArrayBuffer = function r(n, i, s) {
            return __async$1(
              this,
              null,
              regeneratorRuntime$1.mark(function a() {
                var o, l;
                return regeneratorRuntime$1.wrap(function (u) {
                  for (;;)
                    switch ((u.prev = u.next)) {
                      case 0:
                        return (u.next = 2), fetch(n);
                      case 2:
                        return (o = u.sent), (u.next = 5), o.arrayBuffer();
                      case 5:
                        (l = u.sent), i(l, s);
                      case 7:
                      case "end":
                        return u.stop();
                    }
                }, a);
              })
            );
          },
          isPowOf2 = function r(n) {
            for (var i = 2; i !== n && i < n; ) i *= 2;
            return i == n;
          },
          getFitPow = function r(n) {
            for (var i = 2; i < n; ) i *= 2;
            return i / n > 1.5 ? i : i / 2;
          },
          _loadImage = function r(n, i, s) {
            var a = new Image();
            (a.crossOrigin = "Anonymous"),
              (a.src = n),
              (a.onload = function (o) {
                var l = o.target,
                  u = l.width,
                  f = l.height;
                if (isPowOf2(u) && isPowOf2(f)) {
                  s(l, i);
                  return;
                }
                var c = getFitPow(u),
                  h = getFitPow(f);
                (canvas.width = c),
                  (canvas.height = h),
                  context.drawImage(l, 0, 0, c, h),
                  s(context.getImageData(0, 0, c, h), i);
              });
          },
          formatArray = function r(n, i, s) {
            var a = {
                5120: Int8Array,
                5121: Uint8Array,
                5122: Int16Array,
                5123: Uint16Array,
                5125: Uint32Array,
                5126: Float32Array,
              },
              o = {
                5120: "int8",
                5121: "uint8",
                5122: "int16",
                5123: "uint16",
                5125: "uint32",
                5126: "float32",
              },
              l = n.bufferView.data,
              u = a[n.componentType],
              f;
            f = new u(l);
            var c = o[n.componentType];
            return (
              s === "buffer"
                ? (f = i.buffer(f))
                : (f = i.elements({
                    primitive: "triangles",
                    type: c,
                    data: f,
                  })),
              {
                array: f,
                type: c,
                offset: n.byteOffset || 0,
                stride: n.byteStride || 0,
                HAS: 1,
              }
            );
          },
          BezierEasing__namespace = _interopNamespace(BezierEasing),
          earcut__default = _interopDefaultLegacy(earcut),
          REGL__default = _interopDefaultLegacy(REGL),
          dat__namespace = _interopNamespace(dat),
          polylabel$1 = { exports: {} },
          TinyQueue = (function () {
            function r() {
              var i =
                  arguments.length > 0 && arguments[0] !== void 0
                    ? arguments[0]
                    : [],
                s =
                  arguments.length > 1 && arguments[1] !== void 0
                    ? arguments[1]
                    : defaultCompare;
              if (
                (_classCallCheck(this, r),
                (this.data = i),
                (this.length = this.data.length),
                (this.t$ = s),
                this.length > 0)
              )
                for (var a = (this.length >> 1) - 1; a >= 0; a--) this.e$(a);
            }
            var n = r.prototype;
            return (
              (n.push = function (i) {
                this.data.push(i), this.length++, this.i$(this.length - 1);
              }),
              (n.pop = function () {
                if (this.length !== 0) {
                  var i = this.data[0],
                    s = this.data.pop();
                  return (
                    this.length--,
                    this.length > 0 && ((this.data[0] = s), this.e$(0)),
                    i
                  );
                }
              }),
              (n.n$ = function () {
                return this.data[0];
              }),
              (n.i$ = function (i) {
                for (var s = this, a = s.data, o = s.t$, l = a[i]; i > 0; ) {
                  var u = (i - 1) >> 1,
                    f = a[u];
                  if (o(l, f) >= 0) break;
                  (a[i] = f), (i = u);
                }
                a[i] = l;
              }),
              (n.e$ = function (i) {
                for (
                  var s = this,
                    a = s.data,
                    o = s.t$,
                    l = this.length >> 1,
                    u = a[i];
                  i < l;

                ) {
                  var f = (i << 1) + 1,
                    c = a[f],
                    h = f + 1;
                  if (
                    (h < this.length && o(a[h], c) < 0 && ((f = h), (c = a[h])),
                    o(c, u) >= 0)
                  )
                    break;
                  (a[i] = c), (i = f);
                }
                a[i] = u;
              }),
              r
            );
          })(),
          tinyqueue = Object.freeze({ __proto__: null, default: TinyQueue }),
          require$$0 = getAugmentedNamespace(tinyqueue),
          Queue = require$$0;
        Queue.default && (Queue = Queue.default),
          (polylabel$1.exports = polylabel),
          (polylabel$1.exports.default = polylabel);
        function coordEach(r, n, i) {
          if (r !== null)
            for (
              var s,
                a,
                o,
                l,
                u,
                f,
                c,
                h = 0,
                p = 0,
                d,
                m = r.type,
                g = m === "FeatureCollection",
                v = m === "Feature",
                y = g ? r.features.length : 1,
                _ = 0;
              _ < y;
              _++
            ) {
              (c = g ? r.features[_].geometry : v ? r.geometry : r),
                (d = c ? c.type === "GeometryCollection" : !1),
                (u = d ? c.tz.length : 1);
              for (var b = 0; b < u; b++) {
                var S = 0,
                  P = 0;
                if (((l = d ? c.tz[b] : c), l !== null)) {
                  f = l.coordinates;
                  var I = l.type;
                  switch (
                    ((h =
                      i && (I === "Polygon" || I === "MultiPolygon") ? 1 : 0),
                    I)
                  ) {
                    case null:
                      break;
                    case "Point":
                      if (n(f, p, _, S, P) === !1) return !1;
                      p++, S++;
                      break;
                    case "LineString":
                    case "MultiPoint":
                      for (s = 0; s < f.length; s++) {
                        if (n(f[s], p, _, S, P) === !1) return !1;
                        p++, I === "MultiPoint" && S++;
                      }
                      I === "LineString" && S++;
                      break;
                    case "Polygon":
                    case "MultiLineString":
                      for (s = 0; s < f.length; s++) {
                        for (a = 0; a < f[s].length - h; a++) {
                          if (n(f[s][a], p, _, S, P) === !1) return !1;
                          p++;
                        }
                        I === "MultiLineString" && S++, I === "Polygon" && P++;
                      }
                      I === "Polygon" && S++;
                      break;
                    case "MultiPolygon":
                      for (s = 0; s < f.length; s++) {
                        for (P = 0, a = 0; a < f[s].length; a++) {
                          for (o = 0; o < f[s][a].length - h; o++) {
                            if (n(f[s][a][o], p, _, S, P) === !1) return !1;
                            p++;
                          }
                          P++;
                        }
                        S++;
                      }
                      break;
                    case "GeometryCollection":
                      for (s = 0; s < l.tz.length; s++)
                        if (coordEach(l.tz[s], n, i) === !1) return !1;
                      break;
                    default:
                      throw new Error("Unknown Geometry Type");
                  }
                }
              }
            }
        }
        var geobuf = {},
          encode_1 = encode,
          keys$1,
          keysNum,
          keysArr,
          dim$1,
          e$1,
          maxPrecision = 1e6,
          geometryTypes$1 = {
            Point: 0,
            MultiPoint: 1,
            LineString: 2,
            MultiLineString: 3,
            Polygon: 4,
            MultiPolygon: 5,
            GeometryCollection: 6,
          };
        function analyze(r) {
          var n, i;
          if (r.type === "FeatureCollection")
            for (n = 0; n < r.features.length; n++) analyze(r.features[n]);
          else if (r.type === "Feature") {
            r.geometry !== null && analyze(r.geometry);
            for (i in r.properties) saveKey(i);
          } else if (r.type === "Point") analyzePoint(r.coordinates);
          else if (r.type === "MultiPoint") analyzePoints(r.coordinates);
          else if (r.type === "GeometryCollection")
            for (n = 0; n < r.tz.length; n++) analyze(r.tz[n]);
          else if (r.type === "LineString") analyzePoints(r.coordinates);
          else if (r.type === "Polygon" || r.type === "MultiLineString")
            analyzeMultiLine(r.coordinates);
          else if (r.type === "MultiPolygon")
            for (n = 0; n < r.coordinates.length; n++)
              analyzeMultiLine(r.coordinates[n]);
          for (i in r) isSpecialKey(i, r.type) || saveKey(i);
        }
        function writeGeometry(r, n) {
          n.tP(1, geometryTypes$1[r.type]);
          var i = r.coordinates;
          if (r.type === "Point") writePoint(i, n);
          else if (r.type === "MultiPoint") writeLine(i, n);
          else if (r.type === "LineString") writeLine(i, n);
          else if (r.type === "MultiLineString") writeMultiLine(i, n);
          else if (r.type === "Polygon") writeMultiLine(i, n, !0);
          else if (r.type === "MultiPolygon") writeMultiPolygon(i, n);
          else if (r.type === "GeometryCollection")
            for (var s = 0; s < r.tz.length; s++)
              n.Az(4, writeGeometry, r.tz[s]);
          writeProps(r, n, !0);
        }
        var decode_1 = decode,
          keys,
          values,
          lengths,
          dim,
          e,
          geometryTypes = [
            "Point",
            "MultiPoint",
            "LineString",
            "MultiLineString",
            "Polygon",
            "MultiPolygon",
            "GeometryCollection",
          ];
        (geobuf.encode = encode_1), (geobuf.decode = decode_1);
        var ieee754$1 = {};
        (ieee754$1.read = function (r, n, i, s, a) {
          var o,
            l,
            u = a * 8 - s - 1,
            f = (1 << u) - 1,
            c = f >> 1,
            h = -7,
            p = i ? a - 1 : 0,
            d = i ? -1 : 1,
            m = r[n + p];
          for (
            p += d, o = m & ((1 << -h) - 1), m >>= -h, h += u;
            h > 0;
            o = o * 256 + r[n + p], p += d, h -= 8
          );
          for (
            l = o & ((1 << -h) - 1), o >>= -h, h += s;
            h > 0;
            l = l * 256 + r[n + p], p += d, h -= 8
          );
          if (o === 0) o = 1 - c;
          else {
            if (o === f) return l ? NaN : (m ? -1 : 1) * (1 / 0);
            (l = l + Math.pow(2, s)), (o = o - c);
          }
          return (m ? -1 : 1) * l * Math.pow(2, o - s);
        }),
          (ieee754$1.write = function (r, n, i, s, a, o) {
            var l,
              u,
              f,
              c = o * 8 - a - 1,
              h = (1 << c) - 1,
              p = h >> 1,
              d = a === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0,
              m = s ? 0 : o - 1,
              g = s ? 1 : -1,
              v = n < 0 || (n === 0 && 1 / n < 0) ? 1 : 0;
            for (
              n = Math.abs(n),
                isNaN(n) || n === 1 / 0
                  ? ((u = isNaN(n) ? 1 : 0), (l = h))
                  : ((l = Math.floor(Math.log(n) / Math.LN2)),
                    n * (f = Math.pow(2, -l)) < 1 && (l--, (f *= 2)),
                    l + p >= 1 ? (n += d / f) : (n += d * Math.pow(2, 1 - p)),
                    n * f >= 2 && (l++, (f /= 2)),
                    l + p >= h
                      ? ((u = 0), (l = h))
                      : l + p >= 1
                      ? ((u = (n * f - 1) * Math.pow(2, a)), (l = l + p))
                      : ((u = n * Math.pow(2, p - 1) * Math.pow(2, a)),
                        (l = 0)));
              a >= 8;
              r[i + m] = u & 255, m += g, u /= 256, a -= 8
            );
            for (
              l = (l << a) | u, c += a;
              c > 0;
              r[i + m] = l & 255, m += g, l /= 256, c -= 8
            );
            r[i + m - g] |= v * 128;
          });
        var pbf = Pbf,
          ieee754 = ieee754$1;
        (Pbf.oz = 0), (Pbf.sz = 1), (Pbf.az = 2), (Pbf.uz = 5);
        var SHIFT_LEFT_32 = (1 << 16) * (1 << 16),
          SHIFT_RIGHT_32 = 1 / SHIFT_LEFT_32,
          TEXT_DECODER_MIN_LENGTH = 12,
          utf8TextDecoder =
            typeof TextDecoder == "undefined" ? null : new TextDecoder("utf8");
        Pbf.prototype = {
          destroy: function r() {
            this.rz = null;
          },
          ez: function r(n, i, s) {
            for (s = s || this.length; this.Br < s; ) {
              var a = this.YC(),
                o = a >> 3,
                l = this.Br;
              (this.type = a & 7), n(o, i, this), this.Br === l && this.yz(a);
            }
            return i;
          },
          $C: function r(n, i) {
            return this.ez(n, i, this.YC() + this.Br);
          },
          xz: function r() {
            var n = readUInt32(this.rz, this.Br);
            return (this.Br += 4), n;
          },
          wz: function r() {
            var n = readInt32(this.rz, this.Br);
            return (this.Br += 4), n;
          },
          Cz: function r() {
            var n =
              readUInt32(this.rz, this.Br) +
              readUInt32(this.rz, this.Br + 4) * SHIFT_LEFT_32;
            return (this.Br += 8), n;
          },
          kz: function r() {
            var n =
              readUInt32(this.rz, this.Br) +
              readInt32(this.rz, this.Br + 4) * SHIFT_LEFT_32;
            return (this.Br += 8), n;
          },
          hl: function r() {
            var n = ieee754.read(this.rz, this.Br, !0, 23, 4);
            return (this.Br += 4), n;
          },
          iz: function r() {
            var n = ieee754.read(this.rz, this.Br, !0, 52, 8);
            return (this.Br += 8), n;
          },
          YC: function r(n) {
            var i = this.rz,
              s,
              a;
            return (
              (a = i[this.Br++]),
              (s = a & 127),
              a < 128 ||
              ((a = i[this.Br++]), (s |= (a & 127) << 7), a < 128) ||
              ((a = i[this.Br++]), (s |= (a & 127) << 14), a < 128) ||
              ((a = i[this.Br++]), (s |= (a & 127) << 21), a < 128)
                ? s
                : ((a = i[this.Br]),
                  (s |= (a & 15) << 28),
                  readVarintRemainder(s, n, this))
            );
          },
          zz: function r() {
            return this.YC(!0);
          },
          ZC: function r() {
            var n = this.YC();
            return n % 2 === 1 ? (n + 1) / -2 : n / 2;
          },
          nz: function r() {
            return Boolean(this.YC());
          },
          JC: function r() {
            var n = this.YC() + this.Br,
              i = this.Br;
            return (
              (this.Br = n),
              n - i >= TEXT_DECODER_MIN_LENGTH && utf8TextDecoder
                ? readUtf8TextDecoder(this.rz, i, n)
                : readUtf8(this.rz, i, n)
            );
          },
          Pz: function r() {
            var n = this.YC() + this.Br,
              i = this.rz.subarray(this.Br, n);
            return (this.Br = n), i;
          },
          KC: function r(n, i) {
            if (this.type !== Pbf.az) return n.push(this.YC(i));
            var s = readPackedEnd(this);
            for (n = n || []; this.Br < s; ) n.push(this.YC(i));
            return n;
          },
          Sz: function r(n) {
            if (this.type !== Pbf.az) return n.push(this.ZC());
            var i = readPackedEnd(this);
            for (n = n || []; this.Br < i; ) n.push(this.ZC());
            return n;
          },
          Mz: function r(n) {
            if (this.type !== Pbf.az) return n.push(this.nz());
            var i = readPackedEnd(this);
            for (n = n || []; this.Br < i; ) n.push(this.nz());
            return n;
          },
          _z: function r(n) {
            if (this.type !== Pbf.az) return n.push(this.hl());
            var i = readPackedEnd(this);
            for (n = n || []; this.Br < i; ) n.push(this.hl());
            return n;
          },
          Iz: function r(n) {
            if (this.type !== Pbf.az) return n.push(this.iz());
            var i = readPackedEnd(this);
            for (n = n || []; this.Br < i; ) n.push(this.iz());
            return n;
          },
          Vz: function r(n) {
            if (this.type !== Pbf.az) return n.push(this.xz());
            var i = readPackedEnd(this);
            for (n = n || []; this.Br < i; ) n.push(this.xz());
            return n;
          },
          Dz: function r(n) {
            if (this.type !== Pbf.az) return n.push(this.wz());
            var i = readPackedEnd(this);
            for (n = n || []; this.Br < i; ) n.push(this.wz());
            return n;
          },
          Lz: function r(n) {
            if (this.type !== Pbf.az) return n.push(this.Cz());
            var i = readPackedEnd(this);
            for (n = n || []; this.Br < i; ) n.push(this.Cz());
            return n;
          },
          Fz: function r(n) {
            if (this.type !== Pbf.az) return n.push(this.kz());
            var i = readPackedEnd(this);
            for (n = n || []; this.Br < i; ) n.push(this.kz());
            return n;
          },
          yz: function r(n) {
            var i = n & 7;
            if (i === Pbf.oz) for (; this.rz[this.Br++] > 127; );
            else if (i === Pbf.az) this.Br = this.YC() + this.Br;
            else if (i === Pbf.uz) this.Br += 4;
            else if (i === Pbf.sz) this.Br += 8;
            else throw new Error("Unimplemented type: " + i);
          },
          Rz: function r(n, i) {
            this.lz((n << 3) | i);
          },
          hz: function r(n) {
            for (var i = this.length || 16; i < this.Br + n; ) i *= 2;
            if (i !== this.length) {
              var s = new Uint8Array(i);
              s.set(this.rz), (this.rz = s), (this.length = i);
            }
          },
          finish: function r() {
            return (
              (this.length = this.Br),
              (this.Br = 0),
              this.rz.subarray(0, this.length)
            );
          },
          pz: function r(n) {
            this.hz(4), writeInt32(this.rz, n, this.Br), (this.Br += 4);
          },
          mz: function r(n) {
            this.hz(4), writeInt32(this.rz, n, this.Br), (this.Br += 4);
          },
          gz: function r(n) {
            this.hz(8),
              writeInt32(this.rz, n & -1, this.Br),
              writeInt32(this.rz, Math.floor(n * SHIFT_RIGHT_32), this.Br + 4),
              (this.Br += 8);
          },
          bz: function r(n) {
            this.hz(8),
              writeInt32(this.rz, n & -1, this.Br),
              writeInt32(this.rz, Math.floor(n * SHIFT_RIGHT_32), this.Br + 4),
              (this.Br += 8);
          },
          lz: function r(n) {
            if (((n = +n || 0), n > 268435455 || n < 0)) {
              writeBigVarint(n, this);
              return;
            }
            this.hz(4),
              (this.rz[this.Br++] = (n & 127) | (n > 127 ? 128 : 0)),
              !(n <= 127) &&
                ((this.rz[this.Br++] =
                  ((n >>>= 7) & 127) | (n > 127 ? 128 : 0)),
                !(n <= 127) &&
                  ((this.rz[this.Br++] =
                    ((n >>>= 7) & 127) | (n > 127 ? 128 : 0)),
                  !(n <= 127) && (this.rz[this.Br++] = (n >>> 7) & 127)));
          },
          fz: function r(n) {
            this.lz(n < 0 ? -n * 2 - 1 : n * 2);
          },
          dz: function r(n) {
            this.lz(Boolean(n));
          },
          Tz: function r(n) {
            (n = String(n)), this.hz(n.length * 4), this.Br++;
            var i = this.Br;
            this.Br = writeUtf8(this.rz, n, this.Br);
            var s = this.Br - i;
            s >= 128 && makeRoomForExtraLength(i, s, this),
              (this.Br = i - 1),
              this.lz(s),
              (this.Br += s);
          },
          cz: function r(n) {
            this.hz(4),
              ieee754.write(this.rz, n, this.Br, !0, 23, 4),
              (this.Br += 4);
          },
          vz: function r(n) {
            this.hz(8),
              ieee754.write(this.rz, n, this.Br, !0, 52, 8),
              (this.Br += 8);
          },
          Oz: function r(n) {
            var i = n.length;
            this.lz(i), this.hz(i);
            for (var s = 0; s < i; s++) this.rz[this.Br++] = n[s];
          },
          Bz: function r(n, i) {
            this.Br++;
            var s = this.Br;
            n(i, this);
            var a = this.Br - s;
            a >= 128 && makeRoomForExtraLength(s, a, this),
              (this.Br = s - 1),
              this.lz(a),
              (this.Br += a);
          },
          Az: function r(n, i, s) {
            this.Rz(n, Pbf.az), this.Bz(i, s);
          },
          Wz: function r(n, i) {
            i.length && this.Az(n, writePackedVarint, i);
          },
          Nz: function r(n, i) {
            i.length && this.Az(n, writePackedSVarint, i);
          },
          Ez: function r(n, i) {
            i.length && this.Az(n, writePackedBoolean, i);
          },
          jz: function r(n, i) {
            i.length && this.Az(n, writePackedFloat, i);
          },
          Uz: function r(n, i) {
            i.length && this.Az(n, writePackedDouble, i);
          },
          Gz: function r(n, i) {
            i.length && this.Az(n, writePackedFixed32, i);
          },
          qz: function r(n, i) {
            i.length && this.Az(n, writePackedSFixed32, i);
          },
          Qz: function r(n, i) {
            i.length && this.Az(n, writePackedFixed64, i);
          },
          Xz: function r(n, i) {
            i.length && this.Az(n, writePackedSFixed64, i);
          },
          Jz: function r(n, i) {
            this.Rz(n, Pbf.az), this.Oz(i);
          },
          Yz: function r(n, i) {
            this.Rz(n, Pbf.uz), this.pz(i);
          },
          $z: function r(n, i) {
            this.Rz(n, Pbf.uz), this.mz(i);
          },
          Zz: function r(n, i) {
            this.Rz(n, Pbf.sz), this.gz(i);
          },
          Kz: function r(n, i) {
            this.Rz(n, Pbf.sz), this.bz(i);
          },
          tP: function r(n, i) {
            this.Rz(n, Pbf.oz), this.lz(i);
          },
          iP: function r(n, i) {
            this.Rz(n, Pbf.oz), this.fz(i);
          },
          nP: function r(n, i) {
            this.Rz(n, Pbf.az), this.Tz(i);
          },
          eP: function r(n, i) {
            this.Rz(n, Pbf.uz), this.cz(i);
          },
          rP: function r(n, i) {
            this.Rz(n, Pbf.sz), this.vz(i);
          },
          oP: function r(n, i) {
            this.tP(n, Boolean(i));
          },
        };
        var __defProp$3$1 = Object.defineProperty,
          __defProps$2$1 = Object.defineProperties,
          __getOwnPropDescs$2$1 = Object.getOwnPropertyDescriptors,
          __getOwnPropSymbols$3$1 = Object.getOwnPropertySymbols,
          __hasOwnProp$3$1 = Object.prototype.hasOwnProperty,
          __propIsEnum$3$1 = Object.prototype.propertyIsEnumerable,
          __defNormalProp$3$1 = function (r, n, i) {
            return n in r
              ? __defProp$3$1(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$3$1 = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$3$1.call(n, i) && __defNormalProp$3$1(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$3$1)
              try {
                for (
                  var l = __getOwnPropSymbols$3$1(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$3$1.call(n, i) &&
                    __defNormalProp$3$1(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __spreadProps$2$1 = function (r, n) {
            return __defProps$2$1(r, __getOwnPropDescs$2$1(n));
          },
          colorNameDist = {
            aliceblue: "#f0f8ff",
            antiquewhite: "#faebd7",
            aqua: "#00ffff",
            aquamarine: "#7fffd4",
            azure: "#f0ffff",
            beige: "#f5f5dc",
            bisque: "#ffe4c4",
            black: "#000000",
            blanchedalmond: "#ffebcd",
            blue: "#0000ff",
            blueviolet: "#8a2be2",
            brown: "#a52a2a",
            burlywood: "#deb887",
            cadetblue: "#5f9ea0",
            chartreuse: "#7fff00",
            chocolate: "#d2691e",
            coral: "#ff7f50",
            cornflowerblue: "#6495ed",
            cornsilk: "#fff8dc",
            crimson: "#dc143c",
            cyan: "#00ffff",
            darkblue: "#00008b",
            darkcyan: "#008b8b",
            darkgoldenrod: "#b8860b",
            darkgray: "#a9a9a9",
            darkgreen: "#006400",
            darkkhaki: "#bdb76b",
            darkmagenta: "#8b008b",
            darkolivegreen: "#556b2f",
            darkorange: "#ff8c00",
            darkorchid: "#9932cc",
            darkred: "#8b0000",
            darksalmon: "#e9967a",
            darkseagreen: "#8fbc8f",
            darkslateblue: "#483d8b",
            darkslategray: "#2f4f4f",
            darkturquoise: "#00ced1",
            darkviolet: "#9400d3",
            deeppink: "#ff1493",
            deepskyblue: "#00bfff",
            dimgray: "#696969",
            dodgerblue: "#1e90ff",
            firebrick: "#b22222",
            floralwhite: "#fffaf0",
            forestgreen: "#228b22",
            fuchsia: "#ff00ff",
            gainsboro: "#dcdcdc",
            ghostwhite: "#f8f8ff",
            gold: "#ffd700",
            goldenrod: "#daa520",
            grey: "#808080",
            gray: "#808080",
            green: "#008000",
            greenyellow: "#adff2f",
            honeydew: "#f0fff0",
            hotpink: "#ff69b4",
            indianred: "#cd5c5c",
            indigo: "#4b0082",
            ivory: "#fffff0",
            khaki: "#f0e68c",
            lavender: "#e6e6fa",
            lavenderblush: "#fff0f5",
            lawngreen: "#7cfc00",
            lemonchiffon: "#fffacd",
            lightblue: "#add8e6",
            lightcoral: "#f08080",
            lightcyan: "#e0ffff",
            lightgoldenrodyellow: "#fafad2",
            lightgrey: "#d3d3d3",
            lightgreen: "#90ee90",
            lightpink: "#ffb6c1",
            lightsalmon: "#ffa07a",
            lightseagreen: "#20b2aa",
            lightskyblue: "#87cefa",
            lightslategray: "#778899",
            lightsteelblue: "#b0c4de",
            lightyellow: "#ffffe0",
            lime: "#00ff00",
            limegreen: "#32cd32",
            linen: "#faf0e6",
            magenta: "#ff00ff",
            maroon: "#800000",
            mediumaquamarine: "#66cdaa",
            mediumblue: "#0000cd",
            mediumorchid: "#ba55d3",
            mediumpurple: "#9370d8",
            mediumseagreen: "#3cb371",
            mediumslateblue: "#7b68ee",
            mediumspringgreen: "#00fa9a",
            mediumturquoise: "#48d1cc",
            mediumvioletred: "#c71585",
            midnightblue: "#191970",
            mintcream: "#f5fffa",
            mistyrose: "#ffe4e1",
            moccasin: "#ffe4b5",
            navajowhite: "#ffdead",
            navy: "#000080",
            oldlace: "#fdf5e6",
            olive: "#808000",
            olivedrab: "#6b8e23",
            orange: "#ffa500",
            orangered: "#ff4500",
            orchid: "#da70d6",
            palegoldenrod: "#eee8aa",
            palegreen: "#98fb98",
            paleturquoise: "#afeeee",
            palevioletred: "#d87093",
            papayawhip: "#ffefd5",
            peachpuff: "#ffdab9",
            peru: "#cd853f",
            pink: "#ffc0cb",
            plum: "#dda0dd",
            powderblue: "#b0e0e6",
            purple: "#800080",
            rebeccapurple: "#663399",
            red: "#ff0000",
            rosybrown: "#bc8f8f",
            royalblue: "#4169e1",
            saddlebrown: "#8b4513",
            salmon: "#fa8072",
            sandybrown: "#f4a460",
            seagreen: "#2e8b57",
            seashell: "#fff5ee",
            sienna: "#a0522d",
            silver: "#c0c0c0",
            skyblue: "#87ceeb",
            slateblue: "#6a5acd",
            slategray: "#708090",
            snow: "#fffafa",
            springgreen: "#00ff7f",
            steelblue: "#4682b4",
            tan: "#d2b48c",
            teal: "#008080",
            thistle: "#d8bfd8",
            tomato: "#ff6347",
            turquoise: "#40e0d0",
            violet: "#ee82ee",
            wheat: "#f5deb3",
            white: "#ffffff",
            whitesmoke: "#f5f5f5",
            yellow: "#ffff00",
            yellowgreen: "#9acd32",
          },
          ColorUtil$1 = {
            yC: function r(n) {
              var i =
                arguments.length > 1 && arguments[1] !== void 0
                  ? arguments[1]
                  : !1;
              if (!n) return n;
              for (var s = [], a = 0, o = n.length; a < o; a += 2) {
                var l = parseInt(n.substr(a, 2), 16);
                i && (l = parseInt(l / 255 + "")), s.push(l);
              }
              return s.push(s.shift()), s;
            },
            xC: function r(n) {
              var i = n.split(",");
              return (
                (i[0] = parseFloat(i[0].slice(5)) / 255),
                (i[1] = parseFloat(i[1]) / 255),
                (i[2] = parseFloat(i[2]) / 255),
                (i[3] = parseFloat(i[3])),
                i
              );
            },
            Zn: function r(n) {
              var i = n.split(",");
              return (
                (i[0] = parseFloat(i[0].slice(4)) / 255),
                (i[1] = parseFloat(i[1]) / 255),
                (i[2] = parseFloat(i[2]) / 255),
                (i[3] = 1),
                i
              );
            },
            CC: function r(n) {
              for (var i = [], s = 1, a = n.length; s < a; s += 2)
                i.push(parseInt(n.substr(s, 2), 16));
              return (
                i.push((i.shift() / 255).toFixed(2)),
                "rgba(" + i.join(",") + ")"
              );
            },
            $n: function r(n) {
              for (var i = [], s = 1, a = n.length; s < a; s += 2)
                i.push(parseInt(n.substr(s, 2), 16) / 255);
              return i;
            },
            Kn: function r(n) {
              for (var i = [], s = 1, a = n.length; s < a; s += 2)
                i.push(parseInt(n.substr(s, 2), 16) / 255);
              return (i[3] = 1), i;
            },
            ti: function r(n) {
              for (var i = [], s = 1, a = n.length; s < a; s += 1) {
                var o = n.substr(s, 1);
                i.push(parseInt(o + o, 16) / 255);
              }
              return (i[3] = 1), i;
            },
            kC: function r() {
              var n =
                arguments.length > 0 && arguments[0] !== void 0
                  ? arguments[0]
                  : "";
              return (n = n.toLowerCase()), colorNameDist[n];
            },
            zC: function r(n) {
              if (_instanceof(n, Array))
                return [n[0] / 255, n[1] / 255, n[2] / 255, n[3] || 1];
              if (/^rgba\(/.test(n)) return this.xC(n);
              if (/^rgb\(/.test(n)) return this.Zn(n);
              if (n[0] === "#" && typeof n == "string") {
                var i = n.length;
                if (i === 4) return this.ti(n);
                if (i === 7) return this.Kn(n);
                if (i === 9) return this.$n(n);
              } else if (typeof n == "string") {
                var s = this.kC(n);
                return this.Kn(s);
              }
              return n;
            },
          },
          DomUtil = {
            wC: function r(n, i) {
              var s = i.target;
              if (s) {
                var a = n.getBoundingClientRect(),
                  o = [n.clientLeft, n.clientTop],
                  l = i;
                return (
                  _instanceof(i, TouchEvent) &&
                    i.touches &&
                    i.changedTouches &&
                    (i.touches.length > 0
                      ? (l = i.touches[0])
                      : (l = i.changedTouches[i.changedTouches.length - 1])),
                  [l.clientX - a.left - o[0], l.clientY - a.left - o[1]]
                );
              }
              return [0, 0];
            },
          },
          MathUtil = {
            PC: function r(n) {
              return (n / 180) * Math.PI;
            },
            SC: function r(n) {
              return (n * 180) / Math.PI;
            },
          },
          CommonUtil$1 = {
            MC: function r() {
              var n =
                  arguments.length > 0 && arguments[0] !== void 0
                    ? arguments[0]
                    : "",
                i =
                  arguments.length > 1 && arguments[1] !== void 0
                    ? arguments[1]
                    : 10;
              return (
                n +
                Math.round(Math.random() * Math.pow(10, i)) +
                "_" +
                new Date().getTime()
              );
            },
            _C: function r(n, i) {
              var s = n.length,
                a = i.length;
              n.length = s + a;
              for (var o = 0; o < a; o++) n[s + o] = i[o];
              return n;
            },
            ni: function r(n, i) {
              var s =
                arguments.length > 2 && arguments[2] !== void 0
                  ? arguments[2]
                  : {};
              n = encodeURI(n);
              var a = { callback: "callback", type: "json", charset: "utf-8" },
                o = CommonUtil$1.MC("jsonp_", 6) + "_",
                l = document.createElement("script");
              (l.type = "text/javascript"),
                (l.async = !0),
                (s = Object.assign({}, a, s));
              var u = function () {
                (window[o] = null),
                  (l.onerror = null),
                  l.parentNode && l.parentNode.removeChild(l);
              };
              (l.onerror = function () {
                u(), i && i("error", { url: n, info: "Request Error" });
              }),
                (window[o] = function (p) {
                  u(), i && i("complete", { info: "ok", url: n, data: p });
                });
              var f = "?";
              n.indexOf("?") !== -1 && (f = "&");
              var c = n + f + s.callback + "=" + o;
              l.src = c;
              var h =
                document.getElementsByTagName("body")[0] ||
                document.getElementsByTagName("head")[0];
              h.appendChild(l);
            },
            grid: {
              ri: function r(n) {
                for (
                  var i =
                      arguments.length > 1 && arguments[1] !== void 0
                        ? arguments[1]
                        : 100,
                    s = {},
                    a = [],
                    o = i * 2,
                    l = -1,
                    u = n.length;
                  ++l < u;

                ) {
                  var f = n[l].coordinaties,
                    c = Math.floor(f[0] / o),
                    h = Math.floor(f[1] / o),
                    p = c + "-" + h,
                    d = s[p];
                  d
                    ? d.coordinates.push(n[l])
                    : ((s[p] = d =
                        {
                          rowCol: [c, h],
                          center: [c * o + i, h * o + i],
                          coordinates: [n[l]],
                        }),
                      a.push(d));
                }
                return a;
              },
              DC: function r(n, i) {
                var s,
                  a = [],
                  o = i.gap,
                  l = i.radius,
                  u = o / 2,
                  f = _slicedToArray(n.center, 2),
                  c = f[0],
                  h = f[1],
                  p = [c - l + u, h + l - u],
                  d = [c - l + u, h - l + u],
                  m = [c + l - u, h - l + u],
                  g = [c + l - u, h + l - u];
                return (s = a).push.apply(s, [p, d, m, g, p]), a;
              },
            },
            hexagon: {
              ei: Math.PI / 3,
              oi: [
                0,
                Math.PI / 3,
                (2 * Math.PI) / 3,
                Math.PI / 3,
                Math.PI / 3,
                (5 * Math.PI) / 3,
              ],
              ri: function r(n) {
                for (
                  var i =
                      arguments.length > 1 && arguments[1] !== void 0
                        ? arguments[1]
                        : 100,
                    s = {},
                    a = [],
                    o = i * 2 * Math.sin(this.ei),
                    l = i * 1.5,
                    u = 0,
                    f = n.length;
                  u < f;
                  ++u
                ) {
                  var c = n[u].coordinaties,
                    h = _slicedToArray(c, 2),
                    p = h[0],
                    d = h[1];
                  d = d / l;
                  var m = Math.round(d);
                  p = p / o - (m & 1) / 2;
                  var g = Math.round(p),
                    v = d - m;
                  if (Math.abs(v) * 3 > 1) {
                    var y = p - g,
                      _ = g + (p < g ? -1 : 1) / 2,
                      b = m + (d < m ? -1 : 1),
                      S = p - _,
                      P = d - b;
                    y * y + v * v > S * S + P * P &&
                      ((g = _ + (m & 1 ? 1 : -1) / 2), (m = b));
                  }
                  var I = g + "-" + m,
                    F = s[I];
                  F
                    ? F.coordinates.push(n[u])
                    : ((s[I] = F =
                        {
                          rowCol: [g, m],
                          center: [(g + (m & 1) / 2) * o, m * l],
                          coordinates: [n[u]],
                        }),
                      a.push(F));
                }
                return a;
              },
              DC: function r(n, i) {
                var s,
                  a = [],
                  o = i.gap,
                  l = i.radius,
                  u = o / 2,
                  f = l / 2,
                  c = Math.sqrt(3) * l,
                  h = Math.sqrt(Math.pow(c, 2) + Math.pow(l, 2)),
                  p = _slicedToArray(n.center, 2),
                  d = p[0],
                  m = p[1],
                  g = [d, m + h / 2 - u],
                  v = [d - c / 2 + u, m + f - u / 2],
                  y = [d - c / 2 + u, m - f + u / 2],
                  _ = [d, m - h / 2 + u],
                  b = [d + c / 2 - u, m - f + u / 2],
                  S = [d + c / 2 - u, m + f - u / 2];
                return (s = a).push.apply(s, [g, v, y, _, b, S, g]), a;
              },
            },
            ai: function r(n) {
              var i = [];
              if (n.type === "MultiPoint")
                for (
                  var s = n.properties, a = n.coordinates, o = a.length, l = 0;
                  l < o;
                  ++l
                ) {
                  var u = a[l];
                  i.push({ properties: s, type: "Point", coordinates: u });
                }
              else if (n.type === "MultiLineString")
                for (
                  var f = n.properties, c = n.coordinates, h = c.length, p = 0;
                  p < h;
                  ++p
                ) {
                  var d = c[p];
                  i.push({ properties: f, type: "Point", coordinates: d });
                }
              else if (n.type === "MultiPolygon")
                for (
                  var m = n.properties, g = n.coordinates, v = g.length, y = 0;
                  y < v;
                  ++y
                ) {
                  var _ = g[y];
                  i.push({ properties: m, type: "Point", coordinates: _ });
                }
              return i;
            },
          },
          GeometryUtil = __spreadProps$2$1(
            __spreadValues$3$1({}, AMap.GeometryUtil),
            {
              s$: function r(n) {
                var i = 0;
                if (n && n.length > 0) {
                  i += Math.abs(this.ringArea(n[0]));
                  for (var s = 1; s < n.length; s++)
                    i -= Math.abs(this.ringArea(n[s]));
                }
                return i;
              },
              a$: function r(n) {
                return polylabel$1.exports(n, 1);
              },
              l$: function r(n) {
                var i =
                    arguments.length > 1 && arguments[1] !== void 0
                      ? arguments[1]
                      : {},
                  s = 0,
                  a = 0,
                  o = 0;
                return (
                  coordEach(
                    n,
                    function (l) {
                      (s += l[0]), (a += l[1]), o++;
                    },
                    !0
                  ),
                  point$1([s / o, a / o], i.properties)
                );
              },
              c$: function r(n) {
                for (
                  var i = multiPoint(n),
                    s = i.geometry,
                    a = this.l$(i),
                    o = !1,
                    l = 0;
                  !o && l < s.coordinates.length;

                )
                  a.geometry.coordinates[0] === s.coordinates[l][0] &&
                    a.geometry.coordinates[1] === s.coordinates[l][1] &&
                    (o = !0),
                    l++;
                if (o) return a.geometry.coordinates;
                var u = 1 / 0,
                  f,
                  c = !0,
                  h = !1,
                  p = void 0;
                try {
                  for (
                    var d = s.coordinates[Symbol.iterator](), m;
                    !(c = (m = d.next()).done);
                    c = !0
                  ) {
                    var g = m.value,
                      v = this.distance(g, a.geometry.coordinates);
                    v < u && ((u = v), (f = g));
                  }
                } catch (y) {
                  (h = !0), (p = y);
                } finally {
                  try {
                    !c && d.return != null && d.return();
                  } finally {
                    if (h) throw p;
                  }
                }
                return f;
              },
            }
          ),
          LangUtil = {
            Wb: function r(n) {
              return Object.prototype.toString.call(n) === "[object Object]";
            },
          },
          __defProp$2$1 = Object.defineProperty,
          __getOwnPropSymbols$2$1 = Object.getOwnPropertySymbols,
          __hasOwnProp$2$1 = Object.prototype.hasOwnProperty,
          __propIsEnum$2$1 = Object.prototype.propertyIsEnumerable,
          __defNormalProp$2$1 = function (r, n, i) {
            return n in r
              ? __defProp$2$1(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$2$1 = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$2$1.call(n, i) && __defNormalProp$2$1(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$2$1)
              try {
                for (
                  var l = __getOwnPropSymbols$2$1(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$2$1.call(n, i) &&
                    __defNormalProp$2$1(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          ColorUtil = ColorUtil$1,
          _Style = (function () {
            function r() {
              _classCallCheck(this, r);
            }
            var n = r.prototype;
            return (
              (n.parse = function (i, s, a) {
                for (
                  var o = {}, l = {}, u = {}, f = 0, c = i.length;
                  f < c;
                  f++
                ) {
                  var h = i[f],
                    p = this.u$(h, f, s, a);
                  for (var d in p) o[d] || (o[d] = []), o[d].push(p[d]);
                }
                for (var m in a)
                  if (["uniform", "config"].includes(a[m].render)) {
                    var g = this.h$(m, s[m], a[m].defaultValue, a[m].type);
                    a[m].render === "uniform" ? (l[m] = g) : (u[m] = g);
                  }
                return { attributes: o, uniforms: l, si: u };
              }),
              (n.u$ = function (i, s, a, o) {
                var l = {};
                for (var u in o)
                  o[u].render === "attribute" &&
                    (l[u] = this.h$(
                      u,
                      a[u],
                      o[u].defaultValue,
                      o[u].type,
                      function () {
                        return [s, i];
                      }
                    ));
                return l;
              }),
              (n.h$ = function (i, s, a, o, l) {
                var u = typeof o == "function" ? o(i) : o;
                if ((LangUtil.Wb(a) || LangUtil.Wb(s)) && u === "nest") {
                  var f = __spreadValues$2$1(__spreadValues$2$1({}, a), s);
                  for (var c in f)
                    if (
                      Object.prototype.toString.call(f[c]) === "[object Object]"
                    )
                      f[c] = this.h$(c, f[c], (a || {})[c], o, l);
                    else if (typeof f[c] == "function") {
                      var h;
                      f[c] = this.f$(
                        u,
                        (h = f)[c].apply(
                          h,
                          _toConsumableArray((l == null ? void 0 : l(i)) || [])
                        )
                      );
                    } else f[c] = this.f$(u, f[c]);
                  return f;
                } else {
                  var p;
                  return (
                    typeof s == "function"
                      ? (p = s.apply(
                          void 0,
                          _toConsumableArray((l == null ? void 0 : l(i)) || [])
                        ))
                      : (p = s != null ? s : a),
                    this.f$(u, p)
                  );
                }
              }),
              (n.f$ = function (i, s) {
                if (i === "color") return ColorUtil.zC(s);
                if (i === "colors") {
                  if (!Array.isArray(s))
                    throw new Error(
                      "style.colors \u5FC5\u987B\u662F\u6570\u7EC4"
                    );
                  return s.map(function (a) {
                    return ColorUtil.zC(a);
                  });
                }
                return s;
              }),
              (r.getInstance = function () {
                return this.ui;
              }),
              r
            );
          })(),
          Style = _Style;
        Style.ui = new _Style();
        var StyleInstance = Style.getInstance(),
          __defProp$1$2 = Object.defineProperty,
          __defProps$1$1 = Object.defineProperties,
          __getOwnPropDescs$1$1 = Object.getOwnPropertyDescriptors,
          __getOwnPropSymbols$1$2 = Object.getOwnPropertySymbols,
          __hasOwnProp$1$2 = Object.prototype.hasOwnProperty,
          __propIsEnum$1$2 = Object.prototype.propertyIsEnumerable,
          __defNormalProp$1$2 = function (r, n, i) {
            return n in r
              ? __defProp$1$2(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$1$2 = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$1$2.call(n, i) && __defNormalProp$1$2(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$1$2)
              try {
                for (
                  var l = __getOwnPropSymbols$1$2(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$1$2.call(n, i) &&
                    __defNormalProp$1$2(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __spreadProps$1$1 = function (r, n) {
            return __defProps$1$1(r, __getOwnPropDescs$1$1(n));
          },
          Event = (function () {
            function r() {
              _classCallCheck(this, r), (this.fi = {});
            }
            var n = r.prototype;
            return (
              (n.on = function (i, s) {
                var a =
                    arguments.length > 2 && arguments[2] !== void 0
                      ? arguments[2]
                      : this,
                  o =
                    arguments.length > 3 && arguments[3] !== void 0
                      ? arguments[3]
                      : !1,
                  l;
                Array.isArray(i) ? (l = i) : (l = [i]);
                var u = !0,
                  f = !1,
                  c = void 0;
                try {
                  for (
                    var h = l[Symbol.iterator](), p;
                    !(u = (p = h.next()).done);
                    u = !0
                  ) {
                    var d = p.value;
                    this._on(d, s, a, o);
                  }
                } catch (m) {
                  (f = !0), (c = m);
                } finally {
                  try {
                    !u && h.return != null && h.return();
                  } finally {
                    if (f) throw c;
                  }
                }
                return this;
              }),
              (n.off = function (i, s) {
                var a =
                    arguments.length > 2 && arguments[2] !== void 0
                      ? arguments[2]
                      : this,
                  o = this.fi;
                if (i in o) {
                  for (var l = 0; l < o[i].length; l += 1)
                    if (o[i][l].hi === s && o[i][l].context === a)
                      return o[i].splice(l, 1), this;
                }
                return this;
              }),
              (n.hasEvents = function (i, s) {
                var a =
                    arguments.length > 2 && arguments[2] !== void 0
                      ? arguments[2]
                      : this,
                  o = this.fi;
                if (i && s && i in o) {
                  for (var l = 0; l < o[i].length; l += 1)
                    if (o[i][l].hi === s && o[i][l].context === a) return !0;
                }
                return !1;
              }),
              (n.clearEvents = function (i) {
                return (
                  i ? this.fi[i] && delete this.fi[i] : (this.fi = {}), this
                );
              }),
              (n.emit = function (i) {
                var s =
                  arguments.length > 1 && arguments[1] !== void 0
                    ? arguments[1]
                    : {};
                if (!(i in this.fi)) return this;
                for (
                  var a = __spreadProps$1$1(__spreadValues$1$2({}, s), {
                      type: i,
                    }),
                    o = this.fi[i],
                    l = 0,
                    u = o.length;
                  l < u;
                  l += 1
                ) {
                  var f = o[l];
                  !f.hi ||
                    (f.hi.call(f.context, a),
                    f.once && (this.fi[i].splice(l, 1), (l -= 1), (u -= 1)));
                }
                return this;
              }),
              (n.getEvents = function () {
                return this.fi;
              }),
              (n._on = function (i, s) {
                var a =
                    arguments.length > 2 && arguments[2] !== void 0
                      ? arguments[2]
                      : this,
                  o =
                    arguments.length > 3 && arguments[3] !== void 0
                      ? arguments[3]
                      : !1;
                if (this.hasEvents(i, s, a)) return this;
                var l = this.fi;
                return (
                  (l[i] = l[i] || []),
                  l[i].push({ hi: s, context: a || this, once: o }),
                  this
                );
              }),
              r
            );
          })(),
          parser = new uaParserJs.UAParser(),
          buryPoint = {
            sr: Math.random(),
            cr: "1.0",
            lr: {},
            hr: "",
            dr: "LOCA",
            vr: {},
            pr: {},
            init: function r() {
              this.mr(),
                setTimeout(function () {
                  buryPoint.send();
                }, 2e3),
                setInterval(function () {
                  buryPoint.send();
                }, 1e4);
            },
            setAPIKey: function r(n) {
              this.hr = n;
            },
            setContainer: function r(n) {
              this.lr = n;
              var i = n.getBoundingClientRect();
              this.pr.size = [i.width, i.height];
            },
            setVersion: function r(n) {
              this.cr = n;
            },
            mr: function r() {
              var n = document.createElement("canvas"),
                i = n.getContext("webgl");
              if (i) {
                var s = i.getExtension("WEBGL_debug_renderer_info");
                this.pr.br = s && i.getParameter(s.UNMASKED_RENDERER_WEBGL);
              }
            },
            getKey: function r() {
              var n =
                  arguments.length > 0 && arguments[0] !== void 0
                    ? arguments[0]
                    : "",
                i = arguments.length > 1 ? arguments[1] : void 0;
              n = n;
              var s,
                a = [];
              return (
                Object.prototype.toString.call(i) === "[object Object]" &&
                  (a = Object.keys(i)),
                i !== void 0 && n ? (s = n + "@" + a.join()) : (s = n),
                s
              );
            },
            record: function r(n, i, s) {
              this.vr[n] || (this.vr[n] = {});
              var a = this.getKey(i, s);
              this.vr[n][a] == null && (this.vr[n][a] = 0);
            },
            send: function r() {
              var n = [];
              for (var i in this.vr)
                if (this.vr.hasOwnProperty(i)) {
                  var s = this.vr[i],
                    a = [];
                  for (var o in s)
                    s.hasOwnProperty(o) && s[o] == 0 && (a.push(o), (s[o] = 1));
                  a.length && n.push(i + "~" + a.join(","));
                }
              if (n.length) {
                var l = parser.getResult(),
                  u = [
                    "type=nfl",
                    "k=" + this.hr,
                    "m=" + (l.device.type === "moblie" ? 1 : 0),
                    "pf=" + l.os.name,
                    "v=" + this.cr,
                    "branch=" + this.dr,
                    "logversion=2.0",
                    "gc=" + this.pr.br,
                    "log=" + n.join("!"),
                    "appname=" +
                      window.location.origin +
                      window.location.pathname,
                    "sdkversion=" + this.cr,
                  ],
                  f = "https://webapi.amap.com/count?" + u.join("&");
                CommonUtil$1.ni(f);
              }
            },
            gr: function r() {},
          },
          Layer$1 = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              return (
                (o = n.call(this)),
                (o.CLASS_NAME = "Layer"),
                (o.meshes = []),
                (o.preHandle = !1),
                (o.buryPoint = buryPoint),
                (o.d$ = a),
                (o.id = CommonUtil$1.MC()),
                (o.map = a.map),
                (o.zIndex = a.zIndex),
                (o.visible = a.visible),
                (o.opacity = a.opacity),
                (o.zooms = a.zooms),
                (o.style = StyleInstance),
                (o.preHandle = !!a.preHandle),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.setSource = function (a, o) {
                this.source && this.source.Mr(this),
                  this.buryPoint.record(this.CLASS_NAME, "setSource"),
                  (this.source = a),
                  o && this.setStyle(o),
                  this.source.addLayer(this);
              }),
              (s.setStyle = function (a) {
                a && this.buryPoint.record(this.CLASS_NAME, "setStyle", a),
                  (this.styleOptions = a),
                  this.preHandle && this.beforeRender();
              }),
              (s.WC = function () {
                for (
                  var a = function (c) {
                      var h = o[c].id,
                        p = l.find(function (d) {
                          return d.id === h;
                        });
                      p
                        ? (u.didFusion.push(p), u.didFusionDataset.push(o[c]))
                        : u.willFusion.push(o[c]);
                    },
                    o = this.dataset,
                    l = this.meshes,
                    u = { willFusion: [], didFusion: [], didFusionDataset: [] },
                    f = 0;
                  f < o.length;
                  f++
                )
                  a(f);
                return u;
              }),
              (s.setMap = function (a) {
                this.map = a;
              }),
              (s.onAdd = function () {
                this.Cr = performance.now();
              }),
              (s.Ar = function () {
                this.Cr = 0;
              }),
              (s.setZooms = function (a) {
                this.zooms = a;
              }),
              (s.setOpacity = function (a) {
                this.opacity = a;
              }),
              (s.setzIndex = function (a) {
                this.zIndex = a;
              }),
              (s.show = function () {
                this.visible = !0;
              }),
              (s.hide = function () {
                this.visible = !1;
              }),
              (s.zr = function () {
                return performance.now() - this.Cr;
              }),
              i
            );
          })(_wrapNativeSuper(Event)),
          Handler = (function () {
            function r(i) {
              var s = this;
              _classCallCheck(this, r),
                (this._r = [0, 0]),
                (this.Sr = [0, 0]),
                (this.clickCount = 0),
                (this.Ir = !1),
                (this.Pr = function (a) {
                  var o = a.deltaX,
                    l = a.deltaY;
                  s.map.emit("wheel", { event: a, deltaX: o, deltaY: l });
                }),
                (this.Tr = function (a) {
                  (s.Ir = !0),
                    s.container &&
                      ((s._r = DomUtil.wC(s.container, a)), (s.Sr = s._r)),
                    s.map.emit("mousedown", { event: a, Br: s._r });
                }),
                (this.Dr = function (a) {
                  var o = [0, 0],
                    l = _toConsumableArray(s.Sr),
                    u = { event: a, Sr: l, Er: o, _r: s._r };
                  if (s.Ir && s.container) {
                    var f = DomUtil.wC(s.container, a);
                    (o = [f[0] - l[0], f[1] - l[1]]),
                      (s.Sr = f),
                      (u.Er = o),
                      s.map.emit("drag", u);
                  }
                  s.map.emit("mousemove", u);
                }),
                (this.Vr = function (a) {
                  s.Ir = !1;
                  var o = [0, 0];
                  if (s.container) {
                    var l = s;
                    (o = DomUtil.wC(s.container, a)),
                      Math.abs(o[0] - s._r[0]) <= 1 &&
                        Math.abs(o[1] - s._r[1]) <= 1 &&
                        (s.clickCount++,
                        s.clickCount >= 2
                          ? s.map.emit("dblclick", { event: a, Br: o })
                          : s.map.emit("click", { event: a, Br: o })),
                      s.map.emit("mouseup", { event: a, Br: o }),
                      setTimeout(function () {
                        l.clickCount = 0;
                      }, 300);
                  }
                }),
                (this.Rr = function (a) {
                  if ((a.preventDefault(), s.container)) {
                    var o = DomUtil.wC(s.container, a);
                    s.map.emit("rightclick", { event: a, Br: o });
                  }
                }),
                (this.map = i),
                (this.container = this.map.container),
                this.bindEvents();
            }
            var n = r.prototype;
            return (
              (n.bindEvents = function () {
                var i, s, a, o, l;
                (i = this.container) == null ||
                  i.addEventListener("wheel", this.Pr),
                  (s = this.container) == null ||
                    s.addEventListener("mousedown", this.Tr),
                  (a = this.container) == null ||
                    a.addEventListener("mousemove", this.Dr),
                  (o = this.container) == null ||
                    o.addEventListener("mouseup", this.Vr),
                  (l = this.container) == null ||
                    l.addEventListener("contextmenu", this.Rr);
              }),
              r
            );
          })();
        buryPoint.record("Base");
        var Map$1 = (function (r) {
          _inherits(i, r);
          var n = _createSuper(i);
          function i(a, o) {
            _classCallCheck(this, i);
            var l;
            return (
              (l = n.call(this)),
              (l.center = [0, 0]),
              (l.zoom = 10),
              (l.pitch = 0),
              (l.rotation = 0),
              (l.zooms = [1, 30]),
              (l.animate = new chito.Animation()),
              (l.layers = []),
              (l.buryPoint = buryPoint),
              (l.Fa = 30 * 2),
              (l.La = 0),
              (l.Wa = !1),
              (l.Na = !1),
              (l.Ua = l.Fa),
              (l.timeline = performance.now()),
              (l.container = document.getElementById(a)),
              (l.qa = new Handler(_assertThisInitialized(l))),
              (l.options = o),
              (l.Na = o.Na === void 0 ? l.Na : o.Na),
              (l.Fa = o.Fa === void 0 ? l.Fa : o.Fa),
              l.animate.addClip(
                new chito.Clip({ duration: 1e4, repeat: 1 / 0 }),
                { x: [0, 1] }
              ),
              buryPoint.init(),
              l
            );
          }
          var s = i.prototype;
          return (
            (s.render = function () {
              var a = this;
              this.layers.sort(function (o, l) {
                return o.zIndex - l.zIndex;
              }),
                this.layers.forEach(function (o) {
                  o.visible &&
                    o.opacity > 0 &&
                    o.zooms[0] < a.zoom &&
                    o.zooms[1] > a.zoom &&
                    (o.beforeRender(), o.render(), o.afterRender());
                });
            }),
            (s.Qa = function (a) {
              a &&
                (a.zoom !== void 0 &&
                  ((this.zoom = Math.min(
                    Math.max(this.zooms[0], a.zoom),
                    this.zooms[1]
                  )),
                  this.setZoom()),
                a.center !== void 0 &&
                  (this.setCenter(a.center), (this.center = a.center)),
                a.pitch !== void 0 &&
                  ((this.pitch = Math.min(150, Math.max(a.pitch, 0))),
                  this.setPitch()),
                a.rotation !== void 0 &&
                  (this.setRotation(this.rotation - a.rotation),
                  (this.rotation = a.rotation))),
                this.requestRender(),
                this.emit("viewchange");
            }),
            (s.addLayer = function (a) {
              var o = this.layers.some(function (l) {
                return l.id === a.id;
              });
              !o && (a.onAdd() || this.layers.push(a)), this.requestRender();
            }),
            (s.Mr = function (a) {
              var o = this.layers.findIndex(function (u) {
                return u.id === a.id;
              });
              if (o > -1) {
                var l = this.layers.splice(o, 1);
                l.length >= 0 && (l[0].Ar(), this.requestRender());
              }
            }),
            (s.requestRender = function () {
              var a = this;
              this.Ua = this.Fa;
              var o = function () {
                if (
                  ((a.La = requestAnimationFrame(o)),
                  (a.Wa = !a.Wa),
                  !(a.Na && a.Wa))
                ) {
                  if (a.Ua <= 0) {
                    cancelAnimationFrame(a.La), (a.La = 0);
                    return;
                  }
                  a.render(), a.Ua--;
                }
              };
              this.Ua > 0 && !this.La && o();
            }),
            (s.Za = function () {
              return {
                startTime: this.timeline,
                duration: performance.now() - this.timeline,
              };
            }),
            (s.$a = function () {
              return this.Na;
            }),
            i
          );
        })(_wrapNativeSuper(Event));
        (Map$1.Clip = chito.Clip), (Map$1.Animation = chito.Animation);
        var ViewControl$1 = (function () {
            function r(i) {
              var s = this;
              _classCallCheck(this, r),
                (this.La = 0),
                (this.Bs = []),
                (this.animateStatus = "start"),
                (this.Es = Date.now()),
                (this.Vs = []),
                (this.map = i),
                this.map.animate.on("update", function () {
                  s.Rs(), s.Fs();
                }),
                buryPoint.record("ViewControl");
            }
            var n = r.prototype;
            return (
              (n.addAnimates = function (i, s) {
                (this.animateStatus = "start"),
                  buryPoint.record("ViewControl", "addAnimates");
                var a = i[0],
                  o;
                i.length > 1
                  ? (o = this.addAnimates.bind(this, i.slice(1), s))
                  : i.length === 1 && (o = s),
                  this.Ls(a, o);
              }),
              (n.removeAnimate = function (i) {
                buryPoint.record("ViewControl", "removeAnimate");
                var s = this.Bs.findIndex(function (a) {
                  return a === i;
                });
                return this.Bs.splice(s, 1);
              }),
              (n.Ws = function (i) {
                return (
                  buryPoint.record("ViewControl", "removeAnimateByIndex"),
                  this.Bs.splice(i, 1),
                  this.Bs
                );
              }),
              (n.Ns = function () {
                return this.Bs;
              }),
              (n.clearAnimates = function () {
                buryPoint.record("ViewControl", "clearAnimates"),
                  (this.Bs = []),
                  this.qs();
              }),
              (n.pauseAnimate = function () {
                (this.animateStatus = "pause"), (this.Es = Date.now());
              }),
              (n.resumeAnimate = function () {
                if (this.animateStatus === "pause")
                  for (
                    var i = Date.now() - this.Es, s = 0;
                    s < this.Bs.length;
                    s++
                  )
                    this.Bs[s].startTime += i;
                this.animateStatus = "start";
              }),
              (n.addTrackAnimate = function (i, s) {
                (this.animateStatus = "start"),
                  (i || s) && (this.animateStatus = "start");
              }),
              (n.Ys = function () {
                return {
                  zoom: this.map.getZoom(),
                  center: this.map.getCenter(),
                  pitch: this.map.getPitch(),
                  rotation: this.map.getRotation(),
                };
              }),
              (n.Zs = function (i) {
                var s = i.zoom,
                  a = i.center,
                  o = i.pitch,
                  l = i.rotation;
                s && this.map.setZoom(s),
                  a && this.map.setCenter(a),
                  o !== void 0 && this.map.setPitch(o),
                  l !== void 0 && this.map.setRotation(l);
              }),
              (n.Ls = function (i, s) {
                var a = this.Ys(),
                  o = a.zoom,
                  l = a.pitch,
                  u = a.center,
                  f = a.rotation,
                  c = Object.keys(i),
                  h,
                  p = -1,
                  d;
                c.forEach(function (X) {
                  p < i[X].duration && ((p = i[X].duration), (d = X));
                });
                for (var m in i) {
                  var g,
                    v = i[m],
                    y = v.value,
                    _ = v.control,
                    b = v.duration,
                    S = v.timing,
                    P = (g = BezierEasing__namespace).default.apply(
                      g,
                      _toConsumableArray(S)
                    ),
                    I =
                      m === "zoom"
                        ? o
                        : m === "pitch"
                        ? l
                        : m === "rotation"
                        ? f
                        : u;
                  m === "center" && u
                    ? (h = new bezierJs.Bezier(
                        { x: u[0], y: u[1] },
                        { x: _[0][0], y: _[0][1] },
                        { x: _[1][0], y: _[1][1] },
                        { x: y[0], y: y[1] }
                      ))
                    : (h = new bezierJs.Bezier(
                        { x: 0, y: I },
                        { x: _[0][0], y: _[0][1] },
                        { x: _[1][0], y: _[1][1] },
                        { x: 1, y: y }
                      ));
                  var F = {
                    type: m,
                    $s: h,
                    timing: P,
                    duration: b,
                    startTime: 0,
                    finish: d === m ? s : void 0,
                  };
                  this.Ks(F);
                }
              }),
              (n.Ks = function (i) {
                (i.startTime = Date.now()), this.Bs.push(i);
              }),
              (n.qs = function () {
                (this.animateStatus = "stop"),
                  cancelAnimationFrame(this.La),
                  (this.La = 0),
                  (this.Bs = []);
              }),
              (n.Rs = function () {
                var i = this,
                  s = function (u) {
                    var f = i.Bs[u],
                      c = f.timing,
                      h = f.$s,
                      p = f.startTime,
                      d = f.duration,
                      m = f.type,
                      g = f.finish,
                      v = o - p;
                    v > d
                      ? ((f.tf = !0),
                        requestAnimationFrame(function () {
                          g && g(f);
                        }))
                      : a.push(f);
                    var y = Math.min(1, c(v / d)),
                      _ = h.get(y);
                    switch (m) {
                      case "zoom":
                        i.Zs({ zoom: _.y });
                        break;
                      case "pitch":
                        i.Zs({ pitch: _.y });
                        break;
                      case "rotation":
                        i.Zs({ rotation: _.y });
                        break;
                      case "center":
                        i.Zs({ center: [_.x, _.y] });
                        break;
                    }
                  };
                if (this.animateStatus === "start") {
                  for (
                    var a = [], o = Date.now(), l = 0;
                    l < this.Bs.length;
                    l++
                  )
                    s(l);
                  (this.Bs = a), a.length > 0;
                }
              }),
              (n.Fs = function () {}),
              r
            );
          })(),
          DataSource = (function () {
            function r(i) {
              _classCallCheck(this, r),
                (this.layers = []),
                (this.status = "unload"),
                (this.dataset = []),
                (this.options = i),
                (this.id = CommonUtil$1.MC());
            }
            var n = r.prototype;
            return (
              (n.nf = function () {
                this.status = "loaded";
                for (var i = 0; i < this.layers.length; i++) {
                  var s = this.layers[i];
                  s.receiveDataset(this.dataset), s.emit("loaded");
                }
              }),
              (n.addLayer = function (i) {
                var s = this.layers.some(function (a) {
                  return a.id === i.id;
                });
                s || (this.layers.push(i), i.receiveDataset(this.dataset));
              }),
              (n.Mr = function (i) {
                var s = this.layers.findIndex(function (a) {
                  return a.id === i.id;
                });
                s > -1 && this.layers.splice(s, 1);
              }),
              r
            );
          })(),
          __defProp$u = Object.defineProperty,
          __defProps$g = Object.defineProperties,
          __getOwnPropDescs$g = Object.getOwnPropertyDescriptors,
          __getOwnPropSymbols$u = Object.getOwnPropertySymbols,
          __hasOwnProp$u = Object.prototype.hasOwnProperty,
          __propIsEnum$u = Object.prototype.propertyIsEnumerable,
          __defNormalProp$u = function (r, n, i) {
            return n in r
              ? __defProp$u(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$u = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$u.call(n, i) && __defNormalProp$u(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$u)
              try {
                for (
                  var l = __getOwnPropSymbols$u(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$u.call(n, i) && __defNormalProp$u(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __spreadProps$g = function (r, n) {
            return __defProps$g(r, __getOwnPropDescs$g(n));
          },
          CommonUtil = CommonUtil$1,
          GeoUtil = {
            ai: function r(n) {
              var i = [];
              if (n.type === "MultiPoint")
                for (
                  var s = n.properties, a = n.coordinates, o = a.length, l = 0;
                  l < o;
                  ++l
                ) {
                  var u = a[l];
                  i.push({ properties: s, type: "Point", coordinates: u });
                }
              else if (n.type === "MultiLineString")
                for (
                  var f = n.properties, c = n.coordinates, h = c.length, p = 0;
                  p < h;
                  ++p
                ) {
                  var d = c[p];
                  i.push({ properties: f, type: "Point", coordinates: d });
                }
              else if (n.type === "MultiPolygon")
                for (
                  var m = n.properties, g = n.coordinates, v = g.length, y = 0;
                  y < v;
                  ++y
                ) {
                  var _ = g[y];
                  i.push({ properties: m, type: "Point", coordinates: _ });
                }
              return i;
            },
            hf: function r(n) {
              var i =
                  arguments.length > 1 && arguments[1] !== void 0
                    ? arguments[1]
                    : !1,
                s =
                  arguments.length > 2 && arguments[2] !== void 0
                    ? arguments[2]
                    : 0;
              if (n.type === "FeatureCollection" && n.features.length > 0) {
                var a = n.features,
                  o = this.df(a, s);
                return (
                  i &&
                    o.polygons.length > 0 &&
                    (o.polygons = this.vf(o.polygons)),
                  o
                );
              }
              return n;
            },
            vf: function r(n) {
              for (var i = [], s = 0, a = n.length; s < a; s++) {
                var o = n[s],
                  l = __spreadProps$g(__spreadValues$u({}, o), {
                    polygons: [],
                  });
                if (o.geometry.type === "MultiPolygon")
                  for (
                    var u = o.geometry.coordinates, f = 0, c = u.length;
                    f < c;
                    f++
                  ) {
                    var h = u[f];
                    l.polygons[f] = this.triangle(h);
                  }
                else l.polygons[0] = this.triangle(o.geometry.coordinates);
                i[s] = l;
              }
              return i;
            },
            df: function r(n) {
              for (
                var i =
                    arguments.length > 1 && arguments[1] !== void 0
                      ? arguments[1]
                      : 0,
                  s = { points: [], lines: [], polygons: [], mf: [] },
                  a = 0,
                  o = n.length;
                a < o;
                a++
              ) {
                var l = n[a].geometry,
                  u = l.type,
                  f = "points";
                u === "Point" || u === "MultiPoint"
                  ? (f = "points")
                  : u === "LineString" || u === "MultiLineString"
                  ? (f = "lines")
                  : u === "Polygon" || u === "MultiPolygon"
                  ? (f = "polygons")
                  : (f = "others"),
                  (s[f][s[f].length] = __spreadProps$g(
                    __spreadValues$u({}, l),
                    { properties: n[a].properties, sr: ++i }
                  ));
              }
              return s;
            },
            triangle: function r(n) {
              var i = earcut__default.default.flatten(n),
                s = earcut__default.default(i.vertices, i.holes, i.dimensions);
              return { index: s, vertex: i.vertices };
            },
            mergeTriangles: function r(n, i) {
              var s =
                  arguments.length > 2 && arguments[2] !== void 0
                    ? arguments[2]
                    : 3,
                a = n.index,
                o = n.vertex,
                l = i.index,
                u = i.vertex,
                f = o.length / s,
                c = l.length,
                h = a.length;
              a.length += l.length;
              for (var p = 0; p < c; p++) {
                var d = l[p];
                a[p + h] = d + f;
              }
              return CommonUtil._C(o, u), { index: a, vertex: o };
            },
            isClock: function r(n) {
              for (var i = n.length, s = 0, a = 0; a < i; a++) {
                var o = n[a],
                  l = n[(a + 1) % i];
                s += (l[0] - o[0]) * (l[1] + o[1]);
              }
              return s > 0;
            },
          },
          GeoJSONSource = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              return (
                (o = n.call(this, a)),
                (o.className = "GeoJSONSource"),
                (o.type = "geojson"),
                (o.url = a.url),
                buryPoint.record(o.className),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.LC = function () {
                return this.load(), this.dataset;
              }),
              (s.load = function () {
                if (!(this.status === "loaded" || this.status === "loading"))
                  if (((this.status = "loading"), this.options.data)) {
                    var a = this.options.data;
                    this.valid(a) && ((this.dataset = this.bf(a)), this.nf());
                  } else {
                    var o = this,
                      l = this.url;
                    fetch(l)
                      .then(function (u) {
                        return u.json();
                      })
                      .then(function (u) {
                        o.valid(u) && ((o.dataset = o.bf(u)), o.nf());
                      });
                  }
              }),
              (s.valid = function (a) {
                return a || console.warn("\u65E0\u6548\u6570\u636E"), !0;
              }),
              (s.bf = function (a) {
                var o = GeoUtil.hf(a, !1, 0);
                return [{ id: CommonUtil$1.MC(), features: o }];
              }),
              (s.destroy = function () {
                (this.dataset = []), (this.url = "");
              }),
              i
            );
          })(DataSource),
          GeoBufferSource = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              return (
                (o = n.call(this, a)),
                (o.className = "GeoBufferSource"),
                (o.type = "geobuffer"),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.load = function () {
                if (!(this.status === "loaded" || this.status === "loading")) {
                  this.status = "loading";
                  var a = this.options,
                    o = a.data,
                    l = a.url;
                  if (o) {
                    if (this.valid(o)) {
                      var u = geobuf.decode(new pbf(o));
                      (this.dataset = this.bf(u)), this.nf();
                    }
                  } else {
                    var f = this;
                    fetch(l)
                      .then(function (c) {
                        return c.arrayBuffer();
                      })
                      .then(function (c) {
                        var h = geobuf.decode(new pbf(c));
                        f.valid(h) && ((f.dataset = f.bf(h)), f.nf());
                      });
                  }
                }
              }),
              (s.destroy = function () {
                _get(_getPrototypeOf(i.prototype), "destroy", this).call(this);
              }),
              i
            );
          })(GeoJSONSource),
          Context = (function () {
            function r() {
              _classCallCheck(this, r), this.gf();
            }
            var n = r.prototype;
            return (
              (n.gf = function () {
                console.log("gl", this.gl);
              }),
              (n.wf = function () {}),
              (n.reset = function () {}),
              r
            );
          })(),
          GeometryFusion = function r() {
            _classCallCheck(this, r);
          },
          Projection = function r() {
            _classCallCheck(this, r);
          },
          _Earth = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.project = function (a) {
                var o = _slicedToArray(a, 3),
                  l = o[0],
                  u = o[1],
                  f = o[2],
                  c = _Earth.xf + f,
                  h = MathUtil.PC(l),
                  p = MathUtil.PC(u),
                  d = c * Math.cos(p),
                  m = d * Math.sin(h),
                  g = c * Math.sin(p),
                  v = d * Math.cos(h);
                return [m, g, v];
              }),
              (s.unproject = function (a) {
                var o = _slicedToArray(a, 3),
                  l = o[0],
                  u = o[1],
                  f = o[2],
                  c = Math.sqrt(l * l + u * u + f * f),
                  h = Math.asin(u / c),
                  p = c * Math.cos(h),
                  d = Math.asin(l / p);
                return [d, h, c - _Earth.xf];
              }),
              (s.getResolution = function (a) {
                return (20037508342789244e-9 * 2) / 256 / Math.pow(2, a);
              }),
              i
            );
          })(Projection),
          Earth = _Earth;
        (Earth.xf = 6378137),
          (Earth.Mf = 20037508342789244e-9),
          (Earth.kf = 1496e8),
          (Earth.Cf = 363e6),
          (Earth.Af = (23.3 / 180) * Math.PI);
        var _Mercator = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.project = function (a) {
                var o = _Mercator.r,
                  l = _Mercator.Of,
                  u = _slicedToArray(a, 2),
                  f = u[0],
                  c = u[1],
                  h = _Mercator.zf,
                  p = c * l,
                  d = Math.max(Math.min(h, f), -h) * l;
                return (
                  (d = Math.log(Math.tan(Math.PI / 4 + d / 2))), [p * o, d * o]
                );
              }),
              (s.unproject = function (a) {
                var o = _Mercator.r,
                  l = _Mercator._f,
                  u = _slicedToArray(a, 2),
                  f = u[0],
                  c = u[1],
                  h = (f / o) * l,
                  p = (2 * Math.atan(Math.exp(c / o)) - Math.PI / 2) * l;
                return [h, p, 0];
              }),
              (s.getResolution = function (a) {
                return (20037508342789244e-9 * 2) / 256 / Math.pow(2, a);
              }),
              i
            );
          })(Projection),
          Mercator = _Mercator;
        (Mercator.Of = Math.PI / 180),
          (Mercator._f = 180 / Math.PI),
          (Mercator.r = 6378137),
          (Mercator.zf = 85.0511287798);
        var ColorPick = (function () {
            function r() {
              _classCallCheck(this, r),
                (this.Sf = []),
                (this.If = [0, 0, 0, 255]),
                (this.Pf = 256);
            }
            var n = r.prototype;
            return (
              (n.add = function (i) {
                return (this.Sf[this.Tf()] = i), _toConsumableArray(this.If);
              }),
              (n.clear = function () {
                (this.If = [0, 0, 0, 255]), (this.Sf = {});
              }),
              (n.getColor = function () {
                return _toConsumableArray(this.If);
              }),
              (n.jf = function (i) {
                var s = this.Pf,
                  a = s * s,
                  o = _slicedToArray(i, 3),
                  l = o[0],
                  u = o[1],
                  f = o[2],
                  c = l + u * s + f * a;
                return this.Sf[c];
              }),
              (n.Tf = function () {
                var i = this.Pf,
                  s = i * i,
                  a = _slicedToArray(this.If, 3),
                  o = a[0],
                  l = a[1],
                  u = a[2],
                  f = o + l * i + u * s + 1;
                return (
                  (this.If[0] = f % i),
                  (this.If[1] = ~~(f / i) % i),
                  (this.If[2] = ~~(f / s) % i),
                  f
                );
              }),
              r
            );
          })(),
          _Project = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.project = function (a) {
                var o = [];
                return this.loca
                  ? ((o = this.loca.customCoords.lngLatToCoord([a[0], a[1]])),
                    (o[2] = a[2] || 0),
                    o)
                  : a;
              }),
              (s.unproject = function (a) {
                return a;
              }),
              (s.coordsToContainer = function (a) {
                return a;
              }),
              (s.containerToCoords = function (a) {
                return a;
              }),
              (s.getResolution = function (a) {
                return (20037508342789244e-9 * 2) / 256 / Math.pow(2, a);
              }),
              (i.getProject = function () {
                return this.ui;
              }),
              i
            );
          })(Projection),
          Project = _Project;
        Project.ui = new _Project();
        var ProjectInstance = Project.getProject(),
          RendererManager = (function () {
            function r() {
              _classCallCheck(this, r), (this.Cp = []);
            }
            var n = r.prototype;
            return (
              (n.addRenderer = function (i) {
                var s = this.Cp.findIndex(function (a) {
                  return a === i;
                });
                s < 0 && this.Cp.push(i);
              }),
              (n.removeRenderer = function (i) {
                var s = this.Cp.findIndex(function (a) {
                  return a === i;
                });
                s > -1 && this.Cp.splice(s, 1);
              }),
              (n.destroyRenderers = function () {
                this.Cp.forEach(function (i) {
                  i.destroy();
                });
              }),
              r
            );
          })(),
          FusionManager = (function () {
            function r() {
              _classCallCheck(this, r), (this.Ap = []);
            }
            var n = r.prototype;
            return (
              (n.addFusion = function (i) {
                var s = this.Ap.findIndex(function (a) {
                  return a === i;
                });
                s < 0 && this.Ap.push(i);
              }),
              (n.removeFusion = function (i) {
                var s = this.Ap.findIndex(function (a) {
                  return a === i;
                });
                s > -1 && this.Ap.splice(s, 1);
              }),
              (n.destroyFusions = function () {
                this.Ap.forEach(function (i) {
                  i.destroy();
                });
              }),
              r
            );
          })(),
          __defProp$1$1 = Object.defineProperty,
          __defProps$f = Object.defineProperties,
          __getOwnPropDescs$f = Object.getOwnPropertyDescriptors,
          __getOwnPropSymbols$1$1 = Object.getOwnPropertySymbols,
          __hasOwnProp$1$1 = Object.prototype.hasOwnProperty,
          __propIsEnum$1$1 = Object.prototype.propertyIsEnumerable,
          __defNormalProp$1$1 = function (r, n, i) {
            return n in r
              ? __defProp$1$1(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$1$1 = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$1$1.call(n, i) && __defNormalProp$1$1(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$1$1)
              try {
                for (
                  var l = __getOwnPropSymbols$1$1(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$1$1.call(n, i) &&
                    __defNormalProp$1$1(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __spreadProps$f = function (r, n) {
            return __defProps$f(r, __getOwnPropDescs$f(n));
          },
          ViewControl = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              _classCallCheck(this, i);
              var a;
              return (
                (a = n.call.apply(
                  n,
                  [this].concat(Array.prototype.slice.call(arguments))
                )),
                (a.Op = {}),
                (a.zp = -1),
                a
              );
            }
            var s = i.prototype;
            return (
              (s.addAnimates = function (a, o) {
                _get(_getPrototypeOf(i.prototype), "addAnimates", this).call(
                  this,
                  a,
                  o
                );
              }),
              (s.addTrackAnimate = function (a, o) {
                _get(
                  _getPrototypeOf(i.prototype),
                  "addTrackAnimate",
                  this
                ).call(this, a, o);
                var l = a.path,
                  u = a.timing,
                  f = a.rotationSpeed,
                  c = a.duration,
                  h = this.Sp(l),
                  p = h.Ip,
                  d = h.oi,
                  m = h.coords,
                  g = h.Pp,
                  v = new bezierJs.Bezier(
                    { x: 0, y: 0 },
                    { x: u[0][0], y: u[0][1] },
                    { x: u[1][0], y: u[1][1] },
                    { x: 1, y: 1 }
                  ),
                  y = Date.now();
                this.Op = __spreadProps$f(
                  __spreadValues$1$1(
                    { $s: v, startTime: y, coords: m, Ip: p, Pp: g, oi: d },
                    a
                  ),
                  { Tp: this.jp(d, p, g, c, f), finish: o && o.bind(this) }
                );
              }),
              (s.clearAnimates = function () {
                _get(_getPrototypeOf(i.prototype), "clearAnimates", this).call(
                  this
                ),
                  (this.Op = {});
              }),
              (s.pauseAnimate = function () {
                (this.animateStatus = "pause"), (this.Es = Date.now());
              }),
              (s.resumeAnimate = function () {
                var a = this.animateStatus;
                if (
                  (_get(
                    _getPrototypeOf(i.prototype),
                    "resumeAnimate",
                    this
                  ).call(this),
                  a === "pause")
                ) {
                  var o = Date.now() - this.Es;
                  this.Op.startTime += o;
                }
              }),
              (s.Fs = function () {
                if (this.animateStatus === "start") {
                  var a = Date.now(),
                    o = this.Op,
                    l = o.timing,
                    u = o.$s,
                    f = o.startTime,
                    c = o.duration,
                    h = o.finish,
                    p = o.Ip,
                    d = o.Pp,
                    m = o.path,
                    g = o.oi,
                    v = o.Tp;
                  if (!(!p || !l)) {
                    var y = a - f;
                    y > c && (h && h(this.Op), (this.Op = {}));
                    for (
                      var _ = Math.min(1, y / c),
                        b = u.get(_),
                        S = 0,
                        P = { index: 0, Bp: 0 },
                        I = d * b.y,
                        F = 0;
                      F < p.length;
                      F++
                    ) {
                      var X = p[F];
                      if (S + X >= I) {
                        (P.index = F), (P.Bp = (I - S) / X);
                        break;
                      }
                      S += X;
                    }
                    var W = P.index,
                      Z = P.Bp,
                      j = m[W],
                      L = m[W + 1];
                    this.zp != W &&
                      this.Op.rotationSpeed > 0 &&
                      this.map.map.setRotation(-g[W], !1, v[W]),
                      this.Zs({
                        center: [
                          j[0] + (L[0] - j[0]) * Z,
                          j[1] + (L[1] - j[1]) * Z,
                        ],
                      }),
                      (this.zp = W);
                  }
                }
              }),
              (s.jp = function (a, o, l, u, f) {
                for (
                  var c = [], h = this.map.map.getRotation(), p = 0;
                  p < a.length;
                  p++
                ) {
                  var d = Math.abs(a[p] - h),
                    m = p === 0 ? 1e3 : (o[p] / l) * u,
                    g = (o[p] / l) * u,
                    v = (d / f) * 1e3;
                  c.push(Math.min(m, g, v)), (h = a[p]);
                }
                return c;
              }),
              (s.Sp = function (a) {
                for (
                  var o = [],
                    l = [],
                    u = [],
                    f = !1,
                    c = [0, 1],
                    h = 0,
                    p = 0,
                    d = a.length - 1;
                  p < d;
                  p++
                ) {
                  var m = f || ProjectInstance.project(a[p]),
                    g = ProjectInstance.project(a[p + 1]);
                  o.push(
                    Math.sqrt(
                      Math.pow(m[0] - g[0], 2) +
                        Math.pow(m[1] - g[1], 2) +
                        Math.pow(m[2] - g[2], 2)
                    )
                  ),
                    (h += o[p]),
                    l.push(m);
                  var v = [];
                  glMatrix.vec2.normalize(v, [g[0] - m[0], g[1] - m[1]]);
                  var y = [0, 0, 0];
                  glMatrix.vec3.cross(y, [c[0], c[1], 0], [v[0], v[1], 0]),
                    u.push(
                      (u[p - 1] || 0) +
                        ((y[2] < 0 ? 1 : -1) *
                          Math.acos(glMatrix.vec2.dot(v, c)) *
                          180) /
                          Math.PI
                    ),
                    (f = g),
                    (c = v);
                }
                return { oi: u, coords: l, Ip: o, Pp: h };
              }),
              i
            );
          })(ViewControl$1),
          DefaultLight = 0,
          NewLight = 1,
          LagacyLight = 2,
          Light = (function () {
            function r(n, i) {
              _classCallCheck(this, r),
                (this.rawproperty = n),
                i && ((this.loca = i), this.loca.addLight(this));
            }
            return (
              _createClass(r, [
                {
                  key: "color",
                  get: function () {
                    return ColorUtil$1.zC(this.rawproperty.color).slice(0, 3);
                  },
                  set: function (n) {
                    var i;
                    (this.rawproperty.color = n),
                      (i = this.loca) == null || i.requestRender();
                  },
                },
                {
                  key: "intensity",
                  get: function () {
                    var n;
                    return (n = this.rawproperty.intensity) != null ? n : 1;
                  },
                  set: function (n) {
                    var i;
                    (this.rawproperty.intensity = n),
                      (i = this.loca) == null || i.requestRender();
                  },
                },
              ]),
              r
            );
          })(),
          AmbientLight = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.eA = function (a) {}),
              (s.iA = function (a) {
                (a.intensity = this.intensity), (a.lightColor = this.color);
              }),
              i
            );
          })(Light),
          DirectionalLight = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.eA = function (a) {}),
              (s.iA = function (a) {
                (a.intensity = this.intensity),
                  (a.lightColor = this.color),
                  (a.direction = this.direction);
              }),
              _createClass(i, [
                {
                  key: "target",
                  get: function () {
                    return this.rawproperty.target;
                  },
                  set: function (a) {
                    var o;
                    (this.rawproperty.target = a),
                      (o = this.loca) == null || o.requestRender();
                  },
                },
                {
                  key: "position",
                  get: function () {
                    return this.rawproperty.position;
                  },
                  set: function (a) {
                    var o;
                    (this.rawproperty.position = a),
                      (o = this.loca) == null || o.requestRender();
                  },
                },
                {
                  key: "direction",
                  get: function () {
                    return Array.from(
                      glMatrix.vec3.subtract(
                        glMatrix.vec3.create(),
                        this.target,
                        this.position
                      )
                    );
                  },
                },
              ]),
              i
            );
          })(Light),
          PointLight = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.eA = function (a) {}),
              (s.iA = function (a) {
                (a.intensity = this.intensity),
                  (a.lightColor = this.color),
                  (a.position = this.position),
                  (a.dist = this.distance);
              }),
              _createClass(i, [
                {
                  key: "position",
                  get: function () {
                    var a,
                      o =
                        (a = this.loca) == null
                          ? void 0
                          : a.customCoords.lngLatToCoord(
                              this.rawproperty.position
                            );
                    return [o[0], o[1], this.rawproperty.position[2]];
                  },
                  set: function (a) {
                    var o;
                    (this.rawproperty.position = a),
                      (o = this.loca) == null || o.requestRender();
                  },
                },
                {
                  key: "distance",
                  get: function () {
                    var a;
                    return (a = this.rawproperty.distance) != null ? a : 0;
                  },
                  set: function (a) {
                    var o;
                    (this.rawproperty.distance = a),
                      (o = this.loca) == null || o.requestRender();
                  },
                },
              ]),
              i
            );
          })(Light),
          Loca = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              (o = n.call(this, "null", a)),
                (o.size = [0, 0]),
                (o.layers = []),
                (o.animateStatus = "stop"),
                (o.rendererManager = new RendererManager()),
                (o.fusionManager = new FusionManager()),
                (o.Dp = document.createElement("div")),
                (o.nA = {}),
                (o.rA = []),
                (o.oA = DefaultLight),
                (o.Lp = !1),
                (o.map = a.map),
                (o.viewControl = new ViewControl(_assertThisInitialized(o))),
                (o.Wp = a.Wp || [108.9398, 34.3416]),
                (o.projection = ProjectInstance),
                (o.projection.loca = _assertThisInitialized(o)),
                (o.customCoords = o.map.customCoords),
                (o.Np = o.map.customCoords),
                o.Np.setCenter(o.Wp),
                o.Up(),
                o.qp();
              var l = o.map.getContainer();
              (o.Dp.className = "amap-loca loca-controls"),
                l.appendChild(o.Dp),
                o.map && o.buryPoint.setAPIKey(window.AMap.getConfig().key),
                o.buryPoint.setVersion("2.0.0"),
                o.buryPoint.record("Loca");
              var u = new AmbientLight({ color: "#fff", intensity: 0.5 }),
                f = new DirectionalLight({
                  color: "rgb(255,255,255)",
                  position: [0, -1, 1],
                  target: [0, 0, 0],
                  intensity: 0.5,
                }),
                c = new PointLight({
                  color: "rgb(255,255,255)",
                  position: [0, 0, 1e4],
                  intensity: 1,
                  distance: 0,
                });
              return (
                (u.loca = f.loca = c.loca = _assertThisInitialized(o)),
                (o.nA = { ambLight: u, dirLight: f, pointLight: c }),
                o.animate.on("start", function () {
                  return (o.animateStatus = "start");
                }),
                o.animate.on("pause", function () {
                  return (o.animateStatus = "pause");
                }),
                o.animate.on("stop", function () {
                  return (o.animateStatus = "stop");
                }),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.Up = function () {
                if (this.map) {
                  var a =
                    (this.map.getGL && this.map.getGL()) ||
                    this.map.getContext().gl;
                  if (a) {
                    var o = this;
                    REGL__default.default({
                      gl: a,
                      extensions: [
                        "OES_element_index_uint",
                        "ANGLE_instanced_arrays",
                      ],
                      onDone: function (l, u) {
                        if (l) console.error(l);
                        else {
                          o.regl = u;
                          var f = o.map.getContext();
                          f && f.setDirty(), o.requestRender();
                        }
                      },
                    }),
                      this.map.on("firstPaint", function () {
                        var l = o.map.getContext();
                        l && l.setDirty();
                      });
                  }
                }
              }),
              (s.requestRender = function () {
                this.map && this.map.render();
              }),
              (s.add = function (a) {
                if (this.map) {
                  var o = this.layers.some(function (l) {
                    return l.id === a.id;
                  });
                  o ||
                    (this.layers.push(a),
                    a.setLoca(this),
                    a.sA(this.lights, this),
                    this.map.add(a.Yp));
                }
              }),
              (s.remove = function (a) {
                if (this.map) {
                  var o = this.layers.findIndex(function (l) {
                    return l.id === a.id;
                  });
                  o > -1 &&
                    (this.layers.splice(o, 1),
                    this.map.remove(a.Yp),
                    a.Ar(),
                    a.setLoca(null));
                }
              }),
              (s.clear = function () {
                if (this.map) {
                  var a = !0,
                    o = !1,
                    l = void 0;
                  try {
                    for (
                      var u = this.layers[Symbol.iterator](), f;
                      !(a = (f = u.next()).done);
                      a = !0
                    ) {
                      var c = f.value;
                      this.map.remove(c.Yp), c.Ar(), c.setLoca(null);
                    }
                  } catch (h) {
                    (o = !0), (l = h);
                  } finally {
                    try {
                      !a && u.return != null && u.return();
                    } finally {
                      if (o) throw l;
                    }
                  }
                  this.layers.splice(0, this.layers.length), this.clearLight();
                }
              }),
              (s.getControlContainer = function () {
                return this.Dp;
              }),
              (s.getCenter = function () {
                return this.map.getCenter().toArray();
              }),
              (s.getZoom = function () {
                return this.map.getZoom();
              }),
              (s.getPitch = function () {
                return this.map.getPitch();
              }),
              (s.getRotation = function () {
                return this.map.getRotation();
              }),
              (s.setRotation = function (a) {
                this.map.setRotation(a, !0);
              }),
              (s.setZoom = function (a) {
                this.map.setZoom(a, !0);
              }),
              (s.setCenter = function (a) {
                this.map.setCenter(a, !0);
              }),
              (s.setPitch = function (a) {
                this.map.setPitch(a, !0);
              }),
              (s.getLights = function () {
                var a = this.ambLight,
                  o = a.intensity,
                  l = a.color,
                  u = this.dirLight,
                  f = u.intensity,
                  c = u.color,
                  h = u.target,
                  p = u.position,
                  d = [h[0] - p[0], h[1] - p[1], h[2] - p[2]],
                  m = this.pointLight,
                  g = m.intensity,
                  v = m.color,
                  y = m.position,
                  _ = m.distance,
                  b = this.customCoords.lngLatToCoord(y);
                return {
                  ambIntensity: o,
                  ambLightColor: ColorUtil$1.zC(l).slice(0, 3),
                  dirIntensity: f,
                  dirLightColor: ColorUtil$1.zC(c).slice(0, 3),
                  dirVec: _toConsumableArray(d),
                  pointIntensity: g,
                  pointLightColor: ColorUtil$1.zC(v).slice(0, 3),
                  pointPosition: [b[0], b[1], y[2]],
                  aA: _,
                };
              }),
              (s.addLight = function (a) {
                a.loca || (a.loca = this),
                  this.rA.includes(a) || this.rA.push(a),
                  (this.oA |= NewLight);
                var o = !0,
                  l = !1,
                  u = void 0;
                try {
                  for (
                    var f = this.layers[Symbol.iterator](), c;
                    !(o = (c = f.next()).done);
                    o = !0
                  ) {
                    var h = c.value;
                    h.sA(this.lights, this);
                  }
                } catch (p) {
                  (l = !0), (u = p);
                } finally {
                  try {
                    !o && f.return != null && f.return();
                  } finally {
                    if (l) throw u;
                  }
                }
                this.requestRender();
              }),
              (s.removeLight = function (a) {
                var o = this.rA.indexOf(a);
                if (!(o < 0)) {
                  this.rA.splice(o, 1), this.rA.length || (this.oA ^= NewLight);
                  var l = !0,
                    u = !1,
                    f = void 0;
                  try {
                    for (
                      var c = this.layers[Symbol.iterator](), h;
                      !(l = (h = c.next()).done);
                      l = !0
                    ) {
                      var p = h.value;
                      p.sA(this.lights, this);
                    }
                  } catch (d) {
                    (u = !0), (f = d);
                  } finally {
                    try {
                      !l && c.return != null && c.return();
                    } finally {
                      if (u) throw f;
                    }
                  }
                  this.requestRender();
                }
              }),
              (s.clearLight = function () {
                (this.rA = []), (this.nA = {});
                var a = !0,
                  o = !1,
                  l = void 0;
                try {
                  for (
                    var u = this.layers[Symbol.iterator](), f;
                    !(a = (f = u.next()).done);
                    a = !0
                  ) {
                    var c = f.value;
                    c.sA(this.lights, this);
                  }
                } catch (h) {
                  (o = !0), (l = h);
                } finally {
                  try {
                    !a && u.return != null && u.return();
                  } finally {
                    if (o) throw l;
                  }
                }
                (this.oA = DefaultLight), this.requestRender();
              }),
              (s.destroy = function () {
                this.animate.stop(),
                  this.rendererManager.destroyRenderers(),
                  this.fusionManager.destroyFusions();
                for (var a = 0; this.layers.length > 0; a = 0) {
                  var o = this.layers[a];
                  o.destroy();
                }
                this.regl.destroy(), this.animate.destroy();
                var l = this.map.getContainer();
                l && l.removeChild(this.Dp),
                  (this.map = null),
                  (this.animate = null);
              }),
              (s.qp = function () {
                var a = this;
                this.animate.on("update", function () {
                  a.requestRender();
                });
              }),
              _createClass(i, [
                {
                  key: "ambLight",
                  get: function () {
                    return this.nA.ambLight.rawproperty;
                  },
                  set: function (a) {
                    var o = new AmbientLight(a);
                    (o.loca = this),
                      (this.oA |= LagacyLight),
                      (this.nA.ambLight = o);
                  },
                },
                {
                  key: "dirLight",
                  get: function () {
                    return this.nA.dirLight.rawproperty;
                  },
                  set: function (a) {
                    var o = new DirectionalLight(a);
                    (o.loca = this),
                      (this.oA |= LagacyLight),
                      (this.nA.dirLight = o);
                  },
                },
                {
                  key: "pointLight",
                  get: function () {
                    return this.nA.pointLight.rawproperty;
                  },
                  set: function (a) {
                    var o = new PointLight(a);
                    (o.loca = this),
                      (this.oA |= LagacyLight),
                      (this.nA.pointLight = o);
                  },
                },
                {
                  key: "lights",
                  get: function () {
                    var a = this.nA,
                      o = a.ambLight,
                      l = a.dirLight,
                      u = a.pointLight;
                    return this.oA === (NewLight | LagacyLight)
                      ? [o, l, u]
                          .concat(_toConsumableArray(this.rA))
                          .filter(Boolean)
                      : this.oA === LagacyLight || this.oA === DefaultLight
                      ? [o, l, u].filter(Boolean)
                      : this.rA;
                  },
                },
              ]),
              i
            );
          })(Map$1),
          Animation$1 = Loca.Animation,
          Clip = Loca.Clip,
          legendColor = {
            title: {
              label: "\u56FE\u4F8B",
              fontColor: "#fff",
              fontSize: "20px",
              fontWeight: "bold",
              padding: "0 0 5px 0",
              margin: 0,
            },
            style: {
              backgroundColor: "rgba(0,0,0,0.7)",
              fontSize: "14px",
              size: "16px",
              fontColor: "#fff",
              borderRadius: 0,
              position: "absolute",
              padding: "10px 15px",
            },
            dataMap: [
              { label: "\u7B2C\u4E00\u4E2A", color: "#feedde" },
              { label: "\u7B2C\u4E8C\u4E2A", color: "#fdbe85" },
              { label: "\u7B2C\u4E09\u4E2A", color: "#fd8d3c" },
              { label: "\u7B2C\u56DB\u4E2A", color: "#e6550d" },
              { label: "\u7B2C\u4E94\u4E2A", color: "#a63603" },
            ],
          },
          Legend = (function () {
            function r(i) {
              _classCallCheck(this, r),
                (this.$p = null),
                (this.Kp = {}),
                (this.tm = {}),
                (this.$p = i.loca),
                (this.nm = this.$p && this.$p.getControlContainer()),
                (this.lr = document.createElement("div")),
                (this.im = i.dataMap || legendColor.dataMap),
                this.setStyle(i),
                this.addTo(this.$p),
                buryPoint.record("Legend");
            }
            var n = r.prototype;
            return (
              (n.om = function () {
                var i = this,
                  s,
                  a,
                  o = document.createElement("h5");
                (o.innerHTML = this.tm.label),
                  (o.style.cssText = "color: "
                    .concat(this.tm.fontColor, ";font-size: ")
                    .concat(this.tm.fontSize, ";text-align: ")
                    .concat(this.tm.textAlign, ";font-weight: ")
                    .concat(this.tm.fontWeight, ";padding: ")
                    .concat(this.tm.padding, ";margin: ")
                    .concat(this.tm.margin, ";"));
                var l = document.createElement("ul");
                l.style.cssText = "margin: 0; padding: 0; list-style: none;";
                var u = "";
                this.im.forEach(function (f) {
                  u += '\n                <li style="height: '
                    .concat(
                      i.Kp.size,
                      '; box-sizing: content-box; padding: 2px 0;" ><span style="background-color: '
                    )
                    .concat(f.color, "; float:left; width: ")
                    .concat(i.Kp.size, "; height: ")
                    .concat(
                      i.Kp.size,
                      ';"></span><a style="float:left; height: '
                    )
                    .concat(i.Kp.size, "; line-height: ")
                    .concat(
                      i.Kp.size,
                      "; text-align: left; padding-left: 10px; font-size: "
                    )
                    .concat(i.Kp.fontSize, "; color: ")
                    .concat(i.Kp.fontColor, ';">')
                    .concat(f.label, "</a></li>\n            ");
                }),
                  (l.innerHTML = u),
                  (this.lr.innerHTML = ""),
                  (s = this.lr) == null || s.appendChild(o),
                  (a = this.lr) == null || a.appendChild(l);
              }),
              (n.setStyle = function () {
                var i =
                    arguments.length > 0 && arguments[0] !== void 0
                      ? arguments[0]
                      : { style: {}, title: {} },
                  s,
                  a,
                  o,
                  l,
                  u,
                  f,
                  c,
                  h,
                  p = legendColor.style,
                  d = i.style || {};
                (this.Kp.backgroundColor =
                  d.backgroundColor ||
                  this.Kp.backgroundColor ||
                  p.backgroundColor),
                  (this.Kp.borderRadius =
                    d.borderRadius || this.Kp.borderRadius || p.borderRadius),
                  (this.Kp.fontColor =
                    d.fontColor || this.Kp.fontColor || p.fontColor),
                  (this.Kp.fontSize =
                    d.fontSize || this.Kp.fontSize || p.fontSize),
                  (this.Kp.size = d.size || this.Kp.size || p.size),
                  (this.Kp.position =
                    d.position || this.Kp.position || p.position),
                  (this.Kp.padding = d.padding || this.Kp.padding || p.padding),
                  (this.Kp.bottom = d.bottom || ""),
                  (this.Kp.right = d.right || ""),
                  (this.Kp.left = d.left || ""),
                  (this.Kp.top = d.top || "");
                var m = legendColor.title,
                  g = i.title || {};
                (this.tm.label = g.label || this.tm.label || m.label),
                  (this.tm.fontColor =
                    g.fontColor || this.tm.fontColor || m.fontColor),
                  (this.tm.fontSize =
                    g.fontSize || this.tm.fontSize || m.fontSize),
                  (this.tm.fontWeight =
                    g.fontWeight || this.tm.fontWeight || m.fontWeight),
                  (this.tm.padding = g.padding || this.tm.padding || m.padding),
                  (this.tm.margin = g.margin || this.tm.margin || m.margin),
                  (s = this.lr) == null ||
                    s.style.setProperty(
                      "background-color",
                      this.Kp.backgroundColor
                    ),
                  (a = this.lr) == null ||
                    a.style.setProperty("border-radius", this.Kp.borderRadius),
                  (o = this.lr) == null ||
                    o.style.setProperty("position", this.Kp.position),
                  (l = this.lr) == null ||
                    l.style.setProperty("padding", this.Kp.padding),
                  (u = this.lr) == null ||
                    u.style.setProperty("bottom", this.Kp.bottom),
                  (f = this.lr) == null ||
                    f.style.setProperty("right", this.Kp.right),
                  (c = this.lr) == null ||
                    c.style.setProperty("left", this.Kp.left),
                  (h = this.lr) == null ||
                    h.style.setProperty("top", this.Kp.top),
                  this.om();
              }),
              (n.addTo = function (i) {
                var s;
                !i ||
                  ((this.$p = i),
                  (this.nm = i.getControlContainer()),
                  this.lr && ((s = this.nm) == null || s.appendChild(this.lr)));
              }),
              (n.remove = function () {
                var i;
                this.lr && ((i = this.nm) == null || i.removeChild(this.lr)),
                  (this.nm = null),
                  (this.$p = null);
              }),
              r
            );
          })(),
          RenderUtil = {
            getMipMap: function r(n, i) {
              var s = {
                  mipmap: "nice",
                  min: "nearest mipmap linear",
                  mag: "linear",
                  wrapS: "repeat",
                  wrapT: "repeat",
                },
                a = Math.log2(n),
                o = Math.log2(i);
              return a === ~~a && o === ~~o
                ? s
                : { min: "linear", mag: "linear" };
            },
            getBlend: function r() {
              var n =
                  arguments.length > 0 && arguments[0] !== void 0
                    ? arguments[0]
                    : "normal",
                i = {
                  normal: {
                    srcRGB: "src alpha",
                    srcAlpha: 1,
                    dstRGB: "one minus src alpha",
                    dstAlpha: "one minus src alpha",
                  },
                  lighter: { srcRGB: 1, srcAlpha: 1, dstRGB: 1, dstAlpha: 1 },
                  darker: {
                    srcRGB: "dst color",
                    srcAlpha: 1,
                    dstRGB: "dst color",
                    dstAlpha: 1,
                  },
                  zero: { srcRGB: 0, srcAlpha: 0, dstRGB: 0, dstAlpha: 0 },
                };
              return i[n];
            },
            getBezier: function r() {
              var n =
                "\n            // \u4E8C\u6B21\n            float QuadraticIn (float k) {\n                return pow(k, 2.);\n            }\n            float QuadraticOut (float k) {\n                return k * (2.0 - k);\n            }\n            float QuadraticInOut (float k) {\n                if ((k *= 2.0) < 1.0) {\n                    return 0.5 * k * k;\n                }\n                return -0.5 * (--k * (k - 2.0) - 1.0);\n            }\n\n            // \u4E09\u6B21\n            float CubicIn (float k) {\n                return pow(k, 3.);\n            }\n            float CubicOut (float k) {\n                return pow(--k, 3.) + 1.0;\n            }\n            float CubicInOut (float k) {\n                if ((k *= 2.0) < 1.0) {\n                    return 0.5 * pow(k, 3.);\n                }\n                return 0.5 * ((k -= 2.0) * k * k + 2.0);\n            }\n\n            // \u56DB\u6B21\n            float QuarticIn (float k) {\n                return pow(k, 4.);\n            }\n            float QuarticOut (float k) {\n                return 1.0 - (pow(--k, 4.));\n            }\n            float QuarticInOut (float k) {\n                if ((k *= 2.0) < 1.0) {\n                    return 0.5 * pow(k, 4.);\n                }\n                return 0.5 * ((k -= 2.0) * pow(k, 3.) + 2.0);\n            }\n\n            // \u4E94\u6B21\n            float QuinticIn (float k) {\n                return pow(k, 5.);\n            }\n            float QuinticOut (float k) {\n                return 1.0 - (pow(--k, 5.));\n            }\n            float QuinticInOut (float k) {\n                if ((k *= 2.0) < 1.0) {\n                    return 0.5 * pow(k, 5.);\n                }\n                return 0.5 * ((k -= 2.0) * pow(k, 4.) + 2.0);\n            }\n\n            // \u516D\u6B21\n            float SinusoidalIn (float k) {\n                float pi = 3.14159265;\n                return 1.0 - cos(k * pi / 2.0);\n            }\n            float SinusoidalOut (float k) {\n                float pi = 3.14159265;\n                return sin(k * pi / 2.0);\n            }\n            float SinusoidalInOut (float k) {\n                float pi = 3.14159265;\n                return 0.5 * (1.0 - cos(pi * k));\n            }\n\n            // \u4E03\u6B21\n            float ExponentialIn (float k) {\n                return k == 0.0 ? 0.0 : pow(1024.0, k - 1.0);\n            }\n            float ExponentialOut (float k) {\n                return k == 1.0 ? 1.0 : 1.0 - pow(2.0, -10.0 * k);\n            }\n            float ExponentialInOut (float k) {\n                // if (k == 0.0) {\n                //     return 0.0;\n                // }\n                // if (k == 1.0) {\n                //     return 1.0;\n                // }\n                if ((k *= 2.0) < 1.0) {\n                    return 0.5 * pow(1024.0, k - 1.0);\n                }\n                return 0.5 * (-pow(2.0, -10.0 * (k - 1.0)) + 2.0);\n            }\n\n            // \u516B\u6B21\n            float CircularIn (float k) {\n                return 1.0 - sqrt(1.0 - k * k);\n            }\n            float CircularOut (float k) {\n                return sqrt(1.0 - (--k * k));\n            }\n            float CircularInOut (float k) {\n                if ((k *= 2.0) < 1.0) {\n                    return -0.5 * (sqrt(1.0 - k * k) - 1.0);\n                }\n                return 0.5 * (sqrt(1.0 - (k -= 2.0) * k) + 1.0);\n            }\n\n            // \u4E5D\u6B21\n            float ElasticIn (float k) {\n                float pi = 3.14159265;\n                float s;\n                float a = 0.1;\n                float p = 0.4;\n                // if (k == 0.0) {\n                //     return 0.0;\n                // }\n                // if (k == 1.0) {\n                //     return 1.0;\n                // }\n                if (a < 1.0) {\n                    a = 1.0;\n                    s = p / 4.0;\n                } else {\n                    s = p * asin(1.0 / a) / (2.0 * pi);\n                }\n                // return pow(2.0, 10.0 * (k -= 1.0));\n                return -(a * pow(2.0, 10.0 * (k -= 1.0)) * sin((k - s) * (2.0 * pi) / p));\n            }\n            float ElasticOut (float k) {\n                float pi = 3.14159265;\n                float s;\n                float a = 0.1;\n                float p = 0.4;\n                // if (k == 0.0) {\n                //     return 0.0;\n                // }\n                // if (k == 1.0) {\n                //     return 1.0;\n                // }\n                if (a < 1.0) {\n                    a = 1.0;\n                    s = p / 4.0;\n                } else {\n                    s = p * asin(1.0 / a) / (2.0 * pi);\n                }\n                return (a * pow(2.0, -10.0 * k) * sin((k - s) * (2.0 * pi) / p) + 1.0);\n            }\n            float ElasticInOut (float k) {\n                float pi = 3.14159265;\n                float s;\n                float a = 0.1;\n                float p = 0.4;\n                // if (k == 0.0) {\n                //     return 0.0;\n                // }\n                // if (k == 1.0) {\n                //     return 1.0;\n                // }\n                if (a < 1.0) {\n                    a = 1.0;\n                    s = p / 4.0;\n                } else {\n                    s = p * asin(1.0 / a) / (2.0 * pi);\n                }\n                if ((k *= 2.0) < 1.0) {\n                    return -0.5 * (a * pow(2.0, 10.0 * (k -= 1.0)) * sin((k - s) * (2.0 * pi) / p));\n                }\n                return a * pow(2.0, -10.0 * (k -= 1.0)) * sin((k - s) * (2.0 * pi) / p) * 0.5 + 1.0;\n            }\n\n            // \u56DE\u5F39\n            float BackIn (float k) {\n                float s = 1.70158;\n                return pow(k, 2.) * ((s + 1.0) * k - s);\n            }\n            float BackOut (float k) {\n                float s = 1.70158;\n                return pow(--k, 2.) * ((s + 1.0) * k + s) + 1.0;\n            }\n            float BackInOut (float k) {\n                float s = 1.70158 * 1.525;\n                if ((k *= 2.0) < 1.0) {\n                    return 0.5 * (pow(k, 2.) * ((s + 1.0) * k - s));\n                }\n                return 0.5 * ((k -= 2.0) * k * ((s + 1.0) * k + s) + 2.0);\n            }\n\n            // \u53CD\u590D\u6A2A\u8DF3\n            float BounceOut (float k) {\n                if (k < (1.0 / 2.75)) {\n                    return 7.5625 * k * k;\n                } else if (k < (2.0 / 2.75)) {\n                    return 7.5625 * (k -= (1.5 / 2.75)) * k + 0.75;\n                } else if (k < (2.5 / 2.75)) {\n                    return 7.5625 * (k -= (2.25 / 2.75)) * k + 0.9375;\n                } else {\n                    return 7.5625 * (k -= (2.625 / 2.75)) * k + 0.984375;\n                }\n            }\n            float BounceIn (float k) {\n                return 1.0 - BounceOut(1.0 - k);\n            }\n            float BounceInOut (float k) {\n                if (k < 0.5) {\n                    return BounceIn(k * 2.0) * 0.5;\n                }\n                return BounceOut(k * 2.0 - 1.0) * 0.5 + 0.5;\n            }\n            float getBezier(int type, float delayTime, float transformTime, float timer) {\n                if(type == 0) {\n                    return QuadraticIn(timer);\n                } else if(type == 1) {\n                    return QuadraticOut(timer);\n                } else if(type == 2) {\n                    return QuadraticInOut(timer);\n                } else if(type == 3) {\n                    return CubicIn(timer);\n                } else if(type == 4) {\n                    return CubicOut(timer);\n                } else if(type == 5) {\n                    return CubicInOut(timer);\n                } else if(type == 6) {\n                    return QuarticIn(timer);\n                } else if(type == 7) {\n                    return QuarticOut(timer);\n                } else if(type == 8) {\n                    return QuarticInOut(timer);\n                } else if(type == 9) {\n                    return QuinticIn(timer);\n                } else if(type == 10) {\n                    return QuinticOut(timer);\n                } else if(type == 11) {\n                    return QuinticInOut(timer);\n                } else if(type == 12) {\n                    return SinusoidalIn(timer);\n                } else if(type == 13) {\n                    return SinusoidalOut(timer);\n                } else if(type == 14) {\n                    return SinusoidalInOut(timer);\n                } else if(type == 15) {\n                    return ExponentialIn(timer);\n                } else if(type == 16) {\n                    return ExponentialOut(timer);\n                } else if(type == 17) {\n                    return ExponentialInOut(timer);\n                } else if(type == 18) {\n                    return CircularIn(timer);\n                } else if(type == 19) {\n                    return CircularOut(timer);\n                } else if(type == 20) {\n                    return CircularInOut(timer);\n                } else if(type == 21) {\n                    return ElasticIn(timer);\n                } else if(type == 22) {\n                    return ElasticOut(timer);\n                } else if(type == 23) {\n                    return ElasticInOut(timer);\n                } else if(type == 24) {\n                    return BackIn(timer);\n                } else if(type == 25) {\n                    return BackOut(timer);\n                } else if(type == 26) {\n                    return BackInOut(timer);\n                } else if(type == 27) {\n                    return BounceIn(timer);\n                } else if(type == 28) {\n                    return BounceOut(timer);\n                } else if(type == 29) {\n                    return BounceInOut(timer);\n                } else {\n                    return timer;\n                }\n            }";
              return n.replace(/\/\/.*\n/g, "").replace(/\s\s+/g, "");
            },
            getScaleType: function r(n) {
              return "\n            uniform vec4 "
                .concat(
                  n,
                  "Time; // time/delay/trasform/random\n            uniform vec4 "
                )
                .concat(
                  n,
                  "Type; // type/repeat/yoyo/duration\n            uniform vec2 "
                )
                .concat(n, "Value; // start/end\n            float ")
                .concat(
                  n,
                  "ScaleValue(float sule) {\n                bool isYoyoDuration = "
                )
                .concat(n, "Type.z == 1.0 && mod(ceil(")
                .concat(n, "Time.x / ")
                .concat(
                  n,
                  "Type.w), 2.0) == 0.0;\n                bool isYoyoLast = mod("
                )
                .concat(n, "Type.y, 2.0) == 0.0 && ")
                .concat(
                  n,
                  "Type.z == 1.0;\n                float timer = 0.0;\n                float vs = "
                )
                .concat(n, "Value.x;\n                float ve = ")
                .concat(n, "Value.y;\n                if(")
                .concat(
                  n,
                  "Time.w == 0.0) {\n                    timer = fract("
                )
                .concat(n, "Time.x / ")
                .concat(
                  n,
                  "Type.w);\n                    // \u6700\u540E\u4E00\u8F6E,\u7ED3\u675F\n                    if("
                )
                .concat(n, "Time.x >= ")
                .concat(n, "Type.y * ")
                .concat(
                  n,
                  "Type.w) {\n                        if(isYoyoLast) {\n                            return 0.0;\n                        }\n                        return 1.0;\n                    }\n                    if(isYoyoDuration) {\n                        timer = 1.0 - timer;\n                    }\n                    float t = getBezier(int("
                )
                .concat(n, "Type.x), 0.0, ")
                .concat(
                  n,
                  "Type.w, timer);\n                    return t * (ve - vs) + vs;\n                }\n\n                float randomDelay = (sin(length(sule)) + 1.0) / 2.0 * "
                )
                .concat(n, "Time.y;\n                timer = (")
                .concat(n, "Time.x - randomDelay) / ")
                .concat(
                  n,
                  "Time.z;\n                // \u7B2C\u4E00\u8F6E\n                if(timer < 0.0) {\n                    return 0.0;\n                } else if("
                )
                .concat(n, "Time.x >= randomDelay + ")
                .concat(n, "Type.y * ")
                .concat(
                  n,
                  "Time.z) {\n                    // \u6700\u540E\u4E00\u8F6E,\u7ED3\u675F\n                    if(isYoyoLast) {\n                        return 0.0;\n                    }\n                    return 1.0;\n                } else {\n                    if("
                )
                .concat(
                  n,
                  "Type.z == 1.0 && mod(ceil(timer), 2.0) == 0.0) {\n                        timer = 1.0 - fract(timer);\n                    } else {\n                        timer = fract(timer);\n                    }\n                    float t = getBezier(int("
                )
                .concat(n, "Type.x), ")
                .concat(n, "Time.y, ")
                .concat(
                  n,
                  "Time.z, timer);\n                    return t * (ve - vs) + vs;\n                }\n            }\n        "
                )
                .replace(/\/\/.*\n/g, "")
                .replace(/\s\s+/g, "");
            },
            getScaleUniform: function r(n, i) {
              var s;
              return (
                (s = {}),
                _defineProperty(s, n + "Time", i.prop(n + "Time")),
                _defineProperty(s, n + "Type", i.prop(n + "Type")),
                _defineProperty(s, n + "Value", i.prop(n + "Value")),
                s
              );
            },
            getScaleProps: function r(n, i) {
              var s = {};
              if (i) {
                var a = n[i];
                return (
                  (s[i + "Time"] = a.time),
                  (s[i + "Type"] = a.type),
                  (s[i + "Value"] = a.value),
                  s
                );
              }
              for (var o in n) {
                var l = n[o];
                (s[o + "Time"] = l.time),
                  (s[o + "Type"] = l.type),
                  (s[o + "Value"] = l.value);
              }
              return s;
            },
          },
          NotDirty = 0,
          LightDirty = 1,
          AttributesDirty = 2,
          LabelsDirty = 4,
          MeshDirty = AttributesDirty | LabelsDirty,
          MeshesDirty = 8,
          Defines = (function () {
            function r() {
              _classCallCheck(this, r), (this.state = NotDirty);
            }
            return (
              _createClass(r, [
                {
                  key: "isDirty",
                  get: function () {
                    return this.state !== NotDirty;
                  },
                },
              ]),
              r
            );
          })(),
          Shader = (function () {
            function r(i) {
              _classCallCheck(this, r);
              var s = i.vertex,
                a = i.fragment,
                o = i.includes;
              (this.uA = s), (this.fA = a), (this.includes = o || {});
            }
            var n = r.prototype;
            return (
              (n.process = function (i) {
                return (
                  (!(this.lA && this.cA) || i.isDirty) &&
                    ((this.lA = this.hA(i, this.uA)),
                    (this.cA = this.hA(i, this.fA))),
                  { vertex: this.lA, fragment: this.cA }
                );
              }),
              (n.hA = function (i, s) {
                var a = s;
                do {
                  var o = this;
                  a = s.replace(/#include <(.*?)>.*?\n/g, function (u, f) {
                    var c = o,
                      h = f
                        .split(",")
                        .map(function (p) {
                          return p.trim();
                        })
                        .filter(Boolean);
                    return h.reduce(function (p, d) {
                      if (c.includes[d]) return p + c.includes[d] + "\n";
                      throw new Error("include not found: " + d);
                    }, "");
                  });
                } while (a.includes("#include"));
                var l = Object.keys(i).reduce(function (u, f) {
                  return i[f]
                    ? u + "#define ".concat(f, " ").concat(i[f], "\n")
                    : u;
                }, "");
                return l + "\n" + a;
              }),
              r
            );
          })(),
          Layer = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              return (
                (o = n.call(this, a)),
                (o.id = CommonUtil$1.MC()),
                (o.Yp = []),
                (o.styleOptions = {}),
                (o.vA = new Defines()),
                (o.lights = new Array()),
                (o.dA = !1),
                (o.customCenter = [108.9398, 34.3416]),
                (o.colorPick = new ColorPick()),
                (o._needPickFrame = !1),
                (o._pickPos = null),
                (o.um = {}),
                (o.sm = new Loca.Animation()),
                (o.sP = 0),
                (o.fm = 1),
                (o._animateLayerState = o.getInitialAnimateState()),
                (o.customCenter = a.customCenter || o.customCenter),
                (o.dA = a.acceptLight || !1),
                (o.loca = a.loca),
                o.loca && ((o.map = a.loca.map), o.onAdd()),
                (o.projection = ProjectInstance),
                (o.vA.ACCEPT_LIGHT = o.dA),
                o.sm.addClip(new Loca.Clip({ duration: 1e4, repeat: 1 / 0 }), {
                  x: [0, 1],
                }),
                o.sm.start(),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.getInitialAnimateState = function () {
                return {};
              }),
              (s.onAdd = function () {
                var a;
                _get(_getPrototypeOf(i.prototype), "onAdd", this).call(this),
                  this.map &&
                    this.loca &&
                    (this.loca.add(this),
                    this.loca.requestRender(),
                    (a = this.ll) == null || a.p$(this));
              }),
              (s.sA = function (a, o) {
                (this.vA.HAS_LIGHTS = a.length > 0),
                  (this.vA.state |= LightDirty);
              }),
              (s.setLoca = function () {
                var a =
                    arguments.length > 0 && arguments[0] !== void 0
                      ? arguments[0]
                      : null,
                  o = this.loca;
                (this.loca = a),
                  (this.map = a ? (a == null ? void 0 : a.map) : null),
                  this.onAdd(),
                  o && o.requestRender();
              }),
              (s.AC = function (a) {
                if (window.AMap) {
                  var o = this,
                    l = new window.AMap.GLCustomLayer({
                      zIndex: a.zIndex,
                      visible: a.visible,
                      zooms: a.zooms,
                      render: function () {
                        o.render();
                      },
                    });
                  (l.beforeRender = this.beforeRender.bind(this)),
                    (l.afterRender = this.afterRender.bind(this)),
                    this.Yp.push(l),
                    this.map && this.map.add(l);
                }
              }),
              (s.getLayerOptions = function () {
                return {
                  opacity: this.opacity,
                  zooms: this.zooms,
                  visible: this.visible,
                  zIndex: this.zIndex,
                };
              }),
              (s.setOpacity = function () {
                var a =
                  arguments.length > 0 && arguments[0] !== void 0
                    ? arguments[0]
                    : 1;
                (this.opacity = a), this.loca && this.loca.requestRender();
              }),
              (s.setzIndex = function () {
                var a =
                  arguments.length > 0 && arguments[0] !== void 0
                    ? arguments[0]
                    : 10;
                (this.zIndex = a),
                  this.Yp.forEach(function (o) {
                    o.setzIndex(a);
                  }),
                  this.loca && this.loca.requestRender();
              }),
              (s.setZooms = function () {
                var a =
                  arguments.length > 0 && arguments[0] !== void 0
                    ? arguments[0]
                    : [2, 20];
                (this.zooms = a),
                  this.Yp.forEach(function (o) {
                    o.setZooms(a);
                  }),
                  this.loca && this.loca.requestRender();
              }),
              (s.show = function () {
                var a =
                    arguments.length > 0 && arguments[0] !== void 0
                      ? arguments[0]
                      : 0,
                  o = arguments.length > 1 ? arguments[1] : void 0,
                  l = this,
                  u;
                if (
                  ((u = this.ll) == null || u.O$(this),
                  (this.visible = !0),
                  this.Yp.forEach(function (c) {
                    c.show();
                  }),
                  a <= 0)
                ) {
                  (this.fm = 1), this.loca && this.loca.requestRender();
                  return;
                }
                this.fm = 0;
                var f = new Loca.Clip({ duration: a }, { opacity: [0, 1] });
                this.sm.addClip(f),
                  f.on("update", function (c) {
                    (l.fm = c.keyframe.opacity),
                      l.loca && l.loca.requestRender();
                  }),
                  f.on("complete", function () {
                    var c = l;
                    l.sm.removeClip(f),
                      requestAnimationFrame(function () {
                        o && o.call(c);
                      });
                  }),
                  this.sm.start();
              }),
              (s.hide = function () {
                var a =
                    arguments.length > 0 && arguments[0] !== void 0
                      ? arguments[0]
                      : 0,
                  o = arguments.length > 1 ? arguments[1] : void 0,
                  l = this,
                  u;
                if (((u = this.ll) == null || u.k$(this), a <= 0)) {
                  (this.visible = !1),
                    (this.fm = 0),
                    this.Yp.forEach(function (c) {
                      c.hide();
                    }),
                    this.loca && this.loca.requestRender();
                  return;
                }
                this.fm = 1;
                var f = new Loca.Clip({ duration: a }, { opacity: [1, 0] });
                this.sm.addClip(f),
                  f.on("update", function (c) {
                    (l.fm = c.keyframe.opacity),
                      l.loca && l.loca.requestRender();
                  }),
                  f.on("complete", function () {
                    var c = l;
                    (l.visible = !1),
                      l.Yp.forEach(function (h) {
                        h.hide();
                      }),
                      l.sm.removeClip(f),
                      requestAnimationFrame(function () {
                        o && o.call(c);
                      });
                  }),
                  this.sm.start();
              }),
              (s.setCustomCenter = function (a) {
                (this.customCenter = a), this.loca && this.loca.requestRender();
              }),
              (s.beforeRender = function () {
                if (!(!this.loca || !this.loca.regl)) {
                  var a = this.loca.regl;
                  this.aP(a),
                    this.loca.customCoords.setCenter(this.customCenter);
                }
              }),
              (s.remove = function () {
                var a;
                this.map &&
                  this.loca &&
                  ((a = this.loca) == null || a.remove(this),
                  (this.loca = null),
                  (this.map = null));
              }),
              (s.destroy = function () {
                var a;
                (a = this.ll) == null || a.destroy(),
                  this.remove(),
                  this.sm.destroy(),
                  (this.styleOptions = null),
                  (this.fusion = null),
                  (this.ll = null),
                  (this.dataset = []),
                  (this.meshes = []),
                  (this.source = null);
              }),
              (s.queryFeature = function (a) {
                var o, l, u;
                if (
                  (buryPoint.record(this.CLASS_NAME, "queryFeature"),
                  !!this.dm() &&
                    ((this._needPickFrame = !0), !(!this._pickFbo || !a)))
                ) {
                  this._pickPos = a;
                  var f = (o = this.loca) == null ? void 0 : o.regl,
                    c = this.pickRender(),
                    h = f._gl,
                    p = h.drawingBufferHeight / h.canvas.clientHeight,
                    d = a[0] * p,
                    m = h.drawingBufferHeight - a[1] * p,
                    g = new Uint8Array(4);
                  h.bindFramebuffer(
                    h.FRAMEBUFFER,
                    this._pickFbo._framebuffer.framebuffer
                  ),
                    h.readPixels(d, m, 1, 1, h.RGBA, h.UNSIGNED_BYTE, g);
                  var v =
                    typeof c == "function"
                      ? c(g)
                      : this.colorPick.jf([g[0], g[1], g[2], g[3]]);
                  return (
                    h.bindFramebuffer(h.FRAMEBUFFER, null),
                    (this._needPickFrame = !1),
                    (this._pickPos = null),
                    (l = this.loca) != null &&
                      l.map.getContext() &&
                      ((u = this.loca) == null ||
                        u.map.getContext().setDirty()),
                    v
                  );
                }
              }),
              (s.addAnimate = function (a, o) {
                var l = this;
                buryPoint.record(this.CLASS_NAME, "addAnimate");
                var u = 0,
                  f = {
                    Linear: -1,
                    QuadraticIn: u,
                    QuadraticOut: ++u,
                    QuadraticInOut: ++u,
                    CubicIn: ++u,
                    CubicOut: ++u,
                    CubicInOut: ++u,
                    QuarticIn: ++u,
                    QuarticOut: ++u,
                    QuarticInOut: ++u,
                    QuinticIn: ++u,
                    QuinticOut: ++u,
                    QuinticInOut: ++u,
                    SinusoidalIn: ++u,
                    SinusoidalOut: ++u,
                    SinusoidalInOut: ++u,
                    ExponentialIn: ++u,
                    ExponentialOut: ++u,
                    ExponentialInOut: ++u,
                    CircularIn: ++u,
                    CircularOut: ++u,
                    CircularInOut: ++u,
                    ElasticIn: ++u,
                    ElasticOut: ++u,
                    ElasticInOut: ++u,
                    BackIn: ++u,
                    BackOut: ++u,
                    BackInOut: ++u,
                    BounceIn: ++u,
                    BounceOut: ++u,
                    BounceInOut: ++u,
                  },
                  c = Date.now(),
                  h = c;
                (a.random = a.random === void 0 ? !1 : !!a.random),
                  (a.repeat = a.repeat === void 0 ? 1 : a.repeat);
                var p = new Loca.Clip(
                  {
                    duration: a.random ? a.transform : a.duration,
                    easing: a.easing,
                    repeat: a.repeat,
                    startAt: a.startAt,
                    yoyo: a.yoyo,
                  },
                  _defineProperty({}, a.key, a.value)
                );
                this.sm.addClip(p),
                  p.on("update", function () {
                    (c = Date.now() - h),
                      (l._animateLayerState[a.key] = {
                        time: [c, a.delay, a.transform, +a.random],
                        type: [f[a.easing], +a.repeat, +a.yoyo, +a.duration],
                        value: a.value,
                      }),
                      l.loca && l.loca.requestRender();
                  }),
                  p.on("complete", function () {
                    if (a.random && a.delay > 0) {
                      var d = l,
                        m = new Loca.Clip(
                          { duration: a.delay },
                          { delayTime: [0, 1] }
                        );
                      l.sm.addClip(m),
                        m.on("update", function () {
                          (c = Date.now() - h),
                            (d._animateLayerState[a.key] = {
                              time: [c, a.delay, a.transform, +a.random],
                              type: [
                                f[a.easing],
                                +a.repeat,
                                +a.yoyo,
                                +a.duration,
                              ],
                              value: a.value,
                            }),
                            d.loca && d.loca.requestRender();
                        }),
                        m.on("complete", function () {
                          (c = 0), d.sm.removeClip(m), o && o.call(d);
                        });
                    } else (c = 0), l.sm.removeClip(p), o && o.call(l);
                  }),
                  this.sm.start();
              }),
              (s.clearAnimate = function () {
                buryPoint.record(this.CLASS_NAME, "clearAnimate"),
                  (this._animateLayerState = this.getInitialAnimateState()),
                  this.sm.reset(),
                  this.sm.removeClip(),
                  this.loca && this.loca.requestRender();
              }),
              (s.jC = function () {
                if (!(!this.loca || !this.loca.regl || this._pickFbo)) {
                  var a = this.loca.regl;
                  this._pickFbo = a.framebuffer({
                    width: ~~a._gl.canvas.width,
                    height: ~~a._gl.canvas.height,
                    stencil: !1,
                    depth: !1,
                    Zh: !1,
                  });
                }
              }),
              (s.gm = function (a, o) {
                var l;
                if (
                  !(!this.map && this.loca) &&
                  ((o = o || this.um.size),
                  (a = a || this.um.center),
                  !(!o || !a))
                ) {
                  var u = (l = this.loca) == null ? void 0 : l.regl._gl,
                    f = this.map.getCenter().toArray(),
                    c = u.canvas.width,
                    h = u.canvas.height;
                  (this.um = { center: f, size: [c, h] }),
                    (u.canvas.width = o[0] * window.devicePixelRatio),
                    (u.canvas.height = o[1] * window.devicePixelRatio),
                    (u.canvas.style.width = o[0] + "px"),
                    (u.canvas.style.height = o[1] + "px"),
                    u.viewport(0, 0, u.canvas.width, u.canvas.height),
                    this.map.updateView({ size: o, center: a }, !1);
                }
              }),
              (s._getOpacity = function () {
                return this.fm * this.opacity;
              }),
              (s.dm = function () {
                var a;
                if (!this.loca || !this.visible || this.opacity <= 0) return !1;
                var o = (a = this.loca) == null ? void 0 : a.getZoom();
                return !(o < this.zooms[0] || o > this.zooms[1]);
              }),
              (s.aP = function (a, o) {
                if (this._pickFbo) {
                  var l = a._gl,
                    u = l.canvas;
                  (o ||
                    this._pickFbo.width !== u.width ||
                    this._pickFbo.height !== u.height) &&
                    this._pickFbo({ width: ~~u.width, height: ~~u.height });
                }
              }),
              (s.uP = function (a) {
                if (a)
                  for (var o = 0, l = a.length; o < l; o++) {
                    var u = a[o];
                    if (u.attributes)
                      for (var f in u.attributes) {
                        var c = u.attributes[f];
                        c.destroy && c.destroy(),
                          c.buffer && c.buffer.destroy();
                      }
                  }
              }),
              (s.hP = function () {
                var a;
                return (
                  this.sP >= 1 << 30 && (this.sP = 0),
                  ((a = this.loca) == null ? void 0 : a.animateStatus) ===
                    "start" && this.sP++,
                  this.sP
                );
              }),
              _createClass(i, [
                {
                  key: "acceptLight",
                  get: function () {
                    return this.dA;
                  },
                  set: function (a) {
                    var o;
                    a !== this.dA && (this.vA.state |= LightDirty),
                      (this.vA.ACCEPT_LIGHT = a),
                      (this.dA = a),
                      (o = this.loca) == null || o.requestRender();
                  },
                },
              ]),
              i
            );
          })(Layer$1),
          ColorGLSL = {
            getColor: function r(n) {
              return {
                uniform: { isPick: n.prop("isPick") },
                attribute: { pickColor: n.prop("pickColor") },
              };
            },
            getColorShader: function r() {
              return {
                vertex:
                  "\n                uniform bool isPick;\n                attribute vec4 pickColor;\n                varying vec4 vPickColor;\n            ",
                fragment:
                  "\n                uniform bool isPick;\n                varying vec4 vPickColor;\n            ",
                mainVert:
                  "\n                vPickColor = pickColor;\n            ",
                mainFrag:
                  "\n                if(isPick) {\n                    gl_FragColor = vec4(vPickColor.xyzw / 255.0);\n                }\n            ",
              };
            },
          },
          LightGLSL = {
            getLights: function r(n) {
              return {
                acceptLight: n.prop("acceptLight"),
                ambIntensity: n.prop("ambIntensity"),
                ambLightColor: n.prop("ambLightColor"),
                dirIntensity: n.prop("dirIntensity"),
                dirLightColor: n.prop("dirLightColor"),
                dirVec: n.prop("dirVec"),
                pointIntensity: n.prop("pointIntensity"),
                pointLightColor: n.prop("pointLightColor"),
                pointPosition: n.prop("pointPosition"),
                pointDistence: n.prop("pointDistence"),
                cameraPosition: n.prop("cameraPosition"),
                shininess: n.prop("shininess"),
              };
            },
            NC: function r() {
              return "\n            uniform bool acceptLight;\n            uniform float ambIntensity;\n            uniform vec3 ambLightColor;\n\n            uniform float dirIntensity;\n            uniform vec3 dirLightColor;\n            uniform vec3 dirVec;\n\n            uniform float pointIntensity;\n            uniform float pointDistence;\n            uniform vec3 pointLightColor;\n            uniform vec3 pointPosition;\n            uniform vec3 cameraPosition;\n            uniform float shininess;\n\n            struct DiffHighLight {\n                vec3 diffuse;\n                vec3 hightLight;\n            };\n\n            // \u73AF\u5883\u53CD\u5C04\n            vec3 ambient() {\n                return ambLightColor * ambIntensity;\n            }\n\n            // \u6F2B\u53CD\u5C04\n            vec3 diffuse(\n                vec3 normal,\n                vec3 lightDir,\n                vec3 lightColor,\n                float lightIntensity,\n                float weaken\n            ) {\n                vec3 nNormal = normalize(normal);\n                //\u8BA1\u7B97\u5149\u7EBF\u65B9\u5411\u548C\u6CD5\u5411\u91CF\u7684\u70B9\u79EF\n                float nDotL = max(dot(normalize(lightDir), nNormal), 0.0);\n                //\u8BA1\u7B97\u6F2B\u53CD\u5C04\u5149\u7684\u989C\u8272\n                return lightColor * nDotL * lightIntensity * weaken;\n            }\n\n            // \u955C\u9762\u53CD\u5C04\n            vec3 reflectLight(\n                vec3 cameraPosition,\n                vec3 lightDir,\n                vec3 position,\n                vec3 normal,\n                vec3 lightColor,\n                float shininess,\n                float lightIntensity,\n                float weaken\n            ) {\n                float specularLightWeighting = 0.0;\n                // vec3 lightDir = normalize(lightPosition - position);\n                vec3 cameraDirection = normalize(cameraPosition - position);\n                vec3 reflectionDirection = reflect(-lightDir, normal);\n                specularLightWeighting = pow(max(dot(reflectionDirection, cameraDirection), 0.0), shininess);\n                return lightColor * specularLightWeighting * lightIntensity * weaken;\n            }\n\n            // \u8BA1\u7B97\u8870\u51CF\u91CF\n            float lightWeaken(vec3 lightPosition, vec3 position, float distanceIntensity) {\n                // \u5149\u6E90\u548C\u5F53\u524D\u7684\u8DDD\u79BB\uFF0C\u8BA1\u7B97\u8870\u51CF\n                float dist = distance(lightPosition, position);\n                float weaken = 1.0 / (1.0 + dist + dist * dist);\n                if(distanceIntensity > 0.0) {\n                    weaken = clamp(-dist / distanceIntensity + 1.0, 0.0, 1.0);\n                } else {\n                    weaken = 1.0;\n                }\n                return weaken;\n            }\n\n            // \u8BA1\u7B97\u70B9\u5149\u7684\u6F2B\u53CD\u5C04\u548C\u955C\u9762\u53CD\u5C04\n            DiffHighLight pointLightCalc() {\n                vec3 normal = normalize(vNormal);\n                vec3 lightDir = normalize(pointPosition - vPosition);\n                float weaken = lightWeaken(pointPosition, vPosition, pointDistence);\n                vec3 diff = diffuse(normal, lightDir, pointLightColor, pointIntensity, weaken);\n                vec3 highL = reflectLight(cameraPosition, lightDir, vPosition, normal, pointLightColor, shininess, pointIntensity, weaken);\n                DiffHighLight result;\n                result.diffuse = diff;\n                result.hightLight = highL;\n                return result;\n            }\n\n            // \u8BA1\u7B97\u5E73\u884C\u5149\u7684\u6F2B\u53CD\u5C04\u548C\u955C\u9762\u53CD\u5C04\n            DiffHighLight dirLightCalc() {\n                vec3 normal = normalize(vNormal);\n                vec3 diff = diffuse(normal, -dirVec, dirLightColor, dirIntensity, 1.0);\n                // vec3 highL = reflectLight(cameraPosition, normalize(dirVec), vPosition, normal, dirLightColor, shininess, dirIntensity, 1.0);\n                DiffHighLight result;\n                result.diffuse = diff;\n                result.hightLight = vec3(0);\n                return result;\n            }\n\n            // \u8BA1\u7B97\u6700\u7EC8\u7684\u5149\u548C\u6750\u8D28\u7684\u5149 \u989C\u8272\u589E\u76CA\n            vec3 lightColor(vec3 color) {\n                vec3 amb = ambient() * color;\n                DiffHighLight pointDiffHigh = pointLightCalc();\n                DiffHighLight dirDiffHigh = dirLightCalc();\n\n                return amb + dirDiffHigh.diffuse * color + dirDiffHigh.hightLight * color + pointDiffHigh.diffuse * color + pointDiffHigh.hightLight * color;;\n            }\n        ";
            },
          },
          __defProp$t = Object.defineProperty,
          __getOwnPropSymbols$t = Object.getOwnPropertySymbols,
          __hasOwnProp$t = Object.prototype.hasOwnProperty,
          __propIsEnum$t = Object.prototype.propertyIsEnumerable,
          __defNormalProp$t = function (r, n, i) {
            return n in r
              ? __defProp$t(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$t = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$t.call(n, i) && __defNormalProp$t(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$t)
              try {
                for (
                  var l = __getOwnPropSymbols$t(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$t.call(n, i) && __defNormalProp$t(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          Render = (function () {
            function r(i) {
              _classCallCheck(this, r),
                (this.pA = new Map()),
                (this.v$ = []),
                (this.regl = i);
            }
            var n = r.prototype;
            return (
              (n.p$ = function (i) {
                this.v$.forEach(function (s) {
                  var a;
                  return (a = s.p$) == null ? void 0 : a.call(s, i);
                });
              }),
              (n.O$ = function (i) {
                this.v$.forEach(function (s) {
                  var a;
                  return (a = s.O$) == null ? void 0 : a.call(s, i);
                });
              }),
              (n.k$ = function (i) {
                this.v$.forEach(function (s) {
                  var a;
                  return (a = s.k$) == null ? void 0 : a.call(s, i);
                });
              }),
              (n.gA = function (i, s, a, o) {
                if (!this.regl) {
                  console.warn("Please initialize `regl` first.");
                  return;
                }
                var l = new Shader(i),
                  u = l.process(s),
                  f = u.vertex,
                  c = u.fragment;
                o = o != null ? o : 0;
                var h = this.pA.get(i) || [];
                (h[o] = this.regl(__spreadValues$t({ frag: c, vert: f }, a))),
                  this.pA.set(i, h);
              }),
              (n.yA = function (i, s) {
                var a = this.pA.get(i) || [];
                if (!this.regl || !(a != null && a.length)) {
                  console.warn("Please execute `prepareRender` first.");
                  return;
                }
                return (s = s != null ? s : 0), (this.bA = a[s]);
              }),
              (n.destroy = function () {
                this.pA.clear(),
                  (this.bA = void 0),
                  (this.regl = void 0),
                  this.v$.forEach(function (i) {
                    var s;
                    (s = i.destroy) == null || s.call(i);
                  });
              }),
              _createClass(r, [
                {
                  key: "mA",
                  get: function () {
                    return !this.bA;
                  },
                },
              ]),
              r
            );
          })(),
          SubRender = function r() {
            _classCallCheck(this, r);
          },
          polygon = {
            Sw: {
              zooms: [2, 26],
              zIndex: 120,
              visible: !0,
              opacity: 1,
              cullface: "back",
              shininess: 30,
              hasSide: !0,
              depth: !0,
              acceptLight: !0,
              R$: !0,
              I$: !1,
            },
            style: {
              topColor: {
                defaultValue: "rgba(200,200,200,1)",
                type: "color",
                render: "attribute",
              },
              bottomColor: {
                defaultValue: "rgba(200,200,200,1)",
                type: "color",
                render: "attribute",
              },
              sideTopColor: {
                defaultValue: "#ffffff",
                type: "color",
                render: "attribute",
              },
              sideBottomColor: {
                defaultValue: "#fff",
                type: "color",
                render: "attribute",
              },
              borderWidth: {
                defaultValue: 10,
                type: "number",
                render: "attribute",
              },
              borderColor: {
                defaultValue: "rgba(250,250,250,1)",
                type: "color",
                render: "attribute",
              },
              altitude: {
                defaultValue: 0,
                type: "number",
                render: "attribute",
              },
              height: { defaultValue: 0, type: "number", render: "attribute" },
              texture: { defaultValue: !1, type: "image", render: "uniform" },
              textureSize: {
                defaultValue: [10, 3],
                type: "array",
                render: "attribute",
              },
              label: { defaultValue: null, type: "nest", render: "attribute" },
            },
          },
          line = {
            Sw: {
              zooms: [2, 26],
              zIndex: 120,
              visible: !0,
              opacity: 1,
              depth: !1,
            },
            style: {
              unit: { defaultValue: "px", type: "string", render: "uniform" },
              color: {
                defaultValue: "rgba(200,200,200,1)",
                type: "color",
                render: "attribute",
              },
              borderWidth: {
                defaultValue: 0,
                type: "number",
                render: "attribute",
              },
              borderColor: {
                defaultValue: "rgba(250,250,250,1)",
                type: "color",
                render: "attribute",
              },
              lineWidth: {
                defaultValue: 20,
                type: "number",
                render: "attribute",
              },
              dash: {
                defaultValue: [1, 0, 1, 0],
                type: "array",
                render: "attribute",
              },
              altitude: {
                defaultValue: 0,
                type: "number",
                render: "attribute",
              },
            },
          },
          pulseline = {
            Sw: { zooms: [2, 26], zIndex: 120, visible: !0, opacity: 1 },
            style: {
              lineWidth: {
                defaultValue: 1,
                type: "number",
                render: "attribute",
              },
              headColor: {
                defaultValue: "rgba(0, 0, 0, 0.75)",
                type: "color",
                render: "attribute",
              },
              trailColor: {
                defaultValue: "rgba(0, 0, 0, 0.25)",
                type: "color",
                render: "attribute",
              },
              altitude: { defaultValue: 0, type: "number", render: "uniform" },
              interval: { defaultValue: 1, type: "number", render: "uniform" },
              duration: {
                defaultValue: 2e3,
                type: "number",
                render: "uniform",
              },
            },
          },
          scatter = {
            Sw: {
              zooms: [2, 26],
              zIndex: 120,
              visible: !0,
              opacity: 1,
              depth: !1,
            },
            style: {
              size: {
                defaultValue: [20, 20],
                type: "array",
                render: "attribute",
              },
              rotation: {
                defaultValue: 0,
                type: "number",
                render: "attribute",
              },
              color: {
                defaultValue: "rgba(200,200,200,1)",
                type: "color",
                render: "attribute",
              },
              altitude: {
                defaultValue: 0,
                type: "number",
                render: "attribute",
              },
              borderWidth: {
                defaultValue: 0,
                type: "number",
                render: "attribute",
              },
              borderColor: {
                defaultValue: "rgba(250,250,250,1)",
                type: "color",
                render: "attribute",
              },
              texture: { defaultValue: null, type: "image", render: "uniform" },
              unit: { defaultValue: "px", type: "string", render: "uniform" },
              animate: { defaultValue: !1, type: "boolean", render: "uniform" },
              duration: { defaultValue: 0, type: "number", render: "uniform" },
              label: { defaultValue: null, type: "nest", render: "attribute" },
            },
          },
          heatmap = {
            Sw: {
              zooms: [2, 26],
              zIndex: 120,
              visible: !0,
              opacity: 1,
              depth: !0,
            },
            style: {
              radius: { defaultValue: 20, type: "number", render: "attribute" },
              value: { defaultValue: 10, type: "number", render: "attribute" },
              gradient: {
                defaultValue: {
                  0.5: "blue",
                  0.65: "rgb(117,211,248)",
                  0.7: "rgb(0, 255, 0)",
                  0.9: "#ffea00",
                  1: "red",
                },
                type: "object",
                render: "uniform",
              },
              opacity: {
                defaultValue: [0, 1],
                type: "array",
                render: "uniform",
              },
              height: { defaultValue: 100, type: "number", render: "uniform" },
              heightBezier: {
                defaultValue: [0.4, 0.2, 0.4, 0.8],
                type: "array",
                render: "uniform",
              },
              max: { defaultValue: null, type: "number", render: "uniform" },
              min: { defaultValue: null, type: "number", render: "uniform" },
              unit: { defaultValue: "px", type: "string", render: "uniform" },
              difference: { defaultValue: !1, type: "bool", render: "uniform" },
            },
          },
          point = {
            Sw: {
              zooms: [2, 26],
              zIndex: 120,
              visible: !0,
              opacity: 1,
              blend: "normal",
            },
            style: {
              unit: { defaultValue: "px", type: "string", render: "uniform" },
              radius: { defaultValue: 20, type: "number", render: "attribute" },
              borderWidth: {
                defaultValue: 10,
                type: "number",
                render: "attribute",
              },
              blurWidth: {
                defaultValue: -1,
                type: "number",
                render: "attribute",
              },
              color: {
                defaultValue: "rgba(255,255,255,1)",
                type: "color",
                render: "attribute",
              },
              borderColor: {
                defaultValue: "rgba(255,255,255,1)",
                type: "color",
                render: "attribute",
              },
              label: { defaultValue: null, type: "nest", render: "attribute" },
            },
          },
          icon = {
            Sw: { zooms: [2, 26], zIndex: 120, visible: !0, opacity: 1 },
            style: {
              unit: { defaultValue: "px", type: "string", render: "uniform" },
              icon: { defaultValue: "", type: "string", render: "attribute" },
              iconSize: {
                defaultValue: [20, 20],
                type: "array",
                render: "attribute",
              },
              offset: {
                defaultValue: [0, 0],
                type: "array",
                render: "attribute",
              },
              rotation: {
                defaultValue: 0,
                type: "number",
                render: "attribute",
              },
              opacity: { defaultValue: 1, type: "number", render: "attribute" },
              label: { defaultValue: null, type: "nest", render: "attribute" },
            },
          },
          grid$1 = {
            Sw: {
              zooms: [2, 26],
              zIndex: 120,
              visible: !0,
              opacity: 1,
              depth: !0,
              acceptLight: !0,
              shininess: 30,
              hasSide: !0,
              cullface: "back",
            },
            style: {
              unit: {
                defaultValue: "meter",
                type: "string",
                render: "uniform",
              },
              radius: { defaultValue: 1e3, type: "number", render: "uniform" },
              gap: { defaultValue: 0, type: "number", render: "uniform" },
              altitude: {
                defaultValue: 0,
                type: "number",
                render: "attribute",
              },
              height: { defaultValue: 0, type: "number", render: "attribute" },
              topColor: {
                defaultValue: "#ffffff",
                type: "color",
                render: "attribute",
              },
              sideTopColor: {
                defaultValue: "#ffffff",
                type: "color",
                render: "attribute",
              },
              sideBottomColor: {
                defaultValue: "#fff",
                type: "color",
                render: "attribute",
              },
              bottomColor: {
                defaultValue: "rgba(253,0,255,0)",
                type: "color",
                render: "attribute",
              },
              label: { defaultValue: null, type: "nest", render: "attribute" },
            },
          },
          hexagon$1 = {
            Sw: {
              zooms: [2, 26],
              zIndex: 120,
              visible: !0,
              opacity: 1,
              depth: !0,
              acceptLight: !0,
              shininess: 30,
              hasSide: !0,
              cullface: "back",
            },
            style: {
              unit: {
                defaultValue: "meter",
                type: "string",
                render: "uniform",
              },
              radius: { defaultValue: 1e3, type: "number", render: "uniform" },
              gap: { defaultValue: 0, type: "number", render: "uniform" },
              altitude: {
                defaultValue: 0,
                type: "number",
                render: "attribute",
              },
              height: { defaultValue: 0, type: "number", render: "attribute" },
              topColor: {
                defaultValue: "#ffffff",
                type: "color",
                render: "attribute",
              },
              bottomColor: {
                defaultValue: "rgba(253,0,255,0)",
                type: "color",
                render: "attribute",
              },
              sideTopColor: {
                defaultValue: "#ffffff",
                type: "color",
                render: "attribute",
              },
              sideBottomColor: {
                defaultValue: "#fff",
                type: "color",
                render: "attribute",
              },
              label: { defaultValue: null, type: "nest", render: "attribute" },
            },
          },
          link = {
            Sw: { zooms: [2, 26], zIndex: 120, visible: !0, opacity: 1 },
            style: {
              lineColors: {
                defaultValue: ["rgba(10,10,10,1)"],
                type: "colors",
                render: "attribute",
              },
              height: {
                defaultValue: function r(n, i) {
                  return i.distance * 0.7;
                },
                type: "number",
                render: "attribute",
              },
              smoothSteps: {
                defaultValue: 50,
                type: "number",
                render: "uniform",
              },
            },
          },
          pulselink = {
            Sw: {
              zooms: [2, 26],
              zIndex: 120,
              visible: !0,
              opacity: 1,
              depth: !0,
            },
            style: {
              maxHeightScale: {
                defaultValue: 0.5,
                type: "number",
                render: "uniform",
              },
              lineColors: {
                defaultValue: [
                  "rgb(255,228,105)",
                  "rgb(255,164,105)",
                  "rgba(1, 34, 249,1)",
                ],
                type: "colors",
                render: "attribute",
              },
              dash: {
                defaultValue: [10, 0, 10, 0],
                type: "array",
                render: "attribute",
              },
              lineWidth: {
                defaultValue: [10, 20],
                type: "array",
                render: "attribute",
              },
              height: { defaultValue: 0, type: "number", render: "attribute" },
              speed: { defaultValue: 10, type: "number", render: "attribute" },
              smoothSteps: {
                defaultValue: 50,
                type: "number",
                render: "uniform",
              },
              headColor: {
                defaultValue: "rgba(255, 255, 0, 1)",
                type: "color",
                render: "uniform",
              },
              trailColor: {
                defaultValue: "rgba(255, 255, 0, 0)",
                type: "color",
                render: "uniform",
              },
              unit: { defaultValue: "px", type: "number", render: "uniform" },
              flowLength: {
                defaultValue: 10,
                type: "number",
                render: "uniform",
              },
            },
          },
          prism = {
            Sw: {
              zooms: [2, 26],
              zIndex: 120,
              visible: !0,
              opacity: 1,
              depth: !1,
              acceptLight: !0,
              shininess: 30,
              hasSide: !0,
              cullface: "back",
            },
            style: {
              unit: { defaultValue: "px", type: "string", render: "uniform" },
              sideNumber: {
                defaultValue: 3,
                type: "number",
                render: "uniform",
              },
              rotation: {
                defaultValue: 0,
                type: "number",
                render: "attribute",
              },
              radius: { defaultValue: 20, type: "number", render: "attribute" },
              altitude: {
                defaultValue: 0,
                type: "number",
                render: "attribute",
              },
              height: {
                defaultValue: 100,
                type: "number",
                render: "attribute",
              },
              topColor: {
                defaultValue: "#ffffff",
                type: "color",
                render: "attribute",
              },
              sideTopColor: {
                defaultValue: "#ffffff",
                type: "color",
                render: "attribute",
              },
              sideBottomColor: {
                defaultValue: "#fff",
                type: "color",
                render: "attribute",
              },
              label: { defaultValue: null, type: "nest", render: "attribute" },
            },
          },
          gltf = {
            Sw: {
              zooms: [2, 26],
              zIndex: 120,
              visible: !0,
              opacity: 1,
              depth: !0,
            },
            style: {
              rotateX: { defaultValue: 0, type: "number", render: "attribute" },
              rotateY: { defaultValue: 0, type: "number", render: "attribute" },
              rotateZ: { defaultValue: 0, type: "number", render: "attribute" },
              height: { defaultValue: 0, type: "number", render: "attribute" },
              visible: {
                defaultValue: !0,
                type: "boolean",
                render: "attribute",
              },
              scale: {
                defaultValue: [1, 1, 1],
                type: "array",
                render: "attribute",
              },
            },
          },
          zmarker = {
            Sw: { zooms: [2, 26], zIndex: 120, visible: !0, opacity: 1 },
            style: {
              unit: { defaultValue: "px", type: "string", render: "uniform" },
              alwaysFront: {
                defaultValue: !1,
                type: "bool",
                render: "uniform",
              },
              content: {
                defaultValue: "<p>\u8FD9\u662F\u4E00\u4E2A\u6807\u8BB0</p>",
                type: "string",
                render: "attribute",
              },
              size: {
                defaultValue: [20, 20],
                type: "array",
                render: "attribute",
              },
              rotation: {
                defaultValue: 0,
                type: "number",
                render: "attribute",
              },
              altitude: {
                defaultValue: 0,
                type: "number",
                render: "attribute",
              },
            },
          },
          labels = {
            Sw: {
              zooms: [2, 26],
              zIndex: 120,
              visible: !0,
              opacity: 1,
              z$: !0,
              A$: !0,
            },
            style: {
              label: { defaultValue: null, type: "nest", render: "attribute" },
            },
          },
          conf = Object.freeze({
            __proto__: null,
            polygon: polygon,
            line: line,
            pulseline: pulseline,
            scatter: scatter,
            heatmap: heatmap,
            grid: grid$1,
            hexagon: hexagon$1,
            link: link,
            point: point,
            icon: icon,
            pulselink: pulselink,
            Iw: gltf,
            prism: prism,
            zmarker: zmarker,
            labels: labels,
          }),
          __defProp$s = Object.defineProperty,
          __getOwnPropSymbols$s = Object.getOwnPropertySymbols,
          __hasOwnProp$s = Object.prototype.hasOwnProperty,
          __propIsEnum$s = Object.prototype.propertyIsEnumerable,
          __defNormalProp$s = function (r, n, i) {
            return n in r
              ? __defProp$s(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$s = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$s.call(n, i) && __defNormalProp$s(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$s)
              try {
                for (
                  var l = __getOwnPropSymbols$s(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$s.call(n, i) && __defNormalProp$s(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          pushArray$o = CommonUtil$1._C,
          _PolygonsFusion = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.DC = function () {}),
              (s.buildStyle = function (a, o) {
                for (var l, u = polygon.style, f = [], c = 0; c < a.length; c++)
                  if (!(!a[c].features || !a[c].features.polygons)) {
                    for (
                      var h = a[c].features.polygons,
                        p = StyleInstance.parse(h, o, u),
                        d = {},
                        m = 0;
                      m < h.length;
                      m++
                    )
                      if (p)
                        for (var g in p.attributes) {
                          var v = p.attributes[g];
                          d[g] || (d[g] = []),
                            ((l = v[m]) == null ? void 0 : l.length) > 0
                              ? pushArray$o(d[g], v[m])
                              : (d[g][d[g].length] = v[m]);
                        }
                    f.push({ attributes: d, uniforms: p.uniforms, si: p.si });
                  }
                return f;
              }),
              (s.fusion = function (a, o, l, u) {
                if (!this.regl || !l.loca) return [];
                var f = [];
                u = u || this.buildStyle(a, o);
                for (var c = l.loca.customCoords, h = 0; h < a.length; h++) {
                  var p = a[h];
                  if (!(!p.features || !p.features.polygons || !u[h])) {
                    for (
                      var d = p.features.polygons,
                        m = u[h],
                        g = {
                          index: [],
                          vertex: [],
                          color: [],
                          normal: [],
                          uv: [],
                          textureSize: [],
                          pickColor: [],
                          topOrBottom: [],
                          labels: [],
                        },
                        v = [],
                        y = [],
                        _ = [],
                        b = [],
                        S = 0;
                      S < d.length;
                      S++
                    ) {
                      var P = d[S],
                        I = l.colorPick.add(P),
                        F = P.coordinates;
                      if (P.type === "MultiPolygon") {
                        for (var X = 0, W = F.length; X < W; X++) {
                          var Z = F[X],
                            j = this.triangles(
                              Z,
                              { style: m, index: S, pickColor: I, id: P.sr },
                              c,
                              l.hasSide,
                              l.I$
                            ),
                            L = g.vertex.length;
                          v.push(L),
                            y.push(L + j.Tw.Pw),
                            _.push(L + j.Tw.top),
                            GeoUtil.mergeTriangles(g, j, 4),
                            pushArray$o(g.color, j.color),
                            pushArray$o(g.pickColor, j.pickColor),
                            pushArray$o(g.normal, j.normal),
                            pushArray$o(g.uv, j.uv),
                            pushArray$o(g.textureSize, j.textureSize),
                            pushArray$o(g.topOrBottom, j.topOrBottom);
                        }
                        m.attributes.label[S] &&
                          g.labels.push(
                            __spreadValues$s(
                              {
                                position: _toConsumableArray(
                                  GeometryUtil.a$(getMaximumPolygon(F))
                                ).concat([
                                  m.attributes.altitude[S] +
                                    m.attributes.height[S] +
                                    300,
                                ]),
                              },
                              m.attributes.label[S]
                            )
                          );
                      } else {
                        var T = this.triangles(
                            F,
                            { style: m, index: S, pickColor: I, id: P.sr },
                            c,
                            l.hasSide,
                            l.I$
                          ),
                          A = g.vertex.length;
                        v.push(A),
                          y.push(A + T.Tw.Pw),
                          _.push(A + T.Tw.top),
                          GeoUtil.mergeTriangles(g, T, 4),
                          pushArray$o(g.color, T.color),
                          pushArray$o(g.pickColor, T.pickColor),
                          pushArray$o(g.normal, T.normal),
                          pushArray$o(g.uv, T.uv),
                          pushArray$o(g.textureSize, T.textureSize),
                          pushArray$o(g.topOrBottom, T.topOrBottom),
                          m.attributes.label[S] &&
                            g.labels.push(
                              __spreadValues$s(
                                {
                                  position: _toConsumableArray(
                                    GeometryUtil.a$(F)
                                  ).concat([
                                    m.attributes.altitude[S] +
                                      m.attributes.height[S] +
                                      300,
                                  ]),
                                },
                                m.attributes.label[S]
                              )
                            );
                      }
                      b[S] = g.vertex.length;
                    }
                    f[h] = {
                      id: p.id,
                      attributes: {
                        position: {
                          buffer: this.regl.buffer(g.vertex),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        topOrBottom: {
                          buffer: this.regl.buffer(g.topOrBottom),
                          offset: 0,
                          stride: 4 * 1,
                          td: !1,
                          divisor: 0,
                        },
                        color: {
                          buffer: this.regl.buffer(g.color),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        pickColor: {
                          buffer: this.regl.buffer(g.pickColor),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        normal: {
                          buffer: this.regl.buffer(g.normal),
                          offset: 0,
                          stride: 4 * 3,
                          td: !1,
                          divisor: 0,
                        },
                        uv: {
                          buffer: this.regl.buffer(g.uv),
                          offset: 0,
                          stride: 4 * 2,
                          td: !1,
                          divisor: 0,
                        },
                        textureSize: {
                          buffer: this.regl.buffer(g.textureSize),
                          offset: 0,
                          stride: 4 * 2,
                          td: !1,
                          divisor: 0,
                        },
                        index: this.regl.elements({
                          primitive: "triangles",
                          type: "uint32",
                          data: g.index,
                        }),
                      },
                      uniforms: m.uniforms,
                      si: m.si,
                      mf: {
                        Tw: { bottom: v, Pw: y, top: _, jw: b },
                        origin: { position: g.vertex, color: g.color },
                        labels: g.labels,
                      },
                    };
                  }
                }
                return f;
              }),
              (s.triangles = function (a, o, l) {
                for (
                  var u =
                      arguments.length > 3 && arguments[3] !== void 0
                        ? arguments[3]
                        : !0,
                    f =
                      arguments.length > 4 && arguments[4] !== void 0
                        ? arguments[4]
                        : !0,
                    c = GeoUtil.triangle(a),
                    h = c.vertex,
                    p = c.index,
                    d = [],
                    m = o.index,
                    g = o.pickColor,
                    v = o.style.attributes,
                    y = v.height,
                    _ = v.altitude,
                    b = v.topColor,
                    S = v.bottomColor,
                    P = v.sideTopColor,
                    I = v.sideBottomColor,
                    F = v.textureSize,
                    X = _[m],
                    W = y[m] + X,
                    Z = m * 4,
                    j = b.slice(Z, Z + 4),
                    L = S.slice(Z, Z + 4),
                    T = I.slice(Z, Z + 4),
                    A = P.slice(Z, Z + 4),
                    $ = F && F.slice(m * 2, m * 2 + 2),
                    R = [],
                    M = [],
                    w = [],
                    O = [],
                    E = [],
                    k = [],
                    D = [],
                    q = [],
                    J = [],
                    de = [],
                    we = [],
                    Se = [],
                    He = [],
                    et = [],
                    Ke = [],
                    Fe = [],
                    qe = [],
                    Mt = [],
                    ot = [],
                    at = 0,
                    Lt = h.length;
                  at < Lt;
                  at += 2
                ) {
                  var $t = h[at],
                    Rt = h[at + 1],
                    Ot = l.lngLatToCoord([$t, Rt]);
                  this.addVertex(
                    R,
                    D,
                    O,
                    de,
                    [Ot[0], Ot[1], W, o.id],
                    j,
                    [0, 0, 1],
                    [-1, -1],
                    He,
                    [-1, -1],
                    Fe,
                    g
                  ),
                    Mt.push(1),
                    f &&
                      (this.addVertex(
                        M,
                        q,
                        E,
                        we,
                        [Ot[0], Ot[1], X, o.id],
                        L,
                        [0, 0, -1],
                        [-1, -1],
                        et,
                        [-1, -1],
                        Fe,
                        g
                      ),
                      qe.push(0));
                }
                if (u)
                  for (
                    var wt = this.isClock(a[0]), kt = !1, Pt = 0, At = a.length;
                    Pt < At;
                    Pt++
                  ) {
                    var ut = a[Pt];
                    Pt > 0 && (kt = !0);
                    for (
                      var ct = !1, vt = 0, rt = 0, Wt = ut.length;
                      rt < Wt - 1;
                      rt++
                    ) {
                      var Vt = ut[rt],
                        mt = ut[rt + 1],
                        yt = ct || l.lngLatToCoord(Vt),
                        xt = l.lngLatToCoord(mt),
                        It = w.length / 4,
                        Bt = d.length,
                        ar = this.getNormal(yt, xt, !!(+wt ^ +kt)),
                        Gr = glMatrix.vec2.distance(yt, xt);
                      ot.push(0, 1, 0, 1),
                        this.addVertex(
                          w,
                          J,
                          k,
                          Se,
                          [yt[0], yt[1], X, o.id],
                          T,
                          ar,
                          [vt, 0],
                          Ke,
                          $,
                          Fe,
                          g
                        ),
                        this.addVertex(
                          w,
                          J,
                          k,
                          Se,
                          [yt[0], yt[1], W, o.id],
                          A,
                          ar,
                          [vt, W],
                          Ke,
                          $,
                          Fe,
                          g
                        ),
                        this.addVertex(
                          w,
                          J,
                          k,
                          Se,
                          [xt[0], xt[1], X, o.id],
                          T,
                          ar,
                          [vt + Gr, 0],
                          Ke,
                          $,
                          Fe,
                          g
                        ),
                        this.addVertex(
                          w,
                          J,
                          k,
                          Se,
                          [xt[0], xt[1], W, o.id],
                          A,
                          ar,
                          [vt + Gr, W],
                          Ke,
                          $,
                          Fe,
                          g
                        ),
                        wt
                          ? ((d[Bt] = It),
                            (d[Bt + 1] = It + 3),
                            (d[Bt + 2] = It + 1),
                            (d[Bt + 3] = It),
                            (d[Bt + 4] = It + 2),
                            (d[Bt + 5] = It + 3))
                          : ((d[Bt] = It),
                            (d[Bt + 1] = It + 1),
                            (d[Bt + 2] = It + 3),
                            (d[Bt + 3] = It),
                            (d[Bt + 4] = It + 3),
                            (d[Bt + 5] = It + 2)),
                        (ct = xt),
                        (vt += Gr);
                    }
                  }
                var on = M.length,
                  oi = on + w.length,
                  Ur = { vertex: w, index: d };
                return (
                  f &&
                    (Ur = GeoUtil.mergeTriangles(
                      { vertex: M, index: p.slice(0) },
                      { vertex: w, index: d },
                      4
                    )),
                  GeoUtil.mergeTriangles(
                    Ur,
                    { vertex: R, index: p.reverse() },
                    4
                  ),
                  pushArray$o(q, J),
                  pushArray$o(q, D),
                  pushArray$o(E, k),
                  pushArray$o(E, O),
                  pushArray$o(we, Se),
                  pushArray$o(we, de),
                  pushArray$o(et, Ke),
                  pushArray$o(et, He),
                  pushArray$o(qe, ot),
                  pushArray$o(qe, Mt),
                  {
                    vertex: Ur.vertex,
                    index: Ur.index,
                    color: q,
                    normal: E,
                    uv: we,
                    textureSize: et,
                    pickColor: Fe,
                    topOrBottom: qe,
                    Tw: { Pw: on, top: oi },
                  }
                );
              }),
              (s.addVertex = function (a, o, l, u, f, c, h) {
                var p =
                    arguments.length > 7 && arguments[7] !== void 0
                      ? arguments[7]
                      : [-1, -1],
                  d = arguments.length > 8 ? arguments[8] : void 0,
                  m = arguments.length > 9 ? arguments[9] : void 0,
                  g = arguments.length > 10 ? arguments[10] : void 0,
                  v = arguments.length > 11 ? arguments[11] : void 0,
                  y = a.length,
                  _ = l.length,
                  b = u.length;
                if (
                  ((a[y] = f[0]),
                  (a[y + 1] = f[1]),
                  (a[y + 2] = f[2]),
                  (a[y + 3] = f[3]),
                  (o[y] = c[0]),
                  (o[y + 1] = c[1]),
                  (o[y + 2] = c[2]),
                  (o[y + 3] = c[3]),
                  g && v)
                ) {
                  var S = g.length;
                  (g[S] = v[0]),
                    (g[S + 1] = v[1]),
                    (g[S + 2] = v[2]),
                    (g[S + 3] = v[3]);
                }
                (l[_] = h[0]),
                  (l[_ + 1] = h[1]),
                  (l[_ + 2] = h[2]),
                  (u[b] = p[0]),
                  (u[b + 1] = p[1]),
                  d && m && ((d[b] = m[0]), (d[b + 1] = m[1]));
              }),
              (s.getNormal = function (a, o) {
                var l =
                    arguments.length > 2 && arguments[2] !== void 0
                      ? arguments[2]
                      : !1,
                  u = glMatrix.vec3.create();
                glMatrix.vec3.set(u, o[0] - a[0], o[1] - a[1], 0),
                  l && glMatrix.vec3.set(u, a[0] - o[0], a[1] - o[1], 0);
                var f = glMatrix.vec3.create();
                glMatrix.vec3.set(f, 0, 0, 1);
                var c = glMatrix.vec3.create();
                return glMatrix.vec3.normalize(c, glMatrix.vec3.cross(c, u, f));
              }),
              (s.isClock = function (a) {
                for (var o = a.length, l = 0, u = 0; u < o; u++) {
                  var f = a[u],
                    c = a[(u + 1) % o];
                  l += (c[0] - f[0]) * (c[1] + f[1]);
                }
                return l > 0;
              }),
              (s.updateStyle = function (a, o, l) {
                for (
                  var u = function (h, p) {
                      for (
                        var d = a[h],
                          m = o[h].attributes,
                          g = m.altitude,
                          v = m.height,
                          y = m.topColor,
                          _ = m.bottomColor,
                          b = m.sideTopColor,
                          S = m.sideBottomColor,
                          P = m.textureSize,
                          I = m.label,
                          F = d.mf.origin,
                          X = F.position,
                          W = F.color,
                          Z = d.mf.Tw,
                          j = Z.top,
                          L = Z.bottom,
                          T = Z.Pw,
                          A = Z.jw,
                          $ = new Float32Array(W.length / 2),
                          R = 0,
                          M = 0,
                          w = 0,
                          O = X.length;
                        w < O;
                        w += 4
                      ) {
                        var E = (w / 4) * 4,
                          k = void 0,
                          D = [-1, -1];
                        w >= A[R] && R++;
                        var q = R * 4;
                        w >= L[M + 1] && M++,
                          w < T[M]
                            ? l.I$ && ((k = _), (X[w + 2] = g[R]))
                            : w >= T[M] && w < j[M]
                            ? l.hasSide &&
                              (((w - T[M]) / 4) % 2 === 0
                                ? ((k = S), (X[w + 2] = g[R]))
                                : ((k = b), (X[w + 2] = v[R] + g[R])),
                              (D = P.slice(R * 2, R * 2 + 2)))
                            : ((k = y), (X[w + 2] = v[R] + g[R])),
                          (W[E] = k[q]),
                          (W[E + 1] = k[q + 1]),
                          (W[E + 2] = k[q + 2]),
                          (W[E + 3] = k[q + 3]),
                          ($[E / 2] = D[0]),
                          ($[E / 2 + 1] = D[1]);
                      }
                      d.attributes.position.buffer({ data: X }),
                        d.attributes.color.buffer({ data: W }),
                        d.attributes.textureSize.buffer({ data: $ }),
                        (d.uniforms = o[h].uniforms),
                        (d.mf.labels = d.mf.labels.map(function (J, de) {
                          return __spreadValues$s(
                            __spreadValues$s({}, J),
                            I[de]
                          );
                        }));
                    },
                    f = 0,
                    c = a.length;
                  f < c;
                  f++
                )
                  u(f, c);
              }),
              (s.EC = function () {
                return [];
              }),
              (s.destroy = function () {
                this.regl = null;
              }),
              (i.getInstance = function () {
                return this.ui;
              }),
              i
            );
          })(GeometryFusion),
          PolygonsFusion = _PolygonsFusion;
        PolygonsFusion.ui = new _PolygonsFusion();
        var PolygonsFusionInstance = PolygonsFusion.getInstance(),
          lightUniforms =
            "\n#if defined(ACCEPT_LIGHT) && defined(HAS_LIGHTS)\n    #ifdef NUMBER_OF_AMBIENT_LIGHTS\n        struct AmbientLight {\n            float intensity;\n            vec3 lightColor; \n        };\n        uniform AmbientLight ambientLight; \n    #endif\n\n    #ifdef NUMBER_OF_POINT_LIGHTS\n        struct PointLight {\n            float intensity;\n            float dist;\n            vec3 lightColor;\n            vec3 position;\n        };\n        uniform PointLight pointLights[NUMBER_OF_POINT_LIGHTS]; \n    #endif\n\n    #ifdef NUMBER_OF_DIRECTIONAL_LIGHTS\n        struct DirectionalLight {\n            float intensity;\n            vec3 lightColor;\n            vec3 direction;\n        };\n        uniform DirectionalLight directionalLights[NUMBER_OF_DIRECTIONAL_LIGHTS]; \n    #endif\n#endif\n",
          lightFunctions =
            "\n#if defined(ACCEPT_LIGHT) && defined(HAS_LIGHTS)\n    struct DiffHighLight {\n        vec3 diffuse;\n        vec3 highLight;\n    };\n\n    // \u73AF\u5883\u53CD\u5C04\n    vec3 ambient(vec3 ambLightColor, float ambIntensity) {\n        return ambLightColor * ambIntensity;\n    }\n\n    vec3 diffuse(\n        vec3 normal,\n        vec3 lightDir,\n        vec3 lightColor,\n        float lightIntensity,\n        float weaken\n    ) {\n        vec3 nNormal = normalize(normal);\n        //\u8BA1\u7B97\u5149\u7EBF\u65B9\u5411\u548C\u6CD5\u5411\u91CF\u7684\u70B9\u79EF\n        float nDotL = max(dot(normalize(lightDir), nNormal), 0.0);\n        //\u8BA1\u7B97\u6F2B\u53CD\u5C04\u5149\u7684\u989C\u8272\n        return lightColor * nDotL * lightIntensity * weaken;\n    }\n\n    // \u955C\u9762\u53CD\u5C04\n    vec3 reflectLight(\n        vec3 cameraPosition,\n        vec3 lightDir,\n        vec3 position,\n        vec3 normal,\n        vec3 lightColor,\n        float shininess,\n        float lightIntensity,\n        float weaken\n    ) {\n        float specularLightWeighting = 0.0;\n        // vec3 lightDir = normalize(lightPosition - position);\n        vec3 cameraDirection = normalize(cameraPosition - position);\n        vec3 reflectionDirection = reflect(-lightDir, normal);\n        specularLightWeighting = pow(max(dot(reflectionDirection, cameraDirection), 0.0), shininess);\n        return lightColor * specularLightWeighting * lightIntensity * weaken;\n    }\n\n    // \u8BA1\u7B97\u8870\u51CF\u91CF\n    float lightWeaken(vec3 lightPosition, vec3 position, float distanceIntensity) {\n        // \u5149\u6E90\u548C\u5F53\u524D\u7684\u8DDD\u79BB\uFF0C\u8BA1\u7B97\u8870\u51CF\n        float dist = distance(lightPosition, position);\n        float weaken;\n        if(distanceIntensity > 0.0) {\n            weaken = clamp(-dist / distanceIntensity + 1.0, 0.0, 1.0);\n        } else {\n            weaken = 1.0;\n        }\n        return weaken;\n    }\n\n    // \u8BA1\u7B97\u70B9\u5149\u7684\u6F2B\u53CD\u5C04\u548C\u955C\u9762\u53CD\u5C04\n    DiffHighLight pointLightCalc(vec3 pointPosition, vec3 pointLightColor, float pointDistance, float pointIntensity) {\n        vec3 normal = normalize(vNormal);\n        vec3 lightDir = normalize(pointPosition - vPosition);\n        float weaken = lightWeaken(pointPosition, vPosition, pointDistance);\n        vec3 diff = diffuse(normal, lightDir, pointLightColor, pointIntensity, weaken);\n        vec3 highL = reflectLight(cameraPosition, lightDir, vPosition, normal, pointLightColor, shininess, pointIntensity, weaken);\n        DiffHighLight result;\n        result.diffuse = diff;\n        result.highLight = highL;\n        return result;\n    }\n\n    // \u8BA1\u7B97\u5E73\u884C\u5149\u7684\u6F2B\u53CD\u5C04\u548C\u955C\u9762\u53CD\u5C04\n    DiffHighLight dirLightCalc(vec3 dirVec, vec3 dirLightColor, float dirIntensity) {\n        vec3 normal = normalize(vNormal);\n        vec3 diff = diffuse(normal, -dirVec, dirLightColor, dirIntensity, 1.0);\n        // vec3 highL = reflectLight(cameraPosition, normalize(dirVec), vPosition, normal, dirLightColor, shininess, dirIntensity, 1.0);\n        DiffHighLight result;\n        result.diffuse = diff;\n        result.highLight = vec3(0);\n        return result;\n    }\n#endif\n",
          lightMainCompute =
            "\n#if defined(ACCEPT_LIGHT) && defined(HAS_LIGHTS)\n\n    DiffHighLight diffHighLight;\n    vec3 amb = vec3(0.0, 0.0, 0.0);\n    vec3 diffuse = vec3(0.0, 0.0, 0.0);\n    vec3 highLight = vec3(0.0, 0.0, 0.0);  \n\n    #ifdef NUMBER_OF_AMBIENT_LIGHTS\n        amb = ambient(ambientLight.lightColor, ambientLight.intensity) * gl_FragColor.rgb;\n    #endif\n\n    #ifdef NUMBER_OF_POINT_LIGHTS\n        for (int i = 0; i < NUMBER_OF_POINT_LIGHTS; i++) {\n            PointLight l = pointLights[i];\n            diffHighLight = pointLightCalc(l.position, l.lightColor, l.dist, l.intensity);\n            diffuse += diffHighLight.diffuse;\n            highLight += diffHighLight.highLight;\n        }\n    #endif\n\n    #ifdef NUMBER_OF_DIRECTIONAL_LIGHTS\n        for (int i = 0; i < NUMBER_OF_DIRECTIONAL_LIGHTS; i++) {\n            DirectionalLight l = directionalLights[i];\n            diffHighLight = dirLightCalc(l.direction, l.lightColor, l.intensity);\n            diffuse += diffHighLight.diffuse;\n            highLight += diffHighLight.highLight;   \n        }\n\n    #endif\n\n    gl_FragColor.rgb = amb + diffuse * gl_FragColor.rgb + highLight * gl_FragColor.rgb;\n\n#endif\n",
          LightIncludes = {
            lightUniforms: lightUniforms,
            lightFunctions: lightFunctions,
            lightMainCompute: lightMainCompute,
          },
          __defProp$r = Object.defineProperty,
          __getOwnPropSymbols$r = Object.getOwnPropertySymbols,
          __hasOwnProp$r = Object.prototype.hasOwnProperty,
          __propIsEnum$r = Object.prototype.propertyIsEnumerable,
          __defNormalProp$r = function (r, n, i) {
            return n in r
              ? __defProp$r(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$r = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$r.call(n, i) && __defNormalProp$r(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$r)
              try {
                for (
                  var l = __getOwnPropSymbols$r(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$r.call(n, i) && __defNormalProp$r(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          PolygonShader = {
            vertex:
              "\n        precision highp float;\n\n        attribute vec4 position;\n        attribute vec3 normal;\n        attribute vec4 color;\n        attribute vec2 uv;\n        attribute vec2 textureSize;\n        attribute float topOrBottom;\n\n        varying vec3 vNormal;\n        varying vec4 vColor;\n        varying vec3 vPosition;\n        varying vec2 vUv;\n        varying vec2 vTexSize;\n        "
                .concat(ColorGLSL.getColorShader().vertex, "\n        ")
                .concat(RenderUtil.getBezier(), "\n        ")
                .concat(RenderUtil.getScaleType("height"), "\n        ")
                .concat(
                  RenderUtil.getScaleType("altitude"),
                  "\n\n        uniform mat4 mvp;\n\n        void main() {\n            vec3 realPos = position.xyz;\n            float altitudeScale = altitudeScaleValue(position.w);\n            float heightScale = heightScaleValue(position.w);\n            if(topOrBottom == 0.0) {\n                realPos = vec3(position.xy, position.z * altitudeScale);\n            }\n            if(topOrBottom == 1.0) {\n                realPos = vec3(position.xy, position.z * heightScale);\n            }\n            vColor = color;\n            vNormal = normal;\n            vPosition = realPos;\n            vUv = vec2(uv.x / textureSize.x, uv.y / textureSize.y);\n            vTexSize = textureSize;\n            gl_Position = mvp * vec4(realPos, 1.0);\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainVert,
                  "\n        }\n    "
                ),
            fragment:
              "\n        precision highp float;\n        varying vec4 vColor;\n\n        // \u5982\u679C\u9700\u8981\u5149\u7167\uFF0C\u8FD9\u4E24\u4E2A\u53D8\u91CF\u662F\u5FC5\u987B\u7684\n        varying vec3 vNormal;\n        varying vec3 vPosition;\n        varying vec2 vUv;\n        varying vec2 vTexSize;\n\n        uniform float opacity;\n        uniform sampler2D texture;\n        uniform bool useTexture;\n\n        uniform vec3 cameraPosition;\n        uniform float shininess;\n        #include <lightUniforms,lightFunctions>;\n\n        "
                .concat(
                  ColorGLSL.getColorShader().fragment,
                  "\n\n        void main() {\n            if(useTexture && vTexSize.x >= 0.0) {\n                gl_FragColor = texture2D(texture, vUv);\n            } else {\n                gl_FragColor = vColor;\n            }\n            #include <lightMainCompute>;\n            gl_FragColor.a *= opacity;\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainFrag,
                  "\n        }\n    "
                ),
            includes: __spreadValues$r({}, LightIncludes),
          },
          RenderHelper = (function () {
            function r() {
              _classCallCheck(this, r);
            }
            return (
              (r.SA = function (n, i, s) {
                var a = i.vA,
                  o = i.loca,
                  l = n.mA || a.isDirty;
                if (l) {
                  if (
                    (n.mA && (s == null || s("onFirstRendering")),
                    (a.state & LightDirty) === LightDirty &&
                      (this.MA(a, o.lights), s == null || s("light")),
                    (a.state & MeshDirty) === MeshDirty &&
                      (s == null || s("mesh")),
                    (a.state & MeshesDirty) === MeshesDirty &&
                      (s == null || s("meshes")),
                    n.m$(a) === !1)
                  )
                    return !1;
                  a.state = NotDirty;
                }
                return !0;
              }),
              (r.MA = function (n, i) {
                for (
                  var s = function (c, h) {
                      h > 0 ? (n[c] = h) : delete n[c];
                    },
                    a = 0,
                    o = 0,
                    l = 0,
                    u = 0;
                  u < i.length;
                  u++
                ) {
                  var f = i[u];
                  if (_instanceof(f, AmbientLight))
                    if (a > 0) {
                      console.warn(
                        "\u73AF\u5883\u5149\u53EA\u5141\u8BB8\u6709\u4E00\u4E2A\uFF01"
                      );
                      continue;
                    } else a += 1;
                  else
                    _instanceof(f, PointLight)
                      ? (o += 1)
                      : _instanceof(f, DirectionalLight) && (l += 1);
                }
                s("NUMBER_OF_AMBIENT_LIGHTS", a),
                  s("NUMBER_OF_POINT_LIGHTS", o),
                  s("NUMBER_OF_DIRECTIONAL_LIGHTS", l);
              }),
              (r._A = function (n, i) {
                var s = [];
                if (
                  (n.NUMBER_OF_AMBIENT_LIGHTS > 0 &&
                    (s.push("ambientLight.intensity"),
                    s.push("ambientLight.lightColor")),
                  n.NUMBER_OF_POINT_LIGHTS > 0)
                )
                  for (var a = 0; a < n.NUMBER_OF_POINT_LIGHTS; a++)
                    s.push("pointLights[".concat(a, "].intensity")),
                      s.push("pointLights[".concat(a, "].dist")),
                      s.push("pointLights[".concat(a, "].lightColor")),
                      s.push("pointLights[".concat(a, "].position"));
                if (n.NUMBER_OF_DIRECTIONAL_LIGHTS > 0)
                  for (var o = 0; o < n.NUMBER_OF_DIRECTIONAL_LIGHTS; o++)
                    s.push("directionalLights[".concat(o, "].intensity")),
                      s.push("directionalLights[".concat(o, "].lightColor")),
                      s.push("directionalLights[".concat(o, "].direction"));
                return s.reduce(function (l, u) {
                  return (l[u] = i.prop(u)), l;
                }, {});
              }),
              (r.IA = function (n) {
                var i,
                  s = [],
                  a = [],
                  o = !0,
                  l = !1,
                  u = void 0;
                try {
                  for (
                    var f = n[Symbol.iterator](), c;
                    !(o = (c = f.next()).done);
                    o = !0
                  ) {
                    var h = c.value,
                      p = {};
                    h.iA(p),
                      _instanceof(h, AmbientLight)
                        ? (i = p)
                        : _instanceof(h, PointLight)
                        ? s.push(p)
                        : _instanceof(h, DirectionalLight) && a.push(p);
                  }
                } catch (m) {
                  (l = !0), (u = m);
                } finally {
                  try {
                    !o && f.return != null && f.return();
                  } finally {
                    if (l) throw u;
                  }
                }
                var d = {};
                return (
                  i && (d.ambientLight = i),
                  s.length && (d.pointLights = s),
                  a.length && (d.directionalLights = a),
                  d
                );
              }),
              r
            );
          })(),
          NoneState = 0,
          FreshState = 1,
          UpdateState = 2,
          LabelsRender$1 = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              _classCallCheck(this, i);
              var a;
              return (
                (a = n.call.apply(
                  n,
                  [this].concat(Array.prototype.slice.call(arguments))
                )),
                (a.g$ = []),
                (a.renderState = NoneState),
                a
              );
            }
            var s = i.prototype;
            return (
              (s.m$ = function (a) {
                (a.state & MeshesDirty) === MeshesDirty
                  ? (this.renderState |= FreshState)
                  : (a.state & MeshDirty) === MeshDirty &&
                    (this.renderState |= UpdateState);
              }),
              (s.render = function (a) {
                if ("AMap" in window) {
                  var o = a.mf || {},
                    l = o.labels;
                  l &&
                    l.length &&
                    ((this.renderState & FreshState) === FreshState
                      ? ((this.g$ = l.map(function (u) {
                          return new AMap.LabelMarker(u);
                        })),
                        this._$.clear(),
                        this._$.add(this.g$),
                        (this.renderState = NoneState))
                      : (this.renderState & UpdateState) === UpdateState
                      ? (this.g$.forEach(function (u, f) {
                          u.setText({ content: "" }), (u._opts = l[f]);
                        }),
                        (this.renderState ^= UpdateState))
                      : (this.renderState = NoneState));
                } else
                  console.log(
                    "[LabelsRender]: \u4EC5\u652F\u6301\u5728AMap\u4E0A\u8FDB\u884Clabels\u6E32\u67D3\u3002"
                  ),
                    (this.renderState = NoneState);
              }),
              (s.p$ = function (a) {
                this._$ = new AMap.LabelsLayer(a.d$.labelLayerOpts || {});
                var o = a.map;
                o.hasLayer(this._$) || o.add(this._$);
              }),
              (s.O$ = function () {
                var a;
                (a = this._$) == null || a.show();
              }),
              (s.k$ = function () {
                var a;
                (a = this._$) == null || a.hide();
              }),
              (s.destroy = function () {
                var a, o;
                (a = this._$) == null || a.clear(),
                  (o = this._$) == null || o.setMap(null);
              }),
              i
            );
          })(SubRender),
          __defProp$q = Object.defineProperty,
          __defProps$e = Object.defineProperties,
          __getOwnPropDescs$e = Object.getOwnPropertyDescriptors,
          __getOwnPropSymbols$q = Object.getOwnPropertySymbols,
          __hasOwnProp$q = Object.prototype.hasOwnProperty,
          __propIsEnum$q = Object.prototype.propertyIsEnumerable,
          __defNormalProp$q = function (r, n, i) {
            return n in r
              ? __defProp$q(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$q = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$q.call(n, i) && __defNormalProp$q(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$q)
              try {
                for (
                  var l = __getOwnPropSymbols$q(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$q.call(n, i) && __defNormalProp$q(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __spreadProps$e = function (r, n) {
            return __defProps$e(r, __getOwnPropDescs$e(n));
          },
          PolygonsRender = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              _classCallCheck(this, i);
              var a;
              return (
                (a = n.call.apply(
                  n,
                  [this].concat(Array.prototype.slice.call(arguments))
                )),
                (a.v$ = [new LabelsRender$1()]),
                a
              );
            }
            var s = i.prototype;
            return (
              (s.m$ = function (a) {
                if (!this.regl) return !1;
                this.v$.forEach(function (u) {
                  return u.m$(a);
                });
                var o = this.regl,
                  l = RenderHelper._A(a, o);
                this.gA(PolygonShader, a, {
                  attributes: __spreadValues$q(
                    {
                      position: o.prop("position"),
                      color: o.prop("color"),
                      normal: o.prop("normal"),
                      uv: o.prop("uv"),
                      textureSize: o.prop("textureSize"),
                      topOrBottom: o.prop("topOrBottom"),
                    },
                    ColorGLSL.getColor(o).attribute
                  ),
                  uniforms: __spreadValues$q(
                    __spreadValues$q(
                      __spreadValues$q(
                        __spreadValues$q(
                          {
                            mvp: o.prop("mvp"),
                            opacity: o.prop("opacity"),
                            shininess: o.prop("shininess"),
                            cameraPosition: o.prop("cameraPosition"),
                            texture: o.prop("texture"),
                            useTexture: o.prop("useTexture"),
                          },
                          ColorGLSL.getColor(o).uniform
                        ),
                        RenderUtil.getScaleUniform("altitude", o)
                      ),
                      RenderUtil.getScaleUniform("height", o)
                    ),
                    l
                  ),
                  blend: { enable: !0, func: RenderUtil.getBlend("normal") },
                  cull: {
                    enable: o.prop("cullEnable"),
                    face: o.prop("cullface"),
                  },
                  frontFace: "cw",
                  depth: { enable: o.prop("depth"), func: "lequal" },
                  colorMask: o.prop("colorMask"),
                  elements: o.prop("index"),
                });
              }),
              (s.render = function (a) {
                var o = this.yA(PolygonShader);
                if (o) {
                  var l = a.meshes,
                    u = a.mvp,
                    f = a.lights,
                    c = a.R$,
                    h = a.opacity,
                    p = a.cull,
                    d = a.cameraPosition,
                    m = a.shininess,
                    g = a.acceptLight,
                    v = a.texture,
                    y = a.useTexture,
                    _ = a.depth,
                    b = a.vP,
                    S = p !== "none",
                    P = p === "front" ? "front" : "back";
                  if (c)
                    for (var I = 0; I < l.length; I++) {
                      var F = l[I],
                        X = F.attributes;
                      o(
                        __spreadValues$q(
                          __spreadProps$e(
                            __spreadValues$q(__spreadValues$q({}, X), f),
                            {
                              mvp: u,
                              colorMask: [!1, !1, !1, !1],
                              opacity: h,
                              cullEnable: S,
                              cullface: P,
                              depth: _,
                              cameraPosition: d,
                              shininess: m,
                              acceptLight: g,
                              texture: v,
                              useTexture: y,
                              isPick: !1,
                            }
                          ),
                          RenderUtil.getScaleProps(b)
                        )
                      );
                    }
                  for (var W = 0; W < l.length; W++) {
                    var Z = l[W],
                      j = Z.attributes;
                    o(
                      __spreadValues$q(
                        __spreadProps$e(
                          __spreadValues$q(__spreadValues$q({}, j), f),
                          {
                            mvp: u,
                            colorMask: [!0, !0, !0, !0],
                            opacity: h,
                            cullEnable: S,
                            cullface: P,
                            cameraPosition: d,
                            depth: _,
                            shininess: m,
                            acceptLight: g,
                            texture: v,
                            useTexture: y,
                            isPick: !1,
                          }
                        ),
                        RenderUtil.getScaleProps(b)
                      )
                    );
                  }
                  for (var L = 0; L < l.length; L++) {
                    var T = !0,
                      A = !1,
                      $ = void 0;
                    try {
                      for (
                        var R = this.v$[Symbol.iterator](), M;
                        !(T = (M = R.next()).done);
                        T = !0
                      ) {
                        var w = M.value;
                        w.render(l[L]);
                      }
                    } catch (O) {
                      (A = !0), ($ = O);
                    } finally {
                      try {
                        !T && R.return != null && R.return();
                      } finally {
                        if (A) throw $;
                      }
                    }
                  }
                }
              }),
              (s.pickRender = function (a) {
                var o = this.yA(PolygonShader);
                if (o) {
                  var l = a.meshes,
                    u = a.mvp,
                    f = a.lights,
                    c = a.opacity,
                    h = a.cull,
                    p = a.cameraPosition,
                    d = a.depth,
                    m = a.texture,
                    g = a.pickFbo,
                    v = a.pickPos,
                    y = a.vP,
                    _ = h !== "none",
                    b = h === "front" ? "front" : "back";
                  if (g && v) {
                    var S = this;
                    g.use(function () {
                      S.regl.clear({ color: [0, 0, 0, 0], depth: 1 });
                      for (var P = 0; P < l.length; P++) {
                        var I = l[P],
                          F = I.attributes;
                        o(
                          __spreadValues$q(
                            __spreadProps$e(
                              __spreadValues$q(__spreadValues$q({}, F), f),
                              {
                                mvp: u,
                                colorMask: [!0, !0, !0, !0],
                                opacity: c,
                                cullEnable: _,
                                cullface: b,
                                cameraPosition: p,
                                depth: d,
                                shininess: 1,
                                acceptLight: !1,
                                texture: m,
                                useTexture: !1,
                                isPick: !0,
                              }
                            ),
                            RenderUtil.getScaleProps(y)
                          )
                        );
                      }
                    });
                  }
                }
              }),
              i
            );
          })(Render),
          __defProp$p = Object.defineProperty,
          __getOwnPropSymbols$p = Object.getOwnPropertySymbols,
          __hasOwnProp$p = Object.prototype.hasOwnProperty,
          __propIsEnum$p = Object.prototype.propertyIsEnumerable,
          __defNormalProp$p = function (r, n, i) {
            return n in r
              ? __defProp$p(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$p = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$p.call(n, i) && __defNormalProp$p(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$p)
              try {
                for (
                  var l = __getOwnPropSymbols$p(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$p.call(n, i) && __defNormalProp$p(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          getMipMap$1 = RenderUtil.getMipMap,
          pushArray$n = CommonUtil$1._C,
          PolygonLayer = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              (o = n.call(this, a)),
                (o.CLASS_NAME = "Polygon"),
                (o.styleOptions = {}),
                (o.fusion = new PolygonsFusion()),
                (o.ll = new PolygonsRender()),
                (o.Vw = !0);
              var l = polygon.Sw;
              return (
                (o.zooms = a.zooms === void 0 ? l.zooms : a.zooms),
                (o.visible = a.visible === void 0 ? l.visible : a.visible),
                (o.zIndex = a.zIndex === void 0 ? l.zIndex : a.zIndex),
                (o.opacity = a.opacity === void 0 ? l.opacity : a.opacity),
                (o.depth = a.depth === void 0 ? l.depth : a.depth),
                (o.R$ = a.R$ === void 0 ? l.R$ : a.R$),
                (o.I$ = a.I$ === void 0 ? l.I$ : a.I$),
                (o.shininess =
                  a.shininess === void 0 ? l.shininess : a.shininess),
                (o.acceptLight =
                  a.acceptLight === void 0 ? l.acceptLight : a.acceptLight),
                (o.cullface = a.cullface || l.cullface),
                (o.hasSide = a.hasSide === void 0 ? l.hasSide : a.hasSide),
                o.AC({ zooms: o.zooms, visible: o.visible, zIndex: o.zIndex }),
                o.buryPoint.record(o.CLASS_NAME),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.receiveDataset = function (a) {
                (this.dataset = a),
                  this.setStyle(this.styleOptions),
                  this.onAdd();
              }),
              (s.setStyle = function (a) {
                if (
                  (_get(_getPrototypeOf(i.prototype), "setStyle", this).call(
                    this,
                    a
                  ),
                  (this.Kf = null),
                  (this.dataset = this.source.LC()),
                  this.dataset && this.dataset.length > 0 && this.meshes)
                ) {
                  var o = this.WC(),
                    l = o.didFusion,
                    u = this.fusion.buildStyle(this.dataset, this.styleOptions);
                  this.fusion.updateStyle(l, u, this),
                    (this.vA.state |= MeshDirty),
                    this.loca && this.loca.requestRender();
                }
              }),
              (s.getInitialAnimateState = function () {
                return {
                  altitude: {
                    time: [1, 0, 0, 0],
                    type: [-1, 1, 0, 0],
                    value: [0, 1],
                  },
                  height: {
                    time: [1, 0, 0, 0],
                    type: [-1, 1, 0, 0],
                    value: [0, 1],
                  },
                };
              }),
              (s.jC = function () {
                _get(_getPrototypeOf(i.prototype), "jC", this).call(this),
                  !(!this.loca || !this.loca.regl || this.ll.regl) &&
                    ((this.ll.regl = this.loca.regl),
                    this.loca.rendererManager.addRenderer(this.ll));
              }),
              (s.beforeRender = function () {
                if (
                  (_get(
                    _getPrototypeOf(i.prototype),
                    "beforeRender",
                    this
                  ).call(this),
                  !this.fusion.regl &&
                    this.loca &&
                    ((this.fusion.regl = this.loca.regl),
                    this.loca.fusionManager.addFusion(this.fusion)),
                  this.jC(),
                  this.source && (this.dataset = this.source.LC()),
                  this.fusion && this.dataset && this.dataset.length > 0)
                ) {
                  var a = this.WC(),
                    o = a.willFusion,
                    l = a.didFusion;
                  if (o.length > 0) {
                    var u = this.fusion.fusion(o, this.styleOptions, this);
                    (this.meshes = pushArray$n(l, u)),
                      (this.vA.state |= MeshesDirty);
                  }
                }
                var f = this.meshes[0] && this.meshes[0].uniforms.texture;
                this.Rw(f);
              }),
              (s.render = function () {
                var a;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var o = this.loca.customCoords.getCameraParams().position,
                    l =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    u = RenderHelper.IA(this.loca.lights);
                  this.ll &&
                    this.meshes.length > 0 &&
                    this.ll.render({
                      meshes: this.meshes,
                      mvp: l,
                      lights: u,
                      shininess: this.shininess,
                      acceptLight: this.acceptLight,
                      opacity: this._getOpacity(),
                      depth: this.depth,
                      cull: this.cullface,
                      R$: this.R$,
                      cameraPosition: o,
                      texture: this.Kf,
                      useTexture: this.Vw,
                      vP: this._animateLayerState,
                    });
                }
              }),
              (s.pickRender = function () {
                var a;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var o =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    l = this.loca.customCoords.getCameraParams().position,
                    u = RenderHelper.IA(this.loca.lights);
                  this.ll &&
                    this.Kf &&
                    this.ll.pickRender({
                      meshes: this.meshes,
                      mvp: o,
                      lights: u,
                      shininess: this.shininess,
                      acceptLight: this.acceptLight,
                      opacity: this._getOpacity(),
                      depth: this.depth,
                      R$: this.R$,
                      cull: this.cullface,
                      texture: this.Kf,
                      pickFbo: this._needPickFrame && this._pickFbo,
                      pickPos: this._pickPos,
                      cameraPosition: l,
                      vP: this._animateLayerState,
                    });
                }
              }),
              (s.afterRender = function () {}),
              (s.Rw = function (a) {
                if (
                  ((this.Vw = !!a),
                  !(this.Kf || !this.loca || !this.loca.regl) &&
                    ((this.Kf = this.loca.regl.texture({
                      data: [
                        [
                          [0, 255, 0, 0],
                          [255, 0, 0, 0],
                        ],
                        [
                          [0, 0, 255, 0],
                          [255, 255, 0, 0],
                        ],
                      ],
                      flipY: !0,
                    })),
                    !!a))
                )
                  if (Object.prototype.toString.call(a) === "[object String]") {
                    var o = this,
                      l = new Image();
                    (l.crossOrigin = "anonymous"),
                      (l.src = a),
                      (l.onload = function () {
                        o.Kf = o.loca.regl.texture(
                          __spreadValues$p(
                            { data: l, flipY: !0 },
                            getMipMap$1(l.naturalWidth, l.naturalHeight)
                          )
                        );
                      });
                  } else
                    this.Kf = this.loca.regl.texture(
                      __spreadValues$p(
                        { data: a, flipY: !0 },
                        getMipMap$1(a.width, a.height)
                      )
                    );
              }),
              (s.PA = function () {
                return RenderHelper.SA(this.ll, this);
              }),
              i
            );
          })(Layer),
          pushArray$m = CommonUtil$1._C,
          LineFusion = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.DC = function () {}),
              (s.buildStyle = function (a, o) {
                for (var l, u = line.style, f = [], c = 0; c < a.length; c++)
                  if (!(!a[c].features || !a[c].features.lines)) {
                    for (
                      var h = a[c].features.lines,
                        p = StyleInstance.parse(h, o, u),
                        d = {},
                        m = 0;
                      m < h.length;
                      m++
                    )
                      if (p)
                        for (var g in p.attributes) {
                          var v = p.attributes[g];
                          d[g] || (d[g] = []),
                            ((l = v[m]) == null ? void 0 : l.length) > 0
                              ? pushArray$m(d[g], v[m])
                              : (d[g][d[g].length] = v[m]);
                        }
                    f.push({ attributes: d, uniforms: p.uniforms, si: p.si });
                  }
                return f;
              }),
              (s.fusion = function (a, o, l, u) {
                if (!this.regl || !l.loca) return [];
                var f = [];
                u = u || this.buildStyle(a, o);
                for (var c = l.loca.customCoords, h = 0; h < a.length; h++) {
                  var p = a[h];
                  if (!(!p.features || !p.features.lines || !u[h])) {
                    for (
                      var d = p.features.lines,
                        m = u[h],
                        g = {
                          index: [],
                          vertex: [],
                          color: [],
                          normal: [],
                          lineWidth: [],
                          distance: [],
                          dash: [],
                          borderColor: [],
                          borderWidth: [],
                          pickColor: [],
                        },
                        v = [],
                        y = 0;
                      y < d.length;
                      y++
                    ) {
                      var _ = d[y],
                        b = _.coordinates,
                        S = l.colorPick.add(_);
                      if (_.type === "MultiLineString")
                        for (var P = 0, I = b.length; P < I; P++) {
                          var F = b[P],
                            X = this.triangles(
                              F,
                              { style: m, index: y, pickColor: S, id: _.sr },
                              c
                            );
                          GeoUtil.mergeTriangles(g, X, 4),
                            pushArray$m(g.color, X.color),
                            pushArray$m(g.normal, X.normal),
                            pushArray$m(g.lineWidth, X.lineWidth),
                            pushArray$m(g.distance, X.distance),
                            pushArray$m(g.dash, X.dash),
                            pushArray$m(g.borderColor, X.borderColor),
                            pushArray$m(g.pickColor, X.pickColor),
                            pushArray$m(g.borderWidth, X.borderWidth);
                        }
                      else {
                        var W = this.triangles(
                          b,
                          { style: m, index: y, pickColor: S, id: _.sr },
                          c
                        );
                        GeoUtil.mergeTriangles(g, W, 4),
                          pushArray$m(g.color, W.color),
                          pushArray$m(g.normal, W.normal),
                          pushArray$m(g.lineWidth, W.lineWidth),
                          pushArray$m(g.distance, W.distance),
                          pushArray$m(g.dash, W.dash),
                          pushArray$m(g.pickColor, W.pickColor),
                          pushArray$m(g.borderColor, W.borderColor),
                          pushArray$m(g.borderWidth, W.borderWidth);
                      }
                      v[y] = g.lineWidth.length;
                    }
                    f[h] = {
                      id: p.id,
                      attributes: {
                        color: {
                          buffer: this.regl.buffer(g.color),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        dash: {
                          buffer: this.regl.buffer(g.dash),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        position: {
                          buffer: this.regl.buffer(g.vertex),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        normal: {
                          buffer: this.regl.buffer(g.normal),
                          offset: 0,
                          stride: 4 * 3,
                          td: !1,
                          divisor: 0,
                        },
                        lineWidth: {
                          buffer: this.regl.buffer(g.lineWidth),
                          offset: 0,
                          stride: 4,
                          td: !1,
                          divisor: 0,
                        },
                        borderWidth: {
                          buffer: this.regl.buffer(g.borderWidth),
                          offset: 0,
                          stride: 4,
                          td: !1,
                          divisor: 0,
                        },
                        borderColor: {
                          buffer: this.regl.buffer(g.borderColor),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        distance: {
                          buffer: this.regl.buffer(g.distance),
                          offset: 0,
                          stride: 4 * 2,
                          td: !1,
                          divisor: 0,
                        },
                        pickColor: {
                          buffer: this.regl.buffer(g.pickColor),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        index: this.regl.elements({
                          primitive: "triangles",
                          type: "uint32",
                          data: g.index,
                        }),
                      },
                      uniforms: m.uniforms,
                      si: m.si,
                      mf: {
                        Tw: { jw: v },
                        altitude: m.attributes.altitude,
                        origin: {
                          color: g.color,
                          lineWidth: g.lineWidth,
                          borderColor: g.borderColor,
                          borderWidth: g.borderWidth,
                          dash: g.dash,
                          vertex: g.vertex,
                        },
                      },
                    };
                  }
                }
                return f;
              }),
              (s.triangles = function (a, o, l) {
                var u = o.index,
                  f = o.pickColor,
                  c = o.style.attributes,
                  h = c.lineWidth,
                  p = c.color,
                  d = c.dash,
                  m = c.borderColor,
                  g = c.borderWidth,
                  v = c.altitude,
                  y = p.slice(u * 4, u * 4 + 4),
                  _ = d.slice(u * 4, u * 4 + 4),
                  b = m.slice(u * 4, u * 4 + 4),
                  S = g[u],
                  P = h[u],
                  I = v[u],
                  F = { vertex: [], index: [] },
                  X = [],
                  W = [],
                  Z = [],
                  j = [],
                  L = [],
                  T = [],
                  A = [],
                  $ = [],
                  R = glMatrix.vec3.create();
                glMatrix.vec3.set(R, 0, 0, 1);
                for (var M, w, O, E = 0, k = 0, D = a.length; k < D - 1; k++) {
                  var q = [],
                    J = [0, 1, 3, 0, 3, 2],
                    de = M || l.lngLatToCoord(a[k]),
                    we = a[k][2] || I || 0,
                    Se = w || l.lngLatToCoord(a[k + 1]),
                    He = a[k + 1][2] || I || 0,
                    et = !1,
                    Ke = !1,
                    Fe = 0,
                    qe = 0,
                    Mt = W.length;
                  k > 0 && (Fe = W[Mt - 1]);
                  var ot = glMatrix.vec2.distance(de, Se),
                    at = Math.max(ot, E),
                    Lt = at;
                  (qe = Fe + ot),
                    k + 2 < D &&
                      ((et = l.lngLatToCoord(a[k + 2])),
                      (Lt = Math.max(ot, glMatrix.vec2.distance(et, Se)))),
                    pushArray$m(W, [at, Fe, at, Fe, Lt, qe, Lt, qe]);
                  var $t = this.calcNormal(de, Se, R),
                    Rt = [$t[0], $t[1], 0],
                    Ot = [0, 0, 0],
                    wt = [0, 0, 0],
                    kt = O || { Fw: $t, angle: Math.PI },
                    Pt = et
                      ? this.calcAngleNormal(de, Se, et)
                      : { Fw: $t, angle: Math.PI };
                  Pt.Fw[0] === 0 &&
                    Pt.Fw[1] === 0 &&
                    ((Pt.Fw[0] = -$t[0]), (Pt.Fw[1] = -$t[1])),
                    (Ot[0] = kt.Fw[0]),
                    (Ot[1] = kt.Fw[1]),
                    (wt[0] = Pt.Fw[0]),
                    (wt[1] = Pt.Fw[1]);
                  var At = this.calcAngle($t, Ot),
                    ut = this.calcAngle($t, wt);
                  (At < Math.PI / 2 && ut < Math.PI / 2) ||
                  (At > Math.PI / 2 && ut > Math.PI / 2)
                    ? (Ke = !0)
                    : (Ke = !1),
                    At < Math.PI / 2 && ($t = [-$t[0], -$t[1], 0]),
                    ut < Math.PI / 2 && (Rt = [-Rt[0], -Rt[1], 0]);
                  var ct = this.calcWise(Ot, [-$t[0], -$t[1]]) || 1,
                    vt = this.calcWise(wt, [-Rt[0], -Rt[1]]) || 1;
                  if (
                    ((Ot[2] = -ct * kt.angle),
                    (wt[2] = -vt * Pt.angle),
                    this.addVertex({
                      Lw: q,
                      Gh: Z,
                      Ww: X,
                      Nw: A,
                      Uw: j,
                      qw: L,
                      Gw: T,
                      Qw: $,
                      vertex: [de[0], de[1], we, o.id],
                      color: y,
                      normal: $t,
                      lineWidth: P,
                      dash: _,
                      Hw: b,
                      Yw: S,
                      pickColor: f,
                    }),
                    this.addVertex({
                      Lw: q,
                      Gh: Z,
                      Ww: X,
                      Nw: A,
                      Uw: j,
                      qw: L,
                      Gw: T,
                      Qw: $,
                      vertex: [de[0], de[1], we, o.id],
                      color: y,
                      normal: Ot,
                      lineWidth: P,
                      dash: _,
                      Hw: b,
                      Yw: S,
                      pickColor: f,
                    }),
                    this.addVertex({
                      Lw: q,
                      Gh: Z,
                      Ww: X,
                      Nw: A,
                      Uw: j,
                      qw: L,
                      Gw: T,
                      Qw: $,
                      vertex: [Se[0], Se[1], He, o.id],
                      color: y,
                      normal: Ke ? Rt : wt,
                      lineWidth: P,
                      dash: _,
                      Hw: b,
                      Yw: S,
                      pickColor: f,
                    }),
                    this.addVertex({
                      Lw: q,
                      Gh: Z,
                      Ww: X,
                      Nw: A,
                      Uw: j,
                      qw: L,
                      Gw: T,
                      Qw: $,
                      vertex: [Se[0], Se[1], He, o.id],
                      color: y,
                      normal: Ke ? wt : Rt,
                      lineWidth: P,
                      dash: _,
                      Hw: b,
                      Yw: S,
                      pickColor: f,
                    }),
                    et)
                  ) {
                    pushArray$m(W, [Lt, qe]);
                    var rt = this.calcNormal(Se, et, R),
                      Wt = this.calcAngle(rt, wt);
                    Wt < Math.PI / 2 && ((rt[0] = -rt[0]), (rt[1] = -rt[1])),
                      this.addVertex({
                        Lw: q,
                        Gh: Z,
                        Ww: X,
                        Nw: A,
                        Uw: j,
                        qw: L,
                        Gw: T,
                        Qw: $,
                        vertex: [Se[0], Se[1], He, o.id],
                        color: y,
                        normal: rt,
                        lineWidth: P,
                        dash: _,
                        Hw: b,
                        Yw: S,
                        pickColor: f,
                      }),
                      (J[6] = 2),
                      (J[7] = 3),
                      (J[8] = 4);
                  }
                  GeoUtil.mergeTriangles(F, { index: J, vertex: q }, 4),
                    (M = Se),
                    (w = et),
                    (O = Pt),
                    (E = Lt);
                }
                return {
                  index: F.index,
                  vertex: F.vertex,
                  distance: W,
                  normal: X,
                  color: Z,
                  lineWidth: A,
                  dash: j,
                  borderColor: L,
                  borderWidth: T,
                  pickColor: $,
                };
              }),
              (s.addVertex = function (a) {
                var o = a.Lw,
                  l = a.Gh,
                  u = a.Ww,
                  f = a.Nw,
                  c = a.Uw,
                  h = a.qw,
                  p = a.Gw,
                  d = a.Qw,
                  m = a.vertex,
                  g = a.color,
                  v = a.normal,
                  y = a.lineWidth,
                  _ = a.dash,
                  b = a.Hw,
                  S = a.Yw,
                  P = a.pickColor,
                  I = o.length,
                  F = l.length,
                  X = u.length;
                (o[I] = m[0]),
                  (o[I + 1] = m[1]),
                  (o[I + 2] = m[2]),
                  (o[I + 3] = m[3]),
                  (l[F] = g[0]),
                  (l[F + 1] = g[1]),
                  (l[F + 2] = g[2]),
                  (l[F + 3] = g[3]),
                  (u[X] = v[0]),
                  (u[X + 1] = v[1]),
                  (u[X + 2] = v[2]),
                  (f[f.length] = y),
                  (c[F] = _[0]),
                  (c[F + 1] = _[1]),
                  (c[F + 2] = _[2]),
                  (c[F + 3] = _[3]),
                  (h[F] = b[0]),
                  (h[F + 1] = b[1]),
                  (h[F + 2] = b[2]),
                  (h[F + 3] = b[3]),
                  (d[F] = P[0]),
                  (d[F + 1] = P[1]),
                  (d[F + 2] = P[2]),
                  (d[F + 3] = P[3]),
                  (p[p.length] = S);
              }),
              (s.calcAngleNormal = function (a, o, l) {
                var u = glMatrix.vec2.create();
                glMatrix.vec2.set(u, a[0], a[1]);
                var f = glMatrix.vec2.create();
                glMatrix.vec2.set(f, o[0], o[1]);
                var c = glMatrix.vec2.create();
                glMatrix.vec2.set(c, l[0], l[1]);
                var h = glMatrix.vec2.create();
                glMatrix.vec2.sub(h, u, f), glMatrix.vec2.normalize(h, h);
                var p = glMatrix.vec2.create();
                glMatrix.vec2.sub(p, c, f), glMatrix.vec2.normalize(p, p);
                var d = glMatrix.vec2.create();
                return (
                  glMatrix.vec2.add(d, h, p),
                  glMatrix.vec2.normalize(d, d),
                  {
                    Fw: [d[0], d[1], 0],
                    angle: this.calcAngle([h[0], h[1], 0], [p[0], p[1], 0]),
                  }
                );
              }),
              (s.calcAngle = function (a, o) {
                var l = glMatrix.vec3.dot(a, o),
                  u = l / glMatrix.vec3.length(a) / glMatrix.vec3.length(o);
                return Math.acos(Math.max(-1, Math.min(1, u)));
              }),
              (s.calcNormal = function (a, o, l) {
                var u = glMatrix.vec3.create(),
                  f = glMatrix.vec3.create();
                glMatrix.vec3.set(f, a[0], a[1], 0);
                var c = glMatrix.vec3.create();
                glMatrix.vec3.set(c, o[0], o[1], 0);
                var h = glMatrix.vec3.create();
                return (
                  glMatrix.vec3.sub(h, c, f),
                  glMatrix.vec3.cross(u, l, h),
                  glMatrix.vec3.normalize(u, u),
                  [u[0], u[1], 0]
                );
              }),
              (s.calcWise = function (a, o) {
                var l = glMatrix.vec3.create(),
                  u = glMatrix.vec2.fromValues(a[0], a[1]),
                  f = glMatrix.vec2.fromValues(o[0], o[1]);
                return (
                  glMatrix.vec2.cross(l, u, f),
                  l[2] === 0 ? l[2] : l[2] / Math.abs(l[2])
                );
              }),
              (s.updateStyle = function (a, o) {
                for (var l = 0, u = a.length; l < u; l++) {
                  for (
                    var f = a[l],
                      c = o[l].attributes,
                      h = c.color,
                      p = c.lineWidth,
                      d = c.borderColor,
                      m = c.borderWidth,
                      g = c.dash,
                      v = c.altitude,
                      y = f.mf.origin,
                      _ = y.borderColor,
                      b = y.color,
                      S = y.lineWidth,
                      P = y.borderWidth,
                      I = y.dash,
                      F = y.vertex,
                      X = f.mf.altitude,
                      W = f.mf.Tw.jw,
                      Z = 0,
                      j = 0,
                      L = S.length;
                    j < L;
                    j++
                  ) {
                    var T = j * 4;
                    j >= W[Z] && Z++;
                    var A = Z * 4;
                    (b[T] = h[A]),
                      (b[T + 1] = h[A + 1]),
                      (b[T + 2] = h[A + 2]),
                      (b[T + 3] = h[A + 3]),
                      (_[T] = d[A]),
                      (_[T + 1] = d[A + 1]),
                      (_[T + 2] = d[A + 2]),
                      (_[T + 3] = d[A + 3]),
                      (I[T] = g[A]),
                      (I[T + 1] = g[A + 1]),
                      (I[T + 2] = g[A + 2]),
                      (I[T + 3] = g[A + 3]),
                      (P[j] = m[Z]),
                      (S[j] = p[Z]),
                      X[Z] !== v[Z] && (F[T + 2] = v[Z]);
                  }
                  f.attributes.color.buffer({ data: b }),
                    f.attributes.lineWidth.buffer({ data: S }),
                    f.attributes.borderColor.buffer({ data: _ }),
                    f.attributes.borderWidth.buffer({ data: P }),
                    f.attributes.dash.buffer({ data: I }),
                    f.attributes.position.buffer({ data: F });
                }
              }),
              (s.EC = function () {
                return [];
              }),
              (s.destroy = function () {
                this.regl = null;
              }),
              i
            );
          })(GeometryFusion),
          LineShader = {
            vertex:
              "\n        precision highp float;\n        #define PI 3.14159265359\n        attribute vec4 position;\n        attribute vec4 color;\n        attribute vec4 borderColor;\n        attribute vec4 dash;\n        attribute vec3 normal;\n        attribute float lineWidth;\n        attribute float borderWidth;\n        attribute vec2 distance;\n        varying vec4 vColor;\n        varying vec4 vBorderColor;\n        varying vec4 vDash;\n        varying vec2 vNormal;\n        varying float vDist;\n        varying float vWidth;\n        varying float vBorderWidth;\n        uniform mat4 mvp;\n        uniform float resolution;\n        uniform float unit; // 0: px; 1: meter;\n        "
                .concat(ColorGLSL.getColorShader().vertex, "\n        ")
                .concat(RenderUtil.getBezier(), "\n        ")
                .concat(RenderUtil.getScaleType("lineWidth"), "\n        ")
                .concat(
                  RenderUtil.getScaleType("altitude"),
                  "\n\n        void main() {\n            vColor = color;\n            vBorderColor = borderColor;\n            vDash = dash;\n            vDist = distance.y; // \u8DDD\u79BB\u7EBF\u8D77\u59CB\u70B9\u7684\u8DDD\u79BB\n            float res = unit == 0.0 ? resolution : 1.0;\n            float lineWidthScale = lineWidthScaleValue(position.w);\n            float altitudeScale = altitudeScaleValue(position.w);\n            float realLineWidth = (borderWidth + lineWidth / 2.) * res * lineWidthScale;\n            vWidth = lineWidth * lineWidthScale;\n            vBorderWidth = borderWidth * lineWidthScale;\n            // \u7EBF\u6BB5\u7684\u6CD5\u5411\u91CF\u8FD8\u539F\n            vec2 tmpNormal = normal.xy;\n            float angleLineWidth = realLineWidth;\n\n            // z \u65B9\u5411\u4E0D\u7B49\u4E8E 0\uFF0C\u8BF4\u660E\u662F\u62D0\u89D2\u5411\u91CF\uFF0Cz \u4EE3\u8868\u89D2\u5EA6\uFF0C\u9700\u8981\u5BF9\u7EBF\u5BBD\u8FDB\u884C\u8BA1\u7B97\n            if(normal.z != 0.0) {\n                angleLineWidth /= sin(abs(normal.z / 2.));\n                angleLineWidth = max(realLineWidth, min(distance.x, angleLineWidth));\n\n                // \u62D0\u89D2\u5904\u7684\u6CD5\u5411\u91CF\uFF0C\u9700\u8981\u8FD8\u539F\u6210\u5782\u76F4\u7EBF\u6BB5\u65B9\u5411\u7684\u5411\u91CF\n                // \u8FD9\u6837\u624D\u80FD\u5C06\u63CF\u8FB9\u8BA1\u7B97\u51FA\u6765\n                // \u65CB\u8F6C\u89D2\u5EA6\u8BA1\u7B97\n                float theta = normal.z / abs(normal.z) * ((PI - abs(normal.z)) / 2.);\n                // \u65CB\u8F6C\n                tmpNormal =\n                    mat2(cos(theta), -sin(theta),\n                         sin(theta), cos(theta)) * tmpNormal;\n            }\n            vNormal = normalize(tmpNormal.xy);\n\n            vec3 pos = position.xyz + vec3(normal.xy, 0) * angleLineWidth;\n            gl_Position = mvp * vec4(pos.xy, pos.z * altitudeScale, 1.0);\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainVert,
                  "\n        }\n    "
                ),
            fragment:
              "\n        precision highp float;\n        uniform float resolution;\n        uniform float unit; // 0: px; 1: meter;\n        uniform float opacity;\n        varying vec4 vDash;\n        varying vec2 vNormal;\n        varying vec4 vColor;\n        varying float vDist;\n        varying float vWidth;\n        varying float vBorderWidth;\n        varying vec4 vBorderColor;\n        "
                .concat(
                  ColorGLSL.getColorShader().fragment,
                  "\n\n        void main() {\n            float res = unit == 0.0 ? resolution : 1.0;\n            float distPixel = vDist / res;\n            float offset = mod(distPixel, vDash.r + vDash.g + vDash.b + vDash.a);\n            if(offset > vDash.r && offset < vDash.r + vDash.g) {\n                discard;\n            } else if(offset > vDash.r + vDash.g + vDash.b) {\n                discard;\n            }\n\n            gl_FragColor = vColor;\n\n            if(vBorderWidth > 0. && length(vNormal) > 1. - vBorderWidth / (vWidth / 2. + vBorderWidth)) {\n                gl_FragColor = vBorderColor;\n            }\n            gl_FragColor.a *= opacity;\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainFrag,
                  "\n        }\n    "
                ),
          },
          __defProp$o = Object.defineProperty,
          __defProps$d = Object.defineProperties,
          __getOwnPropDescs$d = Object.getOwnPropertyDescriptors,
          __getOwnPropSymbols$o = Object.getOwnPropertySymbols,
          __hasOwnProp$o = Object.prototype.hasOwnProperty,
          __propIsEnum$o = Object.prototype.propertyIsEnumerable,
          __defNormalProp$o = function (r, n, i) {
            return n in r
              ? __defProp$o(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$o = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$o.call(n, i) && __defNormalProp$o(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$o)
              try {
                for (
                  var l = __getOwnPropSymbols$o(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$o.call(n, i) && __defNormalProp$o(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __spreadProps$d = function (r, n) {
            return __defProps$d(r, __getOwnPropDescs$d(n));
          },
          LineRender = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.m$ = function (a) {
                if (!this.regl) return !1;
                var o = this.regl;
                this.gA(LineShader, a, {
                  attributes: __spreadValues$o(
                    {
                      position: o.prop("position"),
                      color: o.prop("color"),
                      lineWidth: o.prop("lineWidth"),
                      normal: o.prop("normal"),
                      distance: o.prop("distance"),
                      dash: o.prop("dash"),
                      borderColor: o.prop("borderColor"),
                      borderWidth: o.prop("borderWidth"),
                    },
                    ColorGLSL.getColor(o).attribute
                  ),
                  uniforms: __spreadValues$o(
                    __spreadValues$o(
                      __spreadValues$o(
                        {
                          mvp: o.prop("mvp"),
                          resolution: o.prop("resolution"),
                          unit: o.prop("unit"),
                          opacity: o.prop("opacity"),
                        },
                        RenderUtil.getScaleUniform("altitude", o)
                      ),
                      RenderUtil.getScaleUniform("lineWidth", o)
                    ),
                    ColorGLSL.getColor(o).uniform
                  ),
                  cull: { enable: !1 },
                  depth: { enable: o.prop("depth") },
                  blend: { enable: !0, func: RenderUtil.getBlend() },
                  elements: o.prop("index"),
                });
              }),
              (s.render = function (a) {
                var o = this.yA(LineShader);
                if (o)
                  for (
                    var l = a.meshes,
                      u = a.mvp,
                      f = a.resolution,
                      c = a.opacity,
                      h = a.vP,
                      p = a.depth,
                      d = 0;
                    d < l.length;
                    d++
                  ) {
                    var m = l[d],
                      g = m.attributes,
                      v = m.uniforms,
                      y = v.unit;
                    o(
                      __spreadProps$d(
                        __spreadValues$o(
                          __spreadProps$d(__spreadValues$o({}, g), {
                            unit: y === "px" ? 0 : 1,
                            mvp: u,
                            resolution: f,
                            depth: p,
                            opacity: c,
                          }),
                          RenderUtil.getScaleProps(h)
                        ),
                        { isPick: !1 }
                      )
                    );
                  }
              }),
              (s.pickRender = function (a) {
                var o = this.yA(LineShader);
                if (o) {
                  var l = a.meshes,
                    u = a.mvp,
                    f = a.resolution,
                    c = a.opacity,
                    h = a.pickFbo,
                    p = a.pickPos,
                    d = a.depth,
                    m = a.vP;
                  if (h && p) {
                    var g = this;
                    h.use(function () {
                      g.regl.clear({ color: [0, 0, 0, 0], depth: 1 });
                      for (var v = 0; v < l.length; v++) {
                        var y = l[v],
                          _ = y.attributes,
                          b = y.uniforms,
                          S = b.unit;
                        o(
                          __spreadValues$o(
                            __spreadProps$d(__spreadValues$o({}, _), {
                              unit: S === "px" ? 0 : 1,
                              mvp: u,
                              depth: d,
                              resolution: f,
                              opacity: c,
                              isPick: !0,
                            }),
                            RenderUtil.getScaleProps(m)
                          )
                        );
                      }
                    });
                  }
                }
              }),
              i
            );
          })(Render),
          pushArray$l = CommonUtil$1._C,
          LineLayer = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              (o = n.call(this, a)),
                (o.CLASS_NAME = "Line"),
                (o.fusion = new LineFusion()),
                (o.ll = new LineRender()),
                (o.depth = !1);
              var l = line.Sw;
              return (
                (o.zooms = a.zooms === void 0 ? l.zooms : a.zooms),
                (o.zIndex = a.zIndex === void 0 ? l.zIndex : a.zIndex),
                (o.opacity = a.opacity === void 0 ? l.opacity : a.opacity),
                (o.visible = a.visible === void 0 ? l.visible : a.visible),
                (o.depth = a.depth === void 0 ? l.depth : a.depth),
                o.AC({ zooms: o.zooms, visible: o.visible, zIndex: o.zIndex }),
                o.buryPoint.record(o.CLASS_NAME),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.receiveDataset = function (a) {
                (this.dataset = a),
                  this.setStyle(this.styleOptions),
                  this.onAdd();
              }),
              (s.setStyle = function (a) {
                if (
                  (_get(_getPrototypeOf(i.prototype), "setStyle", this).call(
                    this,
                    a
                  ),
                  (this.dataset = this.source.LC()),
                  this.dataset && this.dataset.length > 0 && this.meshes)
                ) {
                  var o = this.WC(),
                    l = o.didFusion,
                    u = this.fusion.buildStyle(this.dataset, this.styleOptions);
                  this.fusion.updateStyle(l, u),
                    this.loca && this.loca.requestRender();
                }
              }),
              (s.getInitialAnimateState = function () {
                return {
                  altitude: {
                    time: [1, 0, 0, 0],
                    type: [-1, 1, 0, 0],
                    value: [0, 1],
                  },
                  lineWidth: {
                    time: [1, 0, 0, 0],
                    type: [-1, 1, 0, 0],
                    value: [0, 1],
                  },
                };
              }),
              (s.jC = function () {
                _get(_getPrototypeOf(i.prototype), "jC", this).call(this),
                  !(!this.loca || !this.loca.regl || this.ll.regl) &&
                    ((this.ll.regl = this.loca.regl),
                    this.loca.rendererManager.addRenderer(this.ll));
              }),
              (s.beforeRender = function () {
                if (
                  (_get(
                    _getPrototypeOf(i.prototype),
                    "beforeRender",
                    this
                  ).call(this),
                  !this.fusion.regl &&
                    this.loca &&
                    ((this.fusion.regl = this.loca.regl),
                    this.loca.fusionManager.addFusion(this.fusion)),
                  this.jC(),
                  this.source && (this.dataset = this.source.LC()),
                  this.fusion)
                ) {
                  var a = this.WC(),
                    o = a.willFusion,
                    l = a.didFusion;
                  if ((this.fusion.EC(), o.length > 0)) {
                    var u = this.fusion.fusion(o, this.styleOptions, this);
                    this.meshes = pushArray$l(l, u);
                  }
                }
              }),
              (s.render = function () {
                var a, o;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var l =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    u = this.projection.getResolution(
                      (o = this.loca) == null ? void 0 : o.map.getZoom()
                    );
                  this.ll &&
                    this.meshes.length > 0 &&
                    this.ll.render({
                      meshes: this.meshes,
                      mvp: l,
                      vP: this._animateLayerState,
                      resolution: u,
                      depth: this.depth,
                      opacity: this._getOpacity(),
                    });
                }
              }),
              (s.pickRender = function () {
                var a, o;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var l =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    u = this.projection.getResolution(
                      (o = this.loca) == null ? void 0 : o.map.getZoom()
                    );
                  this.ll &&
                    this.ll.pickRender({
                      meshes: this.meshes,
                      mvp: l,
                      vP: this._animateLayerState,
                      resolution: u,
                      depth: this.depth,
                      opacity: this._getOpacity(),
                      pickFbo: this._needPickFrame && this._pickFbo,
                      pickPos: this._pickPos,
                    });
                }
              }),
              (s.afterRender = function () {}),
              (s.PA = function () {
                return RenderHelper.SA(this.ll, this);
              }),
              i
            );
          })(Layer),
          __defProp$n = Object.defineProperty,
          __defProps$c = Object.defineProperties,
          __getOwnPropDescs$c = Object.getOwnPropertyDescriptors,
          __getOwnPropSymbols$n = Object.getOwnPropertySymbols,
          __hasOwnProp$n = Object.prototype.hasOwnProperty,
          __propIsEnum$n = Object.prototype.propertyIsEnumerable,
          __defNormalProp$n = function (r, n, i) {
            return n in r
              ? __defProp$n(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$n = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$n.call(n, i) && __defNormalProp$n(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$n)
              try {
                for (
                  var l = __getOwnPropSymbols$n(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$n.call(n, i) && __defNormalProp$n(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __spreadProps$c = function (r, n) {
            return __defProps$c(r, __getOwnPropDescs$c(n));
          },
          pushArray$k = CommonUtil$1._C,
          colorToArray = ColorUtil$1.zC.bind(ColorUtil$1),
          DEFAULT_VALUE = 0,
          _HeatMapFusion = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              _classCallCheck(this, i);
              var a;
              return (
                (a = n.call.apply(
                  n,
                  [this].concat(Array.prototype.slice.call(arguments))
                )),
                (a.dP = [1 / 0, -1 / 0]),
                a
              );
            }
            var s = i.prototype;
            return (
              (s.DC = function () {
                for (
                  var a =
                      arguments.length > 0 && arguments[0] !== void 0
                        ? arguments[0]
                        : 1e3,
                    o =
                      arguments.length > 1 && arguments[1] !== void 0
                        ? arguments[1]
                        : 1e3,
                    l = [],
                    u = [],
                    f = 0;
                  f < a;
                  f++
                )
                  for (var c = 0; c < o; c++) {
                    if (c < o - 1 && f >= 1) {
                      var h = ((f - 1) * a + c) * 6;
                      (l[h] = a * (f - 1) + c + 1),
                        (l[h + 1] = a * (f - 1) + c),
                        (l[h + 2] = f * a + c),
                        (l[h + 3] = a * (f - 1) + c + 1),
                        (l[h + 4] = f * a + c),
                        (l[h + 5] = f * a + 1 + c);
                    }
                    u.push(f * a + c);
                  }
                return {
                  size: [a, o],
                  index: this.regl.elements({
                    primitive: "triangles",
                    type: "uint32",
                    data: l,
                  }),
                  position: {
                    buffer: this.regl.buffer(u),
                    offset: 0,
                    stride: 4 * 1,
                    td: !1,
                    divisor: 0,
                  },
                  texture: this.regl.texture({
                    data: [
                      [
                        [0, 255, 0, 200],
                        [255, 0, 0, 200],
                      ],
                      [
                        [0, 0, 255, 200],
                        [255, 0, 255, 200],
                      ],
                    ],
                    flipY: !0,
                  }),
                };
              }),
              (s.buildStyle = function (a, o) {
                for (
                  var l,
                    u = heatmap.style,
                    f = { attributes: [], uniforms: !1, si: !1 },
                    c = 0;
                  c < a.length;
                  c++
                )
                  if (!(!a[c].features || !a[c].features.points)) {
                    var h = a[c].features.points,
                      p = StyleInstance.parse(h, o, u),
                      d = {};
                    f.uniforms || (f.uniforms = p.uniforms),
                      f.si || (f.si = p.si);
                    for (var m = 0, g = h.length; m < g; m++)
                      if (p)
                        for (var v in p.attributes) {
                          var y = p.attributes[v];
                          d[v] || (d[v] = []),
                            ((l = y[m]) == null ? void 0 : l.length) > 0
                              ? pushArray$k(d[v], y[m])
                              : (d[v][d[v].length] = y[m]);
                        }
                    f.attributes.push(d);
                  }
                return f;
              }),
              (s.fusion = function (a, o, l, u) {
                if (!this.regl || !l.loca) return [];
                var f = [];
                u = u || this.buildStyle(a, o);
                for (
                  var c = u.attributes,
                    h = l.loca.customCoords,
                    p = [1 / 0, 1 / 0, -1 / 0, -1 / 0],
                    d = 0,
                    m = [1 / 0, -1 / 0],
                    g = this.GC(u.uniforms.gradient),
                    v = 0;
                  v < a.length;
                  v++
                ) {
                  var y = a[v];
                  if (!(!y.features || !y.features.points || !c[v])) {
                    for (
                      var _ = y.features.points,
                        b = c[v],
                        S = [],
                        P = { vertex: [], index: [], radius: [], value: [] },
                        I = [],
                        F = 0;
                      F < _.length;
                      F++
                    ) {
                      var X = _[F],
                        W = X.coordinates,
                        Z = +b.radius[F],
                        j = +b.value[F];
                      Number.isNaN(j) && ((j = DEFAULT_VALUE), I.push(F));
                      var L = X.sr;
                      if (X.type === "MultiPoint")
                        for (var T = 0, A = W.length; T < A; T++) {
                          var $ = h.lngLatToCoord(W[T]),
                            R = [
                              $[0],
                              $[1],
                              0,
                              L,
                              $[0],
                              $[1],
                              1,
                              L,
                              $[0],
                              $[1],
                              2,
                              L,
                              $[0],
                              $[1],
                              3,
                              L,
                            ];
                          GeoUtil.mergeTriangles(
                            P,
                            { vertex: R, index: [0, 1, 2, 1, 3, 2] },
                            4
                          ),
                            pushArray$k(P.radius, [Z, Z, Z, Z]),
                            pushArray$k(P.value, [j, j, j, j]),
                            this.calcBbox(p, $),
                            (d = Math.max(d, Z)),
                            (m[0] = Math.min(j, m[0])),
                            (m[1] = Math.max(j, m[1]));
                        }
                      else {
                        var M = h.lngLatToCoord(W),
                          w = [
                            M[0],
                            M[1],
                            0,
                            L,
                            M[0],
                            M[1],
                            1,
                            L,
                            M[0],
                            M[1],
                            2,
                            L,
                            M[0],
                            M[1],
                            3,
                            L,
                          ];
                        GeoUtil.mergeTriangles(
                          P,
                          { vertex: w, index: [0, 1, 2, 1, 3, 2] },
                          4
                        ),
                          pushArray$k(P.radius, [Z, Z, Z, Z]),
                          pushArray$k(P.value, [j, j, j, j]),
                          this.calcBbox(p, M),
                          (d = Math.max(d, Z)),
                          (m[0] = Math.min(j, m[0])),
                          (m[1] = Math.max(j, m[1]));
                      }
                      S[F] = P.radius.length;
                    }
                    this.V$(I),
                      (f[v] = {
                        id: y.id,
                        attributes: {
                          position: {
                            buffer: this.regl.buffer(P.vertex),
                            offset: 0,
                            stride: 4 * 4,
                            td: !1,
                            divisor: 0,
                          },
                          radius: {
                            buffer: this.regl.buffer(P.radius),
                            offset: 0,
                            stride: 4,
                            td: !1,
                            divisor: 0,
                          },
                          value: {
                            buffer: this.regl.buffer(P.value),
                            offset: 0,
                            stride: 4,
                            td: !1,
                            divisor: 0,
                          },
                          index: this.regl.elements({
                            primitive: "triangles",
                            type: "uint32",
                            data: P.index,
                          }),
                        },
                        uniforms: __spreadProps$c(
                          __spreadValues$n({}, u.uniforms),
                          {
                            gradient: g.Gh,
                            alpha: g.alpha,
                            maxRadius: d,
                            dataBBox: p,
                            min:
                              u.uniforms.min === null ? m[0] : u.uniforms.min,
                            max:
                              u.uniforms.max === null ? m[1] : u.uniforms.max,
                          }
                        ),
                        si: __spreadProps$c(__spreadValues$n({}, u.si), {
                          count: b.radius.length,
                        }),
                        mf: {
                          origin: { radius: P.radius, value: P.value },
                          Tw: { jw: S },
                        },
                      });
                  }
                }
                return (this.dP = m), f;
              }),
              (s.updateStyle = function (a, o) {
                for (
                  var l = this.GC(o.uniforms.gradient), u = 0, f = a.length;
                  u < f;
                  u++
                ) {
                  for (
                    var c = a[u],
                      h = o.attributes[u],
                      p = h.radius,
                      d = h.value,
                      m = c.mf.origin,
                      g = m.radius,
                      v = m.value,
                      y = c.mf.Tw.jw,
                      _ = 0,
                      b = 0,
                      S = [1 / 0, -1 / 0],
                      P = new Set(),
                      I = 0,
                      F = g.length;
                    I < F;
                    I++
                  ) {
                    I >= y[_] && _++, (g[I] = p[_]);
                    var X = +d[_];
                    Number.isNaN(X) && ((X = DEFAULT_VALUE), P.add(_)),
                      (v[I] = X),
                      (b = Math.max(b, p[_])),
                      (S[0] = Math.min(X, S[0])),
                      (S[1] = Math.max(X, S[1]));
                  }
                  c.attributes.radius.buffer({ data: g }),
                    c.attributes.value.buffer({ data: v }),
                    (c.uniforms = __spreadProps$c(
                      __spreadValues$n(
                        __spreadValues$n({}, c.uniforms),
                        o.uniforms
                      ),
                      {
                        gradient: l.Gh,
                        alpha: l.alpha,
                        maxRadius: b,
                        min: o.uniforms.min === null ? S[0] : o.uniforms.min,
                        max: o.uniforms.max === null ? S[1] : o.uniforms.max,
                      }
                    )),
                    this.V$(Array.from(P));
                }
              }),
              (s.EC = function () {
                return [];
              }),
              (s.calcBbox = function (a, o) {
                var l = o[0],
                  u = o[1];
                (a[0] = Math.min(l, a[0])),
                  (a[1] = Math.min(u, a[1])),
                  (a[2] = Math.max(l, a[2])),
                  (a[3] = Math.max(u, a[3]));
              }),
              (s.GC = function (a) {
                var o = [],
                  l = [];
                for (var u in a)
                  a.hasOwnProperty(u) &&
                    o.push({ stop: parseFloat(u), color: a[u] });
                o.sort(function (p, d) {
                  return p.stop - d.stop;
                });
                for (var f = [], c = 0; c < o.length; c += 1) {
                  var h = colorToArray(o[c].color);
                  l.push(o[c].stop, h[0], h[1], h[2]), f.push(h[3]);
                }
                return { Gh: l, alpha: f };
              }),
              (s.destroy = function () {
                this.regl = null;
              }),
              (s.V$ = function (a) {
                a.length &&
                  console.warn(
                    "\u6570\u636E\u6E90\u4E2D\u5B58\u5728value\u53D6\u503C\u7F3A\u5931\uFF0C\u9ED8\u8BA4\u4E3A"
                      .concat(
                        DEFAULT_VALUE,
                        "\uFF0C\u53EF\u80FD\u4F1A\u5F71\u54CD\u8BA1\u7B97\u7ED3\u679C\uFF0C\u8BF7\u68C0\u67E5\u7B2C"
                      )
                      .concat(a.join("\u3001"), "\u4E2A\u6570\u636E")
                  );
              }),
              (i.getInstance = function () {
                return this.ui;
              }),
              i
            );
          })(GeometryFusion),
          HeatMapFusion = _HeatMapFusion;
        (HeatMapFusion.ui = new _HeatMapFusion()), HeatMapFusion.getInstance();
        var HeatMapShader = {
            gray: {
              vertex:
                "\n            precision highp float;\n            attribute vec4 position;\n            attribute float value;\n            attribute float radius;\n\n            varying float vValue;\n            varying vec2 vDir;\n            varying float vRadius;\n\n            uniform vec4 bbox;\n            uniform float resolution;\n            uniform float unit; // 0: px; 1: meter;\n            uniform float maxRadius;\n            // uniform float radiusScale;\n            "
                  .concat(RenderUtil.getBezier(), "\n            ")
                  .concat(
                    RenderUtil.getScaleType("radius"),
                    "\n\n            // \u8BA1\u7B97\u65B9\u4F4D, xy \u662F\u4F4D\u7F6E, zw \u662F \u65B9\u5411 \u5750\u6807\n            vec4 getPosByDirection(vec2 pos, float direction, float r) {\n                vec2 targetPos;\n                vec2 dir;\n\n                targetPos = vec2(pos - r);\n                dir = vec2(-1, -1);\n                if (direction == 1.0) {\n                    targetPos = vec2(pos.x - r, pos.y + r);\n                    dir = vec2(-1, 1);\n                } else if (direction == 2.0) {\n                    targetPos = vec2(pos.x + r, pos.y - r);\n                    dir = vec2(1, -1);\n                } else if (direction == 3.0) {\n                    targetPos = vec2(pos + r);\n                    dir = vec2(1, 1);\n                }\n                return vec4(targetPos, normalize(dir));\n            }\n\n            void main() {\n                float radiusScale = radiusScaleValue(position.w);\n                float r = radius * radiusScale;\n                float maxR = maxRadius;\n                if(unit == 0.0) {\n                    r *= resolution;\n                    maxR *= resolution;\n                }\n                vec4 b = vec4(bbox.xy - maxR, bbox.zw + maxR);\n                vec2 center = vec2((b.z + b.x) / 2.0, (b.w + b.y) / 2.0);\n                vec2 bboxSize = vec2((b.z - b.x), (b.w - b.y)) / 2.0;\n                vec4 posDir = getPosByDirection(position.xy - center, position.z, r);\n                gl_Position = vec4(posDir.xy / bboxSize, 0, 1);\n                vValue = value;\n                vDir = posDir.zw * sqrt(r * r * 2.0);\n                vRadius = r;\n            }\n        "
                  ),
              fragment:
                "\n            precision highp float;\n            varying float vValue;\n            varying vec2 vDir;\n            varying float vRadius;\n\n            uniform float max;\n            uniform float min;\n\n            void main() {\n                float len = length(vDir);\n                gl_FragColor = vec4(1, 0, 0, (vRadius - len) / vRadius * (vValue - min) / (max - min));\n            }\n        ",
            },
            grid: {
              vertex:
                "\n            precision highp float;\n            attribute float position;\n\n            varying float vValue;\n            varying vec2 vUv;\n\n            uniform mat4 mvp;\n            uniform float resolution;\n            uniform float height;\n            uniform float unit; // 0: px; 1: meter;\n            uniform vec2 size;\n            uniform vec4 bbox;\n            uniform float maxRadius;\n            uniform vec4 heightBezier;\n            uniform sampler2D texture;\n            "
                  .concat(RenderUtil.getBezier(), "\n            ")
                  .concat(
                    RenderUtil.getScaleType("height"),
                    "\n\n            vec2 bezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {\n                float t2 = t * t;\n                float one_minus_t = 1.0 - t;\n                float one_minus_t2 = one_minus_t * one_minus_t;\n                return (P0 * one_minus_t2 * one_minus_t + P1 * 3.0 * t * one_minus_t2 + P2 * 3.0 * t2 * one_minus_t + P3 * t2 * t);\n            }\n\n            vec2 toBezier(float t, vec4 p) {\n                return bezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));\n            }\n\n            // \u8BA1\u7B97\u7EB9\u7406\u5750\u6807\n            vec2 calcUV(float index, vec2 size) {\n                float y = floor(index / size.x);\n                float x = mod(index, size.x);\n                return vec2(x / (size.x - 1.0), y / (size.y - 1.0));\n            }\n\n            // \u8BA1\u7B97\u9876\u70B9\u5750\u6807\n            vec2 calcVertex(float index, vec2 size, vec4 bbox) {\n                // \u6839\u636E\u7D22\u5F15\u83B7\u53D6\u7ECF\u7EAC\u5EA6\n                float col = mod(index, size.x);\n                float row = floor(index / size.x);\n                float widthStep = (bbox.b - bbox.r) / (size.x - 1.0);\n                float heightStep = (bbox.a - bbox.g) / (size.y - 1.0);\n                float x = bbox.x + col * widthStep;\n                float y = bbox.y + row * heightStep;\n                return vec2(x, y);\n            }\n\n            void main() {\n                float heightScale = heightScaleValue(position);\n                vUv = calcUV(position, size);\n                vec4 color = texture2D(texture, vUv);\n                float h = height * toBezier(color.a, heightBezier).y;\n                float maxR = maxRadius;\n                if(unit == 0.0) {\n                    h *= resolution;\n                    maxR *= resolution;\n                }\n                vec4 b = vec4(bbox.xy - maxR, bbox.zw + maxR);\n                gl_Position = mvp * vec4(calcVertex(position, size, b), h * heightScale, 1);\n            }\n        "
                  ),
              fragment:
                "\n            precision highp float;\n            varying vec2 vUv;\n            uniform sampler2D texture;\n            uniform float opacity;\n            uniform vec4 gradient[8];\n            uniform vec2 alpha;\n            uniform bool difference;\n            uniform bool isPick;\n\n            float fade(float low, float high, float value) {\n                if (value < low || value > high) { return 0.0; }\n                return (value-low) / (high-low);\n            }\n\n            // \u6570\u503C\u6620\u5C04\u51FD\u6570\uFF0C\u4E3A\u4E86\u5C06 x:0-1 \u6620\u5C04\u5230\u4EFB\u610F\u4E00\u4E2A [min, max] \u533A\u95F4\u7684\u503C\n            float scaleMap(float min, float max, float x) {\n                if(x == 0.0) {\n                    return x;\n                }\n                if(x < 0.0) {\n                    return min;\n                }\n                if(x > 1.0) {\n                    return max;\n                }\n                float delta = max - min;\n                return min + delta * x;\n            }\n\n            vec4 getColor(float intensity) {\n                vec3 color = vec3(0);\n                float a = 1.0;\n                color = mix(vec3(0, 0, 1), gradient[0].yzw, fade(0.0, gradient[0].x, intensity));\n                for (int gn = 0; gn < 8; gn += 1) {\n                    if (gradient[gn].x >= intensity) {\n                        \n                        // \u5F69\u8679\u6548\u679C\n                        if(difference) {\n                            color = mix(gradient[gn+1].yzw, gradient[gn].yzw, intensity);\n                        } else {\n                            // \u6B63\u5E38\u6548\u679C\n                            color = mix(gradient[gn-1].yzw, gradient[gn].yzw, fade(gradient[gn-1].x, gradient[gn].x, intensity));\n                        }\n                        break;\n                    }\n\n                    // bool isBreak = false;\n                    // if (gradient[gn].x >= intensity) {\n                    //     color = mix(gradient[gn-1].yzw, gradient[gn].yzw, intensity);\n                    //     isBreak = true;\n                    // }\n                    // float delta = gradient[gn].x - intensity;\n                    // if((delta > -0.01 && delta < 0.01) && gn > 0 && intensity <= 1.0) {\n                    //     // \u5F69\u8679\u6548\u679C\n                    //     color = mix(gradient[gn+1].yzw, gradient[gn].yzw, (delta * 100. + 1.) / 2.);\n                    //     // color = vec3(0,1,0);\n                    // }\n                    // if(isBreak) {\n                    //     break;\n                    // }\n                }\n                return vec4(color, scaleMap(alpha.x, alpha.y, intensity));\n            }\n\n            void main() {\n                vec4 gray = texture2D(texture, vUv);\n                gl_FragColor = getColor(gray.a);\n                gl_FragColor.a *= opacity;\n                if (isPick) {\n                    // \u907F\u514D\u900F\u660E\u5EA6\u5F71\u54CD\u62FE\u53D6\u51C6\u786E\u6027\uFF0C\u8FD9\u91CC\u628Aa\u901A\u9053\u7684\u503C\u8F6C\u79FB\u5230b\u901A\u9053\n                    gl_FragColor = vec4(0, 0, gray.a, 1);\n                }\n            }\n        ",
            },
          },
          __defProp$m = Object.defineProperty,
          __defProps$b = Object.defineProperties,
          __getOwnPropDescs$b = Object.getOwnPropertyDescriptors,
          __getOwnPropSymbols$m = Object.getOwnPropertySymbols,
          __hasOwnProp$m = Object.prototype.hasOwnProperty,
          __propIsEnum$m = Object.prototype.propertyIsEnumerable,
          __defNormalProp$m = function (r, n, i) {
            return n in r
              ? __defProp$m(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$m = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$m.call(n, i) && __defNormalProp$m(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$m)
              try {
                for (
                  var l = __getOwnPropSymbols$m(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$m.call(n, i) && __defNormalProp$m(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __spreadProps$b = function (r, n) {
            return __defProps$b(r, __getOwnPropDescs$b(n));
          },
          _HeatMapRender = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              _classCallCheck(this, i);
              var a;
              return (
                (a = n.call.apply(
                  n,
                  [this].concat(Array.prototype.slice.call(arguments))
                )),
                (a.Xw = [0, 0]),
                a
              );
            }
            var s = i.prototype;
            return (
              (s.m$ = function (a) {
                if (!this.regl) return !1;
                var o = this.regl;
                (this.Jw = o.framebuffer({
                  width: o._gl.drawingBufferWidth,
                  height: o._gl.drawingBufferHeight,
                  Zh: !1,
                  stencil: !1,
                  depth: !1,
                })),
                  (this.Xw = [
                    this.regl._gl.drawingBufferWidth,
                    this.regl._gl.drawingBufferHeight,
                  ]),
                  this.gA(HeatMapShader.gray, a, {
                    framebuffer: o.prop("framebuffer"),
                    attributes: {
                      position: o.prop("position"),
                      value: o.prop("value"),
                      radius: o.prop("radius"),
                    },
                    uniforms: __spreadValues$m(
                      {
                        bbox: o.prop("bbox"),
                        unit: o.prop("unit"),
                        resolution: o.prop("resolution"),
                        min: o.prop("min"),
                        max: o.prop("max"),
                        maxRadius: o.prop("maxRadius"),
                      },
                      RenderUtil.getScaleUniform("radius", o)
                    ),
                    depth: { enable: !1 },
                    blend: { enable: !0, func: RenderUtil.getBlend() },
                    elements: o.prop("index"),
                  }),
                  this.gA(HeatMapShader.grid, a, {
                    attributes: { position: o.prop("position") },
                    uniforms: __spreadValues$m(
                      {
                        mvp: o.prop("mvp"),
                        opacity: o.prop("opacity"),
                        texture: o.prop("texture"),
                        bbox: o.prop("bbox"),
                        size: o.prop("size"),
                        height: o.prop("height"),
                        unit: o.prop("unit"),
                        heightBezier: o.prop("heightBezier"),
                        resolution: o.prop("resolution"),
                        maxRadius: o.prop("maxRadius"),
                        gradient: o.prop("gradient"),
                        alpha: o.prop("alpha"),
                        difference: o.prop("difference"),
                        isPick: o.prop("isPick"),
                      },
                      RenderUtil.getScaleUniform("height", o)
                    ),
                    depth: { enable: o.prop("depth") },
                    blend: { enable: !0, func: RenderUtil.getBlend() },
                    cull: { enable: !0, face: "back" },
                    frontFace: "cw",
                    elements: o.prop("index"),
                  });
              }),
              (s.render = function (a) {
                var o = this,
                  l = function (P) {
                    var I = o,
                      F = c[P],
                      X = F.attributes,
                      W = F.uniforms,
                      Z = W.unit,
                      j = W.max,
                      L = W.min,
                      T = W.gradient,
                      A = W.opacity,
                      $ = W.heightBezier,
                      R = W.height,
                      M = W.dataBBox,
                      w = W.maxRadius,
                      O = W.difference,
                      E = F.si,
                      k = E.count,
                      D = o.QC(y, M);
                    o.Jw.use(function () {
                      I.regl.clear({ color: [0, 0, 0, 0], depth: 1 }),
                        u(
                          __spreadValues$m(
                            __spreadProps$b(
                              __spreadValues$m({ framebuffer: I.Jw }, X),
                              {
                                unit: Z === "px" ? 0 : 1,
                                resolution: p,
                                max: j,
                                min: L,
                                bbox: D,
                                maxRadius: w,
                                count: k,
                              }
                            ),
                            RenderUtil.getScaleProps(b, "radius")
                          )
                        );
                    }),
                      f(
                        __spreadValues$m(
                          {
                            texture: o.Jw,
                            heightBezier: $,
                            unit: Z === "px" ? 0 : 1,
                            height: R,
                            gradient: o.HC(T),
                            alpha: A,
                            position: g,
                            index: m,
                            resolution: p,
                            mvp: h,
                            bbox: D,
                            maxRadius: w,
                            size: v,
                            opacity: d,
                            depth: _,
                            difference: O,
                            isPick: !1,
                          },
                          RenderUtil.getScaleProps(b, "height")
                        )
                      );
                  },
                  u = this.yA(HeatMapShader.gray),
                  f = this.yA(HeatMapShader.grid);
                if (!(!u || !f)) {
                  var c = a.meshes,
                    h = a.mvp,
                    p = a.resolution,
                    d = a.opacity,
                    m = a.index,
                    g = a.position,
                    v = a.size,
                    y = a.bbox,
                    _ = a.depth,
                    b = a.vP;
                  (this.Xw[0] !== this.regl._gl.drawingBufferWidth ||
                    this.Xw[1] !== this.regl._gl.drawingBufferHeight) &&
                    ((this.Xw = [
                      this.regl._gl.drawingBufferWidth,
                      this.regl._gl.drawingBufferHeight,
                    ]),
                    this.Jw({ width: this.Xw[0], height: this.Xw[1] }));
                  for (var S = 0; S < c.length; S++) l(S);
                }
              }),
              (s.pickRender = function (a) {
                var o = this.yA(HeatMapShader.gray),
                  l = this.yA(HeatMapShader.grid);
                if (!(!o || !l)) {
                  var u = a.meshes,
                    f = a.mvp,
                    c = a.resolution,
                    h = a.opacity,
                    p = a.index,
                    d = a.position,
                    m = a.size,
                    g = a.bbox,
                    v = a.depth,
                    y = a.vP,
                    _ = a.pickFbo,
                    b = a.pickPos;
                  if (_ && b) {
                    var S = this;
                    _.use(function () {
                      S.regl.clear({ color: [0, 0, 0, 0], depth: 1 });
                      for (var P = 0; P < u.length; P++) {
                        var I = u[P],
                          F = I.uniforms,
                          X = F.unit,
                          W = F.gradient,
                          Z = F.opacity,
                          j = F.heightBezier,
                          L = F.height,
                          T = F.dataBBox,
                          A = F.maxRadius,
                          $ = F.difference,
                          R = S.QC(g, T);
                        l(
                          __spreadValues$m(
                            {
                              texture: S.Jw,
                              heightBezier: j,
                              unit: X === "px" ? 0 : 1,
                              height: L,
                              gradient: S.HC(W),
                              alpha: Z,
                              position: d,
                              index: p,
                              resolution: c,
                              mvp: f,
                              bbox: R,
                              maxRadius: A,
                              size: m,
                              opacity: h,
                              depth: v,
                              difference: $,
                              isPick: !0,
                            },
                            RenderUtil.getScaleProps(y, "height")
                          )
                        );
                      }
                    });
                  }
                }
              }),
              (s.QC = function (a, o) {
                var l = [];
                return (
                  (l[0] = Math.max(a[0], o[0])),
                  (l[1] = Math.max(a[1], o[1])),
                  (l[2] = Math.min(a[2], o[2])),
                  (l[3] = Math.min(a[3], o[3])),
                  l
                );
              }),
              (s.HC = function (a) {
                for (var o = a.length, l = 0; l < 8; l++)
                  o <= l * 4 && (a = a.concat([-1, 0, 0, 0]));
                return a;
              }),
              (s.destroy = function () {
                _get(_getPrototypeOf(i.prototype), "destroy", this).call(this),
                  this.Jw && this.Jw.destroy(),
                  (this.Jw = null);
              }),
              (i.getInstance = function () {
                return this.ui;
              }),
              i
            );
          })(Render),
          HeatMapRender = _HeatMapRender;
        (HeatMapRender.ui = new _HeatMapRender()), HeatMapRender.getInstance();
        var __defProp$l = Object.defineProperty,
          __defProps$a = Object.defineProperties,
          __getOwnPropDescs$a = Object.getOwnPropertyDescriptors,
          __getOwnPropSymbols$l = Object.getOwnPropertySymbols,
          __hasOwnProp$l = Object.prototype.hasOwnProperty,
          __propIsEnum$l = Object.prototype.propertyIsEnumerable,
          __defNormalProp$l = function (r, n, i) {
            return n in r
              ? __defProp$l(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$l = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$l.call(n, i) && __defNormalProp$l(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$l)
              try {
                for (
                  var l = __getOwnPropSymbols$l(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$l.call(n, i) && __defNormalProp$l(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __spreadProps$a = function (r, n) {
            return __defProps$a(r, __getOwnPropDescs$a(n));
          },
          pushArray$j = CommonUtil$1._C,
          HeatMapLayer = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              (o = n.call(this, a)),
                (o.CLASS_NAME = "HeatMap"),
                (o.fusion = new HeatMapFusion()),
                (o.ll = new HeatMapRender()),
                (o.Kw = !1);
              var l = heatmap.Sw;
              return (
                (o.zooms = a.zooms === void 0 ? l.zooms : a.zooms),
                (o.zIndex = a.zIndex === void 0 ? l.zIndex : a.zIndex),
                (o.opacity = a.opacity === void 0 ? l.opacity : a.opacity),
                (o.visible = a.visible === void 0 ? l.visible : a.visible),
                (o.depth = a.depth === void 0 ? l.depth : a.depth),
                o.AC({ zooms: o.zooms, visible: o.visible, zIndex: o.zIndex }),
                o.buryPoint.record(o.CLASS_NAME),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.receiveDataset = function (a) {
                (this.dataset = a),
                  this.setStyle(this.styleOptions),
                  this.onAdd();
              }),
              (s.setStyle = function (a) {
                if (
                  (_get(_getPrototypeOf(i.prototype), "setStyle", this).call(
                    this,
                    a
                  ),
                  (this.dataset = this.source.LC()),
                  this.dataset && this.dataset.length > 0 && this.meshes)
                ) {
                  var o = this.WC(),
                    l = o.didFusion,
                    u = this.fusion.buildStyle(this.dataset, this.styleOptions);
                  this.fusion.updateStyle(l, u),
                    this.loca && this.loca.requestRender();
                }
              }),
              (s.getInitialAnimateState = function () {
                return {
                  height: {
                    time: [1, 0, 0, 0],
                    type: [-1, 1, 0, 0],
                    value: [0, 1],
                  },
                  radius: {
                    time: [1, 0, 0, 0],
                    type: [-1, 1, 0, 0],
                    value: [0, 1],
                  },
                };
              }),
              (s.jC = function () {
                _get(_getPrototypeOf(i.prototype), "jC", this).call(this),
                  !(!this.loca || !this.loca.regl || this.ll.regl) &&
                    ((this.ll.regl = this.loca.regl),
                    this.loca.rendererManager.addRenderer(this.ll));
              }),
              (s.beforeRender = function () {
                if (
                  (_get(
                    _getPrototypeOf(i.prototype),
                    "beforeRender",
                    this
                  ).call(this),
                  !this.fusion.regl &&
                    this.loca &&
                    ((this.fusion.regl = this.loca.regl),
                    this.loca.fusionManager.addFusion(this.fusion)),
                  this.jC(),
                  this.source && (this.dataset = this.source.LC()),
                  this.fusion)
                ) {
                  var a = this.WC(),
                    o = a.willFusion,
                    l = a.didFusion;
                  if ((this.fusion.EC(), o.length > 0)) {
                    var u = this.fusion.fusion(o, this.styleOptions, this);
                    (this.meshes = pushArray$j(l, u)),
                      (this.Kw = this.Kw || this.fusion.DC());
                  }
                }
              }),
              (s.render = function () {
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var a = this.loca.customCoords,
                    o = a.getMVPMatrix(),
                    l = this.projection.getResolution(this.loca.map.getZoom()),
                    u = this.loca.map.getBounds().toJSON(),
                    f = _toConsumableArray(
                      a.lngLatToCoord(u.slice(0, 2))
                    ).concat(_toConsumableArray(a.lngLatToCoord(u.slice(2))));
                  this.ll &&
                    this.meshes.length > 0 &&
                    this.ll.render(
                      __spreadProps$a(
                        __spreadValues$l(
                          {
                            meshes: this.meshes,
                            mvp: o,
                            resolution: l,
                            opacity: this._getOpacity(),
                          },
                          this.Kw
                        ),
                        {
                          bbox: f,
                          depth: this.depth,
                          vP: this._animateLayerState,
                        }
                      )
                    );
                }
              }),
              (s.pickRender = function () {
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var a = this.loca.customCoords,
                    o = a.getMVPMatrix(),
                    l = this.projection.getResolution(this.loca.map.getZoom()),
                    u = this.loca.map.getBounds().toJSON(),
                    f = _toConsumableArray(
                      a.lngLatToCoord(u.slice(0, 2))
                    ).concat(_toConsumableArray(a.lngLatToCoord(u.slice(2))));
                  if (this.ll && this.meshes.length > 0) {
                    var c = this;
                    this.aP(this.loca.regl, !0),
                      this.ll.pickRender(
                        __spreadProps$a(
                          __spreadValues$l(
                            {
                              meshes: this.meshes,
                              mvp: o,
                              resolution: l,
                              opacity: this._getOpacity(),
                            },
                            this.Kw
                          ),
                          {
                            bbox: f,
                            depth: this.depth,
                            pickFbo: this._needPickFrame && this._pickFbo,
                            pickPos: this._pickPos,
                            vP: this._animateLayerState,
                          }
                        )
                      );
                    var h = this.styleOptions,
                      p = h.height,
                      d = p === void 0 ? heatmap.style.height.defaultValue : p,
                      m = h.heightBezier,
                      g =
                        m === void 0
                          ? heatmap.style.heightBezier.defaultValue
                          : m,
                      v = h.unit,
                      y = v === void 0 ? heatmap.style.unit.defaultValue : v;
                    return function (_) {
                      var b,
                        S = _[2],
                        P = S / 255,
                        I = new bezierJs.Bezier(
                          { x: 0, y: 0 },
                          { x: g[0], y: g[1] },
                          { x: g[2], y: g[3] },
                          { x: 1, y: 1 }
                        ),
                        F = d * I.get(P).y,
                        X = y === "px" ? F * l : F,
                        W = _slicedToArray(c.fusion.dP, 2),
                        Z = W[0],
                        j = W[1];
                      return {
                        scale: P,
                        value: P !== 0 ? Z + (j - Z) * P : 0,
                        height: F,
                        lnglat:
                          (b = c.loca) == null
                            ? void 0
                            : b.map
                                .containerToLngLat(
                                  _toConsumableArray(c._pickPos).concat([X])
                                )
                                .toArray(),
                      };
                    };
                  }
                }
              }),
              (s.afterRender = function () {}),
              (s.getGradientSteps = function () {
                for (
                  var a = this.styleOptions,
                    o = a.gradient,
                    l = o === void 0 ? heatmap.style.gradient.defaultValue : o,
                    u = _slicedToArray(this.fusion.dP, 2),
                    f = u[0],
                    c = u[1],
                    h = this.fusion.GC(l),
                    p = h.Gh,
                    d = h.alpha,
                    m = [],
                    g = 0,
                    v = 0;
                  g < p.length;
                  g += 4, v += 1
                ) {
                  var y = _slicedToArray(p.slice(g, g + 4), 4),
                    _ = y[0],
                    b = y[1],
                    S = y[2],
                    P = y[3],
                    I = d[v];
                  m.push({
                    color: "rgba(".concat(
                      [b * 255, S * 255, P * 255, I].join(","),
                      ")"
                    ),
                    scale: _,
                    value: _ !== 0 ? f + (c - f) * _ : 0,
                  });
                }
                return m;
              }),
              (s.destroy = function () {
                _get(_getPrototypeOf(i.prototype), "destroy", this).call(this);
              }),
              (s.PA = function () {
                return RenderHelper.SA(this.ll, this);
              }),
              i
            );
          })(Layer),
          Dat = (function () {
            function r() {
              _classCallCheck(this, r),
                (this.style = {}),
                (this.lights = []),
                (this._w = new dat__namespace.GUI());
            }
            var n = r.prototype;
            return (
              (n.addLayer = function (i) {
                var s = this,
                  a = function (p) {
                    c[p] = f[p];
                    var d = u[p].type;
                    if (_instanceof(c[p], Function)) return "continue";
                    if (
                      (c[p] === void 0 && (c[p] = u[p].defaultValue),
                      d === "color")
                    ) {
                      var m = s;
                      l.addColor(c, p).onChange(function (S) {
                        (c[p] = S), i.setStyle(m.getStyle(i, c));
                      });
                    } else if (d === "array") {
                      var g = s;
                      (c[p] = c[p] + ""),
                        l.add(c, p).onChange(function (S) {
                          (c[p] = S), i.setStyle(g.getStyle(i, c));
                        });
                    } else if (d === "image") {
                      var v = s;
                      Object.prototype.toString.call(c[p]) !==
                        "[object String]" && (c[p] = ""),
                        l.add(c, p).onChange(function (S) {
                          (c[p] = S), i.setStyle(v.getStyle(i, c));
                        });
                    } else if (d === "object") {
                      var y = s;
                      (c[p] = JSON.stringify(c[p])),
                        l.add(c, p).onChange(function (S) {
                          (c[p] = S), i.setStyle(y.getStyle(i, c));
                        });
                    } else if (d === "nest") {
                      var _ = s;
                      (c[p] = nestStringify(c[p])),
                        l.add(c, p).onChange(function (S) {
                          (c[p] = S), i.setStyle(_.getStyle(i, c));
                        });
                    } else {
                      var b = s;
                      l.add(c, p).onChange(function (S) {
                        (c[p] = S), i.setStyle(b.getStyle(i, c));
                      });
                    }
                  },
                  o =
                    arguments.length > 1 && arguments[1] !== void 0
                      ? arguments[1]
                      : "\u56FE\u5C42",
                  l = this._w.addFolder(o),
                  u = this.getSchema(i),
                  f = i.styleOptions,
                  c = {};
                for (var h in u) a(h);
              }),
              (n.addLight = function (i, s) {
                var a = function (c) {
                    var h = i[c];
                    c === "color"
                      ? ((u[c] = i[c]),
                        l.addColor(u, c).onChange(function (p) {
                          (u[c] = p), (i[c] = u[c]), s.requestRender();
                        }))
                      : Object.prototype.toString.call(h) === "[object Array]"
                      ? ((u[c] = i[c] + ""),
                        l.add(u, c).onChange(function (p) {
                          (u[c] = p.split(",")),
                            (i[c] = u[c]),
                            s.requestRender();
                        }))
                      : ((u[c] = i[c]),
                        l.add(u, c).onChange(function (p) {
                          (u[c] = p), (i[c] = u[c]), s.requestRender();
                        }));
                  },
                  o =
                    arguments.length > 2 && arguments[2] !== void 0
                      ? arguments[2]
                      : "\u5149\u6E90",
                  l = this._w.addFolder(o),
                  u = {};
                this.lights.push(u);
                for (var f in i) a(f);
              }),
              (n.addLightInstance = function (i, s) {
                var a = this._w.addFolder(s),
                  o = {};
                this.lights.push(o),
                  Object.keys(i.rawproperty).forEach(function (l) {
                    var u = i.rawproperty[l];
                    l === "color"
                      ? ((o[l] = i.rawproperty[l]),
                        a.addColor(o, l).onChange(function (f) {
                          i[l] = o[l] = f;
                        }))
                      : Object.prototype.toString.call(u) === "[object Array]"
                      ? ((o[l] = i.rawproperty[l] + ""),
                        a.add(o, l).onChange(function (f) {
                          i[l] = o[l] = f.split(",");
                        }))
                      : ((o[l] = i.rawproperty[l]),
                        a.add(o, l).onChange(function (f) {
                          i[l] = o[l] = f;
                        }));
                  });
              }),
              (n.getSchema = function (i) {
                var s = i.CLASS_NAME;
                if (s) return conf[s.toLowerCase()].style;
              }),
              (n.getStyle = function (i, s) {
                var a = function (f) {
                    var c = o[f].type;
                    if (((l[f] = s[f]), c === "array")) {
                      var h = (s[f] + "").split(",");
                      isNaN(+h[0]) ||
                        h.forEach(function (p, d) {
                          h[d] = +p;
                        }),
                        (l[f] = h);
                    } else
                      c === "object"
                        ? (l[f] = JSON.parse(l[f]))
                        : c === "nest" && (l[f] = nestParse(l[f]));
                  },
                  o = this.getSchema(i),
                  l = {};
                for (var u in o) a(u);
                return l;
              }),
              (n.destroy = function () {
                this._w.destroy(), (this.style = {}), (this.lights = []);
              }),
              r
            );
          })(),
          __defProp$k = Object.defineProperty,
          __getOwnPropSymbols$k = Object.getOwnPropertySymbols,
          __hasOwnProp$k = Object.prototype.hasOwnProperty,
          __propIsEnum$k = Object.prototype.propertyIsEnumerable,
          __defNormalProp$k = function (r, n, i) {
            return n in r
              ? __defProp$k(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$k = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$k.call(n, i) && __defNormalProp$k(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$k)
              try {
                for (
                  var l = __getOwnPropSymbols$k(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$k.call(n, i) && __defNormalProp$k(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          pushArray$i = CommonUtil$1._C,
          _ScatterFusion = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.DC = function () {}),
              (s.buildStyle = function (a, o) {
                for (
                  var l,
                    u = scatter.style,
                    f = { attributes: [], uniforms: !1, si: !1 },
                    c = 0;
                  c < a.length;
                  c++
                )
                  if (!(!a[c].features || !a[c].features.points)) {
                    var h = a[c].features.points,
                      p = StyleInstance.parse(h, o, u),
                      d = {};
                    f.uniforms || (f.uniforms = p.uniforms),
                      f.si || (f.si = p.si);
                    for (var m = 0, g = h.length; m < g; m++)
                      if (p)
                        for (var v in p.attributes) {
                          var y = p.attributes[v];
                          d[v] || (d[v] = []),
                            ((l = y[m]) == null ? void 0 : l.length) > 0
                              ? pushArray$i(d[v], y[m])
                              : (d[v][d[v].length] = y[m]);
                        }
                    f.attributes.push(d);
                  }
                return f;
              }),
              (s.fusion = function (a, o, l, u) {
                if (!this.regl || !l.loca) return [];
                var f = [];
                u = u || this.buildStyle(a, o);
                for (
                  var c = u.attributes, h = l.loca.customCoords, p = 0;
                  p < a.length;
                  p++
                ) {
                  var d = a[p];
                  if (!(!d.features || !d.features.points)) {
                    for (
                      var m = d.features.points,
                        g = c[p],
                        v = {
                          index: [],
                          vertex: [],
                          color: [],
                          number: [],
                          uv: [],
                          size: [],
                          rotation: [],
                          borderColor: [],
                          borderWidth: [],
                          pickColor: [],
                          labels: [],
                        },
                        y = [],
                        _ = 0;
                      _ < m.length;
                      _++
                    ) {
                      var b = m[_],
                        S = b.coordinates,
                        P = l.colorPick.add(b);
                      if (b.type === "MultiPoint")
                        for (var I = 0, F = S.length; I < F; I++) {
                          var X = S[I],
                            W = this.triangles(
                              X,
                              { attribute: g, index: _, pickColor: P },
                              h
                            );
                          GeoUtil.mergeTriangles(v, W),
                            pushArray$i(v.color, W.color),
                            pushArray$i(v.rotation, W.rotation),
                            pushArray$i(v.number, W.number),
                            pushArray$i(v.size, W.size),
                            pushArray$i(v.uv, W.uv),
                            pushArray$i(v.borderColor, W.borderColor),
                            pushArray$i(v.borderWidth, W.borderWidth),
                            pushArray$i(v.pickColor, W.pickColor),
                            g.label[_] &&
                              v.labels.push(
                                __spreadValues$k({ position: X }, g.label[_])
                              );
                        }
                      else {
                        var Z = this.triangles(
                          S,
                          { attribute: g, index: _, pickColor: P },
                          h
                        );
                        GeoUtil.mergeTriangles(v, Z),
                          pushArray$i(v.color, Z.color),
                          pushArray$i(v.rotation, Z.rotation),
                          pushArray$i(v.number, Z.number),
                          pushArray$i(v.size, Z.size),
                          pushArray$i(v.uv, Z.uv),
                          pushArray$i(v.borderColor, Z.borderColor),
                          pushArray$i(v.borderWidth, Z.borderWidth),
                          pushArray$i(v.pickColor, Z.pickColor),
                          g.label[_] &&
                            v.labels.push(
                              __spreadValues$k({ position: S }, g.label[_])
                            );
                      }
                      y[_] = v.rotation.length;
                    }
                    f[p] = {
                      id: d.id,
                      attributes: {
                        color: {
                          buffer: this.regl.buffer(v.color),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        pickColor: {
                          buffer: this.regl.buffer(v.pickColor),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        borderColor: {
                          buffer: this.regl.buffer(v.borderColor),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        position: {
                          buffer: this.regl.buffer(v.vertex),
                          offset: 0,
                          stride: 4 * 3,
                          td: !1,
                          divisor: 0,
                        },
                        number: {
                          buffer: this.regl.buffer(v.number),
                          offset: 0,
                          stride: 4,
                          td: !1,
                          divisor: 0,
                        },
                        borderWidth: {
                          buffer: this.regl.buffer(v.borderWidth),
                          offset: 0,
                          stride: 4,
                          td: !1,
                          divisor: 0,
                        },
                        rotation: {
                          buffer: this.regl.buffer(v.rotation),
                          offset: 0,
                          stride: 4,
                          td: !1,
                          divisor: 0,
                        },
                        size: {
                          buffer: this.regl.buffer(v.size),
                          offset: 0,
                          stride: 4 * 2,
                          td: !1,
                          divisor: 0,
                        },
                        uv: {
                          buffer: this.regl.buffer(v.uv),
                          offset: 0,
                          stride: 4 * 2,
                          td: !1,
                          divisor: 0,
                        },
                        index: this.regl.elements({
                          primitive: "triangles",
                          type: "uint32",
                          data: v.index,
                        }),
                      },
                      uniforms: u.uniforms,
                      si: u.si,
                      mf: {
                        Tw: { jw: y },
                        origin: {
                          color: v.color,
                          size: v.size,
                          rotation: v.rotation,
                          borderColor: v.borderColor,
                          borderWidth: v.borderWidth,
                        },
                        labels: v.labels,
                      },
                    };
                  }
                }
                return f;
              }),
              (s.triangles = function (a, o, l) {
                var u = o.index,
                  f = o.pickColor,
                  c = o.attribute,
                  h = c.size,
                  p = c.color,
                  d = c.rotation,
                  m = c.altitude,
                  g = c.borderColor,
                  v = c.borderWidth,
                  y = p.slice(u * 4, u * 4 + 4),
                  _ = g.slice(u * 4, u * 4 + 4),
                  b = h.slice(u * 2, u * 2 + 2),
                  S = d[u],
                  P = v[u],
                  I = m[u],
                  F = l.lngLatToCoord(a),
                  X = a[2] || I || 0,
                  W = [b[0], b[1], b[0], b[1], b[0], b[1], b[0], b[1]],
                  Z = [
                    y[0],
                    y[1],
                    y[2],
                    y[3],
                    y[0],
                    y[1],
                    y[2],
                    y[3],
                    y[0],
                    y[1],
                    y[2],
                    y[3],
                    y[0],
                    y[1],
                    y[2],
                    y[3],
                  ],
                  j = [S, S, S, S],
                  L = [
                    F[0],
                    F[1],
                    X,
                    F[0],
                    F[1],
                    X,
                    F[0],
                    F[1],
                    X,
                    F[0],
                    F[1],
                    X,
                  ],
                  T = [0, 0, 0, 1, 1, 0, 1, 1],
                  A = [
                    _[0],
                    _[1],
                    _[2],
                    _[3],
                    _[0],
                    _[1],
                    _[2],
                    _[3],
                    _[0],
                    _[1],
                    _[2],
                    _[3],
                    _[0],
                    _[1],
                    _[2],
                    _[3],
                  ],
                  $ = [
                    f[0],
                    f[1],
                    f[2],
                    f[3],
                    f[0],
                    f[1],
                    f[2],
                    f[3],
                    f[0],
                    f[1],
                    f[2],
                    f[3],
                    f[0],
                    f[1],
                    f[2],
                    f[3],
                  ],
                  R = [P, P, P, P];
                return {
                  vertex: L,
                  index: [0, 1, 2, 1, 3, 2],
                  number: [0, 1, 3, 2],
                  uv: T,
                  size: W,
                  rotation: j,
                  color: Z,
                  borderColor: A,
                  borderWidth: R,
                  pickColor: $,
                };
              }),
              (s.updateStyle = function (a, o) {
                for (
                  var l = function (c, h) {
                      for (
                        var p = a[c],
                          d = o.attributes[c],
                          m = d.color,
                          g = d.borderColor,
                          v = d.borderWidth,
                          y = d.rotation,
                          _ = d.size,
                          b = d.label,
                          S = p.mf.origin,
                          P = S.borderColor,
                          I = S.color,
                          F = S.borderWidth,
                          X = S.size,
                          W = S.rotation,
                          Z = p.mf.Tw.jw,
                          j = 0,
                          L = 0,
                          T = W.length;
                        L < T;
                        L++
                      ) {
                        var A = L * 4,
                          $ = L * 2;
                        L >= Z[j] && j++;
                        var R = j * 4,
                          M = j * 2;
                        (I[A] = m[R]),
                          (I[A + 1] = m[R + 1]),
                          (I[A + 2] = m[R + 2]),
                          (I[A + 3] = m[R + 3]),
                          (P[A] = g[R]),
                          (P[A + 1] = g[R + 1]),
                          (P[A + 2] = g[R + 2]),
                          (P[A + 3] = g[R + 3]),
                          (X[$] = +_[M]),
                          (X[$ + 1] = +_[M + 1]),
                          (F[L] = v[j]),
                          (W[L] = y[j]);
                      }
                      p.attributes.color.buffer({ data: I }),
                        p.attributes.rotation.buffer({ data: W }),
                        p.attributes.borderColor.buffer({ data: P }),
                        p.attributes.borderWidth.buffer({ data: F }),
                        p.attributes.size.buffer({ data: X }),
                        (p.uniforms = o.uniforms),
                        (p.mf.labels = p.mf.labels.map(function (w, O) {
                          return __spreadValues$k(
                            __spreadValues$k({}, w),
                            b[O]
                          );
                        }));
                    },
                    u = 0,
                    f = a.length;
                  u < f;
                  u++
                )
                  l(u, f);
              }),
              (s.EC = function () {
                return [];
              }),
              (s.destroy = function () {
                this.regl = null;
              }),
              (i.getInstance = function () {
                return this.ui;
              }),
              i
            );
          })(GeometryFusion),
          ScatterFusion = _ScatterFusion;
        (ScatterFusion.ui = new _ScatterFusion()), ScatterFusion.getInstance();
        var ScatterShader = {
            vertex:
              "\n        precision highp float;\n        #define PI 3.14159265359\n        attribute vec3 position;\n        attribute vec4 color;\n        attribute vec4 borderColor;\n        attribute vec2 size;\n        attribute vec2 uv;\n        attribute float rotation;\n        attribute float borderWidth;\n        attribute float number;\n\n        varying vec4 vColor;\n        varying vec4 vBColor;\n        varying float vBWidth;\n        varying vec2 vUv;\n        varying vec2 vSize;\n        varying vec2 vPos;\n\n        uniform mat4 mvp;\n        uniform float resolution;\n        // 0: px, 1: meter\n        uniform float unit;\n        "
                .concat(
                  ColorGLSL.getColorShader().vertex,
                  "\n\n        void main() {\n            // \u5BF9\u89D2\u7EBF\u957F\u5EA6\u4E00\u534A\n            float diagonal = length(size + vec2(borderWidth * 2.0)) / 2.0;\n            float x = size.x / 2.0 + borderWidth;\n            float y = size.y / 2.0 + borderWidth;\n\n            // \u8BA1\u7B97\u9876\u70B9\u5411\u91CF\n            // 1 3 -- 0 1\n            // 0 2 -- 2 3\n            float rotNumber = mod(number + 2.0, 4.0);\n            float oneAngle = asin(x / diagonal);\n            float twoAngle = asin(y / diagonal) * 2.0;\n            float theta = rotation / 180. * PI + oneAngle;\n            if(rotNumber == 1.0) {\n                theta += twoAngle;\n            } else if(rotNumber == 2.0) {\n                theta += twoAngle + oneAngle * 2.0;\n            } else if(rotNumber == 3.0) {\n                theta += (twoAngle + oneAngle) * 2.0;\n            }\n\n            vec2 pos =\n                mat2(cos(theta), -sin(theta),\n                     sin(theta), cos(theta)) * vec2(0, 1);\n\n            float res = unit == 0.0 ? resolution : 1.0;\n\n            gl_Position = mvp * vec4(position + vec3(pos, 0) * diagonal * res, 1.0);\n        \n            vColor = color;\n            vSize = size;\n            vBWidth = borderWidth;\n            vBColor = borderColor;\n            vUv = uv;\n            vPos = pos * diagonal;\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainVert,
                  "\n        }\n    "
                ),
            fragment:
              "\n        precision highp float;\n        uniform float resolution;\n        uniform float opacity;\n        uniform float textureSequence;\n        uniform sampler2D texture;\n        uniform bool useTexture;\n        uniform float animateCounter;\n\n        varying vec2 vSize;\n        varying vec4 vColor;\n        varying vec4 vBColor;\n        varying float vBWidth;\n        varying vec2 vUv;\n        varying vec2 vPos;\n        "
                .concat(
                  ColorGLSL.getColorShader().fragment,
                  "\n\n        void main() {\n            if(useTexture) {\n                // 0.0001 \u89E3\u51B3 mod \u8FD0\u7B97\u7684\u7CBE\u5EA6\u8BEF\u5DEE\u95EE\u9898\u3002\n                float offset = mod(animateCounter + 0.001, textureSequence) / textureSequence;\n                gl_FragColor = texture2D(texture, vec2(vUv.x / textureSequence + offset, vUv.y));\n                // gl_FragColor = vec4(mod(textureSequence + 0.1, textureSequence) / textureSequence, 0, 0, 1);\n            } else {\n                gl_FragColor = vColor;\n\n                // \u6297\u952F\u9F7F\u50CF\u7D20\u4F4D\n                float len = length(vPos);\n                float taaRadius = 2.0;\n                if(len > vSize.x / 2.0 + vBWidth) {\n                    discard;\n                } else if(len > vSize.x / 2.0 + vBWidth - taaRadius) {\n                    gl_FragColor = vBWidth > 0.0 ? vBColor : vColor;\n                    float opa = smoothstep(1.0, 0.0, (len - (vSize.x / 2.0 + vBWidth - taaRadius)) / taaRadius);\n                    gl_FragColor.a *= opa;\n                } else if(vBWidth > 0.0 && len > vSize.x / 2.0 + taaRadius) {\n                    gl_FragColor = vBColor;\n                } else if(vBWidth > 0.0 && len > vSize.x / 2.0) {\n                    float blend = smoothstep(0.0, 1.0, (len - vSize.x / taaRadius) / taaRadius);\n                    gl_FragColor = mix(vColor, vBColor, blend);\n                }\n            }\n            gl_FragColor.a *= opacity;\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainFrag,
                  "\n        }\n    "
                ),
          },
          __defProp$j = Object.defineProperty,
          __defProps$9 = Object.defineProperties,
          __getOwnPropDescs$9 = Object.getOwnPropertyDescriptors,
          __getOwnPropSymbols$j = Object.getOwnPropertySymbols,
          __hasOwnProp$j = Object.prototype.hasOwnProperty,
          __propIsEnum$j = Object.prototype.propertyIsEnumerable,
          __defNormalProp$j = function (r, n, i) {
            return n in r
              ? __defProp$j(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$j = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$j.call(n, i) && __defNormalProp$j(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$j)
              try {
                for (
                  var l = __getOwnPropSymbols$j(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$j.call(n, i) && __defNormalProp$j(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __spreadProps$9 = function (r, n) {
            return __defProps$9(r, __getOwnPropDescs$9(n));
          },
          ScatterRender = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              _classCallCheck(this, i);
              var a;
              return (
                (a = n.call.apply(
                  n,
                  [this].concat(Array.prototype.slice.call(arguments))
                )),
                (a.v$ = [new LabelsRender$1()]),
                a
              );
            }
            var s = i.prototype;
            return (
              (s.m$ = function (a) {
                if (!this.regl) return !1;
                this.v$.forEach(function (l) {
                  return l.m$(a);
                });
                var o = this.regl;
                this.gA(ScatterShader, a, {
                  attributes: __spreadValues$j(
                    {
                      position: o.prop("position"),
                      color: o.prop("color"),
                      size: o.prop("size"),
                      uv: o.prop("uv"),
                      rotation: o.prop("rotation"),
                      number: o.prop("number"),
                      borderColor: o.prop("borderColor"),
                      borderWidth: o.prop("borderWidth"),
                    },
                    ColorGLSL.getColor(o).attribute
                  ),
                  uniforms: __spreadValues$j(
                    {
                      mvp: o.prop("mvp"),
                      resolution: o.prop("resolution"),
                      opacity: o.prop("opacity"),
                      unit: o.prop("unit"),
                      texture: o.prop("texture"),
                      textureSequence: o.prop("textureSequence"),
                      useTexture: o.prop("useTexture"),
                      animateCounter: o.prop("animateCounter"),
                    },
                    ColorGLSL.getColor(o).uniform
                  ),
                  blend: {
                    enable: !0,
                    func: RenderUtil.getBlend("normal"),
                    equation: { rgb: "add", alpha: "add" },
                  },
                  cull: { enable: !0, face: "back" },
                  frontFace: "cw",
                  depth: { enable: o.prop("depth") },
                  elements: o.prop("index"),
                });
              }),
              (s.render = function (a) {
                var o = this.yA(ScatterShader);
                if (o) {
                  for (
                    var l = a.meshes,
                      u = a.mvp,
                      f = a.resolution,
                      c = a.opacity,
                      h = a.texture,
                      p = a.useTexture,
                      d = a.animateCounter,
                      m = a.textureSequence,
                      g = a.depth,
                      v = 0;
                    v < l.length;
                    v++
                  ) {
                    var y = l[v],
                      _ = y.attributes,
                      b = y.uniforms,
                      S = b.unit,
                      P = b.duration;
                    b.animate;
                    var I = parseInt(((d / 60) * m) / (P / 1e3));
                    o(
                      __spreadProps$9(__spreadValues$j({}, _), {
                        mvp: u,
                        resolution: f,
                        opacity: c,
                        unit: S === "px" ? 0 : 1,
                        texture: h,
                        textureSequence: m,
                        useTexture: p,
                        animateCounter: isNaN(I) ? 0 : I,
                        depth: g,
                        isPick: !1,
                      })
                    );
                  }
                  for (var F = 0; F < l.length; F++) {
                    var X = !0,
                      W = !1,
                      Z = void 0;
                    try {
                      for (
                        var j = this.v$[Symbol.iterator](), L;
                        !(X = (L = j.next()).done);
                        X = !0
                      ) {
                        var T = L.value;
                        T.render(l[F]);
                      }
                    } catch (A) {
                      (W = !0), (Z = A);
                    } finally {
                      try {
                        !X && j.return != null && j.return();
                      } finally {
                        if (W) throw Z;
                      }
                    }
                  }
                }
              }),
              (s.pickRender = function (a) {
                var o = this.yA(ScatterShader);
                if (o) {
                  var l = a.meshes,
                    u = a.mvp,
                    f = a.resolution,
                    c = a.opacity,
                    h = a.texture,
                    p = a.useTexture,
                    d = a.animateCounter,
                    m = a.textureSequence,
                    g = a.depth,
                    v = a.pickFbo,
                    y = a.pickPos;
                  if (h && v && y) {
                    var _ = this;
                    v.use(function () {
                      _.regl.clear({ color: [0, 0, 0, 0], depth: 1 });
                      for (var b = 0; b < l.length; b++) {
                        var S = l[b],
                          P = S.attributes,
                          I = S.uniforms,
                          F = I.unit,
                          X = I.duration,
                          W = I.animate,
                          Z = parseInt(((d / 60) * m) / (X / 1e3));
                        o(
                          __spreadProps$9(__spreadValues$j({}, P), {
                            mvp: u,
                            resolution: f,
                            opacity: c,
                            unit: F === "px" ? 0 : 1,
                            texture: h,
                            textureSequence: m,
                            useTexture: p,
                            animateCounter: isNaN(Z) ? 0 : Z,
                            animate: W,
                            depth: g,
                            isPick: !0,
                          })
                        );
                      }
                    });
                  }
                }
              }),
              i
            );
          })(Render),
          __defProp$i = Object.defineProperty,
          __getOwnPropSymbols$i = Object.getOwnPropertySymbols,
          __hasOwnProp$i = Object.prototype.hasOwnProperty,
          __propIsEnum$i = Object.prototype.propertyIsEnumerable,
          __defNormalProp$i = function (r, n, i) {
            return n in r
              ? __defProp$i(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$i = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$i.call(n, i) && __defNormalProp$i(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$i)
              try {
                for (
                  var l = __getOwnPropSymbols$i(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$i.call(n, i) && __defNormalProp$i(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          getMipMap = RenderUtil.getMipMap,
          pushArray$h = CommonUtil$1._C,
          Scatter = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              (o = n.call(this, a)),
                (o.CLASS_NAME = "Scatter"),
                (o.fusion = new ScatterFusion()),
                (o.ll = new ScatterRender()),
                (o.Vw = !1),
                (o.nx = 0);
              var l = scatter.Sw;
              return (
                (o.zooms = a.zooms === void 0 ? l.zooms : a.zooms),
                (o.visible = a.visible === void 0 ? l.visible : a.visible),
                (o.zIndex = a.zIndex === void 0 ? l.zIndex : a.zIndex),
                (o.opacity = a.opacity === void 0 ? l.opacity : a.opacity),
                (o.depth = a.depth === void 0 ? l.depth : a.depth),
                o.AC({ zooms: o.zooms, visible: o.visible, zIndex: o.zIndex }),
                o.buryPoint.record(o.CLASS_NAME),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.receiveDataset = function (a) {
                (this.dataset = a),
                  this.setStyle(this.styleOptions),
                  this.onAdd();
              }),
              (s.setStyle = function (a) {
                if (
                  (_get(_getPrototypeOf(i.prototype), "setStyle", this).call(
                    this,
                    a
                  ),
                  !!a &&
                    ((this.dataset = this.source.LC()),
                    this.dataset && this.dataset.length > 0))
                ) {
                  var o = this.WC(),
                    l = o.didFusion;
                  this.Kf = null;
                  var u = this.fusion.buildStyle(
                    this.dataset,
                    this.styleOptions
                  );
                  this.fusion.updateStyle(l, u),
                    (this.vA.state |= MeshDirty),
                    this.loca && this.loca.requestRender();
                }
              }),
              (s.jC = function () {
                _get(_getPrototypeOf(i.prototype), "jC", this).call(this),
                  !(!this.loca || !this.loca.regl || this.ll.regl) &&
                    ((this.ll.regl = this.loca.regl),
                    this.loca.rendererManager.addRenderer(this.ll));
              }),
              (s.beforeRender = function () {
                if (
                  (_get(
                    _getPrototypeOf(i.prototype),
                    "beforeRender",
                    this
                  ).call(this),
                  !this.fusion.regl &&
                    this.loca &&
                    ((this.fusion.regl = this.loca.regl),
                    this.loca.fusionManager.addFusion(this.fusion)),
                  this.jC(),
                  this.source && (this.dataset = this.source.LC()),
                  this.fusion && this.styleOptions)
                ) {
                  var a = this.WC(),
                    o = a.willFusion,
                    l = a.didFusion;
                  if ((this.fusion.EC(), o.length > 0)) {
                    var u = this.fusion.fusion(o, this.styleOptions, this);
                    (this.meshes = pushArray$h(l, u)),
                      (this.vA.state |= MeshesDirty);
                  }
                }
                if (this.meshes.length > 0) {
                  var f = this.meshes[0].uniforms.texture;
                  this.createTexture(f);
                }
              }),
              (s.render = function () {
                var a, o;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var l =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    u = this.projection.getResolution(
                      (o = this.loca) == null ? void 0 : o.map.getZoom()
                    );
                  if (this.ll && this.meshes.length > 0) {
                    var f = this.hP();
                    this.ll.render({
                      meshes: this.meshes,
                      mvp: l,
                      resolution: u,
                      opacity: this._getOpacity(),
                      texture: this.Kf,
                      useTexture: this.Vw,
                      animateCounter: f,
                      textureSequence: this.nx,
                      depth: this.depth,
                    });
                  }
                }
              }),
              (s.pickRender = function () {
                var a, o;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var l =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    u = this.projection.getResolution(
                      (o = this.loca) == null ? void 0 : o.map.getZoom()
                    );
                  if (this.ll) {
                    var f = this.hP();
                    this.ll.pickRender({
                      meshes: this.meshes,
                      mvp: l,
                      resolution: u,
                      opacity: this._getOpacity(),
                      texture: this.Kf,
                      useTexture: this.Vw,
                      animateCounter: f,
                      textureSequence: this.nx,
                      depth: this.depth,
                      pickFbo: this._needPickFrame && this._pickFbo,
                      pickPos: this._pickPos,
                    });
                  }
                }
              }),
              (s.afterRender = function () {}),
              (s.createTexture = function (a) {
                if (
                  ((this.Vw = !!a),
                  !(this.Kf || !this.loca || !this.loca.regl) &&
                    ((this.Kf = this.loca.regl.texture({
                      data: [
                        [
                          [0, 255, 0, 0],
                          [255, 0, 0, 0],
                        ],
                        [
                          [0, 0, 255, 0],
                          [255, 255, 255, 0],
                        ],
                      ],
                    })),
                    !!a))
                )
                  if (Object.prototype.toString.call(a) === "[object String]") {
                    var o = this,
                      l = new Image();
                    (l.crossOrigin = "anonymous"),
                      (l.src = a),
                      (l.onload = function () {
                        (o.Kf = o.loca.regl.texture(
                          __spreadValues$i(
                            { data: l, flipY: !0 },
                            getMipMap(l.naturalWidth, l.naturalHeight)
                          )
                        )),
                          (o.nx = l.naturalWidth / l.naturalHeight);
                      });
                  } else
                    (this.Kf = this.loca.regl.texture(
                      __spreadValues$i(
                        { data: a, flipY: !0 },
                        getMipMap(a.width, a.height)
                      )
                    )),
                      (this.nx = a.width / a.height);
              }),
              (s.PA = function () {
                return RenderHelper.SA(this.ll, this);
              }),
              i
            );
          })(Layer),
          pushArray$g = CommonUtil$1._C,
          _LinkFusion = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.DC = function () {}),
              (s.buildStyle = function (a, o, l) {
                var u = link.style,
                  f = [];
                if (!l.loca) return {};
                for (var c = l.loca.customCoords, h = 0; h < a.length; h++)
                  if (!(!a[h].features || !a[h].features.lines)) {
                    var p = a[h].features.lines,
                      d = [],
                      m = !0,
                      g = !1,
                      v = void 0;
                    try {
                      for (
                        var y = p[Symbol.iterator](), _;
                        !(m = (_ = y.next()).done);
                        m = !0
                      ) {
                        var b = _.value,
                          S = b.coordinates,
                          P = b.type;
                        if (P === "LineString") {
                          var I = _slicedToArray(S, 2),
                            F = I[0],
                            X = I[1],
                            W = c.lngLatToCoord(F),
                            Z = c.lngLatToCoord(X),
                            j = glMatrix.vec2.distance(W, Z);
                          d.push({ distance: j, link: b });
                        }
                        if (P === "MultiLineString")
                          for (var L = 0; L < S.length; L++) {
                            var T = _slicedToArray(S[L], 2),
                              A = T[0],
                              $ = T[1],
                              R = c.lngLatToCoord(A),
                              M = c.lngLatToCoord($),
                              w = glMatrix.vec2.distance(R, M);
                            d.push({
                              distance: w,
                              link: {
                                coordinates: b.coordinates[L],
                                properties: b.properties,
                              },
                            });
                          }
                      }
                    } catch (E) {
                      (g = !0), (v = E);
                    } finally {
                      try {
                        !m && y.return != null && y.return();
                      } finally {
                        if (g) throw v;
                      }
                    }
                    var O = StyleInstance.parse(d, o, u);
                    f.push(O);
                  }
                return f;
              }),
              (s.fusion = function (a, o, l, u) {
                var f = this,
                  c = function (m) {
                    var g = function (X) {
                        var W = y[X],
                          Z = W.coordinates,
                          j = b.lineColors,
                          L = b.height,
                          T = S.smoothSteps,
                          A = l.colorPick.add(W);
                        if (W.type === "MultiLineString") {
                          var $ = function (ot, at) {
                            var Lt = Z[ot],
                              $t = _slicedToArray(Lt, 2),
                              Rt = $t[0],
                              Ot = $t[1],
                              wt = _slicedToArray(Rt, 2),
                              kt = wt[0],
                              Pt = wt[1],
                              At = _slicedToArray(Ot, 2),
                              ut = At[0],
                              ct = At[1],
                              vt = { x: +kt, y: +Pt, z: 0 },
                              rt = { x: +ut, y: +ct, z: 0 },
                              Wt = L[ot],
                              Vt = [],
                              mt = j[ot];
                            if ((mt.length === 1 && (mt[1] = mt[0]), Wt === 0))
                              (Vt = LinearSplit(vt, rt, mt.length)),
                                Vt.forEach(function (xt, It) {
                                  It !== Vt.length - 1 && P.index.push(I, ++I);
                                  var Bt = p.lngLatToCoord([xt.x, xt.y]);
                                  P.vertex.push(Bt[0], Bt[1], xt.z),
                                    pushArray$g(P.color, mt[It]),
                                    pushArray$g(P.pickColor, A);
                                });
                            else {
                              var yt = {
                                x: kt - (kt - ut) / 2,
                                y: Pt - (Pt - ct) / 2,
                                z: Wt,
                              };
                              (Vt = cubicBezier(vt, yt, rt, 0.5, T)),
                                Vt.forEach(function (xt, It) {
                                  It !== Vt.length - 1 && P.index.push(I, ++I);
                                  var Bt = p.lngLatToCoord([xt.x, xt.y]);
                                  P.vertex.push(Bt[0], Bt[1], xt.z);
                                  var ar = linearGradient(mt, xt.t);
                                  pushArray$g(P.color, ar),
                                    pushArray$g(P.pickColor, A);
                                });
                            }
                            I++;
                          };
                          I = 0;
                          for (var R = 0, M = Z.length; R < M; R++) $(R, M);
                        } else {
                          var w = Z,
                            O = _slicedToArray(w, 2),
                            E = O[0],
                            k = O[1],
                            D = _slicedToArray(E, 2),
                            q = D[0],
                            J = D[1],
                            de = _slicedToArray(k, 2),
                            we = de[0],
                            Se = de[1],
                            He = { x: +q, y: +J, z: 0 },
                            et = { x: +we, y: +Se, z: 0 },
                            Ke = L[X],
                            Fe = [],
                            qe = j[X];
                          if ((qe.length === 1 && (qe[1] = qe[0]), Ke === 0))
                            (Fe = LinearSplit(He, et, qe.length)),
                              Fe.forEach(function (ot, at) {
                                at !== Fe.length - 1 && P.index.push(I, ++I);
                                var Lt = p.lngLatToCoord([ot.x, ot.y]);
                                P.vertex.push(Lt[0], Lt[1], ot.z),
                                  pushArray$g(P.color, qe[at]),
                                  pushArray$g(P.pickColor, A);
                              });
                          else {
                            var Mt = {
                              x: q - (q - we) / 2,
                              y: J - (J - Se) / 2,
                              z: Ke,
                            };
                            (Fe = cubicBezier(He, Mt, et, 0.5, T)),
                              Fe.forEach(function (ot, at) {
                                at !== Fe.length - 1 && P.index.push(I, ++I);
                                var Lt = p.lngLatToCoord([ot.x, ot.y]);
                                P.vertex.push(Lt[0], Lt[1], ot.z);
                                var $t = linearGradient(qe, ot.t);
                                pushArray$g(P.color, $t),
                                  pushArray$g(P.pickColor, A);
                              });
                          }
                          I++;
                        }
                      },
                      v = a[m];
                    if (!v.features || !v.features.lines) return "continue";
                    for (
                      var y = v.features.lines,
                        _ = u[m],
                        b = _.attributes,
                        S = _.uniforms,
                        P = { vertex: [], color: [], pickColor: [], index: [] },
                        I = 0,
                        F = 0;
                      F < y.length;
                      F++
                    )
                      g(F);
                    h[m] = {
                      id: v.id,
                      attributes: {
                        color: {
                          buffer: f.regl.buffer(P.color),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        pickColor: {
                          buffer: f.regl.buffer(P.pickColor),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        position: {
                          buffer: f.regl.buffer(P.vertex),
                          offset: 0,
                          stride: 4 * 3,
                          td: !1,
                          divisor: 0,
                        },
                        index: f.regl.elements({
                          primitive: "lines",
                          type: "uint32",
                          data: P.index,
                        }),
                      },
                      uniforms: _.uniforms,
                      si: _.si,
                    };
                  };
                if (!this.regl || !l.loca) return [];
                var h = [];
                u = u || this.buildStyle(a, o, l);
                for (var p = l.loca.customCoords, d = 0; d < a.length; d++)
                  c(d);
                return h;
              }),
              (s.updateStyle = function (a, o, l, u) {
                if (!l.loca) return [];
                var f = l.dataset;
                return this.fusion(f, o, l, u);
              }),
              (s.EC = function () {
                return [];
              }),
              (s.destroy = function () {
                this.regl = null;
              }),
              (i.getInstance = function () {
                return this.ui;
              }),
              i
            );
          })(GeometryFusion),
          LinkFusion = _LinkFusion;
        (LinkFusion.ui = new _LinkFusion()), LinkFusion.getInstance();
        var LinkShader = {
            vertex:
              "\n        precision highp float;\n        attribute vec3 position;\n        attribute vec4 color;\n        varying vec4 v_color;\n        uniform mat4 mvp;\n        "
                .concat(
                  ColorGLSL.getColorShader().vertex,
                  "\n\n        void main() {\n            v_color = color;\n            gl_Position = mvp * vec4(position, 1.0);\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainVert,
                  "\n        }\n    "
                ),
            fragment:
              "\n        precision highp float;\n        varying vec4 v_color;\n        uniform float opacity;\n        "
                .concat(
                  ColorGLSL.getColorShader().fragment,
                  "\n\n        void main() {\n            gl_FragColor = v_color;\n            gl_FragColor *= opacity;\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainFrag,
                  "\n        }\n    "
                ),
          },
          __defProp$h = Object.defineProperty,
          __defProps$8 = Object.defineProperties,
          __getOwnPropDescs$8 = Object.getOwnPropertyDescriptors,
          __getOwnPropSymbols$h = Object.getOwnPropertySymbols,
          __hasOwnProp$h = Object.prototype.hasOwnProperty,
          __propIsEnum$h = Object.prototype.propertyIsEnumerable,
          __defNormalProp$h = function (r, n, i) {
            return n in r
              ? __defProp$h(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$h = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$h.call(n, i) && __defNormalProp$h(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$h)
              try {
                for (
                  var l = __getOwnPropSymbols$h(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$h.call(n, i) && __defNormalProp$h(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __spreadProps$8 = function (r, n) {
            return __defProps$8(r, __getOwnPropDescs$8(n));
          },
          LinkRender = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.m$ = function (a) {
                if (!this.regl) return !1;
                var o = this.regl;
                this.gA(LinkShader, a, {
                  attributes: __spreadValues$h(
                    { position: o.prop("position"), color: o.prop("color") },
                    ColorGLSL.getColor(o).attribute
                  ),
                  uniforms: __spreadValues$h(
                    { mvp: o.prop("mvp"), opacity: o.prop("opacity") },
                    ColorGLSL.getColor(o).uniform
                  ),
                  depth: { enable: !1 },
                  blend: {
                    enable: !0,
                    func: o.prop("blendFun"),
                    equation: { rgb: "add", alpha: "add" },
                  },
                  elements: o.prop("index"),
                });
              }),
              (s.render = function (a) {
                var o = this.yA(LinkShader);
                if (o)
                  for (
                    var l = a.meshes, u = a.mvp, f = a.opacity, c = 0;
                    c < l.length;
                    c++
                  ) {
                    var h = l[c],
                      p = h.attributes;
                    o(
                      __spreadProps$8(
                        __spreadValues$h(
                          { blendFun: RenderUtil.getBlend("zero") },
                          p
                        ),
                        { mvp: u, opacity: f, isPick: !1 }
                      )
                    ),
                      o(
                        __spreadProps$8(
                          __spreadValues$h(
                            { blendFun: RenderUtil.getBlend("lighter") },
                            p
                          ),
                          { mvp: u, opacity: f, isPick: !1 }
                        )
                      );
                  }
              }),
              (s.pickRender = function (a) {
                var o = this.yA(LinkShader);
                if (o) {
                  var l = a.meshes,
                    u = a.mvp,
                    f = a.opacity,
                    c = a.pickFbo,
                    h = a.pickPos;
                  if (c && h) {
                    var p = this;
                    c.use(function () {
                      p.regl.clear({ color: [0, 0, 0, 0], depth: 1 });
                      for (var d = 0; d < l.length; d++) {
                        var m = l[d],
                          g = m.attributes;
                        o(
                          __spreadProps$8(
                            __spreadValues$h(
                              { blendFun: RenderUtil.getBlend("normal") },
                              g
                            ),
                            { mvp: u, opacity: f, isPick: !0 }
                          )
                        );
                      }
                    });
                  }
                }
              }),
              i
            );
          })(Render),
          pushArray$f = CommonUtil$1._C,
          LinkLayer = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              (o = n.call(this, a)),
                (o.CLASS_NAME = "Link"),
                (o.fusion = new LinkFusion()),
                (o.ll = new LinkRender());
              var l = link.Sw;
              return (
                (o.zooms = a.zooms === void 0 ? l.zooms : a.zooms),
                (o.zIndex = a.zIndex === void 0 ? l.zIndex : a.zIndex),
                (o.opacity = a.opacity === void 0 ? l.opacity : a.opacity),
                (o.visible = a.visible === void 0 ? l.visible : a.visible),
                o.AC({ zooms: o.zooms, visible: o.visible, zIndex: o.zIndex }),
                o.buryPoint.record(o.CLASS_NAME),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.receiveDataset = function (a) {
                (this.dataset = a),
                  this.setStyle(this.styleOptions),
                  this.onAdd();
              }),
              (s.setStyle = function (a) {
                if (
                  (_get(_getPrototypeOf(i.prototype), "setStyle", this).call(
                    this,
                    a
                  ),
                  (this.dataset = this.source.LC()),
                  (this.meshes = []),
                  this.dataset && this.dataset.length > 0 && this.meshes)
                ) {
                  var o = this.WC(),
                    l = o.didFusion,
                    u = this.fusion.buildStyle(
                      this.dataset,
                      this.styleOptions,
                      this
                    ),
                    f = this.fusion.updateStyle(l, this.styleOptions, this, u);
                  (this.meshes = f), this.loca && this.loca.requestRender();
                }
              }),
              (s.jC = function () {
                _get(_getPrototypeOf(i.prototype), "jC", this).call(this),
                  !(!this.loca || !this.loca.regl || this.ll.regl) &&
                    ((this.ll.regl = this.loca.regl),
                    this.loca.rendererManager.addRenderer(this.ll));
              }),
              (s.beforeRender = function () {
                if (
                  (_get(
                    _getPrototypeOf(i.prototype),
                    "beforeRender",
                    this
                  ).call(this),
                  !this.fusion.regl &&
                    this.loca &&
                    ((this.fusion.regl = this.loca.regl),
                    this.loca.fusionManager.addFusion(this.fusion)),
                  this.jC(),
                  this.source && (this.dataset = this.source.LC()),
                  this.fusion)
                ) {
                  var a = this.WC(),
                    o = a.willFusion,
                    l = a.didFusion;
                  if ((this.fusion.EC(), o.length > 0)) {
                    var u = this.fusion.fusion(o, this.styleOptions, this);
                    this.meshes = pushArray$f(l, u);
                  }
                }
              }),
              (s.render = function () {
                var a;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var o =
                    (a = this.loca) == null
                      ? void 0
                      : a.customCoords.getMVPMatrix();
                  this.ll &&
                    this.meshes.length > 0 &&
                    this.ll.render({
                      meshes: this.meshes,
                      mvp: o,
                      opacity: this._getOpacity(),
                    });
                }
              }),
              (s.pickRender = function () {
                var a;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var o =
                    (a = this.loca) == null
                      ? void 0
                      : a.customCoords.getMVPMatrix();
                  this.ll &&
                    this.ll.pickRender({
                      meshes: this.meshes,
                      mvp: o,
                      opacity: this._getOpacity(),
                      pickFbo: this._needPickFrame && this._pickFbo,
                      pickPos: this._pickPos,
                    });
                }
              }),
              (s.afterRender = function () {}),
              (s.PA = function () {
                return RenderHelper.SA(this.ll, this);
              }),
              i
            );
          })(Layer),
          calcDistance = function (r) {
            for (var n = 0, i = 0; i < r.length - 1; i++)
              n += glMatrix.vec2.distance(r[i], r[i + 1]);
            return n;
          },
          reverse = function (r) {
            return glMatrix.vec3.fromValues(-r[0], -r[1], -r[2]);
          },
          normalMultiple = function (r, n) {
            return glMatrix.vec3.fromValues(r[0] * n, r[1] * n, r[2] * n);
          },
          calcNormal = function (r, n, i) {
            var s = glMatrix.vec3.sub(glMatrix.vec3.create(), n, r),
              a = glMatrix.vec3.create();
            return glMatrix.vec3.cross(a, i, s), glMatrix.vec3.normalize(a, a);
          },
          calcAngle = function (r, n) {
            var i =
              glMatrix.vec3.dot(r, n) /
              glMatrix.vec3.length(r) /
              glMatrix.vec3.length(n);
            return Math.acos(Math.min(1, i));
          },
          calcWise = function (r, n) {
            var i = glMatrix.vec3.create(),
              s = glMatrix.vec2.fromValues(r[0], r[1]),
              a = glMatrix.vec2.fromValues(n[0], n[1]);
            return (
              glMatrix.vec2.cross(i, a, s),
              i[2] === 0 ? i[2] : i[2] / Math.abs(i[2])
            );
          },
          calcAngleBisector = function (r, n) {
            var i = glMatrix.vec3.normalize(glMatrix.vec3.create(), r),
              s = glMatrix.vec3.normalize(glMatrix.vec3.create(), n),
              a = glMatrix.vec3.add(glMatrix.vec3.create(), i, s);
            return glMatrix.vec3.normalize(a, a);
          },
          pushArray$e = CommonUtil$1._C,
          _PulseLineFusion = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.DC = function () {}),
              (s.buildStyle = function (a, o) {
                for (
                  var l = function (h) {
                      var p = a[h];
                      if (!a[h].features || !a[h].features.lines)
                        return "continue";
                      var d = p.features.lines,
                        m = StyleInstance.parse(d, o, u),
                        g = {};
                      d.forEach(function (v, y) {
                        if (m)
                          for (var _ in m.attributes) {
                            var b = m.attributes[_];
                            g[_] || (g[_] = []), (g[_][g[_].length] = b[y]);
                          }
                      }),
                        f.push({
                          attributes: g,
                          uniforms: m.uniforms,
                          si: m.si,
                        }),
                        f.push(m);
                    },
                    u = pulseline.style,
                    f = [],
                    c = 0;
                  c < a.length;
                  c++
                )
                  l(c);
                return f;
              }),
              (s.updateStyle = function (a, o, l, u) {
                if (!l.loca) return [];
                var f = l.dataset;
                return this.fusion(f, o, l, u);
              }),
              (s.fusion = function (a, o, l, u) {
                var f = this,
                  c = function (m) {
                    var g = f,
                      v = a[m];
                    if (!a[m].features || !a[m].features.lines)
                      return "continue";
                    var y = v.features.lines,
                      _ = u[m],
                      b = {
                        position: [],
                        normal: [],
                        angle: [],
                        pointType: [],
                        distance: [],
                        startDistance: [],
                        totalDistance: [],
                        lineWidth: [],
                        headColor: [],
                        trailColor: [],
                        pickColor: [],
                        index: [],
                      },
                      S = 0,
                      P = [];
                    y.forEach(function (I, F) {
                      var X = I.type,
                        W = I.coordinates,
                        Z = l.colorPick.add(I);
                      if (X === "MultiLineString") {
                        var j = g;
                        W.forEach(function ($) {
                          var R = $.map(function (O) {
                              return p.lngLatToCoord(O);
                            }),
                            M = j.triangles(R, {
                              style: _,
                              index: F,
                              pickColor: Z,
                            }),
                            w = M.index.map(function (O) {
                              return O + S;
                            });
                          pushArray$e(b.position, M.position),
                            pushArray$e(b.normal, M.normal),
                            pushArray$e(b.angle, M.angle),
                            pushArray$e(b.pointType, M.pointType),
                            pushArray$e(b.distance, M.distance),
                            pushArray$e(b.startDistance, M.startDistance),
                            pushArray$e(b.totalDistance, M.totalDistance),
                            pushArray$e(b.lineWidth, M.lineWidth),
                            pushArray$e(b.headColor, M.headColor),
                            pushArray$e(b.trailColor, M.trailColor),
                            pushArray$e(b.pickColor, M.pickColor),
                            pushArray$e(b.index, w),
                            (S += M.distance.length);
                        });
                      } else {
                        var L = W.map(function ($) {
                            return p.lngLatToCoord($);
                          }),
                          T = g.triangles(L, {
                            style: _,
                            index: F,
                            pickColor: Z,
                          }),
                          A = T.index.map(function ($) {
                            return $ + S;
                          });
                        pushArray$e(b.position, T.position),
                          pushArray$e(b.normal, T.normal),
                          pushArray$e(b.angle, T.angle),
                          pushArray$e(b.pointType, T.pointType),
                          pushArray$e(b.distance, T.distance),
                          pushArray$e(b.startDistance, T.startDistance),
                          pushArray$e(b.totalDistance, T.totalDistance),
                          pushArray$e(b.lineWidth, T.lineWidth),
                          pushArray$e(b.headColor, T.headColor),
                          pushArray$e(b.trailColor, T.trailColor),
                          pushArray$e(b.pickColor, T.pickColor),
                          pushArray$e(b.index, A),
                          (S += T.distance.length);
                      }
                      P[F] = b.distance.length;
                    }),
                      (h[m] = {
                        id: v.id,
                        attributes: {
                          position: {
                            buffer: f.regl.buffer(b.position),
                            size: 3,
                            offset: 0,
                            stride: 0,
                            td: !1,
                            divisor: 0,
                          },
                          normal: {
                            buffer: f.regl.buffer(b.normal),
                            size: 3,
                            offset: 0,
                            stride: 0,
                            td: !1,
                            divisor: 0,
                          },
                          angle: {
                            buffer: f.regl.buffer(b.angle),
                            size: 1,
                            offset: 0,
                            stride: 0,
                            td: !1,
                            divisor: 0,
                          },
                          pointType: {
                            buffer: f.regl.buffer(b.pointType),
                            size: 1,
                            offset: 0,
                            stride: 0,
                            td: !1,
                            divisor: 0,
                          },
                          distance: {
                            buffer: f.regl.buffer(b.distance),
                            size: 1,
                            offset: 0,
                            stride: 0,
                            td: !1,
                            divisor: 0,
                          },
                          startDistance: {
                            buffer: f.regl.buffer(b.startDistance),
                            size: 1,
                            offset: 0,
                            stride: 0,
                            td: !1,
                            divisor: 0,
                          },
                          totalDistance: {
                            buffer: f.regl.buffer(b.totalDistance),
                            size: 1,
                            offset: 0,
                            stride: 0,
                            td: !1,
                            divisor: 0,
                          },
                          lineWidth: {
                            buffer: f.regl.buffer(b.lineWidth),
                            size: 1,
                            offset: 0,
                            stride: 0,
                            td: !1,
                            divisor: 0,
                          },
                          headColor: {
                            buffer: f.regl.buffer(b.headColor),
                            size: 4,
                            offset: 0,
                            stride: 0,
                            td: !1,
                            divisor: 0,
                          },
                          trailColor: {
                            buffer: f.regl.buffer(b.trailColor),
                            size: 4,
                            offset: 0,
                            stride: 0,
                            td: !1,
                            divisor: 0,
                          },
                          pickColor: {
                            buffer: f.regl.buffer(b.pickColor),
                            size: 4,
                            offset: 0,
                            stride: 0,
                            td: !1,
                            divisor: 0,
                          },
                          index: f.regl.elements({
                            primitive: "triangles",
                            type: "uint32",
                            data: b.index,
                          }),
                        },
                        uniforms: _.uniforms,
                        si: _.si,
                        mf: {
                          Tw: { jw: P },
                          origin: {
                            position: b.position,
                            normal: b.normal,
                            angle: b.angle,
                            pointType: b.pointType,
                            distance: b.distance,
                            startDistance: b.startDistance,
                            totalDistance: b.totalDistance,
                            lineWidth: b.lineWidth,
                            index: b.index,
                          },
                        },
                      });
                  };
                if (!this.regl || !l.loca) return [];
                var h = [];
                u = u || this.buildStyle(a, o);
                for (var p = l.loca.customCoords, d = 0; d < a.length; d++)
                  c(d);
                return h;
              }),
              (s.EC = function () {
                return [];
              }),
              (s.triangles = function (a, o) {
                for (
                  var l = o.style,
                    u = l.attributes,
                    f = l.uniforms,
                    c = o.index,
                    h = o.pickColor,
                    p = u.lineWidth,
                    d = u.headColor,
                    m = u.trailColor,
                    g = f.altitude,
                    v = calcDistance(a),
                    y = {
                      position: [],
                      normal: [],
                      angle: [],
                      pointType: [],
                      distance: [],
                      startDistance: [],
                      totalDistance: [],
                      lineWidth: [],
                      headColor: [],
                      trailColor: [],
                      pickColor: [],
                      index: [],
                    },
                    _ = [],
                    b = 0;
                  b < a.length;
                  b++
                )
                  (b === 0 ||
                    a[b][0] !== a[b - 1][0] ||
                    a[b][1] !== a[b - 1][1]) &&
                    _.push(a[b]);
                if (_.length <= 1) return y;
                for (
                  var S = glMatrix.vec3.fromValues(0, 0, 1),
                    P = [],
                    I = [],
                    F = [],
                    X = [],
                    W = [],
                    Z = [],
                    j = [],
                    L = glMatrix.vec3.create(),
                    T = glMatrix.vec3.create(),
                    A = glMatrix.vec3.create(),
                    $ = 0,
                    R = 0;
                  R < _.length;
                  R++
                ) {
                  var M = _[R],
                    w = glMatrix.vec3.fromValues(M[0], M[1], g),
                    O = glMatrix.vec3.fromValues(M[0], M[1], 0);
                  if ((glMatrix.vec3.normalize(O, O), R === 0)) {
                    var E = _[R + 1],
                      k = glMatrix.vec3.fromValues(E[0], E[1], g),
                      D = glMatrix.vec3.sub(glMatrix.vec3.create(), k, w),
                      q = calcNormal(w, k, S);
                    I.push(w, w),
                      F.push(q, normalMultiple(q, -1)),
                      X.push(0, 0),
                      W.push(0, 0),
                      Z.push(0, 0),
                      j.push($, $),
                      (L = reverse(D)),
                      (T = q),
                      (A = w);
                  } else if (R === _.length - 1) {
                    var J = glMatrix.vec3.dist(A, w);
                    I.push(w, w),
                      F.push(T, normalMultiple(T, -1)),
                      X.push(0, 0),
                      W.push(0, 0),
                      ($ += J),
                      Z.push(J, J),
                      j.push($, $);
                    var de = I.length;
                    P.push(de - 4, de - 2, de - 1),
                      P.push(de - 4, de - 1, de - 3);
                  } else {
                    var we = _[R + 1],
                      Se = glMatrix.vec3.fromValues(we[0], we[1], g),
                      He = glMatrix.vec3.sub(glMatrix.vec3.create(), Se, w),
                      et = calcAngleBisector(L, He);
                    if (glMatrix.vec3.length(et) === 0) continue;
                    var Ke = calcNormal(w, Se, S),
                      Fe = calcAngle(et, He),
                      qe = glMatrix.vec3.dist(A, w),
                      Mt = calcWise(L, He);
                    if (Mt >= 0) {
                      I.push(w, w, w, w, w),
                        F.push(
                          et,
                          normalMultiple(T, -1),
                          et,
                          et,
                          normalMultiple(Ke, -1)
                        ),
                        X.push(Fe, 0, Fe, Fe, 0),
                        W.push(-1, 0, 0, 1, 0),
                        ($ += qe),
                        Z.push(qe, qe, qe, qe, qe),
                        j.push($, $, $, $, $);
                      var ot = I.length;
                      P.push(ot - 3, ot - 4, ot - 1),
                        P.push(ot - 7, ot - 5, ot - 4),
                        P.push(ot - 7, ot - 4, ot - 6);
                    } else {
                      I.push(w, w, w, w, w),
                        F.push(T, et, et, Ke, et),
                        X.push(0, Fe, Fe, 0, Fe),
                        W.push(0, -1, 0, 0, 1),
                        ($ += qe),
                        Z.push(qe, qe, qe, qe, qe),
                        j.push($, $, $, $, $);
                      var at = I.length;
                      P.push(at - 3, at - 5, at - 2),
                        P.push(at - 7, at - 5, at - 4),
                        P.push(at - 7, at - 4, at - 6);
                    }
                    (L = reverse(He)), (T = Ke), (A = w);
                  }
                }
                var Lt = [],
                  $t = I.length;
                I.forEach(function (Vt) {
                  var mt = _slicedToArray(Vt, 3),
                    yt = mt[0],
                    xt = mt[1],
                    It = mt[2];
                  Lt.push(yt, xt, It);
                });
                var Rt = [];
                F.forEach(function (Vt) {
                  var mt = _slicedToArray(Vt, 3),
                    yt = mt[0],
                    xt = mt[1],
                    It = mt[2];
                  Rt.push(yt, xt, It);
                });
                for (
                  var Ot = p[c],
                    wt = d[c],
                    kt = [],
                    Pt = m[c],
                    At = [],
                    ut = [],
                    ct = 0;
                  ct < $t;
                  ct++
                ) {
                  var vt, rt, Wt;
                  (vt = kt).push.apply(vt, _toConsumableArray(wt)),
                    (rt = At).push.apply(rt, _toConsumableArray(Pt)),
                    (Wt = ut).push.apply(Wt, _toConsumableArray(h));
                }
                return (
                  (y.index = P),
                  (y.position = Lt),
                  (y.normal = Rt),
                  (y.angle = X),
                  (y.pointType = W),
                  (y.distance = Z),
                  (y.startDistance = j),
                  (y.totalDistance = new Array($t).fill(v)),
                  (y.lineWidth = new Array($t).fill(Ot)),
                  (y.headColor = kt),
                  (y.trailColor = At),
                  (y.pickColor = ut),
                  y
                );
              }),
              (s.destroy = function () {
                this.regl = null;
              }),
              (i.getInstance = function () {
                return this.ui;
              }),
              i
            );
          })(GeometryFusion),
          PulseLineFusion = _PulseLineFusion;
        (PulseLineFusion.ui = new _PulseLineFusion()),
          PulseLineFusion.getInstance();
        var PulseLineShader = {
            vertex:
              "\n        precision highp float;\n        attribute vec3 position;\n        attribute vec3 normal;\n        attribute float angle;\n        attribute float pointType;\n        attribute float distance;\n        attribute float startDistance;\n        attribute float totalDistance;\n        attribute float lineWidth;\n        attribute vec4 headColor;\n        attribute vec4 trailColor;\n        uniform mat4 mvp;\n        uniform float resolution;\n        varying float vDistance;\n        varying float vTotalDistance;\n        varying vec4 vHeadColor;\n        varying vec4 vTrailColor;\n        "
                .concat(
                  ColorGLSL.getColorShader().vertex,
                  "\n\n        vec3 normalizeAndMulti(vec3 vec, float multi) {\n            vec3 nNormal = normalize(vec);\n            return vec3(\n                multi * nNormal.x,\n                multi * nNormal.y,\n                multi * nNormal.z\n            );\n        }\n        \n        void main() {\n          float halfLineWidth = lineWidth / 2.0 * resolution;\n          vec3 pointPosition;\n            // \u5224\u65AD\u662F\u5426\u4E3A\u5185\u89D2\u70B9\n            if (angle != 0.0) {\n                // \u5224\u65AD\u662F\u5426\u4E3A\u89D2\u5EA6\u8FC7\u5C0F\u7684\u7279\u6B8A\u60C5\u5F62\n                bool angleIsTooSmall = halfLineWidth / tan(angle) >= distance;\n                if (angleIsTooSmall) {\n                    if (pointType == 0.0) {\n                        pointPosition = position;\n                    } else {\n                        pointPosition = position + normalizeAndMulti(normal, halfLineWidth);\n                    }\n                    vDistance = startDistance;\n                } else {\n                    pointPosition = position + normalizeAndMulti(normal, halfLineWidth / sin(angle));\n                    vDistance = startDistance + pointType * halfLineWidth / tan(angle);\n                }\n            } else {\n                // \u5916\u89D2\u70B9\n                pointPosition = position + normalizeAndMulti(normal, halfLineWidth);\n                vDistance = startDistance;\n            }\n            vTotalDistance = totalDistance;\n            vHeadColor = headColor;\n            vTrailColor = trailColor;\n            gl_Position = mvp * vec4(pointPosition, 1.0);\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainVert,
                  "\n        }\n    "
                ),
            fragment:
              "\n        precision highp float;\n        varying float vDistance;\n        varying float vTotalDistance;\n        varying vec4 vHeadColor;\n        varying vec4 vTrailColor;\n        uniform float interval;\n        uniform float duration;\n        uniform float time;\n        uniform float opacity;\n\n        float trailLength;\n        float offset;\n        float distanceMod;\n        float ratio;\n        "
                .concat(
                  ColorGLSL.getColorShader().fragment,
                  "\n\n        void main() {\n            trailLength = vTotalDistance * interval;\n            offset = vTotalDistance * mod(time / duration * 1000.0, 1.0);\n            distanceMod = mod(vDistance + trailLength - offset, trailLength);\n            ratio = distanceMod / trailLength;\n            gl_FragColor = mix(vTrailColor, vHeadColor, ratio);\n            gl_FragColor.a *= opacity;\n\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainFrag,
                  "\n            // if (vDistance > offset) {\n            //   gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n            // } else {\n            // }\n        }\n    "
                ),
          },
          __defProp$g = Object.defineProperty,
          __defProps$7 = Object.defineProperties,
          __getOwnPropDescs$7 = Object.getOwnPropertyDescriptors,
          __getOwnPropSymbols$g = Object.getOwnPropertySymbols,
          __hasOwnProp$g = Object.prototype.hasOwnProperty,
          __propIsEnum$g = Object.prototype.propertyIsEnumerable,
          __defNormalProp$g = function (r, n, i) {
            return n in r
              ? __defProp$g(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$g = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$g.call(n, i) && __defNormalProp$g(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$g)
              try {
                for (
                  var l = __getOwnPropSymbols$g(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$g.call(n, i) && __defNormalProp$g(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __spreadProps$7 = function (r, n) {
            return __defProps$7(r, __getOwnPropDescs$7(n));
          },
          PulseLineRender = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.m$ = function (a) {
                if (!this.regl) return !1;
                var o = this.regl;
                this.gA(PulseLineShader, a, {
                  attributes: __spreadValues$g(
                    {
                      position: o.prop("position"),
                      normal: o.prop("normal"),
                      angle: o.prop("angle"),
                      pointType: o.prop("pointType"),
                      startDistance: o.prop("startDistance"),
                      totalDistance: o.prop("totalDistance"),
                      distance: o.prop("distance"),
                      lineWidth: o.prop("lineWidth"),
                      headColor: o.prop("headColor"),
                      trailColor: o.prop("trailColor"),
                    },
                    ColorGLSL.getColor(o).attribute
                  ),
                  uniforms: __spreadValues$g(
                    {
                      mvp: o.prop("mvp"),
                      resolution: o.prop("resolution"),
                      opacity: o.prop("opacity"),
                      duration: o.prop("duration"),
                      interval: o.prop("interval"),
                      time: o.prop("time"),
                    },
                    ColorGLSL.getColor(o).uniform
                  ),
                  blend: {
                    enable: !0,
                    func: {
                      srcRGB: "src alpha",
                      dstRGB: "one minus src alpha",
                      srcAlpha: 1,
                      dstAlpha: "one minus src alpha",
                    },
                    equation: { rgb: "add", alpha: "add" },
                  },
                  depth: { enable: !1 },
                  primitive: "triangles",
                  offset: 0,
                  elements: o.prop("index"),
                });
              }),
              (s.render = function (a) {
                var o = this.yA(PulseLineShader);
                if (o) {
                  var l = a.meshes,
                    u = a.mvp,
                    f = a.resolution,
                    c = a.opacity,
                    h = a.animateCounter;
                  l.forEach(function (p) {
                    var d = p.attributes,
                      m = p.uniforms,
                      g = m.interval,
                      v = m.duration,
                      y = 60,
                      _ = h / y;
                    o(
                      __spreadProps$7(__spreadValues$g({}, d), {
                        mvp: u,
                        resolution: f,
                        opacity: c,
                        interval: g,
                        duration: v,
                        time: _,
                        isPick: !1,
                      })
                    );
                  });
                }
              }),
              (s.pickRender = function (a) {
                var o = this.yA(PulseLineShader);
                if (o) {
                  var l = a.meshes,
                    u = a.mvp,
                    f = a.resolution,
                    c = a.opacity,
                    h = a.animateCounter,
                    p = a.pickFbo,
                    d = a.pickPos;
                  if (p && d) {
                    var m = this;
                    p.use(function () {
                      m.regl.clear({ color: [0, 0, 0, 0], depth: 1 }),
                        l.forEach(function (g) {
                          var v = g.attributes,
                            y = g.uniforms,
                            _ = y.interval,
                            b = y.duration,
                            S = 60,
                            P = h / S;
                          o(
                            __spreadProps$7(__spreadValues$g({}, v), {
                              mvp: u,
                              resolution: f,
                              opacity: c,
                              interval: _,
                              duration: b,
                              time: P,
                              isPick: !0,
                            })
                          );
                        });
                    });
                  }
                }
              }),
              i
            );
          })(Render),
          pushArray$d = CommonUtil$1._C,
          PulseLineLayer = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              (o = n.call(this, a)),
                (o.CLASS_NAME = "PulseLine"),
                (o.fusion = new PulseLineFusion()),
                (o.ll = new PulseLineRender());
              var l = pulseline.Sw;
              return (
                (o.zooms = a.zooms === void 0 ? l.zooms : a.zooms),
                (o.visible = a.visible === void 0 ? l.visible : a.visible),
                (o.zIndex = a.zIndex === void 0 ? l.zIndex : a.zIndex),
                (o.opacity = a.opacity === void 0 ? l.opacity : a.opacity),
                o.AC({ zooms: o.zooms, visible: o.visible, zIndex: o.zIndex }),
                o.buryPoint.record(o.CLASS_NAME),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.receiveDataset = function (a) {
                (this.dataset = a),
                  this.setStyle(this.styleOptions),
                  this.onAdd();
              }),
              (s.sx = function () {
                return { ux: this.sP, timestamp: 0 };
              }),
              (s.setStyle = function (a) {
                if (
                  (_get(_getPrototypeOf(i.prototype), "setStyle", this).call(
                    this,
                    a
                  ),
                  this.dataset && this.dataset.length > 0 && this.meshes)
                ) {
                  var o = this.WC(),
                    l = o.didFusion;
                  if (l.length) {
                    var u = this.fusion.buildStyle(
                        this.dataset,
                        this.styleOptions
                      ),
                      f = this.fusion.updateStyle(
                        l,
                        this.styleOptions,
                        this,
                        u
                      );
                    (this.meshes = f), this.loca && this.loca.requestRender();
                  }
                }
              }),
              (s.jC = function () {
                _get(_getPrototypeOf(i.prototype), "jC", this).call(this),
                  !(!this.loca || !this.loca.regl || this.ll.regl) &&
                    ((this.ll.regl = this.loca.regl),
                    this.loca.rendererManager.addRenderer(this.ll));
              }),
              (s.beforeRender = function () {
                if (
                  (_get(
                    _getPrototypeOf(i.prototype),
                    "beforeRender",
                    this
                  ).call(this),
                  !this.fusion.regl &&
                    this.loca &&
                    ((this.fusion.regl = this.loca.regl),
                    this.loca.fusionManager.addFusion(this.fusion)),
                  this.jC(),
                  this.source && (this.dataset = this.source.LC()),
                  this.fusion)
                ) {
                  var a = this.WC(),
                    o = a.willFusion,
                    l = a.didFusion;
                  if ((this.fusion.EC(), o.length > 0)) {
                    var u = this.fusion.fusion(o, this.styleOptions, this);
                    this.meshes = pushArray$d(l, u);
                  }
                }
              }),
              (s.render = function () {
                var a, o;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var l =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    u = this.projection.getResolution(
                      (o = this.loca) == null ? void 0 : o.map.getZoom()
                    );
                  if (this.ll && this.meshes.length > 0) {
                    var f = this.hP();
                    this.ll.render({
                      meshes: this.meshes,
                      mvp: l,
                      resolution: u,
                      opacity: this._getOpacity(),
                      animateCounter: f,
                      blend: "lighter",
                    });
                  }
                }
              }),
              (s.pickRender = function () {
                var a, o;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var l =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    u = this.projection.getResolution(
                      (o = this.loca) == null ? void 0 : o.map.getZoom()
                    );
                  if (this.ll) {
                    var f = this.hP();
                    this.ll.pickRender({
                      meshes: this.meshes,
                      mvp: l,
                      resolution: u,
                      opacity: this._getOpacity(),
                      animateCounter: f,
                      pickFbo: this._needPickFrame && this._pickFbo,
                      pickPos: this._pickPos,
                    });
                  }
                }
              }),
              (s.afterRender = function () {}),
              (s.PA = function () {
                return RenderHelper.SA(this.ll, this);
              }),
              i
            );
          })(Layer),
          SphericalMercator = (function () {
            var r = Math.PI / 180,
              n = 180 / Math.PI,
              i = 6378137,
              s = 85.0511287798,
              a = function (u, f) {
                var c = s;
                f = Math.max(Math.min(c, f), -c);
                var h = u * r,
                  p = f * r;
                return (
                  (p = Math.log(Math.tan(Math.PI / 4 + p / 2))), [h * i, p * i]
                );
              },
              o = function (u, f) {
                var c = (u / i) * n,
                  h = (2 * Math.atan(Math.exp(f / i)) - Math.PI / 2) * n;
                return [c, h];
              },
              l = function (u) {
                return (20037508342789244e-9 * 2) / 256 / Math.pow(2, u);
              };
            return { project: a, unproject: o, getResolution: l };
          })(),
          grid = {
            ri: function r(n) {
              for (
                var i =
                    arguments.length > 1 && arguments[1] !== void 0
                      ? arguments[1]
                      : 100,
                  s = arguments.length > 2 ? arguments[2] : void 0,
                  a = {},
                  o = [],
                  l = i * 2,
                  u = -1,
                  f = n.length;
                ++u < f;

              ) {
                var c = _slicedToArray(n[u].lnglat, 2),
                  h = c[0],
                  p = c[1],
                  d = SphericalMercator.project(h, p),
                  m = Math.floor(d[0] / l),
                  g = Math.floor(d[1] / l),
                  v = m + "-" + g,
                  y = a[v];
                if (y) y.coordinates.push(n[u]);
                else {
                  var _ = SphericalMercator.unproject(m * l + i, g * l + i);
                  (a[v] = y =
                    {
                      rowCol: [m, g],
                      center: _,
                      coordinates: [n[u]],
                      hx: s(_),
                    }),
                    o.push(y);
                }
              }
              return o;
            },
            vx: function r(n) {
              for (
                var i =
                    arguments.length > 1 && arguments[1] !== void 0
                      ? arguments[1]
                      : 100,
                  s = {},
                  a = [],
                  o = i * 2,
                  l = -1,
                  u = n.length;
                ++l < u;

              ) {
                var f = n[l].coordinaties,
                  c = Math.floor(f[0] / o),
                  h = Math.floor(f[1] / o),
                  p = c + "-" + h,
                  d = s[p];
                d
                  ? d.coordinates.push(n[l])
                  : ((s[p] = d =
                      {
                        rowCol: [c, h],
                        center: [c * o + i, h * o + i],
                        coordinates: [n[l]],
                      }),
                    a.push(d));
              }
              return a;
            },
            DC: function r(n, i) {
              var s,
                a = [],
                o = i.radius,
                l = 0,
                u = _slicedToArray(n.hx, 2),
                f = u[0],
                c = u[1],
                h = [f - o + l, c + o - l],
                p = [f - o + l, c - o + l],
                d = [f + o - l, c - o + l],
                m = [f + o - l, c + o - l];
              return (s = a).push.apply(s, [h, p, d, m, h]), a;
            },
          },
          hexagon = {
            ei: Math.PI / 3,
            oi: [
              0,
              Math.PI / 3,
              (2 * Math.PI) / 3,
              Math.PI / 3,
              Math.PI / 3,
              (5 * Math.PI) / 3,
            ],
            ri: function r(n) {
              for (
                var i =
                    arguments.length > 1 && arguments[1] !== void 0
                      ? arguments[1]
                      : 100,
                  s = arguments.length > 2 ? arguments[2] : void 0,
                  a = {},
                  o = [],
                  l = i * 2 * Math.sin(this.ei),
                  u = i * 1.5,
                  f = 0,
                  c = n.length;
                f < c;
                ++f
              ) {
                var h = _slicedToArray(n[f].lnglat, 2),
                  p = h[0],
                  d = h[1],
                  m = SphericalMercator.project(p, d),
                  g = _slicedToArray(m, 2),
                  v = g[0],
                  y = g[1];
                y = y / u;
                var _ = Math.round(y);
                v = v / l - (_ & 1) / 2;
                var b = Math.round(v),
                  S = y - _;
                if (Math.abs(S) * 3 > 1) {
                  var P = v - b,
                    I = b + (v < b ? -1 : 1) / 2,
                    F = _ + (y < _ ? -1 : 1),
                    X = v - I,
                    W = y - F;
                  P * P + S * S > X * X + W * W &&
                    ((b = I + (_ & 1 ? 1 : -1) / 2), (_ = F));
                }
                var Z = b + "-" + _,
                  j = a[Z];
                if (j) j.coordinates.push(n[f]);
                else {
                  var L = SphericalMercator.unproject(
                    (b + (_ & 1) / 2) * l,
                    _ * u
                  );
                  (a[Z] = j =
                    {
                      rowCol: [b, _],
                      center: L,
                      coordinates: [n[f]],
                      hx: s(L),
                    }),
                    o.push(j);
                }
              }
              return o;
            },
            DC: function r(n, i) {
              var s,
                a = [],
                o = i.radius,
                l = 0,
                u = o / 2,
                f = Math.sqrt(3) * o,
                c = Math.sqrt(Math.pow(f, 2) + Math.pow(o, 2)),
                h = _slicedToArray(n.hx, 2),
                p = h[0],
                d = h[1],
                m = [p, d + c / 2 - l],
                g = [p - f / 2 + l, d + u - l / 2],
                v = [p - f / 2 + l, d - u + l / 2],
                y = [p, d - c / 2 + l],
                _ = [p + f / 2 - l, d - u + l / 2],
                b = [p + f / 2 - l, d + u - l / 2];
              return (s = a).push.apply(s, [m, g, v, y, _, b, m]), a;
            },
          },
          Bin = Object.freeze({
            __proto__: null,
            grid: grid,
            hexagon: hexagon,
          }),
          geoUtils = {
            ai: function r(n) {
              var i = [];
              if (n.type === "MultiPoint")
                for (
                  var s = n.properties, a = n.coordinates, o = a.length, l = 0;
                  l < o;
                  ++l
                ) {
                  var u = a[l];
                  i.push({ properties: s, type: "Point", coordinates: u });
                }
              else if (n.type === "MultiLineString")
                for (
                  var f = n.properties, c = n.coordinates, h = c.length, p = 0;
                  p < h;
                  ++p
                ) {
                  var d = c[p];
                  i.push({ properties: f, type: "Point", coordinates: d });
                }
              else if (n.type === "MultiPolygon")
                for (
                  var m = n.properties, g = n.coordinates, v = g.length, y = 0;
                  y < v;
                  ++y
                ) {
                  var _ = g[y];
                  i.push({ properties: m, type: "Point", coordinates: _ });
                }
              return i;
            },
          },
          __defProp$f = Object.defineProperty,
          __getOwnPropSymbols$f = Object.getOwnPropertySymbols,
          __hasOwnProp$f = Object.prototype.hasOwnProperty,
          __propIsEnum$f = Object.prototype.propertyIsEnumerable,
          __defNormalProp$f = function (r, n, i) {
            return n in r
              ? __defProp$f(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$f = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$f.call(n, i) && __defNormalProp$f(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$f)
              try {
                for (
                  var l = __getOwnPropSymbols$f(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$f.call(n, i) && __defNormalProp$f(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          pushArray$c = CommonUtil$1._C,
          styleConf = { grid: grid$1, hexagon: hexagon$1 },
          GridsFusion = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.DC = function (a, o, l) {
                for (
                  var u =
                      arguments.length > 3 && arguments[3] !== void 0
                        ? arguments[3]
                        : "grid",
                    f,
                    c,
                    h,
                    p,
                    d = [],
                    m = 0,
                    g = a.length;
                  m < g;
                  m++
                )
                  if (!(!a[m].features || !a[m].features.points)) {
                    var v = o.unit,
                      y = o.radius,
                      _ = o.gap,
                      b = a[m].features.points,
                      S = y,
                      P = _;
                    v === "px" &&
                      ((S *= l.projection.getResolution(
                        (f = l.loca) == null ? void 0 : f.map.getZoom()
                      )),
                      (P *= l.projection.getResolution(
                        (c = l.loca) == null ? void 0 : c.map.getZoom()
                      )));
                    for (var I = [], F = [], X = 0, W = b.length; X < W; X++) {
                      var Z = b[X];
                      if (Z.type === "MultiPoint") {
                        for (
                          var j = geoUtils.ai(Z), L = 0, T = j.length;
                          L < T;
                          L++
                        ) {
                          var A = j[L];
                          F.push({
                            lnglat: A.coordinates,
                            properties: A.properties,
                          });
                        }
                        pushArray$c(I, j);
                      } else
                        F.push({
                          lnglat: Z.coordinates,
                          properties: Z.properties,
                        }),
                          I.push(Z);
                    }
                    var $ = Bin[u].ri(
                      F,
                      S + P,
                      (p = l.loca) == null
                        ? void 0
                        : p.customCoords.lngLatToCoord.bind(
                            (h = l.loca) == null ? void 0 : h.customCoords
                          )
                    );
                    d.push($);
                  }
                return d;
              }),
              (s.buildStyle = function (a, o) {
                for (
                  var l =
                      arguments.length > 2 && arguments[2] !== void 0
                        ? arguments[2]
                        : "grid",
                    u,
                    f = styleConf[l].style,
                    c = [],
                    h = 0,
                    p = a.length;
                  h < p;
                  h++
                ) {
                  for (
                    var d = a[h],
                      m = StyleInstance.parse(d, o, f),
                      g = {},
                      v = 0,
                      y = d.length;
                    v < y;
                    v++
                  )
                    if (m)
                      for (var _ in m.attributes) {
                        var b = m.attributes[_];
                        g[_] || (g[_] = []),
                          ((u = b[v]) == null ? void 0 : u.length) > 0
                            ? pushArray$c(g[_], b[v])
                            : (g[_][g[_].length] = b[v]);
                      }
                  c.push({ attributes: g, uniforms: m.uniforms, si: m.si });
                }
                return c;
              }),
              (s.fusion = function (a, o, l) {
                var u =
                    arguments.length > 3 && arguments[3] !== void 0
                      ? arguments[3]
                      : "grid",
                  f;
                if (!this.regl || !l.loca) return [];
                var c = l.projection.getResolution(
                    (f = l.loca) == null ? void 0 : f.map.getZoom()
                  ),
                  h = [],
                  p = this.DC(a, o, l, u),
                  d = o.unit,
                  m = o.radius,
                  g = o.gap,
                  v = m,
                  y = g;
                d === "px" && ((v *= c), (y *= c));
                for (
                  var _ = this.buildStyle(p, o, u), b = 0, S = p.length;
                  b < S;
                  b++
                ) {
                  for (
                    var P = p[b],
                      I = _[b],
                      F = {
                        index: [],
                        vertex: [],
                        color: [],
                        pickColor: [],
                        normal: [],
                        topOrBottom: [],
                        labels: [],
                      },
                      X = [],
                      W = [],
                      Z = [],
                      j = [],
                      L = 0,
                      T = P.length;
                    L < T;
                    L++
                  ) {
                    var A = P[L],
                      $ = Bin[u].DC(A, { radius: v, gap: y }),
                      R = l.colorPick.add(A),
                      M = PolygonsFusionInstance.triangles(
                        [$],
                        { style: I, index: L, pickColor: R, id: L },
                        {
                          lngLatToCoord: function (O) {
                            return O;
                          },
                        },
                        l.hasSide
                      ),
                      w = F.vertex.length;
                    X.push(w),
                      W.push(w + M.Tw.Pw),
                      Z.push(w + M.Tw.top),
                      GeoUtil.mergeTriangles(F, M, 4),
                      pushArray$c(F.color, M.color),
                      pushArray$c(F.pickColor, M.pickColor),
                      pushArray$c(F.normal, M.normal),
                      pushArray$c(F.topOrBottom, M.topOrBottom),
                      I.attributes.label[L] &&
                        F.labels.push(
                          __spreadValues$f(
                            {
                              position: _toConsumableArray(A.center).concat([
                                I.attributes.altitude[L] +
                                  I.attributes.height[L] +
                                  100,
                              ]),
                            },
                            I.attributes.label[L]
                          )
                        );
                  }
                  (j[b] = F.vertex.length),
                    (h[b] = {
                      id: a[b].id,
                      attributes: {
                        color: {
                          buffer: this.regl.buffer(F.color),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        pickColor: {
                          buffer: this.regl.buffer(F.pickColor),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        position: {
                          buffer: this.regl.buffer(F.vertex),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        topOrBottom: {
                          buffer: this.regl.buffer(F.topOrBottom),
                          offset: 0,
                          stride: 4 * 1,
                          td: !1,
                          divisor: 0,
                        },
                        normal: {
                          buffer: this.regl.buffer(F.normal),
                          offset: 0,
                          stride: 4 * 3,
                          td: !1,
                          divisor: 0,
                        },
                        index: this.regl.elements({
                          primitive: "triangles",
                          type: "uint32",
                          data: F.index,
                        }),
                      },
                      uniforms: {},
                      si: I.si,
                      mf: {
                        Tw: { bottom: X, Pw: W, top: Z, jw: j },
                        origin: { position: F.vertex, color: F.color },
                        labels: F.labels,
                      },
                    });
                }
                return h;
              }),
              (s.updateStyle = function (a, o) {
                for (
                  var l = function (c, h) {
                      for (
                        var p = a[c],
                          d = o[c].attributes,
                          m = d.altitude,
                          g = d.height,
                          v = d.topColor,
                          y = d.sideBottomColor,
                          _ = d.sideTopColor,
                          b = d.label,
                          S = p.mf.origin,
                          P = S.position,
                          I = S.color,
                          F = p.mf.Tw,
                          X = F.top,
                          W = F.bottom,
                          Z = F.Pw,
                          j = F.jw,
                          L = 0,
                          T = 0,
                          A = 0,
                          $ = P.length;
                        A < $;
                        A += 3
                      ) {
                        var R = (A / 3) * 4,
                          M = void 0;
                        A >= j[L] && L++;
                        var w = L * 4;
                        A >= W[T + 1] && T++,
                          A < Z[T]
                            ? ((M = y), (P[A + 2] = m[L]))
                            : A >= Z[T] && A < X[T]
                            ? ((A - Z[T]) / 3) % 2 === 0
                              ? ((P[A + 2] = m[L]), (M = y))
                              : ((P[A + 2] = g[L]), (M = _))
                            : ((M = v), (P[A + 2] = g[L])),
                          (I[R] = M[w]),
                          (I[R + 1] = M[w + 1]),
                          (I[R + 2] = M[w + 2]),
                          (I[R + 3] = M[w + 3]);
                      }
                      p.attributes.position.buffer({ data: P }),
                        p.attributes.color.buffer({ data: I }),
                        (p.mf.labels = p.mf.labels.map(function (O, E) {
                          return __spreadValues$f(
                            __spreadValues$f({}, O),
                            b[E]
                          );
                        }));
                    },
                    u = 0,
                    f = a.length;
                  u < f;
                  u++
                )
                  l(u, f);
              }),
              (s.EC = function () {
                for (
                  var a = arguments.length, o = new Array(a), l = 0;
                  l < a;
                  l++
                )
                  o[l] = arguments[l];
                throw new Error("Method not implemented.");
              }),
              (s.destroy = function () {
                this.regl = null;
              }),
              i
            );
          })(GeometryFusion),
          __defProp$e = Object.defineProperty,
          __getOwnPropSymbols$e = Object.getOwnPropertySymbols,
          __hasOwnProp$e = Object.prototype.hasOwnProperty,
          __propIsEnum$e = Object.prototype.propertyIsEnumerable,
          __defNormalProp$e = function (r, n, i) {
            return n in r
              ? __defProp$e(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$e = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$e.call(n, i) && __defNormalProp$e(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$e)
              try {
                for (
                  var l = __getOwnPropSymbols$e(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$e.call(n, i) && __defNormalProp$e(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          GridShader = {
            vertex:
              "\n        precision highp float;\n\n        attribute vec4 position;\n        attribute vec3 normal;\n        attribute vec4 color;\n        attribute float topOrBottom;\n\n        varying vec3 vNormal;\n        varying vec4 vColor;\n        varying vec3 vPosition;\n\n        uniform mat4 mvp;\n        "
                .concat(ColorGLSL.getColorShader().vertex, "\n        ")
                .concat(RenderUtil.getBezier(), "\n        ")
                .concat(RenderUtil.getScaleType("altitude"), "\n        ")
                .concat(
                  RenderUtil.getScaleType("height"),
                  "\n\n        void main() {\n            float altitudeScale = altitudeScaleValue(position.w);\n            float heightScale = heightScaleValue(position.w);\n            // \u52A8\u753B\n            vec3 realPos = position.xyz;\n            if(topOrBottom == 0.0) {\n                realPos = vec3(position.xy, position.z * altitudeScale);\n            }\n            if(topOrBottom == 1.0) {\n                realPos = vec3(position.xy, position.z * heightScale);\n            }\n            vColor = color;\n            vNormal = normal;\n            vPosition = realPos;\n            gl_Position = mvp * vec4(realPos, 1.0);\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainVert,
                  "\n        } \n    "
                ),
            fragment:
              "\n        precision highp float;\n        varying vec4 vColor;\n\n        // \u5982\u679C\u9700\u8981\u5149\u7167\uFF0C\u8FD9\u4E24\u4E2A\u53D8\u91CF\u662F\u5FC5\u987B\u7684\n        varying vec3 vNormal;\n        varying vec3 vPosition;\n\n        uniform float opacity;\n\n        uniform vec3 cameraPosition;\n        uniform float shininess;\n        #include <lightUniforms,lightFunctions>;\n\n        "
                .concat(
                  ColorGLSL.getColorShader().fragment,
                  "\n\n        void main() {\n            gl_FragColor = vColor;\n            #include <lightMainCompute>;\n            gl_FragColor.a *= opacity;\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainFrag,
                  "\n        }\n    "
                ),
            includes: __spreadValues$e({}, LightIncludes),
          },
          __defProp$d = Object.defineProperty,
          __defProps$6 = Object.defineProperties,
          __getOwnPropDescs$6 = Object.getOwnPropertyDescriptors,
          __getOwnPropSymbols$d = Object.getOwnPropertySymbols,
          __hasOwnProp$d = Object.prototype.hasOwnProperty,
          __propIsEnum$d = Object.prototype.propertyIsEnumerable,
          __defNormalProp$d = function (r, n, i) {
            return n in r
              ? __defProp$d(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$d = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$d.call(n, i) && __defNormalProp$d(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$d)
              try {
                for (
                  var l = __getOwnPropSymbols$d(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$d.call(n, i) && __defNormalProp$d(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __spreadProps$6 = function (r, n) {
            return __defProps$6(r, __getOwnPropDescs$6(n));
          },
          GridsRender = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              _classCallCheck(this, i);
              var a;
              return (
                (a = n.call.apply(
                  n,
                  [this].concat(Array.prototype.slice.call(arguments))
                )),
                (a.v$ = [new LabelsRender$1()]),
                a
              );
            }
            var s = i.prototype;
            return (
              (s.m$ = function (a) {
                if (!this.regl) return !1;
                this.v$.forEach(function (u) {
                  return u.m$(a);
                });
                var o = this.regl,
                  l = RenderHelper._A(a, o);
                this.gA(GridShader, a, {
                  attributes: __spreadValues$d(
                    {
                      position: o.prop("position"),
                      color: o.prop("color"),
                      normal: o.prop("normal"),
                      topOrBottom: o.prop("topOrBottom"),
                    },
                    ColorGLSL.getColor(o).attribute
                  ),
                  uniforms: __spreadValues$d(
                    __spreadValues$d(
                      __spreadValues$d(
                        __spreadValues$d(
                          {
                            mvp: o.prop("mvp"),
                            opacity: o.prop("opacity"),
                            shininess: o.prop("shininess"),
                            cameraPosition: o.prop("cameraPosition"),
                          },
                          RenderUtil.getScaleUniform("height", o)
                        ),
                        RenderUtil.getScaleUniform("altitude", o)
                      ),
                      ColorGLSL.getColor(o).uniform
                    ),
                    l
                  ),
                  blend: { enable: !0, func: RenderUtil.getBlend() },
                  cull: {
                    enable: o.prop("cullEnable"),
                    face: o.prop("cullface"),
                  },
                  depth: { enable: o.prop("depth"), func: "lequal" },
                  frontFace: "cw",
                  colorMask: o.prop("colorMask"),
                  elements: o.prop("index"),
                });
              }),
              (s.render = function (a) {
                var o = this.yA(GridShader);
                if (o) {
                  for (
                    var l = a.meshes,
                      u = a.mvp,
                      f = a.depth,
                      c = a.shininess,
                      h = a.acceptLight,
                      p = a.cull,
                      d = a.opacity,
                      m = a.cameraPosition,
                      g = a.lights,
                      v = a.vP,
                      y = p !== "none",
                      _ = p === "front" ? "front" : "back",
                      b = 0;
                    b < l.length;
                    b++
                  ) {
                    var S = l[b],
                      P = S.attributes;
                    o(
                      __spreadValues$d(
                        __spreadProps$6(
                          __spreadValues$d(__spreadValues$d({}, P), g),
                          {
                            depth: f,
                            shininess: c,
                            acceptLight: h,
                            cullEnable: y,
                            cullface: _,
                            opacity: d,
                            cameraPosition: m,
                            count: P.index.length,
                            mvp: u,
                            colorMask: [!1, !1, !1, !1],
                            isPick: !1,
                          }
                        ),
                        RenderUtil.getScaleProps(v)
                      )
                    );
                  }
                  for (var I = 0; I < l.length; I++) {
                    var F = l[I],
                      X = F.attributes;
                    o(
                      __spreadValues$d(
                        __spreadProps$6(
                          __spreadValues$d(__spreadValues$d({}, X), g),
                          {
                            depth: f,
                            shininess: c,
                            acceptLight: h,
                            cullEnable: y,
                            cullface: _,
                            opacity: d,
                            cameraPosition: m,
                            count: X.index.length,
                            mvp: u,
                            colorMask: [!0, !0, !0, !0],
                            isPick: !1,
                          }
                        ),
                        RenderUtil.getScaleProps(v)
                      )
                    );
                  }
                  for (var W = 0; W < l.length; W++) {
                    var Z = !0,
                      j = !1,
                      L = void 0;
                    try {
                      for (
                        var T = this.v$[Symbol.iterator](), A;
                        !(Z = (A = T.next()).done);
                        Z = !0
                      ) {
                        var $ = A.value;
                        $.render(l[W]);
                      }
                    } catch (R) {
                      (j = !0), (L = R);
                    } finally {
                      try {
                        !Z && T.return != null && T.return();
                      } finally {
                        if (j) throw L;
                      }
                    }
                  }
                }
              }),
              (s.pickRender = function (a) {
                var o = this.yA(GridShader);
                if (o) {
                  var l = a.meshes,
                    u = a.mvp,
                    f = a.depth,
                    c = a.shininess,
                    h = a.acceptLight,
                    p = a.cull,
                    d = a.opacity,
                    m = a.cameraPosition,
                    g = a.lights,
                    v = a.pickFbo,
                    y = a.vP,
                    _ = p !== "none",
                    b = p === "front" ? "front" : "back";
                  if (v) {
                    var S = this;
                    v.use(function () {
                      S.regl.clear({ color: [0, 0, 0, 0], depth: 1 });
                      for (var P = 0; P < l.length; P++) {
                        var I = l[P],
                          F = I.attributes;
                        o(
                          __spreadValues$d(
                            __spreadProps$6(
                              __spreadValues$d(__spreadValues$d({}, F), g),
                              {
                                depth: f,
                                shininess: c,
                                acceptLight: h,
                                cullEnable: _,
                                cullface: b,
                                opacity: d,
                                cameraPosition: m,
                                count: F.index.length,
                                mvp: u,
                                colorMask: [!0, !0, !0, !0],
                                isPick: !0,
                              }
                            ),
                            RenderUtil.getScaleProps(y)
                          )
                        );
                      }
                    });
                  }
                }
              }),
              i
            );
          })(Render),
          pushArray$b = CommonUtil$1._C,
          GridLayer = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              (o = n.call(this, a)),
                (o.CLASS_NAME = "Grid"),
                (o.fusion = new GridsFusion()),
                (o.ll = new GridsRender());
              var l = grid$1.Sw;
              return (
                (o.zooms = a.zooms === void 0 ? l.zooms : a.zooms),
                (o.visible = a.visible === void 0 ? l.visible : a.visible),
                (o.zIndex = a.zIndex === void 0 ? l.zIndex : a.zIndex),
                (o.opacity = a.opacity === void 0 ? l.opacity : a.opacity),
                (o.shininess =
                  a.shininess === void 0 ? l.shininess : a.shininess),
                (o.acceptLight =
                  a.acceptLight === void 0 ? l.acceptLight : a.acceptLight),
                (o.cullface = a.cullface || l.cullface),
                (o.hasSide = a.hasSide === void 0 ? l.hasSide : a.hasSide),
                (o.depth = a.depth === void 0 ? l.depth : a.depth),
                o.AC({ zooms: o.zooms, visible: o.visible, zIndex: o.zIndex }),
                o.buryPoint.record(o.CLASS_NAME),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.receiveDataset = function (a) {
                (this.dataset = a),
                  this.setStyle(this.styleOptions),
                  this.onAdd();
              }),
              (s.setStyle = function (a) {
                if (
                  ((a.unit = a.unit || "meter"),
                  _get(_getPrototypeOf(i.prototype), "setStyle", this).call(
                    this,
                    a
                  ),
                  (this.dataset = this.source.LC()),
                  this.colorPick.clear(),
                  this.dataset && this.dataset.length > 0 && this.meshes)
                ) {
                  var o = this.WC(),
                    l = o.didFusionDataset,
                    u = this.fusion.fusion(l, this.styleOptions, this);
                  (this.meshes = u),
                    (this.vA.state |= MeshesDirty),
                    this.loca && this.loca.requestRender();
                }
              }),
              (s.getInitialAnimateState = function () {
                return {
                  altitude: {
                    time: [1, 0, 0, 0],
                    type: [-1, 1, 0, 0],
                    value: [0, 1],
                  },
                  height: {
                    time: [1, 0, 0, 0],
                    type: [-1, 1, 0, 0],
                    value: [0, 1],
                  },
                };
              }),
              (s.jC = function () {
                _get(_getPrototypeOf(i.prototype), "jC", this).call(this),
                  !(!this.loca || !this.loca.regl || this.ll.regl) &&
                    ((this.ll.regl = this.loca.regl),
                    this.loca.rendererManager.addRenderer(this.ll));
              }),
              (s.beforeRender = function () {
                if (
                  (_get(
                    _getPrototypeOf(i.prototype),
                    "beforeRender",
                    this
                  ).call(this),
                  !this.fusion.regl &&
                    this.loca &&
                    ((this.fusion.regl = this.loca.regl),
                    this.loca.fusionManager.addFusion(this.fusion)),
                  this.jC(),
                  this.source && (this.dataset = this.source.LC()),
                  this.fusion)
                ) {
                  var a = this.WC(),
                    o = a.willFusion;
                  if (o.length > 0) {
                    var l = this.fusion.fusion(o, this.styleOptions, this);
                    (this.meshes = pushArray$b(this.meshes, l)),
                      (this.vA.state |= MeshesDirty);
                  }
                }
              }),
              (s.render = function () {
                var a;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var o =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    l = RenderHelper.IA(this.loca.lights);
                  this.ll &&
                    this.meshes.length > 0 &&
                    this.ll.render({
                      meshes: this.meshes,
                      mvp: o,
                      lights: l,
                      cameraPosition:
                        this.loca.customCoords.getCameraParams().position,
                      shininess: this.shininess,
                      acceptLight: this.acceptLight,
                      opacity: this._getOpacity(),
                      depth: this.depth,
                      cull: this.cullface,
                      vP: this._animateLayerState,
                    });
                }
              }),
              (s.pickRender = function () {
                var a;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var o =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    l = RenderHelper.IA(this.loca.lights);
                  this.ll &&
                    this.ll.pickRender({
                      meshes: this.meshes,
                      mvp: o,
                      lights: l,
                      cameraPosition:
                        this.loca.customCoords.getCameraParams().position,
                      shininess: this.shininess,
                      acceptLight: this.acceptLight,
                      opacity: this._getOpacity(),
                      depth: this.depth,
                      cull: this.cullface,
                      pickFbo: this._needPickFrame && this._pickFbo,
                      pickPos: this._pickPos,
                      vP: this._animateLayerState,
                    });
                }
              }),
              (s.afterRender = function () {}),
              (s.PA = function () {
                return RenderHelper.SA(this.ll, this);
              }),
              i
            );
          })(Layer),
          pushArray$a = CommonUtil$1._C,
          HexagonLayer = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              (o = n.call(this, a)),
                (o.CLASS_NAME = "Hexagon"),
                (o.fusion = new GridsFusion()),
                (o.ll = new GridsRender());
              var l = hexagon$1.Sw;
              return (
                (o.zooms = a.zooms === void 0 ? l.zooms : a.zooms),
                (o.zIndex = a.zIndex === void 0 ? l.zIndex : a.zIndex),
                (o.opacity = a.opacity === void 0 ? l.opacity : a.opacity),
                (o.visible = a.visible === void 0 ? l.visible : a.visible),
                (o.shininess =
                  a.shininess === void 0 ? l.shininess : a.shininess),
                (o.acceptLight =
                  a.acceptLight === void 0 ? l.acceptLight : a.acceptLight),
                (o.cullface = a.cullface || l.cullface),
                (o.hasSide = a.hasSide === void 0 ? l.hasSide : a.hasSide),
                (o.depth = a.depth === void 0 ? l.depth : a.depth),
                o.AC({ zooms: o.zooms, visible: o.visible, zIndex: o.zIndex }),
                o.buryPoint.record(o.CLASS_NAME),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.receiveDataset = function (a) {
                (this.dataset = a),
                  this.setStyle(this.styleOptions),
                  this.onAdd();
              }),
              (s.setStyle = function (a) {
                if (
                  ((a.unit = a.unit || "meter"),
                  _get(_getPrototypeOf(i.prototype), "setStyle", this).call(
                    this,
                    a
                  ),
                  (this.dataset = this.source.LC()),
                  this.colorPick.clear(),
                  this.dataset && this.dataset.length > 0 && this.meshes)
                ) {
                  var o = this.WC(),
                    l = o.didFusionDataset,
                    u = this.fusion.fusion(
                      l,
                      this.styleOptions,
                      this,
                      "hexagon"
                    );
                  (this.meshes = u),
                    (this.vA.state |= MeshesDirty),
                    this.loca && this.loca.requestRender();
                }
              }),
              (s.getInitialAnimateState = function () {
                return {
                  altitude: {
                    time: [1, 0, 0, 0],
                    type: [-1, 1, 0, 0],
                    value: [0, 1],
                  },
                  height: {
                    time: [1, 0, 0, 0],
                    type: [-1, 1, 0, 0],
                    value: [0, 1],
                  },
                };
              }),
              (s.jC = function () {
                _get(_getPrototypeOf(i.prototype), "jC", this).call(this),
                  !(!this.loca || !this.loca.regl || this.ll.regl) &&
                    ((this.ll.regl = this.loca.regl),
                    this.loca.rendererManager.addRenderer(this.ll));
              }),
              (s.beforeRender = function () {
                if (
                  (_get(
                    _getPrototypeOf(i.prototype),
                    "beforeRender",
                    this
                  ).call(this),
                  !this.fusion.regl &&
                    this.loca &&
                    ((this.fusion.regl = this.loca.regl),
                    this.loca.fusionManager.addFusion(this.fusion)),
                  this.jC(),
                  this.source && (this.dataset = this.source.LC()),
                  this.fusion)
                ) {
                  var a = this.WC(),
                    o = a.willFusion;
                  if (o.length > 0) {
                    var l = this.fusion.fusion(
                      o,
                      this.styleOptions,
                      this,
                      "hexagon"
                    );
                    (this.meshes = pushArray$a(this.meshes, l)),
                      (this.vA.state |= MeshesDirty);
                  }
                }
              }),
              (s.render = function () {
                var a;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var o =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    l = RenderHelper.IA(this.loca.lights);
                  this.ll &&
                    this.meshes.length > 0 &&
                    this.ll.render({
                      meshes: this.meshes,
                      mvp: o,
                      lights: l,
                      cameraPosition:
                        this.loca.customCoords.getCameraParams().position,
                      shininess: this.shininess,
                      acceptLight: this.acceptLight,
                      opacity: this._getOpacity(),
                      depth: this.depth,
                      cull: this.cullface,
                      vP: this._animateLayerState,
                    });
                }
              }),
              (s.pickRender = function () {
                var a;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var o =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    l = RenderHelper.IA(this.loca.lights);
                  this.ll &&
                    this.ll.pickRender({
                      meshes: this.meshes,
                      mvp: o,
                      lights: l,
                      cameraPosition:
                        this.loca.customCoords.getCameraParams().position,
                      shininess: this.shininess,
                      acceptLight: this.acceptLight,
                      opacity: this._getOpacity(),
                      depth: this.depth,
                      cull: this.cullface,
                      pickFbo: this._needPickFrame && this._pickFbo,
                      pickPos: this._pickPos,
                      vP: this._animateLayerState,
                    });
                }
              }),
              (s.afterRender = function () {}),
              (s.PA = function () {
                return RenderHelper.SA(this.ll, this);
              }),
              i
            );
          })(Layer),
          __defProp$c = Object.defineProperty,
          __getOwnPropSymbols$c = Object.getOwnPropertySymbols,
          __hasOwnProp$c = Object.prototype.hasOwnProperty,
          __propIsEnum$c = Object.prototype.propertyIsEnumerable,
          __defNormalProp$c = function (r, n, i) {
            return n in r
              ? __defProp$c(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$c = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$c.call(n, i) && __defNormalProp$c(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$c)
              try {
                for (
                  var l = __getOwnPropSymbols$c(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$c.call(n, i) && __defNormalProp$c(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          pushArray$9 = CommonUtil$1._C,
          _PointFusion = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.buildStyle = function (a, o) {
                for (var l = point.style, u = [], f = 0; f < a.length; f++)
                  if (!(!a[f].features || !a[f].features.points)) {
                    var c = a[f].features.points,
                      h = StyleInstance.parse(c, o, l);
                    u.push(h);
                  }
                return u;
              }),
              (s.DC = function () {}),
              (s.fusion = function (a, o, l, u) {
                if (!this.regl || !l.loca) return [];
                u = u || this.buildStyle(a, o);
                for (
                  var f = l.loca.customCoords.lngLatToCoord.bind(
                      l.loca.customCoords
                    ),
                    c = [],
                    h = 0,
                    p = a.length;
                  h < p;
                  h++
                ) {
                  var d = a[h];
                  if (!(!d.features || !d.features.points || !u[h])) {
                    for (
                      var m = u[h].attributes,
                        g = d.features.points,
                        v = {
                          vertex: [],
                          color: [],
                          radius: [],
                          blurWidth: [],
                          borderColor: [],
                          borderWidth: [],
                          pickColor: [],
                          labels: [],
                        },
                        y = 0;
                      y < g.length;
                      y++
                    ) {
                      var _ = g[y],
                        b = _.coordinates,
                        S = l.colorPick.add(_);
                      if (_.type === "MultiPoint")
                        for (var P = 0, I = b.length; P < I; P++) {
                          var F = b[P],
                            X = f(F);
                          pushArray$9(v.vertex, [X[0], X[1], _.sr]),
                            pushArray$9(v.color, m.color[y]),
                            pushArray$9(v.borderColor, m.borderColor[y]),
                            pushArray$9(v.pickColor, S),
                            v.radius.push(m.radius[y]),
                            v.blurWidth.push(m.blurWidth[y]),
                            v.borderWidth.push(m.borderWidth[y]),
                            m.label[y] &&
                              v.labels.push(
                                __spreadValues$c({ position: F }, m.label[y])
                              );
                        }
                      else {
                        var W = f(b);
                        pushArray$9(v.vertex, [W[0], W[1], _.sr]),
                          pushArray$9(v.color, m.color[y]),
                          pushArray$9(v.borderColor, m.borderColor[y]),
                          pushArray$9(v.pickColor, S),
                          v.radius.push(m.radius[y]),
                          v.blurWidth.push(m.blurWidth[y]),
                          v.borderWidth.push(m.borderWidth[y]),
                          m.label[y] &&
                            v.labels.push(
                              __spreadValues$c({ position: b }, m.label[y])
                            );
                      }
                    }
                    c[h] = {
                      status: "buffered",
                      id: d.id,
                      attributes: {
                        position: {
                          buffer: this.regl.buffer(v.vertex),
                          offset: 0,
                          stride: 4 * 3,
                          td: !1,
                          divisor: 0,
                        },
                        radius: {
                          buffer: this.regl.buffer(v.radius),
                          offset: 0,
                          stride: 4 * 1,
                          td: !1,
                          divisor: 0,
                        },
                        color: {
                          buffer: this.regl.buffer(v.color),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        borderWidth: {
                          buffer: this.regl.buffer(v.borderWidth),
                          offset: 0,
                          stride: 4 * 1,
                          td: !1,
                          divisor: 0,
                        },
                        borderColor: {
                          buffer: this.regl.buffer(v.borderColor),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        blurWidth: {
                          buffer: this.regl.buffer(v.blurWidth),
                          offset: 0,
                          stride: 4 * 1,
                          td: !1,
                          divisor: 0,
                        },
                        pickColor: {
                          buffer: this.regl.buffer(v.pickColor),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                      },
                      uniforms: u[h].uniforms,
                      si: u[h].si,
                      mf: { count: v.radius.length, labels: v.labels },
                    };
                  }
                }
                return c;
              }),
              (s.EC = function () {
                return [];
              }),
              (s.destroy = function () {
                this.regl = null;
              }),
              (i.getInstance = function () {
                return this.ui;
              }),
              i
            );
          })(GeometryFusion),
          PointFusion = _PointFusion;
        (PointFusion.ui = new _PointFusion()), PointFusion.getInstance();
        var PointShader = {
            point: {
              vertex:
                "\n            precision highp float;\n\n            uniform mat4 mvp;\n            uniform float resolution;\n            // unit: px=0, meter=1\n            uniform float unit;\n            uniform float ratio;\n\n            attribute vec3 position;\n            attribute float radius;\n            attribute vec4 color;\n            attribute float borderWidth;\n            attribute vec4 borderColor;\n            attribute float blurWidth;\n\n            varying float vRadius;\n            varying vec4 vColor;\n            varying float vBorderWidth;\n            varying vec4 vBorderColor;\n            varying float vBlurRadius;\n            "
                  .concat(ColorGLSL.getColorShader().vertex, "\n            ")
                  .concat(RenderUtil.getBezier(), "\n            ")
                  .concat(
                    RenderUtil.getScaleType("radius"),
                    "\n\n            void main() {\n                float radiusScale = radiusScaleValue(position.z);\n                float res = (unit == 1.0 ? resolution : 1.0) / ratio;\n                gl_Position = mvp * vec4(position.xy, 0, 1);\n                vRadius = radius / res * radiusScale;\n                vColor = color;\n                vBorderWidth = borderWidth / res * radiusScale;\n                vBorderColor = borderColor;\n                vBlurRadius = blurWidth / res * radiusScale;\n                gl_PointSize = (vRadius + vBorderWidth) * 2.0 * radiusScale;\n                "
                  )
                  .concat(
                    ColorGLSL.getColorShader().mainVert,
                    "\n            }\n        "
                  ),
              fragment:
                "\n            precision highp float;\n            uniform float layerOpacity;\n            \n            varying float vRadius;\n            varying vec4 vColor;\n            varying float vBorderWidth;\n            varying vec4 vBorderColor;\n            varying float vBlurRadius;\n            "
                  .concat(
                    ColorGLSL.getColorShader().fragment,
                    "\n\n            void main() {\n                gl_FragColor = vColor;\n                // \u6297\u952F\u9F7F\u50CF\u7D20\u4F4D\n                float realRadius = vRadius + vBorderWidth;\n                float len = distance(gl_PointCoord, vec2(0.5, 0.5)) * 2.0 * realRadius;\n                float taaRadius = 2.0;\n                if(len > realRadius) {\n                    discard;\n                } else if(len > realRadius - taaRadius) {\n                    gl_FragColor = vBorderWidth > 0.0 ? vBorderColor : vColor;\n                    float opa = smoothstep(1.0, 0.0, (len - (realRadius - taaRadius)) / taaRadius);\n                    gl_FragColor.a *= opa;\n                } else if(vBorderWidth > 0.0 && len > vRadius + taaRadius) {\n                    gl_FragColor = vBorderColor;\n                } else if(vBorderWidth > 0.0 && len > vRadius) {\n                    float blend = smoothstep(0.0, 1.0, (len - vRadius / taaRadius) / taaRadius);\n                    gl_FragColor = mix(vColor, vBorderColor, blend);\n                }\n                // float opacity_t = 1. - smoothstep(u_range[1] - 1. / u_radius, u_range[1], offset);\n\n                if(vBlurRadius >= 0.0 && len > (realRadius - vBlurRadius)) {\n                    gl_FragColor.a = smoothstep(1.0, 0.0, (len - (realRadius - vBlurRadius)) / vBlurRadius);\n                }\n                // gl_FragColor.a *= layerOpacity;\n\n                "
                  )
                  .concat(
                    ColorGLSL.getColorShader().mainFrag,
                    "\n            }\n        "
                  ),
            },
            mx: {
              vertex:
                "\n            precision highp float;\n\n            attribute float position;\n            varying vec2 vUv;\n\n            struct UvPos {\n                vec2 uv;\n                vec2 pos;\n            };\n\n            // \u83B7\u53D6\u5750\u6807\n            UvPos getPos(float type) {\n                UvPos result;\n                vec2 uv = vec2(1);\n                vec2 pos = vec2(1);\n                if(type == 0.0) {\n                    uv = vec2(0, 0);\n                    pos = vec2(-1, -1);\n                } else if(type == 1.0) {\n                    uv = vec2(0, 1);\n                    pos = vec2(-1, 1);\n                } else if(type == 2.0) {\n                    uv = vec2(1, 0);\n                    pos = vec2(1, -1);\n                }\n                result.uv = uv;\n                result.pos = pos;\n                return result;\n            }\n\n            void main() {\n                UvPos res = getPos(position);\n                gl_Position = vec4(res.pos, 0, 1);\n                vUv = res.uv;\n            }\n        ",
              fragment:
                "\n            precision highp float;\n\n            varying vec2 vUv;\n\n            uniform float layerOpacity;\n            uniform sampler2D texture;\n\n            void main() {\n                gl_FragColor = texture2D(texture, vUv);\n                gl_FragColor.a *= layerOpacity;\n            }\n        ",
            },
          },
          __defProp$b = Object.defineProperty,
          __defProps$5 = Object.defineProperties,
          __getOwnPropDescs$5 = Object.getOwnPropertyDescriptors,
          __getOwnPropSymbols$b = Object.getOwnPropertySymbols,
          __hasOwnProp$b = Object.prototype.hasOwnProperty,
          __propIsEnum$b = Object.prototype.propertyIsEnumerable,
          __defNormalProp$b = function (r, n, i) {
            return n in r
              ? __defProp$b(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$b = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$b.call(n, i) && __defNormalProp$b(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$b)
              try {
                for (
                  var l = __getOwnPropSymbols$b(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$b.call(n, i) && __defNormalProp$b(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __spreadProps$5 = function (r, n) {
            return __defProps$5(r, __getOwnPropDescs$5(n));
          },
          PointRender = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              _classCallCheck(this, i);
              var a;
              return (
                (a = n.call.apply(
                  n,
                  [this].concat(Array.prototype.slice.call(arguments))
                )),
                (a.v$ = [new LabelsRender$1()]),
                a
              );
            }
            var s = i.prototype;
            return (
              (s.m$ = function (a) {
                if (!this.regl) return !1;
                this.v$.forEach(function (l) {
                  return l.m$(a);
                });
                var o = this.regl;
                (this.bx = o.framebuffer({
                  width: o._gl.drawingBufferWidth,
                  height: o._gl.drawingBufferHeight,
                  stencil: !1,
                  depth: !1,
                  Zh: !1,
                })),
                  this.gA(PointShader.point, a, {
                    attributes: __spreadValues$b(
                      {
                        position: o.prop("position"),
                        radius: o.prop("radius"),
                        color: o.prop("color"),
                        borderWidth: o.prop("borderWidth"),
                        borderColor: o.prop("borderColor"),
                        blurWidth: o.prop("blurWidth"),
                      },
                      ColorGLSL.getColor(o).attribute
                    ),
                    primitive: "points",
                    uniforms: __spreadValues$b(
                      __spreadValues$b(
                        {
                          mvp: o.prop("mvp"),
                          resolution: o.prop("resolution"),
                          unit: o.prop("unit"),
                          ratio: window.AMap.Browser.retina ? 2 : 1,
                        },
                        RenderUtil.getScaleUniform("radius", o)
                      ),
                      ColorGLSL.getColor(o).uniform
                    ),
                    depth: { enable: !1 },
                    blend: { enable: !0, func: o.prop("blend") },
                    count: o.prop("count"),
                  }),
                  this.gA(PointShader.mx, a, {
                    attributes: { position: [0, 1, 2, 3] },
                    uniforms: {
                      texture: o.prop("texture"),
                      layerOpacity: o.prop("layerOpacity"),
                    },
                    depth: { enable: !1 },
                    blend: { enable: !0, func: o.prop("blend") },
                    elements: [0, 1, 2, 1, 3, 2],
                    count: 6,
                  });
              }),
              (s.render = function (a) {
                var o = this,
                  l = function (X) {
                    var W = o,
                      Z = c[X],
                      j = Z.attributes,
                      L = Z.uniforms,
                      T = Z.mf,
                      A = T.count;
                    o.bx.use(function () {
                      W.regl.clear({ color: [0, 0, 0, 0], depth: 1 }),
                        u(
                          __spreadValues$b(
                            __spreadProps$5(__spreadValues$b({}, j), {
                              unit: L.unit === "px" ? 0 : 1,
                              count: A,
                              resolution: m,
                              layerOpacity: p,
                              mvp: h,
                              blend: RenderUtil.getBlend(d),
                              isPick: !1,
                            }),
                            RenderUtil.getScaleProps(g)
                          )
                        );
                    }),
                      f(
                        __spreadProps$5(__spreadValues$b({}, j), {
                          texture: o.bx,
                          layerOpacity: p,
                          blend: RenderUtil.getBlend("normal"),
                        })
                      );
                  },
                  u = this.yA(PointShader.point),
                  f = this.yA(PointShader.mx);
                if (!(!u || !f)) {
                  var c = a.meshes,
                    h = a.mvp,
                    p = a.opacity,
                    d = a.blend,
                    m = a.resolution,
                    g = a.vP;
                  if (!(c.length < 1)) {
                    (this.bx.width !== this.regl._gl.drawingBufferWidth ||
                      this.bx.height !== this.regl._gl.drawingBufferHeight) &&
                      this.bx({
                        width: this.regl._gl.drawingBufferWidth,
                        height: this.regl._gl.drawingBufferHeight,
                      });
                    for (var v = 0; v < c.length; v++) l(v);
                    for (var y = 0; y < c.length; y++) {
                      var _ = !0,
                        b = !1,
                        S = void 0;
                      try {
                        for (
                          var P = this.v$[Symbol.iterator](), I;
                          !(_ = (I = P.next()).done);
                          _ = !0
                        ) {
                          var F = I.value;
                          F.render(c[y]);
                        }
                      } catch (X) {
                        (b = !0), (S = X);
                      } finally {
                        try {
                          !_ && P.return != null && P.return();
                        } finally {
                          if (b) throw S;
                        }
                      }
                    }
                  }
                }
              }),
              (s.pickRender = function (a) {
                var o = this.yA(PointShader.point),
                  l = this.yA(PointShader.mx);
                if (!(!o || !l)) {
                  var u = a.meshes,
                    f = a.mvp,
                    c = a.opacity,
                    h = a.resolution,
                    p = a.pickFbo,
                    d = a.pickPos,
                    m = a.vP;
                  if (!(u.length < 1) && (this.regl._refresh(), p && d)) {
                    var g = this;
                    p.use(function () {
                      g.regl.clear({ color: [0, 0, 0, 0] });
                      for (var v = 0; v < u.length; v++) {
                        var y = u[v],
                          _ = y.attributes,
                          b = y.uniforms,
                          S = y.mf,
                          P = S.count;
                        o(
                          __spreadValues$b(
                            __spreadProps$5(__spreadValues$b({}, _), {
                              unit: b.unit === "px" ? 0 : 1,
                              count: P,
                              resolution: h,
                              layerOpacity: c,
                              mvp: f,
                              blend: RenderUtil.getBlend("normal"),
                              isPick: !0,
                            }),
                            RenderUtil.getScaleProps(m)
                          )
                        );
                      }
                    });
                  }
                }
              }),
              (s.destroy = function () {
                _get(_getPrototypeOf(i.prototype), "destroy", this).call(this),
                  this.bx.destroy();
              }),
              i
            );
          })(Render),
          pushArray$8 = CommonUtil$1._C,
          PointLayer = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              (o = n.call(this, a)),
                (o.CLASS_NAME = "Point"),
                (o.fusion = new PointFusion()),
                (o.ll = new PointRender());
              var l = point.Sw;
              return (
                (o.zooms = a.zooms === void 0 ? l.zooms : a.zooms),
                (o.visible = a.visible === void 0 ? l.visible : a.visible),
                (o.zIndex = a.zIndex === void 0 ? l.zIndex : a.zIndex),
                (o.opacity = a.opacity === void 0 ? l.opacity : a.opacity),
                (o.blend = a.blend === void 0 ? l.blend : a.blend),
                o.AC({ zooms: o.zooms, visible: o.visible, zIndex: o.zIndex }),
                o.buryPoint.record(o.CLASS_NAME),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.setStyle = function (a) {
                if (
                  (_get(_getPrototypeOf(i.prototype), "setStyle", this).call(
                    this,
                    a
                  ),
                  (this.dataset = this.source.LC()),
                  this.colorPick.clear(),
                  this.dataset && this.dataset.length > 0)
                ) {
                  var o = this.WC(),
                    l = o.didFusionDataset,
                    u = this.fusion.fusion(l, this.styleOptions, this);
                  (this.meshes = u),
                    (this.vA.state |= MeshesDirty),
                    this.loca && this.loca.requestRender();
                }
              }),
              (s.getInitialAnimateState = function () {
                return {
                  radius: {
                    time: [1, 0, 0, 0],
                    type: [-1, 1, 0, 0],
                    value: [0, 1],
                  },
                };
              }),
              (s.receiveDataset = function (a) {
                (this.dataset = a),
                  this.setStyle(this.styleOptions),
                  this.onAdd();
              }),
              (s.jC = function () {
                _get(_getPrototypeOf(i.prototype), "jC", this).call(this),
                  !(!this.loca || !this.loca.regl || this.ll.regl) &&
                    ((this.ll.regl = this.loca.regl),
                    this.loca.rendererManager.addRenderer(this.ll));
              }),
              (s.beforeRender = function () {
                if (
                  (_get(
                    _getPrototypeOf(i.prototype),
                    "beforeRender",
                    this
                  ).call(this),
                  !this.fusion.regl &&
                    this.loca &&
                    ((this.fusion.regl = this.loca.regl),
                    this.loca.fusionManager.addFusion(this.fusion)),
                  this.jC(),
                  this.source && (this.dataset = this.source.LC()),
                  this.fusion)
                ) {
                  var a = this.WC(),
                    o = a.willFusion;
                  if (o.length > 0) {
                    var l = this.fusion.fusion(o, this.styleOptions, this);
                    (this.meshes = pushArray$8(this.meshes, l)),
                      (this.vA.state |= MeshesDirty);
                  }
                }
              }),
              (s.render = function () {
                var a, o;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var l =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    u = this.projection.getResolution(
                      (o = this.loca) == null ? void 0 : o.map.getZoom()
                    );
                  this.ll &&
                    this.meshes.length &&
                    this.ll.render({
                      meshes: this.meshes,
                      mvp: l,
                      resolution: u,
                      opacity: this._getOpacity(),
                      blend: this.blend,
                      vP: this._animateLayerState,
                    });
                }
              }),
              (s.pickRender = function () {
                var a, o;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var l = this.projection.getResolution(
                      (a = this.loca) == null ? void 0 : a.map.getZoom()
                    ),
                    u =
                      (o = this.loca) == null
                        ? void 0
                        : o.customCoords.getMVPMatrix();
                  this.ll &&
                    this.meshes.length > 0 &&
                    this.ll.pickRender({
                      meshes: this.meshes,
                      resolution: l,
                      opacity: this._getOpacity(),
                      pickFbo: this._needPickFrame && this._pickFbo,
                      pickPos: this._pickPos,
                      mvp: u,
                      vP: this._animateLayerState,
                    });
                }
              }),
              (s.afterRender = function () {}),
              (s.destroy = function () {
                _get(_getPrototypeOf(i.prototype), "destroy", this).call(this);
              }),
              (s.PA = function () {
                return RenderHelper.SA(this.ll, this);
              }),
              i
            );
          })(Layer),
          __defProp$a = Object.defineProperty,
          __getOwnPropSymbols$a = Object.getOwnPropertySymbols,
          __hasOwnProp$a = Object.prototype.hasOwnProperty,
          __propIsEnum$a = Object.prototype.propertyIsEnumerable,
          __defNormalProp$a = function (r, n, i) {
            return n in r
              ? __defProp$a(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$a = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$a.call(n, i) && __defNormalProp$a(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$a)
              try {
                for (
                  var l = __getOwnPropSymbols$a(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$a.call(n, i) && __defNormalProp$a(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          pushArray$7 = CommonUtil$1._C,
          _IconFusion = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              _classCallCheck(this, i);
              var a;
              return (
                (a = n.call.apply(
                  n,
                  [this].concat(Array.prototype.slice.call(arguments))
                )),
                (a.kx = {}),
                a
              );
            }
            var s = i.prototype;
            return (
              (s.buildStyle = function (a, o) {
                for (var l, u = icon.style, f = [], c = 0; c < a.length; c++)
                  if (!(!a[c].features || !a[c].features.points)) {
                    for (
                      var h = a[c].features.points,
                        p = StyleInstance.parse(h, o, u),
                        d = {},
                        m = 0;
                      m < h.length;
                      m++
                    )
                      if (p)
                        for (var g in p.attributes) {
                          var v = p.attributes[g];
                          d[g] || (d[g] = []),
                            typeof v[m] == "string"
                              ? pushArray$7(d[g], [v[m]])
                              : ((l = v[m]) == null ? void 0 : l.length) > 0
                              ? pushArray$7(d[g], v[m])
                              : (d[g][d[g].length] = v[m]);
                        }
                    f.push({ attributes: d, uniforms: p.uniforms, si: p.si });
                  }
                return f;
              }),
              (s.DC = function () {}),
              (s.fusion = function (a, o, l, u) {
                return !this.regl || !l.loca
                  ? []
                  : ((u = u || this.buildStyle(a, o)),
                    o && a && a.length
                      ? this.Cx({ dataset: a, styleOptions: o, Sw: l, Ax: u })
                      : []);
              }),
              (s.Ox = function (a, o) {
                var l = o.zx(),
                  u = l._x,
                  f = l.Sx,
                  c = null,
                  h = a;
                if (f.has(h)) c = f.get(h);
                else {
                  if (_instanceof(a, SVGSVGElement)) {
                    var p = new XMLSerializer();
                    h = p.serializeToString(a);
                  } else
                    _instanceof(a, Image)
                      ? (h = a.src)
                      : typeof a == "string" && (h = a);
                  f.has(h)
                    ? (c = f.get(h))
                    : (u.push(a), (c = u.length - 1), f.set(h, c));
                }
                return c;
              }),
              (s.Cx = function (a) {
                for (
                  var o = a.dataset,
                    l = a.Ax,
                    u = a.Sw,
                    f = this,
                    c,
                    h = [],
                    p =
                      (c = u == null ? void 0 : u.loca) == null
                        ? void 0
                        : c.customCoords,
                    d = function (W) {
                      var Z = W.mesh,
                        j = W.style,
                        L = W.lnglat,
                        T = W.pickColor,
                        A = W.id,
                        $ = p.lngLatToCoord(L);
                      pushArray$7(Z.position, [$[0], $[1], A]),
                        pushArray$7(Z.iconSize, j.iconSize),
                        pushArray$7(Z.offset, j.offset);
                      var R = (j.rotation / 180) * Math.PI;
                      pushArray$7(Z.rotation, [R]),
                        pushArray$7(Z.opacity, [j.opacity]);
                      var M = f.Ox(j.icon, u);
                      pushArray$7(Z.iconIndex, [M]),
                        pushArray$7(Z.pickColor, T),
                        j.label &&
                          Z.labels.push(
                            __spreadValues$a({ position: L }, j.label)
                          );
                    },
                    m = 0;
                  m < o.length;
                  m++
                ) {
                  var g = o[m];
                  if (!(!g.features || !g.features.points)) {
                    for (
                      var v = g.features.points,
                        y = l[m],
                        _ = {
                          position: [],
                          iconIndex: [],
                          iconSize: [],
                          offset: [],
                          rotation: [],
                          opacity: [],
                          pickColor: [],
                          labels: [],
                        },
                        b = 0;
                      b < v.length;
                      b++
                    ) {
                      var S = v[b],
                        P = S == null ? void 0 : S.coordinates,
                        I = u.colorPick.add(S),
                        F = {
                          icon: y.attributes.icon[b],
                          iconSize: y.attributes.iconSize.slice(
                            b * 2,
                            b * 2 + 2
                          ),
                          rotation: y.attributes.rotation[b],
                          opacity: y.attributes.opacity[b],
                          offset: y.attributes.offset.slice(b * 2, b * 2 + 2),
                          label: y.attributes.label[b],
                        };
                      if (P && P.length)
                        if (S.type == "MultiPoint")
                          for (var X = 0; X < P.length; X++)
                            d({
                              mesh: _,
                              style: F,
                              lnglat: P[X],
                              pickColor: I,
                              id: S.sr,
                            });
                        else
                          d({
                            mesh: _,
                            style: F,
                            lnglat: P,
                            pickColor: I,
                            id: S.sr,
                          });
                    }
                    h[m] = {
                      id: g.id,
                      attributes: {
                        position: {
                          buffer: this.regl.buffer(_.position),
                          offset: 0,
                          stride: 4 * 3,
                          td: !1,
                          divisor: 0,
                        },
                        iconIndex: {
                          buffer: this.regl.buffer(_.iconIndex),
                          offset: 0,
                          stride: 4 * 1,
                          td: !1,
                          divisor: 0,
                        },
                        iconSize: {
                          buffer: this.regl.buffer(_.iconSize),
                          offset: 0,
                          stride: 4 * 2,
                          td: !1,
                          divisor: 0,
                        },
                        offset: {
                          buffer: this.regl.buffer(_.offset),
                          offset: 0,
                          stride: 4 * 2,
                          td: !1,
                          divisor: 0,
                        },
                        rotation: {
                          buffer: this.regl.buffer(_.rotation),
                          offset: 0,
                          stride: 4 * 1,
                          td: !1,
                          divisor: 0,
                        },
                        opacity: {
                          buffer: this.regl.buffer(_.opacity),
                          offset: 0,
                          stride: 4 * 1,
                          td: !1,
                          divisor: 0,
                        },
                        pickColor: {
                          buffer: this.regl.buffer(_.pickColor),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                      },
                      uniforms: y.uniforms,
                      si: y.si,
                      mf: { count: _.position.length / 3, labels: _.labels },
                    };
                  }
                }
                return h;
              }),
              (s.EC = function () {
                return [];
              }),
              (s.destroy = function () {
                this.regl = null;
              }),
              (i.getInstance = function () {
                return this.ui;
              }),
              i
            );
          })(GeometryFusion),
          IconFusion = _IconFusion;
        (IconFusion.ui = new _IconFusion()), IconFusion.getInstance();
        var IconShader = {
            vertex:
              "\n        precision highp float;\n\n        uniform mat4 mvp;\n        uniform float iconCount;\n        uniform float resolution;\n        // unit: px=0, meter=1\n        uniform float unit;\n        uniform float ratio;\n\n        attribute vec3 position;\n        attribute vec2 iconSize;\n        attribute vec2 offset;\n        attribute float rotation;\n        attribute float opacity;\n        attribute float iconIndex;\n\n        varying vec2 v_size;\n        varying float v_rotation;\n        varying float v_opacity;\n        varying vec2 v_texture_coord;\n        "
                .concat(ColorGLSL.getColorShader().vertex, "\n        ")
                .concat(RenderUtil.getBezier(), "\n        ")
                .concat(RenderUtil.getScaleType("iconSize"), "\n        ")
                .concat(
                  RenderUtil.getScaleType("offset"),
                  "\n\n        void main() {\n            float res = unit == 1.0 ? 1.0 : resolution;\n\n            gl_Position = mvp * vec4(position.xy + offset * res * offsetScaleValue(position.z), 0, 1);\n            v_texture_coord = vec2(1.0 / iconCount * iconIndex, 0.0);\n\n            // \u8BA1\u7B97 xy \u7684\u76F8\u5BF9\u503C\n            res = unit == 1.0 ? resolution : 1.0;\n            v_size = iconSize.xy / res * ratio * iconSizeScaleValue(position.z);\n            float dist = sqrt(v_size.x * v_size.x + v_size.y * v_size.y);\n            // v_size.x = v_size.x / dist * v_size.x;\n            // v_size.y = v_size.y / dist * v_size.y;\n\n            v_rotation = rotation;\n            v_opacity = opacity;\n            gl_PointSize = dist;\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainVert,
                  "\n        }\n    "
                ),
            fragment:
              "\n        precision highp float;\n        uniform sampler2D texture;\n        // uniform float resolution;\n        uniform float layerOpacity;\n        uniform float iconCount;\n\n        varying vec2 v_size;\n        varying float v_rotation;\n        varying float v_opacity;\n        varying vec2 v_texture_coord;\n        "
                .concat(
                  ColorGLSL.getColorShader().fragment,
                  "\n\n        vec2 rotateUV(vec2 uv, float arc, vec2 mid){\n            mat2 rotn =  mat2(cos(arc), sin(arc),\n                             -sin(arc), cos(arc));\n            return rotn * (uv - mid) + mid;\n        }\n\n        void main() {\n            vec2 txture_partial_size = vec2(1.0 / iconCount, 1);\n            gl_FragColor = vec4(0,0,0,1.0);\n\n            float maxSize = sqrt(v_size.x * v_size.x + v_size.y * v_size.y);\n\n            // \u65CB\u8F6C\uFF1A\u65CB\u8F6C\u5FC5\u987B\u5728\u653E\u7F29\u4E4B\u524D\n            vec2 uv = rotateUV(gl_PointCoord.xy, -v_rotation, vec2(0.5,0.5));\n\n            // \u653E\u7F29\uFF1A\u5750\u6807\u7A7A\u95F4\u653E\u5927\uFF0C\u4F7F\u539F\u672C\u7684[0, 1]\u53D8\u4E3A[0, 1*scale]\n            uv = vec2(\n                uv.x / v_size.x * maxSize,\n                uv.y / v_size.y * maxSize\n            );\n\n            // \u4FEE\u6B63\uFF1A\u4F7F[0, 1*scale]\u53D8\u4E3A[-1*scale/2, 0) [0, 1] (1, 1*scale/2]\u7684\u90E8\u5206\u6765\u753B\u56FE\u5F62\uFF0C\u4E24\u4FA7\u5176\u4F59\u90E8\u5206\u753B\u7A7A\u767D\n            uv = vec2(\n                uv.x - ((maxSize/v_size.x - 1.0) / 2.0),\n                uv.y - ((maxSize/v_size.y - 1.0) / 2.0)\n            );\n\n            float flag1 = step(float(uv.x), 0.0);\n            float flag2 = step(1.0, float(uv.x));\n            float flag3 = step(1.0, float(uv.y));\n            float flag4 = step(float(uv.y), 0.0);\n            float invalid = flag1 + flag2 + flag3 + flag4;\n            vec2 _uv = txture_partial_size * uv;\n            vec2 coord = v_texture_coord + _uv;\n            vec4 t_clr = texture2D(texture, coord);\n            gl_FragColor = (1.0 - invalid) * t_clr;\n            gl_FragColor.a *= v_opacity * layerOpacity;\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainFrag,
                  "\n        }\n    "
                ),
          },
          __defProp$9 = Object.defineProperty,
          __defProps$4 = Object.defineProperties,
          __getOwnPropDescs$4 = Object.getOwnPropertyDescriptors,
          __getOwnPropSymbols$9 = Object.getOwnPropertySymbols,
          __hasOwnProp$9 = Object.prototype.hasOwnProperty,
          __propIsEnum$9 = Object.prototype.propertyIsEnumerable,
          __defNormalProp$9 = function (r, n, i) {
            return n in r
              ? __defProp$9(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$9 = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$9.call(n, i) && __defNormalProp$9(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$9)
              try {
                for (
                  var l = __getOwnPropSymbols$9(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$9.call(n, i) && __defNormalProp$9(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __spreadProps$4 = function (r, n) {
            return __defProps$4(r, __getOwnPropDescs$4(n));
          },
          IconRender = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              _classCallCheck(this, i);
              var a;
              return (
                (a = n.call.apply(
                  n,
                  [this].concat(Array.prototype.slice.call(arguments))
                )),
                (a.v$ = [new LabelsRender$1()]),
                a
              );
            }
            var s = i.prototype;
            return (
              (s.m$ = function (a) {
                if (!this.regl) return !1;
                this.v$.forEach(function (l) {
                  return l.m$(a);
                });
                var o = this.regl;
                this.gA(IconShader, a, {
                  attributes: __spreadValues$9(
                    {
                      position: o.prop("position"),
                      iconIndex: o.prop("iconIndex"),
                      iconSize: o.prop("iconSize"),
                      offset: o.prop("offset"),
                      rotation: o.prop("rotation"),
                      opacity: o.prop("opacity"),
                    },
                    ColorGLSL.getColor(o).attribute
                  ),
                  uniforms: __spreadValues$9(
                    __spreadValues$9(
                      __spreadValues$9(
                        {
                          mvp: o.prop("mvp"),
                          resolution: o.prop("resolution"),
                          texture: o.prop("texture"),
                          iconCount: o.prop("iconCount"),
                          layerOpacity: o.prop("layerOpacity"),
                          unit: o.prop("unit"),
                          ratio: window.AMap.Browser.retina ? 2 : 1,
                        },
                        ColorGLSL.getColor(o).uniform
                      ),
                      RenderUtil.getScaleUniform("iconSize", o)
                    ),
                    RenderUtil.getScaleUniform("offset", o)
                  ),
                  depth: { enable: !1 },
                  blend: { enable: !0, func: RenderUtil.getBlend("normal") },
                  count: o.prop("count"),
                  primitive: "points",
                });
              }),
              (s.render = function (a) {
                var o = this.yA(IconShader);
                if (o) {
                  var l = a.meshes,
                    u = a.mvp,
                    f = a.opacity,
                    c = a.resolution,
                    h = a.texture,
                    p = a.iconCount,
                    d = a.vP;
                  if (!(l.length < 1)) {
                    for (var m = 0; m < l.length; m++) {
                      var g = l[m],
                        v = g.attributes,
                        y = g.uniforms,
                        _ = g.mf,
                        b = _.count;
                      o(
                        __spreadValues$9(
                          __spreadProps$4(
                            __spreadValues$9(__spreadValues$9({}, v), y),
                            {
                              unit: y.unit === "px" ? 0 : 1,
                              count: b,
                              resolution: c,
                              layerOpacity: f,
                              iconCount: p,
                              texture: h,
                              mvp: u,
                              isPick: !1,
                            }
                          ),
                          RenderUtil.getScaleProps(d)
                        )
                      );
                    }
                    for (var S = 0; S < l.length; S++) {
                      var P = !0,
                        I = !1,
                        F = void 0;
                      try {
                        for (
                          var X = this.v$[Symbol.iterator](), W;
                          !(P = (W = X.next()).done);
                          P = !0
                        ) {
                          var Z = W.value;
                          Z.render(l[S]);
                        }
                      } catch (j) {
                        (I = !0), (F = j);
                      } finally {
                        try {
                          !P && X.return != null && X.return();
                        } finally {
                          if (I) throw F;
                        }
                      }
                    }
                  }
                }
              }),
              (s.pickRender = function (a) {
                var o = this.yA(IconShader);
                if (o) {
                  var l = a.meshes,
                    u = a.mvp,
                    f = a.opacity,
                    c = a.resolution,
                    h = a.texture,
                    p = a.iconCount,
                    d = a.pickFbo,
                    m = a.pickPos,
                    g = a.vP;
                  if (!(l.length < 1) && d && m) {
                    var v = this;
                    d.use(function () {
                      v.regl.clear({ color: [0, 0, 0, 0], depth: 1 });
                      for (var y = 0; y < l.length; y++) {
                        var _ = l[y],
                          b = _.attributes,
                          S = _.uniforms,
                          P = _.mf,
                          I = P.count,
                          F = S.unit === "px" ? 0 : 1;
                        o(
                          __spreadValues$9(
                            __spreadProps$4(
                              __spreadValues$9(__spreadValues$9({}, b), S),
                              {
                                unit: F,
                                count: I,
                                resolution: c,
                                layerOpacity: f,
                                iconCount: p,
                                texture: h,
                                mvp: u,
                                isPick: !0,
                              }
                            ),
                            RenderUtil.getScaleProps(g)
                          )
                        );
                      }
                    });
                  }
                }
              }),
              i
            );
          })(Render),
          IconLayer = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              (o = n.call(this, a)),
                (o.CLASS_NAME = "Icon"),
                (o.fusion = new IconFusion()),
                (o.ll = new IconRender()),
                (o.Tx = !1),
                (o.jx = []),
                (o.Bx = 0),
                (o.Dx = new Map());
              var l = icon.Sw;
              return (
                (o.zooms = a.zooms === void 0 ? l.zooms : a.zooms),
                (o.visible = a.visible === void 0 ? l.visible : a.visible),
                (o.zIndex = a.zIndex === void 0 ? l.zIndex : a.zIndex),
                (o.opacity = a.opacity === void 0 ? l.opacity : a.opacity),
                o.AC({ zooms: o.zooms, visible: o.visible, zIndex: o.zIndex }),
                o.buryPoint.record(o.CLASS_NAME),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.setStyle = function (a) {
                if (
                  (_get(_getPrototypeOf(i.prototype), "setStyle", this).call(
                    this,
                    a
                  ),
                  (this.dataset = this.source.LC()),
                  this.colorPick.clear(),
                  (this.Ex = null),
                  (this.jx = []),
                  this.Dx.clear(),
                  this.dataset && this.dataset.length > 0)
                ) {
                  this.Vx = this.meshes;
                  var o = this.WC(),
                    l = o.didFusionDataset,
                    u = this.fusion.fusion(l, this.styleOptions, this);
                  this.meshes = u;
                  for (var f = 0; f < this.meshes.length; f++)
                    this.Vx[f].mf = this.meshes[f].mf;
                  (this.vA.state |= MeshesDirty),
                    this.loca && this.loca.requestRender();
                }
              }),
              (s.getInitialAnimateState = function () {
                return {
                  iconSize: {
                    time: [1, 0, 0, 0],
                    type: [-1, 1, 0, 0],
                    value: [0, 1],
                  },
                  offset: {
                    time: [1, 0, 0, 0],
                    type: [-1, 1, 0, 0],
                    value: [0, 1],
                  },
                };
              }),
              (s.receiveDataset = function (a) {
                (this.dataset = a),
                  this.setStyle(this.styleOptions),
                  this.onAdd();
              }),
              (s.jC = function () {
                _get(_getPrototypeOf(i.prototype), "jC", this).call(this),
                  !(!this.loca || !this.loca.regl || this.ll.regl) &&
                    ((this.ll.regl = this.loca.regl),
                    this.loca.rendererManager.addRenderer(this.ll));
              }),
              (s.beforeRender = function () {
                if (
                  (_get(
                    _getPrototypeOf(i.prototype),
                    "beforeRender",
                    this
                  ).call(this),
                  !this.fusion.regl &&
                    this.loca &&
                    ((this.fusion.regl = this.loca.regl),
                    this.loca.fusionManager.addFusion(this.fusion)),
                  this.jC(),
                  this.source && (this.dataset = this.source.LC()),
                  this.fusion)
                ) {
                  var a = this.WC(),
                    o = a.willFusion;
                  if (o.length > 0) {
                    var l = this.fusion.fusion(o, this.styleOptions, this);
                    (this.meshes = l), (this.vA.state |= MeshesDirty);
                  }
                }
              }),
              (s.render = function () {
                var a, o;
                if (!!this.loca && !!this.PA()) {
                  if ((this.loca.regl._refresh(), this.Kf)) {
                    var l =
                        (a = this.loca) == null
                          ? void 0
                          : a.customCoords.getMVPMatrix(),
                      u = this.projection.getResolution(
                        (o = this.loca) == null ? void 0 : o.map.getZoom()
                      ),
                      f = this.Ex ? this.meshes : this.Vx;
                    this.ll &&
                      f.length > 0 &&
                      this.ll.render({
                        texture: this.Kf,
                        iconCount: this.Bx,
                        meshes: f,
                        mvp: l,
                        resolution: u,
                        opacity: this._getOpacity(),
                        vP: this._animateLayerState,
                      });
                  }
                  if (!this.Ex) {
                    var c = this.jx;
                    if (c && c.length && !this.Tx) {
                      var h = this;
                      (this.Tx = !0),
                        mergeImages(
                          {
                            images: _toConsumableArray(c).concat(
                              _toConsumableArray(c),
                              _toConsumableArray(c)
                            ),
                            wx: [256, 256],
                          },
                          function (p) {
                            var d, m;
                            (h.Tx = !1),
                              p &&
                                ((h.Ex = p.xx),
                                p.xx &&
                                  (h.Kf && h.Kf.destroy(),
                                  (h.Kf =
                                    (d = h == null ? void 0 : h.loca) == null
                                      ? void 0
                                      : d.regl.texture({
                                          format: "rgba",
                                          width: h.Ex.width,
                                          Rx: h.Ex.height,
                                          data: h.Ex,
                                        })),
                                  (h.Bx = c.length),
                                  (m = h.loca) == null || m.requestRender()));
                          },
                          function (p) {
                            console.log("mergeImage error", p);
                          }
                        );
                    }
                  }
                }
              }),
              (s.pickRender = function () {
                var a, o;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var l =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    u = this.projection.getResolution(
                      (o = this.loca) == null ? void 0 : o.map.getZoom()
                    );
                  this.ll &&
                    this.Kf &&
                    this.ll.pickRender({
                      texture: this.Kf,
                      iconCount: this.jx.length,
                      meshes: this.meshes,
                      mvp: l,
                      resolution: u,
                      opacity: this._getOpacity(),
                      pickFbo: this._needPickFrame && this._pickFbo,
                      pickPos: this._pickPos,
                      vP: this._animateLayerState,
                    });
                }
              }),
              (s.destroy = function () {
                _get(_getPrototypeOf(i.prototype), "destroy", this).call(this),
                  (this.Ex = null),
                  (this.Kf = null);
              }),
              (s.afterRender = function () {}),
              (s.zx = function () {
                return { Sx: this.Dx, _x: this.jx };
              }),
              (s.PA = function () {
                return RenderHelper.SA(this.ll, this);
              }),
              i
            );
          })(Layer),
          __defProp$8 = Object.defineProperty,
          __getOwnPropSymbols$8 = Object.getOwnPropertySymbols,
          __hasOwnProp$8 = Object.prototype.hasOwnProperty,
          __propIsEnum$8 = Object.prototype.propertyIsEnumerable,
          __defNormalProp$8 = function (r, n, i) {
            return n in r
              ? __defProp$8(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$8 = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$8.call(n, i) && __defNormalProp$8(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$8)
              try {
                for (
                  var l = __getOwnPropSymbols$8(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$8.call(n, i) && __defNormalProp$8(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          pushArray$6 = CommonUtil$1._C,
          _PrismFusion = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.DC = function () {}),
              (s.buildStyle = function (a, o) {
                for (var l, u = prism.style, f = [], c = 0; c < a.length; c++)
                  if (!(!a[c].features || !a[c].features.points)) {
                    for (
                      var h = a[c].features.points,
                        p = StyleInstance.parse(h, o, u),
                        d = {},
                        m = 0;
                      m < h.length;
                      m++
                    )
                      if (p)
                        for (var g in p.attributes) {
                          var v = p.attributes[g];
                          d[g] || (d[g] = []),
                            ((l = v[m]) == null ? void 0 : l.length) > 0
                              ? pushArray$6(d[g], v[m])
                              : (d[g][d[g].length] = v[m]);
                        }
                    f.push({ attributes: d, uniforms: p.uniforms, si: p.si });
                  }
                return f;
              }),
              (s.fusion = function (a, o, l, u) {
                if (!l.loca || !l.loca.regl) return [];
                var f = l.loca.regl,
                  c = l.loca.customCoords,
                  h = [];
                u = u || this.buildStyle(a, o);
                for (var p = 0; p < a.length; p++) {
                  var d = a[p];
                  if (!(!d.features || !d.features.points || !u[p])) {
                    for (
                      var m = d.features.points,
                        g = u[p],
                        v = {
                          index: [],
                          vertex: [],
                          radius: [],
                          sideNo: [],
                          id: [],
                          color: [],
                          rotation: [],
                          pickColor: [],
                          labels: [],
                        },
                        y = g.attributes,
                        _ = y.altitude,
                        b = y.height,
                        S = y.radius,
                        P = y.rotation,
                        I = y.topColor,
                        F = y.sideTopColor,
                        X = y.sideBottomColor,
                        W = y.label,
                        Z = g.uniforms,
                        j = Z.sideNumber,
                        L = 0;
                      L < m.length;
                      L++
                    ) {
                      var T = m[L],
                        A = L * 4,
                        $ = l.colorPick.add(T),
                        R = T.coordinates;
                      if (T.type === "MultiPoint")
                        for (var M = 0, w = R.length; M < w; M++) {
                          var O = R[M],
                            E = this.Fx({
                              vertex: [O[0], O[1], O[2] || _[L]],
                              Lx: c,
                              height: b[L],
                              pickColor: $,
                              Wx: j,
                              topColor: I.slice(A, A + 4),
                              sideTopColor: F.slice(A, A + 4),
                              sideBottomColor: X.slice(A, A + 4),
                              radius: S[L],
                              rotation: P[L],
                              hasSide: l.hasSide,
                              id: T.sr,
                            });
                          GeoUtil.mergeTriangles(v, E, 4),
                            pushArray$6(v.color, E.Gh),
                            pushArray$6(v.sideNo, E.Nx),
                            pushArray$6(v.radius, E.radius),
                            pushArray$6(v.id, E.id),
                            pushArray$6(v.rotation, E.Ux),
                            pushArray$6(v.pickColor, E.Qw),
                            W[L] &&
                              v.labels.push(
                                __spreadValues$8(
                                  {
                                    position: [
                                      O[0],
                                      O[1],
                                      (O[2] || _[L]) + b + 100,
                                    ],
                                  },
                                  W[L]
                                )
                              );
                        }
                      else {
                        var k = this.Fx({
                          vertex: [R[0], R[1], R[2] || _[L]],
                          Lx: c,
                          height: b[L],
                          pickColor: $,
                          Wx: j,
                          topColor: I.slice(A, A + 4),
                          sideTopColor: F.slice(A, A + 4),
                          sideBottomColor: X.slice(A, A + 4),
                          radius: S[L],
                          rotation: P[L],
                          hasSide: l.hasSide,
                          id: T.sr,
                        });
                        GeoUtil.mergeTriangles(v, k, 4),
                          pushArray$6(v.color, k.Gh),
                          pushArray$6(v.sideNo, k.Nx),
                          pushArray$6(v.radius, k.radius),
                          pushArray$6(v.id, k.id),
                          pushArray$6(v.rotation, k.Ux),
                          pushArray$6(v.pickColor, k.Qw),
                          W[L] &&
                            v.labels.push(
                              __spreadValues$8(
                                {
                                  position: [
                                    R[0],
                                    R[1],
                                    (R[2] || _[L]) + b[L] + 100,
                                  ],
                                },
                                W[L]
                              )
                            );
                      }
                    }
                    h[p] = {
                      id: d.id,
                      attributes: {
                        position: {
                          buffer: f.buffer(v.vertex),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        color: {
                          buffer: f.buffer(v.color),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        sideNo: {
                          buffer: f.buffer(v.sideNo),
                          offset: 0,
                          stride: 4,
                          td: !1,
                          divisor: 0,
                        },
                        id: {
                          buffer: f.buffer(v.id),
                          offset: 0,
                          stride: 4,
                          td: !1,
                          divisor: 0,
                        },
                        radius: {
                          buffer: f.buffer(v.radius),
                          offset: 0,
                          stride: 4,
                          td: !1,
                          divisor: 0,
                        },
                        rotation: {
                          buffer: f.buffer(v.rotation),
                          offset: 0,
                          stride: 4,
                          td: !1,
                          divisor: 0,
                        },
                        pickColor: {
                          buffer: f.buffer(v.pickColor),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        index: f.elements({
                          primitive: "triangles",
                          type: "uint32",
                          data: v.index,
                        }),
                      },
                      uniforms: g.uniforms,
                      si: g.si,
                      mf: { labels: v.labels },
                    };
                  }
                }
                return h;
              }),
              (s.updateStyle = function (a, o) {
                for (
                  var l = function (c, h) {
                      for (
                        var p = a[c],
                          d = o[c].attributes,
                          m = d.altitude,
                          g = d.height,
                          v = d.topColor,
                          y = d.bottomColor,
                          _ = d.sideColor,
                          b = d.textureSize,
                          S = d.label,
                          P = p.mf.origin,
                          I = P.position,
                          F = P.color,
                          X = p.mf.Tw,
                          W = X.top,
                          Z = X.bottom,
                          j = X.Pw,
                          L = X.jw,
                          T = new Float32Array(F.length / 2),
                          A = 0,
                          $ = 0,
                          R = 0,
                          M = I.length;
                        R < M;
                        R += 4
                      ) {
                        var w = (R / 4) * 4,
                          O = void 0,
                          E = [-1, -1];
                        R >= L[A] && A++;
                        var k = A * 4;
                        R >= Z[$ + 1] && $++,
                          R < j[$]
                            ? ((O = y), (I[R + 2] = m[A]))
                            : R >= j[$] && R < W[$]
                            ? (((R - j[$]) / 4) % 2 === 0
                                ? (I[R + 2] = m[A])
                                : (I[R + 2] = g[A] + m[A]),
                              (O = _),
                              (E = b.slice(A * 2, A * 2 + 2)))
                            : ((O = v), (I[R + 2] = g[A] + m[A])),
                          (F[w] = O[k]),
                          (F[w + 1] = O[k + 1]),
                          (F[w + 2] = O[k + 2]),
                          (F[w + 3] = O[k + 3]),
                          (T[w / 2] = E[0]),
                          (T[w / 2 + 1] = E[1]);
                      }
                      p.attributes.position.buffer({ data: I }),
                        p.attributes.color.buffer({ data: F }),
                        p.attributes.textureSize.buffer({ data: T }),
                        (p.uniforms = o[c].uniforms),
                        (p.mf.labels = p.mf.labels.map(function (D, q) {
                          return __spreadValues$8(
                            __spreadValues$8({}, D),
                            S[q]
                          );
                        }));
                    },
                    u = 0,
                    f = a.length;
                  u < f;
                  u++
                )
                  l(u, f);
              }),
              (s.EC = function () {
                return [];
              }),
              (s.destroy = function () {}),
              (s.Fx = function (a) {
                var o = a.Wx,
                  l = a.height,
                  u = a.Lx,
                  f = a.vertex,
                  c = a.topColor,
                  h = a.sideTopColor,
                  p = a.sideBottomColor,
                  d = a.pickColor,
                  m = a.radius,
                  g = a.rotation,
                  v = a.hasSide,
                  y = a.id,
                  _ = [],
                  b = [],
                  S = [],
                  P = [],
                  I = [],
                  F = [],
                  X = [],
                  W = [];
                this.qx(W, o, I.length);
                for (var Z = 0; Z < o; Z++) {
                  var j = u.lngLatToCoord(f);
                  this.Gx(b, S, [j[0], j[1], f[2] + l, 1], c, _, d),
                    P.push(Z),
                    F.push(m),
                    I.push(g),
                    X.push(y);
                }
                if (v)
                  for (var L = 0; L < o; L++) {
                    var T = u.lngLatToCoord(f),
                      A = I.length;
                    W.push(A + 1, A, A + 3, A + 3, A, A + 2);
                    for (var $ = 0; $ < 4; $++) {
                      var R = !!($ % 2),
                        M = R ? h : p;
                      this.Gx(
                        b,
                        S,
                        [T[0], T[1], f[2] + (R ? l : 0), R ? 0.5 : 0],
                        M,
                        _,
                        d
                      ),
                        P.push($ < 2 ? L : L + 0.5),
                        F.push(m),
                        I.push(g),
                        X.push(y);
                    }
                  }
                return {
                  Qw: _,
                  Gh: S,
                  vertex: b,
                  Nx: P,
                  Ux: I,
                  radius: F,
                  id: X,
                  index: W,
                };
              }),
              (s.Gx = function (a, o, l, u, f, c) {
                var h = a.length,
                  p = o.length;
                if (
                  ((a[h] = l[0]),
                  (a[h + 1] = l[1]),
                  (a[h + 2] = l[2]),
                  (a[h + 3] = l[3]),
                  (o[p] = u[0]),
                  (o[p + 1] = u[1]),
                  (o[p + 2] = u[2]),
                  (o[p + 3] = u[3]),
                  f && c)
                ) {
                  var d = f.length;
                  (f[d] = c[0]),
                    (f[d + 1] = c[1]),
                    (f[d + 2] = c[2]),
                    (f[d + 3] = c[3]);
                }
              }),
              (s.qx = function (a, o, l) {
                for (var u = 0; u < o - 2; u++) a.push(0, l + u + 1, l + u + 2);
                return a;
              }),
              (i.getInstance = function () {
                return this.ui;
              }),
              i
            );
          })(GeometryFusion),
          PrismFusion = _PrismFusion;
        PrismFusion.ui = new _PrismFusion();
        var PrismFusionInstance = PrismFusion.getInstance(),
          __defProp$7 = Object.defineProperty,
          __getOwnPropSymbols$7 = Object.getOwnPropertySymbols,
          __hasOwnProp$7 = Object.prototype.hasOwnProperty,
          __propIsEnum$7 = Object.prototype.propertyIsEnumerable,
          __defNormalProp$7 = function (r, n, i) {
            return n in r
              ? __defProp$7(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$7 = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$7.call(n, i) && __defNormalProp$7(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$7)
              try {
                for (
                  var l = __getOwnPropSymbols$7(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$7.call(n, i) && __defNormalProp$7(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          PrismShader = {
            vertex:
              "\n        precision highp float;\n\n        attribute vec4 position;\n        attribute vec4 color;\n        attribute float radius;\n        attribute float rotation;\n        attribute float id;\n        // \u8FB9\u7684\u5E8F\u53F7, \u4EE3\u8868\u5F53\u524D\u7684\u9876\u70B9\u5E8F\u53F7\n        // \u5E8F\u53F7\u4ECE\u6B63\u5317\u65B9\u5411\u5F00\u59CB\uFF0C\u987A\u65F6\u9488\u6570\n        attribute float sideNo;\n\n        varying vec3 vNormal;\n        varying vec4 vColor;\n        varying vec3 vPosition;\n        "
                .concat(
                  ColorGLSL.getColorShader().vertex,
                  "\n\n        uniform mat4 mvp;\n        // unit: px=0, meter=1\n        uniform float unit;\n        uniform float resolution;\n        // uniform float heightScale;\n        // uniform float altitudeScale;\n        // uniform float rotationScale;\n        // uniform float radiusScale;\n        uniform float sideNumber;\n        "
                )
                .concat(RenderUtil.getBezier(), "\n        ")
                .concat(RenderUtil.getScaleType("radius"), "\n        ")
                .concat(RenderUtil.getScaleType("height"), "\n        ")
                .concat(RenderUtil.getScaleType("altitude"), "\n        ")
                .concat(
                  RenderUtil.getScaleType("rotation"),
                  "\n\n        // z \u8F74\u65CB\u8F6C\n        vec2 rotateZ(vec2 a, float rad) {\n            float s = sin(rad);\n            float c = cos(rad);\n            float x = a.x;\n            float y = a.y;\n\n            // x = x * c - y * s;\n            // y = y * c + x * s;\n            // return vec2(x, y);\n            mat2 rotate = mat2(\n                c, -s,\n                s, c\n            );\n            return a * rotate;\n        }\n        // \u6839\u636E\u5E8F\u53F7\uFF0C\u8BA1\u7B97 normal \u548C\u9876\u70B9\u4F4D\u7F6E\n        struct vecInfo {\n            vec3 position;\n            vec3 normal;\n        };\n        vecInfo getVec(float rotationScale, float radiusScale) {\n            vec2 ori = vec2(0, 1);\n            float PI = 3.14159265;\n            float rot = rotation / 180.0 * PI * rotationScale;\n            float angle = PI * 2.0 / sideNumber;\n            // \u5982\u679C\u662F\u50CF\u7D20\uFF0C\u9700\u8981\u8BA1\u7B97\u4E3A\u7C73\n            float r = unit == 1.0 ? 1.0 : resolution;\n            vec2 pos = rotateZ(ori, -angle * ceil(sideNo) - rot) * radius * radiusScale * r;\n            vec3 normal = vec3(0,0,1);\n\n            // \u9876\u9762 normal \u5C31\u662F (0,0,1)\n            // \u5426\u5219\u5C31\u662F\u4FA7\u9762\uFF0C\u6211\u4EEC\u9700\u8981\u6839\u636E\u9762\u5B9A\u4E49\u4FA7\u9762\u5411\u91CF\n            // w \u5206\u91CF =1.0\uFF0C\u8BF4\u660E\u662F\u9876\u9762\n            // w = 0.5 \u8BF4\u660E\u662F\u4FA7\u9762\u7684\u9876\u70B9\n            // w = 0.0 \u8BF4\u660E\u662F\u4FA7\u9762\u7684\u5E95\u9762\n            if(position.w != 1.0) {\n                normal = vec3(rotateZ(ori, -angle * (floor(sideNo) + 0.5) - rot), 0);\n            }\n            vecInfo result;\n            result.position =vec3(pos + position.xy, position.z);\n            result.normal = normal;\n            return result;\n        }\n\n        void main() {\n            float radiusScale = radiusScaleValue(id);\n            float rotationScale = rotationScaleValue(id);\n            float heightScale = heightScaleValue(id);\n            float altitudeScale = altitudeScaleValue(id);\n            vecInfo info = getVec(rotationScale, radiusScale);\n            float r = unit == 1.0 ? 1.0 : resolution;\n            vec3 realPos = info.position.xyz;\n            // \u5E95\u90E8\n            if(position.w == 0.0) {\n                realPos = vec3(realPos.xy, realPos.z * r * altitudeScale);\n            }\n            // \u9876\u90E8\n            if(position.w > 0.0) {\n                realPos = vec3(realPos.xy, realPos.z * r * heightScale);\n            }\n            vColor = color;\n            vNormal = info.normal;\n            vPosition = realPos;\n            gl_Position = mvp * vec4(realPos, 1.0);\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainVert,
                  "\n        }\n    "
                ),
            fragment:
              "\n        precision highp float;\n        varying vec4 vColor;\n\n        // \u5982\u679C\u9700\u8981\u5149\u7167\uFF0C\u8FD9\u4E24\u4E2A\u53D8\u91CF\u662F\u5FC5\u987B\u7684\n        varying vec3 vNormal;\n        varying vec3 vPosition;\n\n        uniform float opacity;\n\n        uniform vec3 cameraPosition;\n        uniform float shininess;\n        #include <lightUniforms,lightFunctions>;\n\n        "
                .concat(
                  ColorGLSL.getColorShader().fragment,
                  "\n\n        void main() {\n            gl_FragColor = vColor;\n\n            #include <lightMainCompute>;\n\n            gl_FragColor.a *= opacity;\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainFrag,
                  "\n        }\n    "
                ),
            includes: __spreadValues$7({}, LightIncludes),
          },
          __defProp$6 = Object.defineProperty,
          __defProps$3 = Object.defineProperties,
          __getOwnPropDescs$3 = Object.getOwnPropertyDescriptors,
          __getOwnPropSymbols$6 = Object.getOwnPropertySymbols,
          __hasOwnProp$6 = Object.prototype.hasOwnProperty,
          __propIsEnum$6 = Object.prototype.propertyIsEnumerable,
          __defNormalProp$6 = function (r, n, i) {
            return n in r
              ? __defProp$6(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$6 = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$6.call(n, i) && __defNormalProp$6(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$6)
              try {
                for (
                  var l = __getOwnPropSymbols$6(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$6.call(n, i) && __defNormalProp$6(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __spreadProps$3 = function (r, n) {
            return __defProps$3(r, __getOwnPropDescs$3(n));
          },
          PrismRender = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              _classCallCheck(this, i);
              var a;
              return (
                (a = n.call.apply(
                  n,
                  [this].concat(Array.prototype.slice.call(arguments))
                )),
                (a.v$ = [new LabelsRender$1()]),
                a
              );
            }
            var s = i.prototype;
            return (
              (s.m$ = function (a) {
                if (!this.regl) return !1;
                this.v$.forEach(function (u) {
                  return u.m$(a);
                });
                var o = this.regl,
                  l = RenderHelper._A(a, o);
                this.gA(PrismShader, a, {
                  attributes: __spreadValues$6(
                    {
                      position: o.prop("position"),
                      color: o.prop("color"),
                      sideNo: o.prop("sideNo"),
                      radius: o.prop("radius"),
                      rotation: o.prop("rotation"),
                      id: o.prop("id"),
                    },
                    ColorGLSL.getColor(o).attribute
                  ),
                  uniforms: __spreadValues$6(
                    __spreadValues$6(
                      __spreadValues$6(
                        __spreadValues$6(
                          __spreadValues$6(
                            __spreadValues$6(
                              {
                                mvp: o.prop("mvp"),
                                resolution: o.prop("resolution"),
                                unit: o.prop("unit"),
                                opacity: o.prop("layerOpacity"),
                                sideNumber: o.prop("sideNumber"),
                                shininess: o.prop("shininess"),
                                cameraPosition: o.prop("cameraPosition"),
                              },
                              ColorGLSL.getColor(o).uniform
                            ),
                            RenderUtil.getScaleUniform("height", o)
                          ),
                          RenderUtil.getScaleUniform("radius", o)
                        ),
                        RenderUtil.getScaleUniform("rotation", o)
                      ),
                      RenderUtil.getScaleUniform("altitude", o)
                    ),
                    l
                  ),
                  blend: { enable: !0, func: RenderUtil.getBlend("normal") },
                  cull: {
                    enable: o.prop("cullEnable"),
                    face: o.prop("cullface"),
                  },
                  frontFace: "cw",
                  depth: { enable: !0, func: "lequal" },
                  elements: o.prop("index"),
                });
              }),
              (s.render = function (a) {
                var o = this.yA(PrismShader);
                if (o) {
                  var l = a.meshes,
                    u = a.mvp,
                    f = a.lights,
                    c = a.opacity,
                    h = a.cull,
                    p = a.cameraPosition,
                    d = a.shininess,
                    m = a.acceptLight,
                    g = a.vP,
                    v = a.resolution,
                    y = a.isPick,
                    _ = y === void 0 ? !1 : y;
                  if (!(l.length < 1)) {
                    for (var b = 0; b < l.length; b++) {
                      var S = l[b],
                        P = S.attributes,
                        I = S.uniforms,
                        F = h !== "none",
                        X = h === "front" ? "front" : "back";
                      o(
                        __spreadValues$6(
                          __spreadProps$3(
                            __spreadValues$6(__spreadValues$6({}, P), f),
                            {
                              unit: I.unit === "px" ? 0 : 1,
                              layerOpacity: c,
                              mvp: u,
                              cullEnable: F,
                              cullface: X,
                              cameraPosition: p,
                              shininess: d,
                              acceptLight: m,
                              isPick: _,
                              resolution: v,
                              sideNumber: I.sideNumber,
                            }
                          ),
                          RenderUtil.getScaleProps(g)
                        )
                      );
                    }
                    for (var W = 0; W < l.length; W++) {
                      var Z = !0,
                        j = !1,
                        L = void 0;
                      try {
                        for (
                          var T = this.v$[Symbol.iterator](), A;
                          !(Z = (A = T.next()).done);
                          Z = !0
                        ) {
                          var $ = A.value;
                          $.render(l[W]);
                        }
                      } catch (R) {
                        (j = !0), (L = R);
                      } finally {
                        try {
                          !Z && T.return != null && T.return();
                        } finally {
                          if (j) throw L;
                        }
                      }
                    }
                  }
                }
              }),
              (s.pickRender = function (a) {
                var o = this.yA(PrismShader);
                if (!!o && a.pickFbo && a.pickPos) {
                  var l = this;
                  a.pickFbo.use(function () {
                    l.regl.clear({ color: [0, 0, 0, 0], depth: 1 }),
                      l.render(
                        __spreadProps$3(__spreadValues$6({}, a), { isPick: !0 })
                      );
                  });
                }
              }),
              i
            );
          })(Render),
          pushArray$5 = CommonUtil$1._C,
          PrismLayer = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              (o = n.call(this, a)),
                (o.CLASS_NAME = "Prism"),
                (o.fusion = new PrismFusion()),
                (o.ll = new PrismRender());
              var l = prism.Sw;
              return (
                (o.zooms = a.zooms === void 0 ? l.zooms : a.zooms),
                (o.visible = a.visible === void 0 ? l.visible : a.visible),
                (o.zIndex = a.zIndex === void 0 ? l.zIndex : a.zIndex),
                (o.opacity = a.opacity === void 0 ? l.opacity : a.opacity),
                (o.shininess =
                  a.shininess === void 0 ? l.shininess : a.shininess),
                (o.acceptLight =
                  a.acceptLight === void 0 ? l.acceptLight : a.acceptLight),
                (o.hasSide = a.hasSide === void 0 ? l.hasSide : a.hasSide),
                (o.cullface = a.cullface || l.cullface),
                (o.fusion = PrismFusionInstance),
                o.AC({ zooms: o.zooms, visible: o.visible, zIndex: o.zIndex }),
                o.buryPoint.record(o.CLASS_NAME),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.setStyle = function (a) {
                if (
                  (_get(_getPrototypeOf(i.prototype), "setStyle", this).call(
                    this,
                    a
                  ),
                  (this.dataset = this.source.LC()),
                  this.colorPick.clear(),
                  this.loca && this.dataset && this.dataset.length > 0)
                ) {
                  var o = this.WC(),
                    l = o.didFusionDataset,
                    u = this.fusion.fusion(l, this.styleOptions, this);
                  (this.meshes = u),
                    (this.vA.state |= MeshesDirty),
                    this.loca.requestRender();
                }
              }),
              (s.receiveDataset = function (a) {
                (this.dataset = a),
                  this.setStyle(this.styleOptions),
                  this.onAdd();
              }),
              (s.jC = function () {
                _get(_getPrototypeOf(i.prototype), "jC", this).call(this),
                  !(!this.loca || !this.loca.regl || this.ll.regl) &&
                    ((this.ll.regl = this.loca.regl),
                    this.loca.rendererManager.addRenderer(this.ll));
              }),
              (s.beforeRender = function () {
                if (
                  (_get(
                    _getPrototypeOf(i.prototype),
                    "beforeRender",
                    this
                  ).call(this),
                  this.loca && this.loca.fusionManager.addFusion(this.fusion),
                  this.jC(),
                  this.source && (this.dataset = this.source.LC()),
                  this.fusion)
                ) {
                  var a = this.WC(),
                    o = a.willFusion;
                  if (o.length > 0) {
                    var l = this.fusion.fusion(o, this.styleOptions, this);
                    (this.meshes = pushArray$5(this.meshes, l)),
                      (this.vA.state |= MeshesDirty);
                  }
                }
              }),
              (s.render = function () {
                var a, o;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var l =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    u = this.projection.getResolution(
                      (o = this.loca) == null ? void 0 : o.map.getZoom()
                    ),
                    f = this.loca.customCoords.getCameraParams().position,
                    c = RenderHelper.IA(this.loca.lights);
                  this.ll &&
                    this.meshes.length > 0 &&
                    this.ll.render({
                      meshes: this.meshes,
                      mvp: l,
                      resolution: u,
                      opacity: this._getOpacity(),
                      vP: this._animateLayerState,
                      lights: c,
                      cull: this.cullface,
                      cameraPosition: f,
                      shininess: this.shininess,
                      acceptLight: this.acceptLight,
                      isPick: !1,
                    });
                }
              }),
              (s.pickRender = function () {
                var a, o;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var l =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    u = this.projection.getResolution(
                      (o = this.loca) == null ? void 0 : o.map.getZoom()
                    ),
                    f = this.loca.customCoords.getCameraParams().position,
                    c = RenderHelper.IA(this.loca.lights);
                  this.ll &&
                    this.meshes.length > 0 &&
                    this.ll.pickRender({
                      meshes: this.meshes,
                      mvp: l,
                      resolution: u,
                      opacity: this._getOpacity(),
                      vP: this._animateLayerState,
                      lights: c,
                      cull: this.cullface,
                      cameraPosition: f,
                      shininess: this.shininess,
                      acceptLight: this.acceptLight,
                      isPick: !0,
                      pickFbo: this._needPickFrame && this._pickFbo,
                      pickPos: this._pickPos,
                    });
                }
              }),
              (s.afterRender = function () {}),
              (s.destroy = function () {
                _get(_getPrototypeOf(i.prototype), "destroy", this).call(this),
                  (this.ll = null);
              }),
              (s.getInitialAnimateState = function () {
                return {
                  height: {
                    time: [1, 0, 0, 0],
                    type: [-1, 1, 0, 0],
                    value: [0, 1],
                  },
                  radius: {
                    time: [1, 0, 0, 0],
                    type: [-1, 1, 0, 0],
                    value: [0, 1],
                  },
                  altitude: {
                    time: [1, 0, 0, 0],
                    type: [-1, 1, 0, 0],
                    value: [0, 1],
                  },
                  rotation: {
                    time: [1, 0, 0, 0],
                    type: [-1, 1, 0, 0],
                    value: [0, 1],
                  },
                };
              }),
              (s.PA = function () {
                return RenderHelper.SA(this.ll, this);
              }),
              i
            );
          })(Layer),
          pushArray$4 = CommonUtil$1._C,
          PulseLinkFusion = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.DC = function () {}),
              (s.buildStyle = function (a, o, l) {
                var u = pulselink.style,
                  f = [];
                if (!l.loca) return {};
                for (var c = l.loca.customCoords, h = 0; h < a.length; h++)
                  if (!(!a[h].features || !a[h].features.lines)) {
                    var p = a[h].features.lines,
                      d = [],
                      m = !0,
                      g = !1,
                      v = void 0;
                    try {
                      for (
                        var y = p[Symbol.iterator](), _;
                        !(m = (_ = y.next()).done);
                        m = !0
                      ) {
                        var b = _.value,
                          S = b.coordinates,
                          P = b.type;
                        if (P === "LineString") {
                          var I = S[0],
                            F = S[S.length - 1],
                            X = c.lngLatToCoord(I),
                            W = c.lngLatToCoord(F),
                            Z = glMatrix.vec2.distance(X, W);
                          d.push({ distance: Z, link: b });
                        }
                        if (P === "MultiLineString")
                          for (var j = 0; j < S.length; j++) {
                            var L = S[j],
                              T = [L[0], L[L.length - 1]],
                              A = T[0],
                              $ = T[1],
                              R = c.lngLatToCoord(A),
                              M = c.lngLatToCoord($),
                              w = glMatrix.vec2.distance(R, M);
                            d.push({
                              distance: w,
                              link: {
                                coordinates: b.coordinates[j],
                                properties: b.properties,
                              },
                            });
                          }
                      }
                    } catch (E) {
                      (g = !0), (v = E);
                    } finally {
                      try {
                        !m && y.return != null && y.return();
                      } finally {
                        if (g) throw v;
                      }
                    }
                    var O = StyleInstance.parse(d, o, u);
                    f.push(O);
                  }
                return f;
              }),
              (s.fusion = function (a, o, l, u) {
                if (!this.regl || !l.loca) return [];
                var f = [];
                u = u || this.buildStyle(a, o, l);
                for (var c = l.loca.customCoords, h = 0; h < a.length; h++) {
                  var p = a[h];
                  if (!(!p.features || !p.features.lines)) {
                    for (
                      var d = p.features.lines,
                        m = u[h],
                        g = m.attributes,
                        v = m.uniforms,
                        y = {
                          vertex: [],
                          color: [],
                          pickColor: [],
                          lineWidth: [],
                          distance: [],
                          speed: [],
                          lineDir: [],
                          dash: [],
                          index: [],
                        },
                        _ = 0;
                      _ < d.length;
                      _++
                    ) {
                      var b = d[_],
                        S = b.coordinates,
                        P = g.lineColors,
                        I = g.height,
                        F = g.lineWidth,
                        X = g.dash,
                        W = g.speed,
                        Z = v.smoothSteps,
                        j = v.maxHeightScale,
                        L = X[_],
                        T = W[_],
                        A = F[_],
                        $ = (A[1] - A[0]) / (Z - 1),
                        R = l.colorPick.add(b),
                        M = I[_],
                        w = P[_],
                        O = Math.max(w.length, 2),
                        E = (A[1] - A[0]) / (O - 1);
                      if (b.type === "MultiLineString")
                        for (var k = 0, D = S.length; k < D; k++) {
                          var q = S[k],
                            J = [],
                            de = [q[0], q[q.length - 1]],
                            we = _slicedToArray(de[0], 2),
                            Se = we[0],
                            He = we[1],
                            et = _slicedToArray(de[1], 2),
                            Ke = et[0],
                            Fe = et[1],
                            qe = { x: Se, y: He, z: 0 },
                            Mt = { x: Ke, y: Fe, z: 0 },
                            ot = [Ke - Se, Fe - He, 0],
                            at = [Se - Ke, He - Fe, 0],
                            Lt = glMatrix.vec3.cross(
                              new Float32Array(3),
                              ot,
                              [0, 0, -1]
                            ),
                            $t = glMatrix.vec3.cross(
                              new Float32Array(3),
                              ot,
                              [0, 0, 1]
                            );
                          if (M === 0)
                            (J = LinearSplit(qe, Mt, O)),
                              this.Qx(J, y, c, {
                                Hx: w,
                                Yx: A,
                                Xx: Lt,
                                pickColor: R,
                                lineDir: ot,
                                Jx: at,
                                Zx: E,
                                $x: $t,
                                dash: L,
                                speed: T,
                              });
                          else {
                            var Rt = {
                              x: Se - (Se - Ke) / 2,
                              y: He - (He - Fe) / 2,
                              z: M,
                            };
                            (J = cubicBezier(qe, Rt, Mt, 0.5, Z)),
                              this.Qx(J, y, c, {
                                Hx: w,
                                Yx: A,
                                Xx: Lt,
                                pickColor: R,
                                lineDir: ot,
                                Jx: at,
                                Zx: $,
                                $x: $t,
                                dash: L,
                                speed: T,
                              });
                          }
                        }
                      else {
                        var Ot = [S[0], S[S.length - 1]],
                          wt = _slicedToArray(Ot[0], 2),
                          kt = wt[0],
                          Pt = wt[1],
                          At = _slicedToArray(Ot[1], 2),
                          ut = At[0],
                          ct = At[1],
                          vt = [ut - kt, ct - Pt, 0],
                          rt = [kt - ut, Pt - ct, 0],
                          Wt = glMatrix.vec3.cross(
                            new Float32Array(3),
                            vt,
                            [0, 0, -1]
                          ),
                          Vt = glMatrix.vec3.cross(
                            new Float32Array(3),
                            vt,
                            [0, 0, 1]
                          ),
                          mt = { x: kt, y: Pt, z: 0 },
                          yt = { x: ut, y: ct, z: 0 },
                          xt = [];
                        if (M === 0)
                          (xt = LinearSplit(mt, yt, O)),
                            this.Qx(xt, y, c, {
                              Hx: w,
                              Yx: A,
                              Xx: Wt,
                              pickColor: R,
                              lineDir: vt,
                              Jx: rt,
                              Zx: E,
                              $x: Vt,
                              dash: L,
                              speed: T,
                            });
                        else {
                          var It = {
                            x: kt - (kt - ut) * j,
                            y: Pt - (Pt - ct) * j,
                            z: M,
                          };
                          (xt = cubicBezier(mt, It, yt, 0.5, Z)),
                            this.Qx(xt, y, c, {
                              Hx: w,
                              Yx: A,
                              Xx: Wt,
                              pickColor: R,
                              lineDir: vt,
                              Jx: rt,
                              Zx: $,
                              $x: Vt,
                              dash: L,
                              speed: T,
                            });
                        }
                      }
                    }
                    f[h] = {
                      id: p.id,
                      attributes: {
                        color: {
                          buffer: this.regl.buffer(y.color),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        dash: {
                          buffer: this.regl.buffer(y.dash),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        speed: {
                          buffer: this.regl.buffer(y.speed),
                          offset: 0,
                          stride: 4 * 1,
                          td: !1,
                          divisor: 0,
                        },
                        lineDir: {
                          buffer: this.regl.buffer(y.lineDir),
                          offset: 0,
                          stride: 4 * 3,
                          td: !1,
                          divisor: 0,
                        },
                        lineWidth: {
                          buffer: this.regl.buffer(y.lineWidth),
                          offset: 0,
                          stride: 4 * 1,
                          td: !1,
                          divisor: 0,
                        },
                        distance: {
                          buffer: this.regl.buffer(y.distance),
                          offset: 0,
                          stride: 4 * 2,
                          td: !1,
                          divisor: 0,
                        },
                        pickColor: {
                          buffer: this.regl.buffer(y.pickColor),
                          offset: 0,
                          stride: 4 * 4,
                          td: !1,
                          divisor: 0,
                        },
                        position: {
                          buffer: this.regl.buffer(y.vertex),
                          offset: 0,
                          stride: 4 * 3,
                          td: !1,
                          divisor: 0,
                        },
                        index: this.regl.elements({
                          primitive: "triangles",
                          type: "uint32",
                          data: y.index,
                        }),
                      },
                      uniforms: m.uniforms,
                      si: m.si,
                    };
                  }
                }
                return f;
              }),
              (s.updateStyle = function (a, o, l, u) {
                if (!l.loca) return [];
                var f = l.dataset;
                return this.fusion(f, o, l, u);
              }),
              (s.EC = function () {
                return [];
              }),
              (s.destroy = function () {
                this.regl = null;
              }),
              (s.Qx = function (a, o, l, u) {
                for (
                  var f = u.Hx,
                    c = u.speed,
                    h = u.Yx,
                    p = u.dash,
                    d = u.Xx,
                    m = u.pickColor,
                    g = u.Zx,
                    v = u.$x,
                    y = 0,
                    _ = !1,
                    b = 0,
                    S = { Kx: [], tM: [], coords: [] },
                    P = 0,
                    I = a.length;
                  P < I - 1;
                  P++
                ) {
                  var F = a[P],
                    X = a[P + 1],
                    W = _ || l.lngLatToCoord([F.x, F.y]),
                    Z = l.lngLatToCoord([X.x, X.y]),
                    j = [Z[0] - W[0], Z[1] - W[1], X.z - F.z],
                    L = glMatrix.vec2.len(j);
                  _ || S.coords.push(W),
                    S.coords.push(Z),
                    S.tM.push(j),
                    S.Kx.push(y),
                    (b += L),
                    (y = L + y),
                    (_ = Z);
                }
                for (
                  var T = S.Kx, A = S.tM, $ = S.coords, R = 0, M = a.length;
                  R < M - 1;
                  R++
                ) {
                  var w = a[R],
                    O = a[R + 1],
                    E = $[R],
                    k = $[R + 1],
                    D = A[R],
                    q = linearGradient(f, w.t),
                    J = linearGradient(f, O.t),
                    de = T[R],
                    we = T[R + 1] || b,
                    Se = A[R - 1] || D,
                    He = this.nM(
                      {
                        Br: [E[0], E[1], w.z],
                        color: q,
                        Xx: d,
                        lineDir: Se,
                        width: h[0] + g * R,
                        distance: [de, b],
                        pickColor: m,
                        dash: p,
                        speed: c,
                      },
                      {
                        Br: [k[0], k[1], O.z],
                        color: J,
                        Xx: v,
                        lineDir: D,
                        width: h[0] + g * (R + 1),
                        distance: [we, b],
                        pickColor: m,
                        dash: p,
                        speed: c,
                      }
                    );
                  GeoUtil.mergeTriangles(o, He, 3),
                    pushArray$4(o.color, He.color),
                    pushArray$4(o.lineWidth, He.width),
                    pushArray$4(o.distance, He.distance),
                    pushArray$4(o.lineDir, He.lineDir),
                    pushArray$4(o.pickColor, He.pickColor),
                    pushArray$4(o.dash, He.dash),
                    pushArray$4(o.speed, He.speed);
                }
              }),
              (s.nM = function (a, o) {
                var l = a.Br,
                  u = a.color,
                  f = a.width,
                  c = a.pickColor,
                  h = a.lineDir,
                  p = a.distance,
                  d = a.dash,
                  m = a.speed,
                  g = o.Br,
                  v = o.color,
                  y = o.width,
                  _ = o.pickColor,
                  b = o.lineDir,
                  S = o.distance,
                  P = o.dash,
                  I = o.speed,
                  F = _toConsumableArray(l).concat(
                    _toConsumableArray(l),
                    _toConsumableArray(g),
                    _toConsumableArray(g)
                  ),
                  X = _toConsumableArray(u).concat(
                    _toConsumableArray(u),
                    _toConsumableArray(v),
                    _toConsumableArray(v)
                  ),
                  W = [f, f, y, y],
                  Z = _toConsumableArray(p).concat(
                    _toConsumableArray(p),
                    _toConsumableArray(S),
                    _toConsumableArray(S)
                  ),
                  j = _toConsumableArray(c).concat(
                    _toConsumableArray(c),
                    _toConsumableArray(_),
                    _toConsumableArray(_)
                  ),
                  L = [-h[0], -h[1], -h[2]],
                  T = [-b[0], -b[1], -b[2]],
                  A = _toConsumableArray(h).concat(
                    _toConsumableArray(L),
                    _toConsumableArray(b),
                    _toConsumableArray(T)
                  ),
                  $ = _toConsumableArray(d).concat(
                    _toConsumableArray(d),
                    _toConsumableArray(P),
                    _toConsumableArray(P)
                  ),
                  R = [m, m, I, I];
                return {
                  vertex: F,
                  distance: Z,
                  speed: R,
                  color: X,
                  width: W,
                  pickColor: j,
                  lineDir: A,
                  dash: $,
                  index: [1, 0, 2, 2, 3, 1],
                };
              }),
              i
            );
          })(GeometryFusion),
          PulseLinkShader = {
            vertex:
              "\n        precision highp float;\n        attribute vec3 position;\n        attribute vec4 color;\n        // attribute vec3 normal;\n        attribute vec3 lineDir;\n        attribute vec3 vertexNext;\n        attribute float lineWidth;\n        attribute vec2 distance;\n        attribute vec4 dash;\n        attribute float speed;\n        varying vec4 vColor;\n        varying vec4 vDash;\n        varying vec2 vDistance;\n        varying float vSpeed;\n        uniform mat4 mvp;\n        uniform vec3 cameraPosition;\n        uniform float unit; // 0: px; 1: meter;\n        uniform float resolution;\n        "
                .concat(
                  ColorGLSL.getColorShader().vertex,
                  "\n\n        void main() {\n            float res = unit == 0.0 ? resolution : 1.0;\n            // \u8BA1\u7B97\u5F53\u524D\u9876\u70B9\u5230\u76F8\u673A\u7684\u5411\u91CF\n            vec3 cameraDir = vec3(cameraPosition - position);\n            vec3 cameraNor = cross(cameraDir, lineDir);\n\n            vColor = color;\n            vDash = dash;\n            vSpeed = speed;\n            vDistance = distance;\n            vec3 pos = position + normalize(cameraNor) * (lineWidth / 2.0) * res;\n            gl_Position = mvp * vec4(pos, 1.0);\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainVert,
                  "\n        }\n    "
                ),
            fragment:
              "\n        precision highp float;\n        varying vec4 vColor;\n        varying vec4 vDash;\n        varying vec2 vDistance;\n        varying float vSpeed;\n        uniform float opacity;\n        uniform float animateCounter;\n        uniform float resolution;\n        uniform float flowLength;\n        uniform vec4 headColor;\n        uniform vec4 trailColor;\n        uniform float unit;\n        "
                .concat(
                  ColorGLSL.getColorShader().fragment,
                  "\n\n        void main() {\n            float res = unit == 0.0 ? resolution : 1.0;\n            float curDist = vDistance.x;\n            float distPixel = vDistance.x / res;\n            float offset = mod(distPixel, vDash.r + vDash.g + vDash.b + vDash.a);\n            if(offset > vDash.r && offset < vDash.r + vDash.g) {\n                discard;\n            } else if(offset > vDash.r + vDash.g + vDash.b) {\n                discard;\n            }\n            float op = offset / (vDash.r + vDash.g + vDash.b + vDash.a);\n            gl_FragColor = vColor;\n\n            // \u8109\u51B2\u7C92\u5B50\n            float ligLen = flowLength * res;\n            float curTop = animateCounter * vSpeed * res / 1000.0 * 60.0;\n            float realCurTop = mod(curTop, vDistance.y);\n            float realCurBottom = mod(curTop - ligLen, vDistance.y);\n            float delta = 1.0 - (curDist - realCurBottom) / ligLen;\n            vec4 resultColor = vColor;\n\n            // \u8BF4\u660E\u662F\u5728\u672B\u7AEF\uFF0C\u5934\u90E8\u5DF2\u7ECF\u51FA\u4E86\u7AEF\u70B9\n            if(realCurTop < realCurBottom) {\n                // \u672B\u7AEF\n                if(curDist > realCurBottom) {\n                    resultColor = mix(headColor, trailColor, delta);\n                }\n                // \u59CB\u7AEF\n                if(curDist < realCurTop) {\n                    float delta = 1.0 - (vDistance.y - realCurBottom + curDist) / ligLen;\n                    resultColor = mix(headColor, trailColor, delta);\n                }\n                gl_FragColor = mix(vColor, resultColor, resultColor.a);\n            } else {\n                if(curDist < realCurTop && curDist > realCurBottom) {\n                    resultColor = mix(headColor, trailColor, delta);\n                }\n                gl_FragColor = mix(vColor, resultColor, resultColor.a);\n            }\n            gl_FragColor.a *= opacity;\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainFrag,
                  "\n        }\n    "
                ),
          },
          __defProp$5 = Object.defineProperty,
          __defProps$2 = Object.defineProperties,
          __getOwnPropDescs$2 = Object.getOwnPropertyDescriptors,
          __getOwnPropSymbols$5 = Object.getOwnPropertySymbols,
          __hasOwnProp$5 = Object.prototype.hasOwnProperty,
          __propIsEnum$5 = Object.prototype.propertyIsEnumerable,
          __defNormalProp$5 = function (r, n, i) {
            return n in r
              ? __defProp$5(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$5 = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$5.call(n, i) && __defNormalProp$5(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$5)
              try {
                for (
                  var l = __getOwnPropSymbols$5(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$5.call(n, i) && __defNormalProp$5(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __spreadProps$2 = function (r, n) {
            return __defProps$2(r, __getOwnPropDescs$2(n));
          },
          PulseLinkRender = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.m$ = function (a) {
                if (!this.regl) return !1;
                var o = this.regl;
                this.gA(PulseLinkShader, a, {
                  frag: PulseLinkShader.fragment,
                  vert: PulseLinkShader.vertex,
                  attributes: __spreadValues$5(
                    {
                      position: o.prop("position"),
                      color: o.prop("color"),
                      lineDir: o.prop("lineDir"),
                      lineWidth: o.prop("lineWidth"),
                      distance: o.prop("distance"),
                      dash: o.prop("dash"),
                      speed: o.prop("speed"),
                    },
                    ColorGLSL.getColor(o).attribute
                  ),
                  uniforms: __spreadValues$5(
                    {
                      mvp: o.prop("mvp"),
                      opacity: o.prop("opacity"),
                      resolution: o.prop("resolution"),
                      flowLength: o.prop("flowLength"),
                      unit: o.prop("unit"),
                      cameraPosition: o.prop("cameraPosition"),
                      animateCounter: o.prop("animateCounter"),
                      trailColor: o.prop("trailColor"),
                      headColor: o.prop("headColor"),
                    },
                    ColorGLSL.getColor(o).uniform
                  ),
                  cull: { enable: !1 },
                  depth: { enable: o.prop("depth") },
                  blend: { enable: !0, func: RenderUtil.getBlend() },
                  elements: o.prop("index"),
                });
              }),
              (s.render = function (a) {
                var o = this.yA(PulseLinkShader);
                if (o)
                  for (
                    var l = a.meshes,
                      u = a.mvp,
                      f = a.animateCounter,
                      c = a.opacity,
                      h = a.resolution,
                      p = a.depth,
                      d = a.cameraPosition,
                      m = 0;
                    m < l.length;
                    m++
                  ) {
                    var g = l[m],
                      v = g.attributes,
                      y = g.uniforms,
                      _ = y.unit,
                      b = y.flowLength,
                      S = y.trailColor,
                      P = y.headColor;
                    o(
                      __spreadProps$2(__spreadValues$5({}, v), {
                        cameraPosition: d,
                        mvp: u,
                        animateCounter: f,
                        unit: _ === "px" ? 0 : 1,
                        resolution: h,
                        opacity: c,
                        depth: p,
                        trailColor: S,
                        headColor: P,
                        flowLength: b,
                        isPick: !1,
                      })
                    );
                  }
              }),
              (s.pickRender = function (a) {
                var o = this.yA(PulseLinkShader);
                if (o) {
                  var l = a.meshes,
                    u = a.animateCounter,
                    f = a.mvp,
                    c = a.opacity,
                    h = a.pickFbo,
                    p = a.pickPos,
                    d = a.resolution,
                    m = a.cameraPosition,
                    g = a.depth;
                  if (h && p) {
                    var v = this;
                    h.use(function () {
                      v.regl.clear({ color: [0, 0, 0, 0], depth: 1 });
                      for (var y = 0; y < l.length; y++) {
                        var _ = l[y],
                          b = _.attributes,
                          S = _.uniforms,
                          P = S.unit,
                          I = S.flowLength,
                          F = S.trailColor,
                          X = S.headColor;
                        o(
                          __spreadProps$2(
                            __spreadValues$5(
                              { blendFun: RenderUtil.getBlend() },
                              b
                            ),
                            {
                              cameraPosition: m,
                              mvp: f,
                              animateCounter: u,
                              unit: P === "px" ? 0 : 1,
                              resolution: d,
                              opacity: c,
                              depth: g,
                              trailColor: F,
                              headColor: X,
                              flowLength: I,
                              isPick: !0,
                            }
                          )
                        );
                      }
                    });
                  }
                }
              }),
              i
            );
          })(Render),
          pushArray$3 = CommonUtil$1._C,
          PulseLinkLayer = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              (o = n.call(this, a)),
                (o.CLASS_NAME = "PulseLink"),
                (o.fusion = new PulseLinkFusion()),
                (o.ll = new PulseLinkRender()),
                (o.depth = !0);
              var l = pulselink.Sw;
              return (
                (o.zooms = a.zooms === void 0 ? l.zooms : a.zooms),
                (o.zIndex = a.zIndex === void 0 ? l.zIndex : a.zIndex),
                (o.opacity = a.opacity === void 0 ? l.opacity : a.opacity),
                (o.visible = a.visible === void 0 ? l.visible : a.visible),
                (o.depth = a.depth === void 0 ? l.depth : a.depth),
                o.AC({ zooms: o.zooms, visible: o.visible, zIndex: o.zIndex }),
                o.buryPoint.record(o.CLASS_NAME),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.receiveDataset = function (a) {
                (this.dataset = a),
                  this.setStyle(this.styleOptions),
                  this.onAdd();
              }),
              (s.setStyle = function (a) {
                if (
                  (_get(_getPrototypeOf(i.prototype), "setStyle", this).call(
                    this,
                    a
                  ),
                  (this.dataset = this.source.LC()),
                  (this.meshes = []),
                  this.dataset && this.dataset.length > 0 && this.meshes)
                ) {
                  var o = this.WC(),
                    l = o.didFusion,
                    u = this.fusion.buildStyle(
                      this.dataset,
                      this.styleOptions,
                      this
                    ),
                    f = this.fusion.updateStyle(l, this.styleOptions, this, u);
                  (this.meshes = f), this.loca && this.loca.requestRender();
                }
              }),
              (s.jC = function () {
                _get(_getPrototypeOf(i.prototype), "jC", this).call(this),
                  !(!this.loca || !this.loca.regl || this.ll.regl) &&
                    ((this.ll.regl = this.loca.regl),
                    this.loca.rendererManager.addRenderer(this.ll));
              }),
              (s.beforeRender = function () {
                if (
                  (_get(
                    _getPrototypeOf(i.prototype),
                    "beforeRender",
                    this
                  ).call(this),
                  !this.fusion.regl &&
                    this.loca &&
                    ((this.fusion.regl = this.loca.regl),
                    this.loca.fusionManager.addFusion(this.fusion)),
                  this.jC(),
                  this.source && (this.dataset = this.source.LC()),
                  this.fusion)
                ) {
                  var a = this.WC(),
                    o = a.willFusion,
                    l = a.didFusion;
                  if ((this.fusion.EC(), o.length > 0)) {
                    var u = this.fusion.fusion(o, this.styleOptions, this);
                    this.meshes = pushArray$3(l, u);
                  }
                }
              }),
              (s.render = function () {
                var a, o;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var l =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    u = this.projection.getResolution(
                      (o = this.loca) == null ? void 0 : o.map.getZoom()
                    ),
                    f = this.loca.customCoords.getCameraParams().position;
                  if (this.ll && this.meshes.length > 0) {
                    var c = this.hP();
                    this.ll.render({
                      meshes: this.meshes,
                      mvp: l,
                      depth: this.depth,
                      resolution: u,
                      opacity: this._getOpacity(),
                      animateCounter: c,
                      cameraPosition: f,
                    });
                  }
                }
              }),
              (s.pickRender = function () {
                var a, o;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var l =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    u = this.loca.customCoords.getCameraParams().position,
                    f = this.projection.getResolution(
                      (o = this.loca) == null ? void 0 : o.map.getZoom()
                    );
                  if (this.ll) {
                    var c = this.hP();
                    this.ll.pickRender({
                      depth: this.depth,
                      meshes: this.meshes,
                      mvp: l,
                      resolution: f,
                      cameraPosition: u,
                      animateCounter: c,
                      opacity: this._getOpacity(),
                      pickFbo: this._needPickFrame && this._pickFbo,
                      pickPos: this._pickPos,
                    });
                  }
                }
              }),
              (s.afterRender = function () {}),
              (s.PA = function () {
                return RenderHelper.SA(this.ll, this);
              }),
              i
            );
          })(Layer),
          util = newUtil(),
          inliner = newInliner(),
          fontFaces = newFontFaces(),
          images = newImages(),
          defaultOptions = { iM: void 0, rM: !1 },
          domtoimage = {
            eM: toSvg,
            oM: toPng,
            aM: toJpeg,
            pP: toCanvas,
            toBlob: toBlob,
            uM: toPixelData,
            sM: {
              fM: fontFaces,
              images: images,
              cM: util,
              lM: inliner,
              options: {},
            },
          };
        function cloneNode(r, n, i) {
          if (!i && n && !n(r)) return Promise.resolve();
          return Promise.resolve(r)
            .then(s)
            .then(function (l) {
              return a(r, l, n);
            })
            .then(function (l) {
              return o(r, l);
            });
          function s(l) {
            return _instanceof(l, HTMLCanvasElement)
              ? util.pM(l.toDataURL())
              : l.cloneNode(!1);
          }
          function a(l, u, f) {
            var c = l.childNodes;
            if (c.length === 0) return Promise.resolve(u);
            return h(u, util.mM(c), f).then(function () {
              return u;
            });
            function h(p, d, m) {
              var g = Promise.resolve();
              return (
                d.forEach(function (v) {
                  g = g
                    .then(function () {
                      return cloneNode(v, m);
                    })
                    .then(function (y) {
                      y && p.appendChild(y);
                    });
                }),
                g
              );
            }
          }
          function o(l, u) {
            if (!_instanceof(u, Element)) return u;
            return Promise.resolve()
              .then(f)
              .then(c)
              .then(h)
              .then(p)
              .then(function () {
                return u;
              });
            function f() {
              d(window.getComputedStyle(l), u.style);
              function d(m, g) {
                v(m, g);
                function v(y, _) {
                  util.mM(y).forEach(function (b) {
                    _.setProperty(
                      b,
                      y.getPropertyValue(b),
                      y.getPropertyPriority(b)
                    );
                  });
                }
              }
            }
            function c() {
              [":before", ":after"].forEach(function (m) {
                d(m);
              });
              function d(m) {
                var g = window.getComputedStyle(l, m),
                  v = g.getPropertyValue("content");
                if (v === "" || v === "none") return;
                var y = util.bM();
                u.className = u.className + " " + y;
                var _ = document.createElement("style");
                _.appendChild(b(y, m, g)), u.appendChild(_);
                function b(S, P, I) {
                  var F = "." + S + ":" + P,
                    X = I.cssText ? W(I) : Z(I);
                  return document.createTextNode(F + "{" + X + "}");
                  function W(j) {
                    var L = j.getPropertyValue("content");
                    return j.cssText + " content: " + L + ";";
                  }
                  function Z(j) {
                    return util.mM(j).map(L).join("; ") + ";";
                    function L(T) {
                      return (
                        T +
                        ": " +
                        j.getPropertyValue(T) +
                        (j.getPropertyPriority(T) ? " !important" : "")
                      );
                    }
                  }
                }
              }
            }
            function h() {
              _instanceof(l, HTMLTextAreaElement) && (u.innerHTML = l.value),
                _instanceof(l, HTMLInputElement) &&
                  u.setAttribute("value", l.value);
            }
            function p() {
              !_instanceof(u, SVGElement) ||
                (u.setAttribute("xmlns", "http://www.w3.org/2000/svg"),
                _instanceof(u, SVGRectElement) &&
                  ["width", "height"].forEach(function (d) {
                    var m = u.getAttribute(d);
                    !m || u.style.setProperty(d, m);
                  }));
            }
          }
        }
        var pushArray$2 = CommonUtil$1._C,
          ZMarkerFusion = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              _classCallCheck(this, i);
              var a;
              return (
                (a = n.call.apply(
                  n,
                  [this].concat(Array.prototype.slice.call(arguments))
                )),
                (a.kx = {}),
                (a.PM = new Map()),
                a
              );
            }
            var s = i.prototype;
            return (
              (s.buildStyle = function (a, o, l) {
                for (var u, f = zmarker.style, c = [], h = 0; h < a.length; h++)
                  if (!(!a[h].features || !a[h].features.points)) {
                    for (
                      var p = a[h].features.points,
                        d = StyleInstance.parse(p, o, f),
                        m = {},
                        g = 0;
                      g < p.length;
                      g++
                    )
                      if (d)
                        for (var v in d.attributes) {
                          var y = d.attributes[v];
                          m[v] || (m[v] = []),
                            typeof y[g] == "string"
                              ? v === "content"
                                ? m[v].push(this.TM(y[g]))
                                : pushArray$2(m[v], [y[g]])
                              : ((u = y[g]) == null ? void 0 : u.length) > 0
                              ? pushArray$2(m[v], y[g])
                              : (m[v][m[v].length] = y[g]);
                        }
                    c.push({ attributes: m, uniforms: d.uniforms, si: d.si }),
                      this.jM(l);
                  }
                return c;
              }),
              (s.DC = function () {}),
              (s.fusion = function (a, o, l, u) {
                if (!this.regl || !l.loca) return [];
                u = u || this.buildStyle(a, o, l);
                var f = [];
                return (
                  o &&
                    a &&
                    a.length &&
                    (f = this.Cx({
                      dataset: a,
                      styleOptions: o,
                      Sw: l,
                      Ax: u,
                    })),
                  f
                );
              }),
              (s.Cx = function (a) {
                for (
                  var o = a.dataset,
                    l = a.Ax,
                    u = a.Sw,
                    f,
                    c = [],
                    h =
                      (f = u == null ? void 0 : u.loca) == null
                        ? void 0
                        : f.customCoords,
                    p = function (W) {
                      var Z = W.mesh,
                        j = W.style,
                        L = W.lnglat,
                        T = W.id,
                        A = W.pickColor,
                        $ = h.lngLatToCoord(L);
                      pushArray$2(Z.position, [
                        $[0],
                        $[1],
                        $[2] || j.altitude,
                        T,
                      ]),
                        pushArray$2(Z.size, j.size),
                        pushArray$2(Z.uv, j.uv),
                        Z.rotation.push((j.rotation / 180) * Math.PI),
                        pushArray$2(Z.pickColor, A);
                    },
                    d = 0;
                  d < o.length;
                  d++
                ) {
                  var m = o[d];
                  if (!(!m.features || !m.features.points)) {
                    for (
                      var g = m.features.points,
                        v = l[d],
                        y = {
                          position: [],
                          size: [],
                          uv: [],
                          rotation: [],
                          pickColor: [],
                        },
                        _ = u.zx().BM,
                        b = 0;
                      b < g.length;
                      b++
                    ) {
                      var S = g[b],
                        P = S == null ? void 0 : S.coordinates,
                        I = u.colorPick.add(S),
                        F = {
                          uv: _.get("" + v.attributes.content[b]),
                          size: v.attributes.size.slice(b * 2, b * 2 + 2),
                          rotation: v.attributes.rotation[b],
                          altitude: v.attributes.altitude[b],
                        };
                      if (P && P.length)
                        if (S.type == "MultiPoint")
                          for (var X = 0; X < P.length; X++)
                            p({
                              mesh: y,
                              style: F,
                              lnglat: P[X],
                              pickColor: I,
                              id: S.sr,
                            });
                        else
                          p({
                            mesh: y,
                            style: F,
                            lnglat: P,
                            pickColor: I,
                            id: S.sr,
                          });
                    }
                    (y.rect = [
                      0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1,
                    ]),
                      (c[d] = {
                        id: m.id,
                        attributes: {
                          rect: {
                            buffer: this.regl.buffer(y.rect),
                            offset: 0,
                            stride: 4 * 3,
                            td: !1,
                            divisor: 0,
                          },
                          position: {
                            buffer: this.regl.buffer(y.position),
                            offset: 0,
                            stride: 4 * 4,
                            td: !1,
                            divisor: 1,
                          },
                          uv: {
                            buffer: this.regl.buffer(y.uv),
                            offset: 0,
                            stride: 4 * 4,
                            td: !1,
                            divisor: 1,
                          },
                          size: {
                            buffer: this.regl.buffer(y.size),
                            offset: 0,
                            stride: 4 * 2,
                            td: !1,
                            divisor: 1,
                          },
                          rotation: {
                            buffer: this.regl.buffer(y.rotation),
                            offset: 0,
                            stride: 4 * 1,
                            td: !1,
                            divisor: 1,
                          },
                          pickColor: {
                            buffer: this.regl.buffer(y.pickColor),
                            offset: 0,
                            stride: 4 * 4,
                            td: !1,
                            divisor: 1,
                          },
                        },
                        uniforms: v.uniforms,
                        mf: { count: y.rotation.length },
                      });
                  }
                }
                return c;
              }),
              (s.EC = function () {
                return [];
              }),
              (s.destroy = function () {
                this.regl = null;
              }),
              (s.TM = function (a) {
                var o = this.PM.has(a);
                if (o) return this.PM.get(a);
                var l = this.PM.size;
                return this.PM.set(a, l), l;
              }),
              (s.jM = function (a) {
                var o = this,
                  l = a.zx().BM,
                  u = this.PM,
                  f = document.createElement("div");
                f.setAttribute(
                  "style",
                  "position: fixed; z-index: 999999; top: 0; left: 0; opacity: 0; poinert-events: none; width: 4096px;"
                ),
                  document.body.appendChild(f);
                var c = "";
                u.forEach(function (d, m) {
                  c +=
                    '<div data-index="' +
                    d +
                    '" style="float: left; padding: 2px;">' +
                    m +
                    "</div>";
                }),
                  (f.innerHTML = c);
                var h = f.scrollWidth,
                  p = f.scrollHeight;
                f.querySelectorAll("div").forEach(function (d) {
                  l.set(d.dataset.index, [
                    d.offsetLeft / h,
                    d.offsetTop / p,
                    (d.offsetLeft + d.scrollWidth) / h,
                    (d.offsetTop + d.scrollHeight) / p,
                  ]);
                }),
                  document.body.removeChild(f),
                  f.setAttribute(
                    "style",
                    "position: fixed; z-index: 999999; top: 0; left: 0; poinert-events: none; width: 4096px;"
                  ),
                  domtoimage
                    .pP(f, { width: h, height: p, dM: 1 })
                    .then(function (d) {
                      a.DM(
                        o == null
                          ? void 0
                          : o.regl.texture({
                              format: "rgba",
                              width: h,
                              height: p,
                              data: d,
                            })
                      );
                    });
              }),
              i
            );
          })(GeometryFusion),
          ZMarkerShader = {
            vertex:
              "\n        precision highp float;\n\n        uniform mat4 mvp;\n        uniform float resolution;\n        // unit: px=0, meter=1\n        uniform float unit;\n        uniform bool alwaysFront;\n        uniform float rot;\n\n        attribute vec3 rect;\n        attribute vec4 position;\n        attribute vec2 size;\n        attribute vec4 uv;\n        attribute float rotation;\n\n        varying vec2 vSize;\n        varying float vRotation;\n        varying vec2 vTextureCoord;\n        "
                .concat(ColorGLSL.getColorShader().vertex, "\n        ")
                .concat(RenderUtil.getBezier(), "\n        ")
                .concat(RenderUtil.getScaleType("altitude"), "\n        ")
                .concat(
                  RenderUtil.getScaleType("rotation"),
                  "\n\n        // z \u8F74\u65CB\u8F6C\n        mat4 rotateZ(mat4 a, float rad) {\n            float s = sin(rad);\n            float c = cos(rad);\n\n            // \u7B2C\u4E8C\u79CD\n            mat4 rotate = mat4(\n                c, -s, 0, 0,\n                s, c, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1\n            );\n            return a * rotate;\n        }\n\n        // \u901A\u8FC7\u9876\u70B9\u8BA1\u7B97\u51FA uv\n        vec2 getUV() {\n            vec2 result = vec2(0);\n            if(rect == vec3(0, 0, 1)) {\n                // \u5DE6\u4E0B\n                result = vec2(uv);\n            } else if(rect == vec3(0, 0, 0)) {\n                // \u5DE6\u4E0A\n                result = vec2(uv.x, uv.w);\n            } else if(rect == vec3(1, 0, 1)) {\n                // \u53F3\u4E0B\n                result = vec2(uv.z, uv.y);\n            } else if(rect == vec3(1, 0, 0)) {\n                // \u53F3\u4E0A\n                result = vec2(uv.z, uv.w);\n            }\n            return result;\n        }\n\n        // \u6839\u636E rect \u83B7\u53D6\u771F\u5B9E\u7684\u5750\u6807\n        vec4 getPos(float rotationScale, float altitudeScale) {\n            float res = unit == 1.0 ? 1.0 : resolution;\n            vec4 result = vec4(position.xyz, 1);\n            result.z *= altitudeScale;\n            if(rect == vec3(0, 0, 1)) {\n                // \u5DE6\u4E0A\n                result.x = result.x - size.x * res / 2.0;\n                result.z = result.z + size.y * res;\n            } else if(rect == vec3(0, 0, 0)) {\n                // \u5DE6\u4E0B\n                result.x = result.x - size.x * res / 2.0;\n            } else if(rect == vec3(1, 0, 1)) {\n                // \u53F3\u4E0A\n                result.x = result.x + size.x * res / 2.0;\n                result.z = result.z + size.y * res;\n            } else if(rect == vec3(1, 0, 0)) {\n                // \u53F3\u4E0B\n                result.x = result.x + size.x * res / 2.0;\n            }\n\n            // \u65CB\u8F6C\n            mat4 matrix = mat4(0);\n            matrix[0].x = 1.0;\n            matrix[1].y = 1.0;\n            matrix[2].z = 1.0;\n            matrix[3].w = 1.0;\n            float r = alwaysFront ? rot : rotation * rotationScale;\n            result.xy -= position.xy;\n            result = rotateZ(matrix, r) * result;\n            result.xy += position.xy;\n            return result;\n        }\n\n        void main() {\n            float rotationScale = rotationScaleValue(position.w);\n            float altitudeScale = altitudeScaleValue(position.w);\n            gl_Position = mvp * getPos(rotationScale, altitudeScale);\n            vTextureCoord = getUV();\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainVert,
                  "\n        }\n    "
                ),
            fragment:
              "\n        precision highp float;\n        uniform sampler2D texture;\n        uniform float layerOpacity;\n\n        varying vec2 vTextureCoord;\n        "
                .concat(
                  ColorGLSL.getColorShader().fragment,
                  "\n\n        void main() {\n            gl_FragColor = texture2D(texture, vTextureCoord);\n            gl_FragColor.a *= layerOpacity;\n            "
                )
                .concat(
                  ColorGLSL.getColorShader().mainFrag,
                  "\n        }\n    "
                ),
          },
          __defProp$4 = Object.defineProperty,
          __defProps$1 = Object.defineProperties,
          __getOwnPropDescs$1 = Object.getOwnPropertyDescriptors,
          __getOwnPropSymbols$4 = Object.getOwnPropertySymbols,
          __hasOwnProp$4 = Object.prototype.hasOwnProperty,
          __propIsEnum$4 = Object.prototype.propertyIsEnumerable,
          __defNormalProp$4 = function (r, n, i) {
            return n in r
              ? __defProp$4(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$4 = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$4.call(n, i) && __defNormalProp$4(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$4)
              try {
                for (
                  var l = __getOwnPropSymbols$4(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$4.call(n, i) && __defNormalProp$4(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __spreadProps$1 = function (r, n) {
            return __defProps$1(r, __getOwnPropDescs$1(n));
          },
          ZMarkerRender = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.m$ = function (a) {
                if (!this.regl) return !1;
                var o = this.regl;
                this.gA(ZMarkerShader, a, {
                  attributes: __spreadValues$4(
                    {
                      rect: o.prop("rect"),
                      position: o.prop("position"),
                      size: o.prop("size"),
                      uv: o.prop("uv"),
                      rotation: o.prop("rotation"),
                    },
                    ColorGLSL.getColor(o).attribute
                  ),
                  uniforms: __spreadValues$4(
                    __spreadValues$4(
                      __spreadValues$4(
                        {
                          mvp: o.prop("mvp"),
                          resolution: o.prop("resolution"),
                          rot: o.prop("rot"),
                          texture: o.prop("texture"),
                          layerOpacity: o.prop("layerOpacity"),
                          unit: o.prop("unit"),
                          alwaysFront: o.prop("alwaysFront"),
                        },
                        RenderUtil.getScaleUniform("rotation", o)
                      ),
                      RenderUtil.getScaleUniform("altitude", o)
                    ),
                    ColorGLSL.getColor(o).uniform
                  ),
                  depth: { enable: !1, mask: !0, func: "less", range: [0, 1] },
                  blend: { enable: !0, func: RenderUtil.getBlend("normal") },
                  count: 6,
                  instances: o.prop("count"),
                });
              }),
              (s.render = function (a) {
                var o = this.yA(ZMarkerShader);
                if (o) {
                  var l = a.meshes,
                    u = a.mvp,
                    f = a.opacity,
                    c = a.resolution,
                    h = a.texture,
                    p = a.vP,
                    d = a.rot;
                  if (!(l.length < 1))
                    for (var m = 0; m < l.length; m++) {
                      var g = l[m],
                        v = g.attributes,
                        y = g.uniforms,
                        _ = g.mf,
                        b = _.count;
                      o(
                        __spreadValues$4(
                          __spreadProps$1(
                            __spreadValues$4(__spreadValues$4({}, v), y),
                            {
                              unit: y.unit === "px" ? 0 : 1,
                              resolution: c,
                              layerOpacity: f,
                              rot: d,
                              texture: h,
                              count: b,
                              mvp: u,
                              isPick: !1,
                            }
                          ),
                          RenderUtil.getScaleProps(p)
                        )
                      );
                    }
                }
              }),
              (s.pickRender = function (a) {
                var o = this.yA(ZMarkerShader);
                if (o) {
                  var l = a.meshes,
                    u = a.mvp,
                    f = a.opacity,
                    c = a.resolution,
                    h = a.texture,
                    p = a.vP,
                    d = a.rot,
                    m = a.pickFbo,
                    g = a.pickPos;
                  if (!(l.length < 1) && m && g) {
                    var v = this;
                    m.use(function () {
                      v.regl.clear({ color: [0, 0, 0, 0], depth: 1 });
                      for (var y = 0; y < l.length; y++) {
                        var _ = l[y],
                          b = _.attributes,
                          S = _.uniforms,
                          P = _.mf,
                          I = P.count;
                        o(
                          __spreadValues$4(
                            __spreadProps$1(
                              __spreadValues$4(__spreadValues$4({}, b), S),
                              {
                                unit: S.unit === "px" ? 0 : 1,
                                resolution: c,
                                layerOpacity: f,
                                rot: d,
                                texture: h,
                                count: I,
                                mvp: u,
                                isPick: !0,
                              }
                            ),
                            RenderUtil.getScaleProps(p)
                          )
                        );
                      }
                    });
                  }
                }
              }),
              i
            );
          })(Render),
          pushArray$1 = CommonUtil$1._C,
          ZMarkerLayer = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              (o = n.call(this, a)),
                (o.CLASS_NAME = "ZMarker"),
                (o.fusion = new ZMarkerFusion()),
                (o.ll = new ZMarkerRender()),
                (o.jx = []),
                (o.EM = new Map());
              var l = zmarker.Sw;
              return (
                (o.zooms = a.zooms === void 0 ? l.zooms : a.zooms),
                (o.visible = a.visible === void 0 ? l.visible : a.visible),
                (o.zIndex = a.zIndex === void 0 ? l.zIndex : a.zIndex),
                (o.opacity = a.opacity === void 0 ? l.opacity : a.opacity),
                o.AC({ zooms: o.zooms, visible: o.visible, zIndex: o.zIndex }),
                o.buryPoint.record(o.CLASS_NAME),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.setStyle = function (a) {
                if (
                  (_get(_getPrototypeOf(i.prototype), "setStyle", this).call(
                    this,
                    a
                  ),
                  (this.dataset = this.source.LC()),
                  this.colorPick.clear(),
                  (this.Kf = null),
                  (this.jx = []),
                  this.EM.clear(),
                  this.dataset && this.dataset.length > 0)
                ) {
                  var o = this.WC(),
                    l = o.didFusionDataset,
                    u = this.fusion.fusion(l, this.styleOptions, this);
                  (this.meshes = u),
                    (this.vA.state |= MeshesDirty),
                    this.loca && this.loca.requestRender();
                }
              }),
              (s.getInitialAnimateState = function () {
                return {
                  altitude: {
                    time: [1, 0, 0, 0],
                    type: [-1, 1, 0, 0],
                    value: [0, 1],
                  },
                  rotation: {
                    time: [1, 0, 0, 0],
                    type: [-1, 1, 0, 0],
                    value: [0, 1],
                  },
                };
              }),
              (s.receiveDataset = function (a) {
                (this.dataset = a),
                  this.setStyle(this.styleOptions),
                  this.onAdd();
              }),
              (s.jC = function () {
                _get(_getPrototypeOf(i.prototype), "jC", this).call(this),
                  !(!this.loca || !this.loca.regl || this.ll.regl) &&
                    ((this.ll.regl = this.loca.regl),
                    this.loca.rendererManager.addRenderer(this.ll));
              }),
              (s.beforeRender = function () {
                if (
                  (_get(
                    _getPrototypeOf(i.prototype),
                    "beforeRender",
                    this
                  ).call(this),
                  !this.fusion.regl &&
                    this.loca &&
                    ((this.fusion.regl = this.loca.regl),
                    this.loca.fusionManager.addFusion(this.fusion)),
                  this.jC(),
                  this.source && (this.dataset = this.source.LC()),
                  this.fusion)
                ) {
                  var a = this.WC(),
                    o = a.willFusion;
                  if (o.length > 0) {
                    var l = this.fusion.fusion(o, this.styleOptions, this);
                    (this.meshes = pushArray$1(this.meshes, l)),
                      (this.vA.state |= MeshesDirty);
                  }
                }
              }),
              (s.render = function () {
                var a, o, l;
                if (
                  !!this.loca &&
                  !!this.PA() &&
                  (this.loca.regl._refresh(), this.Kf)
                ) {
                  var u =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    f = this.projection.getResolution(
                      (o = this.loca) == null ? void 0 : o.map.getZoom()
                    ),
                    c =
                      -(
                        ((l = this.loca) == null
                          ? void 0
                          : l.map.getRotation()) / 180
                      ) * Math.PI,
                    h = this.Kf ? this.meshes : this.Vx;
                  this.ll &&
                    h.length > 0 &&
                    this.ll.render({
                      texture: this.Kf || this.VM,
                      meshes: h,
                      mvp: u,
                      rot: c,
                      resolution: f,
                      opacity: this._getOpacity(),
                      vP: this._animateLayerState,
                    });
                }
              }),
              (s.pickRender = function () {
                var a, o, l;
                if (
                  !!this.loca &&
                  !!this.PA() &&
                  (this.loca.regl._refresh(), this.Kf)
                ) {
                  var u =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    f = this.projection.getResolution(
                      (o = this.loca) == null ? void 0 : o.map.getZoom()
                    ),
                    c =
                      -(
                        ((l = this.loca) == null
                          ? void 0
                          : l.map.getRotation()) / 180
                      ) * Math.PI,
                    h = this.Kf ? this.meshes : this.Vx;
                  this.ll &&
                    h.length > 0 &&
                    this.ll.pickRender({
                      texture: this.Kf || this.VM,
                      meshes: h,
                      mvp: u,
                      rot: c,
                      resolution: f,
                      pickFbo: this._needPickFrame && this._pickFbo,
                      pickPos: this._pickPos,
                      opacity: this._getOpacity(),
                      vP: this._animateLayerState,
                    });
                }
              }),
              (s.destroy = function () {
                _get(_getPrototypeOf(i.prototype), "destroy", this).call(this),
                  this.Kf.destroy(),
                  (this.Kf = null);
              }),
              (s.afterRender = function () {}),
              (s.zx = function () {
                return { BM: this.EM, _x: this.jx };
              }),
              (s.DM = function (a) {
                (this.Kf = a), this.loca && this.loca.requestRender();
              }),
              (s.PA = function () {
                return RenderHelper.SA(this.ll, this);
              }),
              i
            );
          })(Layer),
          BINARY_EXTENSION_HEADER_MAGIC = "glTF",
          BINARY_EXTENSION_HEADER_LENGTH = 12,
          BINARY_EXTENSION_CHUNK_TYPES = { JSON: 1313821514, mP: 5130562 },
          KHR_BINARY_GLTF = "KHR_binary_glTF",
          LoaderUtils = (function () {
            function r() {
              _classCallCheck(this, r);
            }
            return (
              (r.gP = function (n) {
                if (typeof TextDecoder != "undefined")
                  return new TextDecoder().decode(n);
                for (var i = "", s = 0, a = n.length; s < a; s++)
                  i += String.fromCharCode(n[s]);
                try {
                  return decodeURIComponent(escape(i));
                } catch (o) {
                  return i;
                }
              }),
              (r.bP = function (n) {
                var i = n.lastIndexOf("/");
                return i === -1 ? "./" : n.substr(0, i + 1);
              }),
              (r.yP = function (n, i) {
                return typeof n != "string" || n === ""
                  ? ""
                  : (/^https?:\/\//i.test(i) &&
                      /^\//.test(n) &&
                      (i = i.replace(/(^https?:\/\/[^\/]+).*/i, "$1")),
                    /^(https?:)?\/\//i.test(n) ||
                    /^data:.*,.*$/i.test(n) ||
                    /^blob:.*$/i.test(n)
                      ? n
                      : i + n);
              }),
              r
            );
          })(),
          GLTFBinaryExtension = function r(n) {
            _classCallCheck(this, r),
              (this.name = KHR_BINARY_GLTF),
              (this.content = null),
              (this.body = null);
            var i = new DataView(n, 0, BINARY_EXTENSION_HEADER_LENGTH);
            if (
              ((this.xP = {
                wP: "glTF",
                version: i.getUint32(4, !0),
                length: i.getUint32(8, !0),
              }),
              this.xP.wP !== BINARY_EXTENSION_HEADER_MAGIC)
            )
              throw new Error("error magic");
            if (this.xP.version < 2) throw new Error("error version");
            for (
              var s = this.xP.length - BINARY_EXTENSION_HEADER_LENGTH,
                a = new DataView(n, BINARY_EXTENSION_HEADER_LENGTH),
                o = 0;
              o < s;

            ) {
              var l = a.getUint32(o, !0);
              o += 4;
              var u = a.getUint32(o, !0);
              if (((o += 4), u === BINARY_EXTENSION_CHUNK_TYPES.JSON)) {
                var f = new Uint8Array(
                  n,
                  BINARY_EXTENSION_HEADER_LENGTH + o,
                  l
                );
                this.content = LoaderUtils.gP(f);
              } else if (u === BINARY_EXTENSION_CHUNK_TYPES.mP) {
                var c = BINARY_EXTENSION_HEADER_LENGTH + o;
                this.body = n.slice(c, c + l);
              }
              o += l;
            }
            if (this.content === null)
              throw new Error("JSON content not found.");
          },
          __async$1 = function (r, n, i) {
            return new Promise(function (s, a) {
              var o = function (f) {
                  try {
                    u(i.next(f));
                  } catch (c) {
                    a(c);
                  }
                },
                l = function (f) {
                  try {
                    u(i.LA(f));
                  } catch (c) {
                    a(c);
                  }
                },
                u = function (f) {
                  return f.done
                    ? s(f.value)
                    : Promise.resolve(f.value).then(o, l);
                };
              u((i = i.apply(r, n)).next());
            });
          },
          globalUniformBlockID = 0,
          curLoader = null,
          NUM_MAX_JOINTS = 65,
          Scene = function r(n, i) {
            (this.name = i.name !== void 0 ? i.name : null),
              (this.nodes = new Array(i.nodes.length));
            for (var s = 0, a = i.nodes.length; s < a; s++)
              this.nodes[s] = n.nodes[i.nodes[s]];
            (this.extensions = i.extensions !== void 0 ? i.extensions : null),
              (this.CP = i.CP !== void 0 ? i.CP : null),
              (this.kP = null);
          },
          BoundingBox = function r(n, i, s) {
            (n =
              n ||
              glMatrix.vec3.fromValues(
                Number.POSITIVE_INFINITY,
                Number.POSITIVE_INFINITY,
                Number.POSITIVE_INFINITY
              )),
              (i =
                i ||
                glMatrix.vec3.fromValues(
                  Number.NEGATIVE_INFINITY,
                  Number.NEGATIVE_INFINITY,
                  Number.NEGATIVE_INFINITY
                )),
              s === void 0 || s === !0
                ? ((this.min = glMatrix.vec3.clone(n)),
                  (this.max = glMatrix.vec3.clone(i)))
                : ((this.min = n), (this.max = i)),
              (this.transform = glMatrix.mat4.create());
          };
        (BoundingBox.prototype.zP = function (r) {
          glMatrix.vec3.min(this.min, this.min, r.min),
            glMatrix.vec3.max(this.max, this.max, r.max);
        }),
          (BoundingBox.prototype.PP = function () {
            (this.transform[0] = this.max[0] - this.min[0]),
              (this.transform[5] = this.max[1] - this.min[1]),
              (this.transform[10] = this.max[2] - this.min[2]),
              (this.transform[12] = this.min[0]),
              (this.transform[13] = this.min[1]),
              (this.transform[14] = this.min[2]);
          }),
          (BoundingBox.SP = (function () {
            var r = glMatrix.vec3.create(),
              n = glMatrix.vec3.create(),
              i = glMatrix.vec3.create(),
              s = glMatrix.vec3.create(),
              a = glMatrix.vec3.create();
            return function (o, l) {
              glMatrix.vec3.set(r, l[0], l[1], l[2]),
                glMatrix.vec3.set(n, l[4], l[5], l[6]),
                glMatrix.vec3.set(i, l[8], l[9], l[10]);
              var u = glMatrix.vec3.fromValues(l[12], l[13], l[14]),
                f = glMatrix.vec3.clone(u);
              glMatrix.vec3.scale(s, r, o.min[0]),
                glMatrix.vec3.scale(a, r, o.max[0]),
                glMatrix.vec3.min(r, s, a),
                glMatrix.vec3.add(u, u, r),
                glMatrix.vec3.max(r, s, a),
                glMatrix.vec3.add(f, f, r),
                glMatrix.vec3.scale(s, n, o.min[1]),
                glMatrix.vec3.scale(a, n, o.max[1]),
                glMatrix.vec3.min(n, s, a),
                glMatrix.vec3.add(u, u, n),
                glMatrix.vec3.max(n, s, a),
                glMatrix.vec3.add(f, f, n),
                glMatrix.vec3.scale(s, i, o.min[2]),
                glMatrix.vec3.scale(a, i, o.max[2]),
                glMatrix.vec3.min(i, s, a),
                glMatrix.vec3.add(u, u, i),
                glMatrix.vec3.max(i, s, a),
                glMatrix.vec3.add(f, f, i);
              var c = new BoundingBox(u, f, !1);
              return c.PP(), c;
            };
          })());
        var Accessor = function r(n, i) {
          (this.bufferView = i),
            (this.componentType = n.componentType),
            (this.byteOffset = n.byteOffset !== void 0 ? n.byteOffset : 0),
            (this.byteStride = i.byteStride),
            (this.td = n.td !== void 0 ? n.td : !1),
            (this.count = n.count),
            (this.type = n.type),
            (this.size = Type2NumOfComponent[this.type]),
            (this.min = n.min),
            (this.max = n.max),
            (this.extensions = n.extensions !== void 0 ? n.extensions : null),
            (this.CP = n.CP !== void 0 ? n.CP : null);
        };
        Accessor.prototype.MP = function (r, n) {
          n.vertexAttribPointer(
            r,
            this.size,
            this.componentType,
            this.td,
            this.byteStride,
            this.byteOffset
          ),
            n.enableVertexAttribArray(r);
        };
        var BufferView = function r(n, i) {
          (this.byteLength = n.byteLength),
            (this.byteOffset = n.byteOffset !== void 0 ? n.byteOffset : 0),
            (this.byteStride = n.byteStride !== void 0 ? n.byteStride : 0),
            (this.target = n.target !== void 0 ? n.target : null),
            (this.data =
              i && i.slice(this.byteOffset, this.byteOffset + this.byteLength)),
            (this.extensions = n.extensions !== void 0 ? n.extensions : null),
            (this.CP = n.CP !== void 0 ? n.CP : null),
            (this.buffer = null);
        };
        (BufferView.prototype.createBuffer = function (r) {
          this.buffer = r.createBuffer();
        }),
          (BufferView.prototype._P = function (r) {
            return this.target
              ? (r.bindBuffer(this.target, this.buffer),
                r.bufferData(this.target, this.data, r.STATIC_DRAW),
                r.bindBuffer(this.target, null),
                !0)
              : !1;
          });
        var Camera = function r(n) {
            (this.name = n.name !== void 0 ? n.name : null),
              (this.type = n.type),
              (this.IP = n.IP === void 0 ? null : n.IP),
              (this.perspective =
                n.perspective === void 0
                  ? null
                  : {
                      VP: n.perspective.VP,
                      DP: n.perspective.DP,
                      LP: n.perspective.LP !== void 0 ? n.perspective.LP : null,
                      FP: n.perspective.FP !== void 0 ? n.perspective.FP : null,
                    }),
              (this.extensions = n.extensions !== void 0 ? n.extensions : null),
              (this.CP = n.CP !== void 0 ? n.CP : null);
          },
          Node = function r(n, i) {
            if (
              ((this.name = n.name !== void 0 ? n.name : null),
              (this.nodeID = i),
              (this.Np = n.Np !== void 0 ? n.Np : null),
              (this.matrix = glMatrix.mat4.create()),
              n.hasOwnProperty("matrix"))
            ) {
              for (var s = 0; s < 16; ++s) this.matrix[s] = n.matrix[s];
              (this.translation = glMatrix.vec3.create()),
                glMatrix.mat4.getTranslation(this.translation, this.matrix),
                (this.rotation = glMatrix.quat.create()),
                glMatrix.mat4.getRotation(this.rotation, this.matrix),
                (this.scale = glMatrix.vec3.create()),
                glMatrix.mat4.getScaling(this.scale, this.matrix);
            } else this.RP(n.translation, n.rotation, n.scale);
            if (
              ((this.children = n.children || []),
              (this.mesh =
                n.mesh !== void 0 ? curLoader.TP.meshes[n.mesh] : null),
              (this.OP = n.OP !== void 0 ? n.OP : null),
              n.extensions !== void 0 &&
                n.extensions.BP !== void 0 &&
                curLoader.AP === !0)
            ) {
              var a =
                  curLoader.NP.json.extensions.BP.WP[n.extensions.BP.OP.name],
                o = curLoader.NP.WP[a];
              this.OP = new SkinLink(curLoader.TP, o, n.extensions.BP.OP.EP);
            }
            (this.jP = n.jP !== void 0 ? n.jP : null),
              (this.extensions = n.extensions !== void 0 ? n.extensions : null),
              (this.CP = n.CP !== void 0 ? n.CP : null),
              (this.UP = null),
              (this.GP = new BoundingBox());
          };
        (Node.prototype.HP = function (r, n) {
          n(this, r);
          for (var i = 0, s = this.children.length; i < s; i++)
            this.children[i].HP(this, n);
        }),
          (Node.prototype.qP = function (r, n) {
            for (var i = 0, s = this.children.length; i < s; i++)
              this.children[i].qP(this, n);
            n(this, r);
          }),
          (Node.prototype.QP = function (r, n, i) {
            n(this, r);
            for (var s = 0, a = this.children.length; s < a; s++)
              this.children[s].QP(this, n, i);
            i(this, r);
          });
        var TRSMatrix = glMatrix.mat4.create();
        (Node.prototype.RP = function (r, n, i) {
          (this.translation =
            r !== void 0
              ? glMatrix.vec3.fromValues(r[0], r[1], r[2])
              : glMatrix.vec3.fromValues(0, 0, 0)),
            (this.rotation =
              n !== void 0
                ? glMatrix.vec4.fromValues(n[0], n[1], n[2], n[3])
                : glMatrix.vec4.fromValues(0, 0, 0, 1)),
            (this.scale =
              i !== void 0
                ? glMatrix.vec3.fromValues(i[0], i[1], i[2])
                : glMatrix.vec3.fromValues(1, 1, 1)),
            this.XP();
        }),
          (Node.prototype.XP = function () {
            glMatrix.mat4.fromRotationTranslation(
              TRSMatrix,
              this.rotation,
              this.translation
            ),
              glMatrix.mat4.scale(this.matrix, TRSMatrix, this.scale);
          });
        var Mesh = function r(n, i) {
            (this.JP = i),
              (this.name = n.name !== void 0 ? n.name : null),
              (this.primitives = []),
              (this.kP = null);
            for (var s, a, o = 0, l = n.primitives.length; o < l; ++o)
              (s = n.primitives[o]),
                (a = new Primitive(curLoader.TP, s)),
                this.primitives.push(a),
                a.kP &&
                  (this.kP || (this.kP = new BoundingBox()), this.kP.zP(a.kP));
            this.kP && this.kP.PP(),
              (this.jP = n.jP !== void 0 ? n.jP : null),
              (this.extensions = n.extensions !== void 0 ? n.extensions : null),
              (this.CP = n.CP !== void 0 ? n.CP : null);
          },
          Primitive = function r(n, i) {
            (this.attributes = i.attributes),
              (this.indices = i.indices !== void 0 ? i.indices : null);
            var s;
            if (
              i.extensions !== void 0 &&
              i.extensions.BP !== void 0 &&
              curLoader.AP === !0 &&
              i.extensions.BP.attributes
            )
              for (s in i.extensions.BP.attributes)
                this.attributes[s] = i.extensions.BP.attributes[s];
            this.indices !== null
              ? ((this.YP = n.json.accessors[this.indices].componentType),
                (this.$P = n.json.accessors[this.indices].count),
                (this.ZP = n.json.accessors[this.indices].byteOffset || 0))
              : ((this.KP = n.json.accessors[this.attributes.POSITION].count),
                (this.tS =
                  n.json.accessors[this.attributes.POSITION].byteOffset || 0));
            for (s in this.attributes)
              this.attributes[s] = n.accessors[this.attributes[s]];
            if (
              ((this.material =
                i.material !== void 0 ? n.materials[i.material] : null),
              (this.mode = i.mode !== void 0 ? i.mode : 4),
              (this.iS = i.iS),
              (this.extensions = i.extensions !== void 0 ? i.extensions : null),
              (this.CP = i.CP !== void 0 ? i.CP : null),
              (this.Lw = null),
              (this.nS = null),
              (this.eS = null),
              (this.Sd = null),
              (this.kP = null),
              this.attributes.POSITION !== void 0)
            ) {
              var a = this.attributes.POSITION;
              a.max &&
                a.type === "VEC3" &&
                ((this.kP = new BoundingBox(
                  glMatrix.vec3.fromValues(a.min[0], a.min[1], a.min[2]),
                  glMatrix.vec3.fromValues(a.max[0], a.max[1], a.max[2]),
                  !1
                )),
                this.kP.PP());
            }
          },
          Texture = function r(n) {
            (this.name = n.name !== void 0 ? n.name : null),
              (this.sampler =
                n.sampler !== void 0 ? curLoader.TP.samplers[n.sampler] : null),
              (this.source =
                n.source !== void 0 ? curLoader.TP.images[n.source] : null),
              (this.extensions = n.extensions !== void 0 ? n.extensions : null),
              (this.CP = n.CP !== void 0 ? n.CP : null),
              (this.texture = null);
          };
        Texture.prototype.createTexture = function (r) {
          (this.texture = r.createTexture()),
            r.bindTexture(r.TEXTURE_2D, this.texture),
            r.texImage2D(
              r.TEXTURE_2D,
              0,
              r.RGBA,
              r.RGBA,
              r.UNSIGNED_BYTE,
              this.source
            ),
            r.generateMipmap(r.TEXTURE_2D),
            r.bindTexture(r.TEXTURE_2D, null);
        };
        var magFilters = { 9728: "nearest", 9729: "linear" },
          minFilters = {
            9728: "nearest",
            9729: "linear",
            9987: "linear mipmap linear",
            9986: "nearest mipmap linear",
            9985: "linear mipmap nearest",
            9984: "nearest mipmap nearest",
          },
          wrapMode = { 10497: "repeat", 33071: "clamp", 33648: "mirror" },
          Sampler = function r(n) {
            (this.name = n.name !== void 0 ? n.name : null),
              (this.mag = n.ac !== void 0 ? magFilters[n.ac] : "linear"),
              (this.min = n.oc !== void 0 ? minFilters[n.oc] : "linear"),
              (this.wrapS = n.wrapS !== void 0 ? wrapMode[n.wrapS] : "repeat"),
              (this.wrapT = n.wrapT !== void 0 ? wrapMode[n.wrapT] : "repeat");
          },
          TextureInfo = function r(n) {
            (this.index = n.index),
              (this.rS = n.rS !== void 0 ? n.rS : 0),
              (this.extensions = n.extensions !== void 0 ? n.extensions : null),
              (this.CP = n.CP !== void 0 ? n.CP : null);
          },
          PbrMetallicRoughness = function r(n) {
            (this.baseColorFactor =
              n.baseColorFactor !== void 0 ? n.baseColorFactor : [1, 1, 1, 1]),
              (this.baseColorTexture =
                n.baseColorTexture !== void 0
                  ? new TextureInfo(n.baseColorTexture)
                  : null),
              (this.metallicFactor =
                n.metallicFactor !== void 0 ? n.metallicFactor : 1),
              (this.roughnessFactor =
                n.roughnessFactor !== void 0 ? n.roughnessFactor : 1),
              (this.oS = n.oS !== void 0 ? new TextureInfo(n.oS) : null),
              (this.extensions = n.extensions !== void 0 ? n.extensions : null),
              (this.CP = n.CP !== void 0 ? n.CP : null);
          },
          NormalTextureInfo = function r(n) {
            (this.index = n.index),
              (this.rS = n.rS !== void 0 ? n.rS : 0),
              (this.scale = n.scale !== void 0 ? n.scale : 1),
              (this.extensions = n.extensions !== void 0 ? n.extensions : null),
              (this.CP = n.CP !== void 0 ? n.CP : null);
          },
          OcclusionTextureInfo = function r(n) {
            (this.index = n.index),
              (this.rS = n.rS !== void 0 ? n.rS : 0),
              (this.sS = n.sS !== void 0 ? n.sS : 1),
              (this.extensions = n.extensions !== void 0 ? n.extensions : null),
              (this.CP = n.CP !== void 0 ? n.CP : null);
          },
          Material = function r(n) {
            (this.name = n.name !== void 0 ? n.name : null),
              (this.pbrMetallicRoughness =
                n.pbrMetallicRoughness !== void 0
                  ? new PbrMetallicRoughness(n.pbrMetallicRoughness)
                  : new PbrMetallicRoughness({
                      baseColorFactor: [1, 1, 1, 1],
                      metallicFactor: 1,
                      oS: 1,
                    })),
              (this.aS = n.aS !== void 0 ? new NormalTextureInfo(n.aS) : null),
              (this.uS =
                n.uS !== void 0 ? new OcclusionTextureInfo(n.uS) : null),
              (this.emissiveTexture =
                n.emissiveTexture !== void 0
                  ? new TextureInfo(n.emissiveTexture)
                  : null),
              (this.hS = n.hS !== void 0 ? n.hS : [0, 0, 0]),
              (this.lS = n.lS !== void 0 ? n.lS : "OPAQUE"),
              (this.fS = n.fS !== void 0 ? n.fS : 0.5),
              (this.cS = n.cS || !1),
              (this.extensions = n.extensions !== void 0 ? n.extensions : null),
              (this.CP = n.CP !== void 0 ? n.CP : null);
          },
          Skin = function r(n, i, s) {
            (this.name = i.name !== void 0 ? i.name : null),
              (this.vS = s),
              (this.dS = new Array(i.dS.length));
            var a, o;
            for (a = 0, o = this.dS.length; a < o; a++)
              this.dS[a] = n.nodes[i.dS[a]];
            if (
              ((this.pS = i.pS !== void 0 ? n.nodes[i.pS] : null),
              (this.EP = i.EP !== void 0 ? n.accessors[i.EP] : null),
              (this.extensions = i.extensions !== void 0 ? i.extensions : null),
              (this.CP = i.CP !== void 0 ? i.CP : null),
              (this.mS = globalUniformBlockID++),
              this.EP)
            )
              for (
                this.gS = _getAccessorData(this.EP),
                  this.bS = [],
                  this.yS = null,
                  this.xS = new Float32Array(NUM_MAX_JOINTS * 16),
                  a = 0,
                  o = this.gS.length;
                a < o;
                a += 16
              )
                this.bS.push(
                  glMatrix.mat4.fromValues(
                    this.gS[a],
                    this.gS[a + 1],
                    this.gS[a + 2],
                    this.gS[a + 3],
                    this.gS[a + 4],
                    this.gS[a + 5],
                    this.gS[a + 6],
                    this.gS[a + 7],
                    this.gS[a + 8],
                    this.gS[a + 9],
                    this.gS[a + 10],
                    this.gS[a + 11],
                    this.gS[a + 12],
                    this.gS[a + 13],
                    this.gS[a + 14],
                    this.gS[a + 15]
                  )
                );
          },
          SkinLink = function r(n, i, s) {
            if (
              ((this.wS = !0),
              n.WP || (n.WP = []),
              n.WP.push(this),
              (this.name = i.name),
              (this.vS = n.WP.length - 1),
              (this.dS = i.dS),
              (this.pS = i.pS),
              (this.EP = s !== void 0 ? n.accessors[s] : null),
              (this.mS = globalUniformBlockID++),
              this.EP)
            ) {
              (this.gS = _getAccessorData(this.EP)),
                (this.bS = []),
                (this.yS = null),
                (this.xS = new Float32Array(NUM_MAX_JOINTS * 16));
              for (var a = 0, o = this.gS.length; a < o; a += 16)
                this.bS.push(
                  glMatrix.mat4.fromValues(
                    this.gS[a],
                    this.gS[a + 1],
                    this.gS[a + 2],
                    this.gS[a + 3],
                    this.gS[a + 4],
                    this.gS[a + 5],
                    this.gS[a + 6],
                    this.gS[a + 7],
                    this.gS[a + 8],
                    this.gS[a + 9],
                    this.gS[a + 10],
                    this.gS[a + 11],
                    this.gS[a + 12],
                    this.gS[a + 13],
                    this.gS[a + 14],
                    this.gS[a + 15]
                  )
                );
            }
          },
          Target = function r(n) {
            (this.nodeID = n.node !== void 0 ? n.node : null),
              (this.path = n.path),
              (this.extensions = n.extensions !== void 0 ? n.extensions : null),
              (this.CP = n.CP !== void 0 ? n.CP : null);
          },
          Channel = function r(n, i) {
            (this.sampler = i.samplers[n.sampler]),
              (this.target = new Target(n.target)),
              (this.extensions = n.extensions !== void 0 ? n.extensions : null),
              (this.CP = n.CP !== void 0 ? n.CP : null);
          },
          AnimationSampler = function r(n, i) {
            (this.input = n.accessors[i.input]),
              (this.CS = n.accessors[i.CS]),
              (this.kS = _getAccessorData(this.input)),
              (this.zS = _getAccessorData(this.CS)),
              (this.PS = i.PS !== void 0 ? i.PS : "LINEAR"),
              (this.extensions = i.extensions !== void 0 ? i.extensions : null),
              (this.CP = i.CP !== void 0 ? i.CP : null),
              (this.SS = 0),
              (this.MS = glMatrix.vec4.create()),
              (this._S = this.kS[this.kS.length - 1]),
              (this.IS = this._S - this.kS[0]);
          },
          animationOutputValueVec4a = glMatrix.vec4.create(),
          animationOutputValueVec4b = glMatrix.vec4.create();
        AnimationSampler.prototype.jf = function (r) {
          r > this._S &&
            ((r -= this.IS * Math.ceil((r - this._S) / this.IS)),
            (this.SS = 0));
          for (
            var n = this.kS.length;
            this.SS <= n - 2 && r >= this.kS[this.SS + 1];

          )
            this.SS++;
          this.SS >= n - 1 && ((r -= this.IS), (this.SS = 0));
          for (
            var i = Type2NumOfComponent[this.CS.type],
              s = i === 4 ? glMatrix.quat.lb : glMatrix.vec4.Ia,
              a = this.SS,
              o = a * i,
              l = o + i,
              u = Math.max(0, r - this.kS[a]) / (this.kS[a + 1] - this.kS[a]),
              f = 0;
            f < i;
            f++
          )
            (animationOutputValueVec4a[f] = this.zS[o + f]),
              (animationOutputValueVec4b[f] = this.zS[l + f]);
          switch (this.PS) {
            case "LINEAR":
              s(
                this.MS,
                animationOutputValueVec4a,
                animationOutputValueVec4b,
                u
              );
              break;
          }
        };
        var Animation = function r(n, i) {
            this.name = i.name !== void 0 ? i.name : null;
            var s, a;
            for (this.samplers = [], s = 0, a = i.samplers.length; s < a; s++)
              this.samplers[s] = new AnimationSampler(n, i.samplers[s]);
            for (this.ic = [], s = 0, a = i.ic.length; s < a; s++)
              this.ic[s] = new Channel(i.ic[s], this);
            (this.extensions = i.extensions !== void 0 ? i.extensions : null),
              (this.CP = i.CP !== void 0 ? i.CP : null);
          },
          glTFModel = function r(n) {
            (this.json = n),
              (this.VS = n.scene !== void 0 ? n.scene : 0),
              (this.version = Number(n.asset.version)),
              n.accessors && (this.accessors = new Array(n.accessors.length)),
              n.bufferViews &&
                (this.bufferViews = new Array(n.bufferViews.length)),
              n.scenes && (this.scenes = new Array(n.scenes.length)),
              n.nodes && (this.nodes = new Array(n.nodes.length)),
              n.meshes && (this.meshes = new Array(n.meshes.length)),
              n.materials && (this.materials = new Array(n.materials.length)),
              n.textures && (this.textures = new Array(n.textures.length)),
              n.samplers && (this.samplers = new Array(n.samplers.length)),
              n.images && (this.images = new Array(n.images.length)),
              n.WP && (this.WP = new Array(n.WP.length)),
              n.DS && (this.DS = new Array(n.DS.length)),
              n.cameras && (this.cameras = new Array(n.cameras.length)),
              (this.extensions = n.extensions !== void 0 ? n.extensions : null),
              (this.CP = n.CP !== void 0 ? n.CP : null);
          },
          glTFLoader = function r() {
            this.LS(), (this.TP = null), (this.AP = !1), (this.FS = null);
          };
        (glTFLoader.prototype.LS = function () {
          (this.RS = !1),
            (this.TS = 0),
            (this.OS = 0),
            (this.BS = []),
            (this.AS = {}),
            (this.WS = 0),
            (this.NS = 0),
            (this.ES = 0),
            (this.jS = 0),
            (this.US = 0),
            (this.GS = 0),
            (this.onload = null),
            (curLoader = this);
        }),
          (glTFLoader.prototype.HS = function () {
            this.TS == this.OS && this.ES == this.jS && (this.RS = !0),
              this.RS &&
                this.US == this.GS &&
                (this.qS(), this.onload(this.TP));
          }),
          (glTFLoader.prototype.QS = function (r, n, i) {
            (this.AP = !0), (this.NP = n), this.XS(r, i);
          }),
          (glTFLoader.prototype.JS = function (r) {
            var n = 0,
              i = 0;
            if (this.TP.bufferViews)
              for (n = 0, i = this.TP.bufferViews.length; n < i; n++)
                this.TP.bufferViews[n] = new BufferView(
                  this.TP.json.bufferViews[n],
                  this.BS[this.TP.json.bufferViews[n].buffer]
                );
            var s = this,
              a = function (c, h) {
                s.jS++, (s.TP.images[h] = c), s.HS();
              },
              o;
            if (r.images) {
              for (o in r.images)
                if ((s.ES++, r.images[o].uri))
                  if (r.images[o].uri.indexOf("data:") > -1) {
                    var l = r.images[o].uri;
                    _loadImage(l, o, a);
                  } else _loadImage(s.YS + r.images[o].uri, o, a);
                else if (r.images[o].bufferView !== void 0) {
                  var u = new Blob(
                      [
                        this.TP.bufferViews[this.TP.json.images[o].bufferView]
                          .data,
                      ],
                      { type: r.images[o].mimeType }
                    ),
                    f = URL.createObjectURL(u);
                  _loadImage(f, o, a);
                }
            } else s.HS();
          }),
          (glTFLoader.prototype.XS = function (r, n) {
            r.indexOf("glb") > -1 ? this.$S(r, n) : this.ZS(r, n);
          }),
          (glTFLoader.prototype.ZS = function (r, n) {
            this.LS(),
              (this.onload =
                n ||
                function (s) {
                  console.log("glTF model loaded.");
                }),
              (this.YS = _getBaseUri(r));
            var i = this;
            _loadJSON(r, function (s) {
              var a = JSON.parse(s);
              i.TP = new glTFModel(a);
              var o,
                l = function (h, p) {
                  var d = parseInt(p);
                  (i.BS[d] = h), i.OS++, i.OS === i.TS && i.JS(a);
                };
              if (a.buffers)
                for (o in a.buffers) {
                  var u = o;
                  if ((i.TS++, a.buffers[u].uri.indexOf("data:") > -1)) {
                    var f = function (h) {
                        for (
                          var p = h.split("base64,")[1],
                            d = window.atob(p),
                            m = d.length,
                            g = new Uint8Array(m),
                            v = 0;
                          v < m;
                          v++
                        )
                          g[v] = d.charCodeAt(v);
                        return g.buffer;
                      },
                      c = f(a.buffers[u].uri);
                    l(c, u);
                  } else _loadArrayBuffer(i.YS + a.buffers[u].uri, l, u);
                }
              else i.JS(a);
            });
          }),
          (glTFLoader.prototype.$S = function (r, n) {
            this.LS(),
              (this.onload =
                n ||
                function (s) {
                  console.log("glTF model loaded.");
                }),
              (this.YS = _getBaseUri(r));
            var i = this;
            _loadGlb(r, function (s) {
              var a = JSON.parse(s.content);
              debugger;
              i.TP = new glTFModel(a);
              var o,
                l = function (f, c) {
                  var h = parseInt(c);
                  (i.BS[h] = f), i.OS++, i.OS === i.TS && i.JS(a);
                };
              if (a.buffers)
                for (o in a.buffers) {
                  var u = o;
                  i.TS++, l(s.body, u);
                }
              else i.JS(a);
            });
          }),
          (glTFLoader.prototype.qS = function () {
            var r = function (p, d) {
                var m = c[p.nodeID];
                d !== null
                  ? glMatrix.mat4.mul(m, c[d.nodeID], p.matrix)
                  : glMatrix.mat4.copy(m, p.matrix);
              },
              n = function (p, d) {
                var m = c[p.nodeID],
                  g;
                d !== null ? (g = d.GP) : (g = l.kP),
                  p.mesh &&
                    ((f = p.mesh),
                    f.kP &&
                      ((p.UP = BoundingBox.SP(f.kP, m)),
                      p.children.length === 0 &&
                        (glMatrix.vec3.copy(p.GP.min, p.UP.min),
                        glMatrix.vec3.copy(p.GP.max, p.UP.max)))),
                  glMatrix.vec3.min(g.min, g.min, p.GP.min),
                  glMatrix.vec3.max(g.max, g.max, p.GP.max);
              };
            curLoader = this;
            var i, s, a, o, l, u, f;
            if (this.TP.cameras)
              for (i = 0, s = this.TP.cameras.length; i < s; i++)
                this.TP.cameras[i] = new Camera(this.TP.json.cameras[i]);
            if (this.TP.accessors)
              for (i = 0, s = this.TP.accessors.length; i < s; i++)
                this.TP.accessors[i] = new Accessor(
                  this.TP.json.accessors[i],
                  this.TP.bufferViews[this.TP.json.accessors[i].bufferView]
                );
            if (this.TP.materials)
              for (i = 0, s = this.TP.materials.length; i < s; i++)
                this.TP.materials[i] = new Material(this.TP.json.materials[i]);
            if (this.TP.samplers)
              for (i = 0, s = this.TP.samplers.length; i < s; i++)
                this.TP.samplers[i] = new Sampler(this.TP.json.samplers[i]);
            if (this.TP.textures)
              for (i = 0, s = this.TP.textures.length; i < s; i++)
                this.TP.textures[i] = new Texture(this.TP.json.textures[i]);
            for (i = 0, s = this.TP.meshes.length; i < s; i++)
              this.TP.meshes[i] = new Mesh(this.TP.json.meshes[i], i);
            for (i = 0, s = this.TP.nodes.length; i < s; i++)
              this.TP.nodes[i] = new Node(this.TP.json.nodes[i], i);
            for (i = 0, s = this.TP.nodes.length; i < s; i++)
              for (
                u = this.TP.nodes[i], a = 0, o = u.children.length;
                a < o;
                a++
              )
                u.children[a] = this.TP.nodes[u.children[a]];
            var c = new Array(this.TP.nodes.length);
            for (i = 0, s = c.length; i < s; i++) c[i] = glMatrix.mat4.create();
            for (i = 0, s = this.TP.scenes.length; i < s; i++) {
              for (
                l = this.TP.scenes[i] =
                  new Scene(this.TP, this.TP.json.scenes[i]),
                  l.kP = new BoundingBox(),
                  a = 0,
                  o = l.nodes.length;
                a < o;
                a++
              )
                (u = l.nodes[a]), u.QP(null, r, n);
              l.kP.PP();
            }
            for (a = 0, o = this.TP.nodes.length; a < o; a++)
              (u = this.TP.nodes[a]), u.GP !== null && u.GP.PP();
            if (this.TP.DS)
              for (i = 0, s = this.TP.DS.length; i < s; i++)
                this.TP.DS[i] = new Animation(this.TP, this.TP.json.DS[i]);
            var h;
            if (this.TP.json.WP)
              for (i = 0, s = this.TP.WP.length; i < s; i++)
                for (
                  this.TP.WP[i] = new Skin(this.TP, this.TP.json.WP[i], i),
                    h = this.TP.WP[i].dS,
                    a = 0,
                    o = h.length;
                  a < o;
                  a++
                )
                  h[a].KS = a;
            for (i = 0, s = this.TP.nodes.length; i < s; i++)
              (u = this.TP.nodes[i]),
                u.OP !== null &&
                  typeof u.OP == "number" &&
                  (u.OP = this.TP.WP[u.OP]);
          });
        var Type2NumOfComponent = {
            SCALAR: 1,
            VEC2: 2,
            VEC3: 3,
            VEC4: 4,
            MAT2: 4,
            MAT3: 9,
            MAT4: 16,
          },
          canvas = document.createElement("canvas"),
          context = canvas.getContext("2d"),
          __defProp$3 = Object.defineProperty,
          __getOwnPropSymbols$3 = Object.getOwnPropertySymbols,
          __hasOwnProp$3 = Object.prototype.hasOwnProperty,
          __propIsEnum$3 = Object.prototype.propertyIsEnumerable,
          __defNormalProp$3 = function (r, n, i) {
            return n in r
              ? __defProp$3(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$3 = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$3.call(n, i) && __defNormalProp$3(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$3)
              try {
                for (
                  var l = __getOwnPropSymbols$3(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$3.call(n, i) && __defNormalProp$3(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __async = function (r, n, i) {
            return new Promise(function (s, a) {
              var o = function (f) {
                  try {
                    u(i.next(f));
                  } catch (c) {
                    a(c);
                  }
                },
                l = function (f) {
                  try {
                    u(i.LA(f));
                  } catch (c) {
                    a(c);
                  }
                },
                u = function (f) {
                  return f.done
                    ? s(f.value)
                    : Promise.resolve(f.value).then(o, l);
                };
              u((i = i.apply(r, n)).next());
            });
          },
          GLTF = (function () {
            function r(i, s) {
              _classCallCheck(this, r),
                (this.nodes = []),
                (this.meshes = []),
                (this.t_ = []),
                (this.i_ = []),
                (this.materials = []),
                (this.textures = []),
                (this.accessors = []),
                (this.bufferViews = []),
                (this.samplers = []),
                (this.DS = []),
                (this.scene = {}),
                (this.n_ = {}),
                (this.url = i),
                (this.regl = s),
                (this.i_ = []);
            }
            var n = r.prototype;
            return (
              (n.e_ = function () {
                return __async(
                  this,
                  null,
                  regeneratorRuntime$1.mark(function i() {
                    var s;
                    return regeneratorRuntime$1.wrap(
                      function (a) {
                        for (;;)
                          switch ((a.prev = a.next)) {
                            case 0:
                              return (a.next = 2), this.r_();
                            case 2:
                              return (s = a.sent), a.abrupt("return", s);
                            case 4:
                            case "end":
                              return a.stop();
                          }
                      },
                      i,
                      this
                    );
                  })
                );
              }),
              (n.r_ = function () {
                return __async(
                  this,
                  null,
                  regeneratorRuntime$1.mark(function i() {
                    var s;
                    return regeneratorRuntime$1.wrap(
                      function (a) {
                        for (;;)
                          switch ((a.prev = a.next)) {
                            case 0:
                              return (
                                (s = this),
                                (a.next = 3),
                                new Promise(function (o, l) {
                                  var u = s,
                                    f = new glTFLoader();
                                  f.XS(s.url, function (c) {
                                    !c || !c.json
                                      ? l({ s_: "no gltf" })
                                      : ((u.o_ = c), u.parseData(c), o(u));
                                  });
                                })
                              );
                            case 3:
                              return a.abrupt("return", a.sent);
                            case 4:
                            case "end":
                              return a.stop();
                          }
                      },
                      i,
                      this
                    );
                  })
                );
              }),
              (n.parseData = function (i) {
                var s = i.scenes,
                  a = i.nodes,
                  o = i.json,
                  l = i.accessors;
                this.accessors = l;
                for (
                  var u = o.scene || 0, f = s[u].nodes, c = 0;
                  c < f.length;
                  c++
                ) {
                  var h = a[f[c].nodeID];
                  this.a_(h);
                }
                var p = this.u_();
                this.h_(p), this.l_();
              }),
              (n.l_ = function () {
                this.i_.sort(function (i, s) {
                  return i.parseData.f_.length - s.parseData.f_.length;
                });
              }),
              (n.a_ = function (i, s) {
                var a = glMatrix.mat4.create();
                if (
                  (i.matrix && glMatrix.mat4.multiply(a, i.matrix, a),
                  s && glMatrix.mat4.multiply(a, s, a),
                  i.mesh)
                )
                  this.t_.push({ mesh: i.mesh, finalMatrix: a });
                else if (i.children)
                  for (var o = i.children, l = o.length, u = 0; u < l; u++)
                    a ? this.a_(o[u], a) : this.a_(o[u]);
              }),
              (n.u_ = function () {
                for (var i = this.t_.length, s = {}, a = 0; a < i; a++) {
                  var o = this.t_[a],
                    l = o.mesh,
                    u = l.JP;
                  s[u] || (s[u] = { finalMatrix: [], mesh: o.mesh }),
                    s[u].finalMatrix.push(o.finalMatrix);
                }
                return s;
              }),
              (n.h_ = function (i) {
                for (var s = Object.keys(i), a = s.length, o = 0; o < a; o++)
                  for (
                    var l = s[o],
                      u = i[l],
                      f = u.mesh,
                      c = u.finalMatrix,
                      h = f.primitives,
                      p = 0;
                    p < h.length;
                    p++
                  ) {
                    var d = h[p],
                      m = d.attributes,
                      g = d.indices,
                      v = d.material,
                      y = { array: this.regl.elements() },
                      _ = { array: this.regl.buffer(), offset: 0, stride: 0 },
                      b = {
                        array: this.regl.buffer(),
                        offset: 0,
                        stride: 0,
                        HAS: 0,
                      },
                      S = { array: this.regl.buffer(), offset: 0, stride: 0 },
                      P = {
                        color: [0, 0, 0, 1],
                        texture: this.regl.texture(),
                        MRtexture: this.regl.texture(),
                        emissiveTexture: this.regl.texture(),
                        HAS_TEXTURE: 0,
                        metallicFactor: 1,
                        roughnessFactor: 1,
                      },
                      I = {};
                    if (v && v.pbrMetallicRoughness) {
                      if (
                        (v.pbrMetallicRoughness.baseColorFactor &&
                          (P.color = v.pbrMetallicRoughness.baseColorFactor),
                        v.pbrMetallicRoughness.baseColorTexture)
                      ) {
                        var F = v.pbrMetallicRoughness.baseColorTexture.index,
                          X = this.o_.textures[F],
                          W = X.source;
                        (P.texture = this.regl.texture(
                          __spreadValues$3(
                            {
                              data: W.data || W,
                              width: W.width,
                              height: W.height,
                            },
                            X.sampler
                          )
                        )),
                          (I.HAS_BASE_TEXTURE = 1);
                      }
                      if (
                        (v.pbrMetallicRoughness.roughnessFactor &&
                          (P.roughnessFactor =
                            v.pbrMetallicRoughness.roughnessFactor),
                        v.pbrMetallicRoughness.metallicFactor &&
                          (P.metallicFactor =
                            v.pbrMetallicRoughness.metallicFactor),
                        v.pbrMetallicRoughness.oS)
                      ) {
                        var Z = v.pbrMetallicRoughness.oS.index,
                          j = this.o_.textures[Z],
                          L = j.source;
                        (P.MRtexture = this.regl.texture(
                          __spreadValues$3(
                            {
                              data: L.data || L,
                              width: L.width,
                              height: L.height,
                            },
                            j.sampler
                          )
                        )),
                          (I.HAS_MR_TEXTURE = 1);
                      }
                      if (v.emissiveTexture) {
                        var T = v.emissiveTexture.index,
                          A = this.o_.textures[T],
                          $ = A.source;
                        (P.emissiveTexture = this.regl.texture(
                          __spreadValues$3(
                            {
                              data: $.data || $,
                              width: $.width,
                              height: $.height,
                            },
                            A.sampler
                          )
                        )),
                          (I.HAS_EMIS_TEXTURE = 1);
                      }
                    }
                    if (g !== void 0) {
                      var R = this.accessors[g];
                      y = formatArray(R, this.regl, "element");
                    }
                    var M = m.POSITION,
                      w = m.NORMAL,
                      O = m.TEXCOORD_0;
                    M && (_ = formatArray(m.POSITION, this.regl, "buffer")),
                      w &&
                        ((b = formatArray(m.NORMAL, this.regl, "buffer")),
                        (I.HAS_NORMAL = 1)),
                      O && (S = formatArray(m.TEXCOORD_0, this.regl, "buffer"));
                    var E = {
                      c_: this.accessors[g || 0],
                      v_: _,
                      d_: b,
                      p_: S,
                      m_: y,
                      g_: P,
                      b_: I,
                      f_: JSON.stringify(I),
                    };
                    this.i_.push({
                      parseData: E,
                      finalMatrix: c,
                      finalMatrixCount: c.length,
                    });
                  }
              }),
              r
            );
          })(),
          GLTFFusion = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.buildStyle = function (a, o) {
                for (var l = gltf.style, u = [], f = 0; f < a.length; f++)
                  if (!(!a[f].features || !a[f].features.points)) {
                    var c = a[f].features.points,
                      h = StyleInstance.parse(c, o, l);
                    u.push(h);
                  }
                return u;
              }),
              (s.fusion = function (a, o, l) {
                var u = this,
                  f = function (v, y) {
                    for (
                      var _ = u,
                        b = function (F) {
                          var X = P[F],
                            W = X.coordinates,
                            Z = X.properties,
                            j = (c = l.loca) == null ? void 0 : c.customCoords,
                            L = j.lngLatToCoord(W),
                            T = d[v].attributes,
                            A = T.rotateX,
                            $ = T.rotateY,
                            R = T.rotateZ,
                            M = T.visible,
                            w = T.height,
                            O = T.scale,
                            E = [A[F], $[F], R[F]],
                            k = M[F],
                            D = w[F],
                            q = O[F];
                          if (Z && Z.url) {
                            var J = Z.url,
                              de = new GLTF(
                                J,
                                (h = l.loca) == null ? void 0 : h.regl
                              ),
                              we = l.x_.y_(J);
                            if (we)
                              we.status === "loaded"
                                ? _.w_(
                                    we.data,
                                    {
                                      properties: Z,
                                      C_: E,
                                      k_: k,
                                      z_: D,
                                      P_: q,
                                      position: L,
                                      coordinates: W,
                                    },
                                    l
                                  )
                                : (l.S_[J] || (l.S_[J] = []),
                                  l.S_[J].push({
                                    style: {
                                      properties: Z,
                                      C_: E,
                                      k_: k,
                                      z_: D,
                                      P_: q,
                                      position: L,
                                      coordinates: W,
                                    },
                                  }));
                            else {
                              var Se = _;
                              l.x_.M_(J),
                                de.e_().then(function (He) {
                                  if (
                                    (l.x_.__(J, He),
                                    Se.w_(
                                      He,
                                      {
                                        properties: Z,
                                        C_: E,
                                        k_: k,
                                        z_: D,
                                        P_: q,
                                        position: L,
                                        coordinates: W,
                                      },
                                      l
                                    ),
                                    l.S_[J] && l.S_[J].length > 0)
                                  )
                                    for (var et = l.S_[J].length; et > 0; et--)
                                      Se.w_(He, l.S_[J][et - 1].style, l),
                                        l.S_[J].pop();
                                });
                            }
                          }
                        },
                        S = a[v],
                        P = S.features.points,
                        I = 0;
                      I < P.length;
                      I++
                    )
                      b(I);
                    p[v] = {
                      id: S.id,
                      attributes: {},
                      uniforms: {},
                      si: {},
                      mf: {},
                      status: "buffered",
                    };
                  },
                  c,
                  h;
                if (!this.regl || !l.loca) return [];
                for (
                  var p = [], d = this.buildStyle(a, o), m = 0, g = a.length;
                  m < g;
                  m++
                )
                  f(m);
                return p;
              }),
              (s.w_ = function (a, o, l) {
                var u = o.C_,
                  f = o.k_,
                  c = o.z_,
                  h = o.P_,
                  p = o.position,
                  d = o.coordinates,
                  m = o.properties,
                  g = JSON.parse(JSON.stringify(a.o_.scenes[0].kP || {}));
                (g.scale = h),
                  (g.height = c),
                  (g.position = { lnglat: d, locaPos: p });
                for (var v = a.i_, y = [], _ = 0; _ < v.length; _++) {
                  var b = v[_],
                    S = {
                      id: _.toString(),
                      status: "buffered",
                      attributes: { Iw: b, I_: p, C_: u, k_: f, z_: c, P_: h },
                      uniforms: { color: [1, 0, 0, 1] },
                      si: {},
                    };
                  y.push(S);
                }
                l.V_.push({ sceneBBox: g, meshes: y, D_: m.url }),
                  this.L_(l),
                  l.loca.requestRender();
              }),
              (s.L_ = function (a) {
                for (var o, l = {}, u = 0; u < a.V_.length; u++) {
                  var f = a.V_[u],
                    c = f.D_,
                    h = f.sceneBBox,
                    p = f.meshes,
                    d = h.position.locaPos,
                    m = h.height;
                  l[c] || (l[c] = { F_: p, position: [] }),
                    l[c].position.push([d[0], d[1], m]),
                    (l[c].sceneBBox = h);
                }
                for (var g in l)
                  l[g].positionBuffer =
                    (o = a.loca) == null
                      ? void 0
                      : o.regl.buffer(
                          l[g].position.map(function (v) {
                            return v;
                          })
                        );
                a.R_ = l;
              }),
              (s.DC = function () {}),
              (s.EC = function () {
                return [];
              }),
              (s.destroy = function () {
                this.regl = null;
              }),
              i
            );
          })(GeometryFusion),
          __defProp$2 = Object.defineProperty,
          __getOwnPropSymbols$2 = Object.getOwnPropertySymbols,
          __hasOwnProp$2 = Object.prototype.hasOwnProperty,
          __propIsEnum$2 = Object.prototype.propertyIsEnumerable,
          __defNormalProp$2 = function (r, n, i) {
            return n in r
              ? __defProp$2(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$2 = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$2.call(n, i) && __defNormalProp$2(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$2)
              try {
                for (
                  var l = __getOwnPropSymbols$2(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$2.call(n, i) && __defNormalProp$2(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          GLTFShader = {
            vertex:
              "\n        precision mediump float;\n        attribute vec3 model_pos;\n        \n        #ifdef HAS_BASE_TEXTURE\n            attribute vec2 uvs;\n            varying vec2 vUv;\n        #endif\n\n        attribute vec3 normal_pos;\n        // attribute mat4 model_matrix;\n        uniform mat4 model_matrix;\n\n\n        varying vec3 vNormal;\n        varying vec3 vPosition;\n\n\n        uniform mat4 mvp;\n        uniform mat4 rotateMatrix;\n        // uniform vec3 point_pos;\n        attribute vec3 point_pos;\n\n        void main () {\n\n            #ifdef HAS_BASE_TEXTURE\n                vUv = uvs;\n            #endif\n\n            vNormal = normalize(normal_pos.xzy);\n            vec4 tmpPos = rotateMatrix * model_matrix * vec4(model_pos.xyz,1.);\n            \n            // vPosition \u5C40\u90E8\u58A8\u5361\u6258\u5750\u6807\n            vPosition = vec3(tmpPos.xy + point_pos.xy, tmpPos.z + point_pos.z);\n\n            vec4 pos =  mvp * vec4(tmpPos.xy + point_pos.xy, tmpPos.z + point_pos.z,1);\n            gl_Position = pos;\n\n        }\n    ",
            fragment:
              "\n            precision mediump float;\n            // precision highp float;\n\n            uniform vec4 model_texture_color;\n            uniform sampler2D texture; \n\n            uniform sampler2D MRtexture; \n\n            uniform sampler2D emissiveTexture; \n\n            uniform float roughnessFactor;\n            uniform float metallicFactor;\n\n            // uniform float ambIntensity;\n\n                \n            uniform vec3 lightDir;\n            #ifdef HAS_BASE_TEXTURE\n                varying vec2 vUv;\n            #endif\n\n            varying vec3 vNormal;\n            varying vec3 vPosition;\n\n            // uniform float shininess;\n\n            const float c_MinRoughness = 0.04;\n\n            struct PBRInfo\n            {\n                float NdotL;                  // cos angle between normal and light direction\n                float NdotV;                  // cos angle between normal and view direction\n                float NdotH;                  // cos angle between normal and half vector\n                float LdotH;                  // cos angle between light direction and half vector\n                float VdotH;                  // cos angle between view direction and half vector\n                float perceptualRoughness;    // roughness value, as authored by the model creator (input to shader)\n                float metalness;              // metallic value at the surface\n                vec3 reflectance0;            // full reflectance color (normal incidence angle)\n                vec3 reflectance90;           // reflectance color at grazing angle\n                float alphaRoughness;         // roughness mapped to a more linear change in the roughness (proposed by [2])\n                vec3 diffuseColor;            // color contribution from diffuse lighting\n                vec3 specularColor;           // color contribution from specular lighting\n            };\n\n            uniform vec3 cameraPosition;\n            uniform float shininess;\n            #include <lightUniforms>;\n\n            // vec3 lightDir = normalize(lightPosition - position);\n            // vec3 cameraDirection = normalize(cameraPosition - position);\n\n\n            const float PI = 3.14159265359;\n            const float M_PI = 3.141592653589793;\n\n\n\n            // http://chilliant.blogspot.com/2012/08/srgb-approximations-for-hlsl.html\n            vec3 linearTosRGB(vec3 color)\n            {\n                const float GAMMA = 2.2;\n                const float INV_GAMMA = 1.0 / GAMMA;    \n                return pow(color, vec3(INV_GAMMA));\n            }\n\n            float DistributionGGX(vec3 N, vec3 H, float roughness)\n            {\n                float a = roughness * roughness;\n                float a2 = a * a;\n                float NdotH = max(dot(N, H), 0.0);\n                float NdotH2 = NdotH * NdotH;\n\n                float nom = a2;\n                float denom = (NdotH2 * (a2 - 1.0) + 1.0);\n                denom = PI * denom * denom;\n\n                return nom / max(denom, 0.001);\n            }\n            float GeometrySchlickGGX(float NdotV, float roughness)\n            {\n                float r = (roughness + 1.0);\n                float k = (r*r) / 8.0;\n\n                float nom   = NdotV;\n                float denom = NdotV * (1.0 - k) + k;\n\n                return nom / denom;\n            }\n            float GeometrySmith(vec3 N, vec3 V, vec3 L, float roughness)\n            {\n                float NdotV = max(dot(N, V), 0.0);\n                float NdotL = max(dot(N, L), 0.0);\n                float ggx2 = GeometrySchlickGGX(NdotV, roughness);\n                float ggx1 = GeometrySchlickGGX(NdotL, roughness);\n\n                return ggx1 * ggx2;\n            }\n            vec3 fresnelSchlick(float cosTheta, vec3 F0)\n            {\n                return F0 + (1.0 - F0) * pow(1.0 - cosTheta, 5.0);\n            }\n\n            vec3 specularReflection(PBRInfo pbrInputs)\n            {\n                return pbrInputs.reflectance0 + (pbrInputs.reflectance90 - pbrInputs.reflectance0) * pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n            }\n\n            float visibilityOcclusion(PBRInfo pbrInputs)\n            {\n                float NdotL = pbrInputs.NdotL;\n                float NdotV = pbrInputs.NdotV;\n                float alphaRoughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n\n                float GGXV = NdotL * sqrt(NdotV * NdotV * (1.0 - alphaRoughnessSq) + alphaRoughnessSq);\n                float GGXL = NdotV * sqrt(NdotL * NdotL * (1.0 - alphaRoughnessSq) + alphaRoughnessSq);\n                return 0.5 / (GGXV + GGXL);\n            }\n\n            float microfacetDistribution(PBRInfo pbrInputs)\n            {\n                float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n                float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n                return roughnessSq / (M_PI * f * f);\n            }\n            vec3 diffuse(PBRInfo pbrInputs)\n            {\n                return pbrInputs.diffuseColor / M_PI;\n            }\n\n            vec3 gammaCorrection(vec3 color) {\n                return pow(color, vec3(1.0 / 2.2));\n            }\n\n\n           \n\n\n            void main () {\n                // \u57FA\u8272\n                vec4 baseColor = model_texture_color;\n\n                #ifdef HAS_BASE_TEXTURE\n                    baseColor = texture2D(texture, vUv);\n                #endif\n\n                // \u8BA1\u7B97 \u7C97\u7CD9\u5EA6 \u548C \u91D1\u5C5E\u5EA6\n           \n                float perceptualRoughness = roughnessFactor;\n                float metallic = metallicFactor;\n\n                #ifdef HAS_MR_TEXTURE\n                    vec4 MRtextureColor = texture2D(MRtexture, vUv);\n                    perceptualRoughness = MRtextureColor.g;\n                    metallic = MRtextureColor.b;\n                #endif\n \n                // c_MinRoughness = 0.04 \u7ECF\u9A8C\u503C\n                perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n                metallic = clamp(metallic, 0.0, 1.0);\n                float alphaRoughness = perceptualRoughness * perceptualRoughness;\n                \n\n                vec3 f0 = vec3(0.04);\n                vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n                diffuseColor *= 1.0 - metallic;\n                vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n\n                // \u8BA1\u7B97\u53CD\u5C04\u7387 reflectance.\n                float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n                float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n                vec3 specularEnvironmentR0 = specularColor.rgb;\n                vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n                vec3 n = normalize(vNormal);\n                vec3 v = normalize(cameraPosition - vPosition);  \n                // vec3 l = normalize(u_LightDirection);             \n                // Vector from surface point to light\n\n                // \u70B9\u3001\u5E73\u884C\u5149\u3001\u73AF\u5883\u5149\n                // vec3 color = baseColor.rgb;\n                vec3 color = vec3(0.0);\n\n\n                vec3 diffuseContrib = vec3(0.0);\n                vec3 specContrib = vec3(0.0);\n\n                for (int i = 0; i < NUMBER_OF_POINT_LIGHTS; i++) {\n                    PointLight pointLight = pointLights[i];\n                    // vec3 lightPosition = vec3(1.,1.,100.);\n                    vec3 l = normalize(pointLight.position - vPosition);\n\n                    // \u8BA1\u7B97\u534A\u89D2\u5411\u91CF h \n                    vec3 h = normalize(l + v);                         \n                    vec3 reflection = -normalize(reflect(v, n));\n\n                    float NdotL = clamp(dot(n, l), 0.001, 1.0);\n                    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n                    float NdotH = clamp(dot(n, h), 0.0, 1.0);\n                    float LdotH = clamp(dot(l, h), 0.0, 1.0);\n                    float VdotH = clamp(dot(v, h), 0.0, 1.0);\n\n                    PBRInfo pbrInputs = PBRInfo(\n                        NdotL,\n                        NdotV,\n                        NdotH,\n                        LdotH,\n                        VdotH,\n                        perceptualRoughness,\n                        metallic,\n                        specularEnvironmentR0,\n                        specularEnvironmentR90,\n                        alphaRoughness,\n                        diffuseColor,\n                        specularColor\n                    );\n\n                    vec3 F = specularReflection(pbrInputs);\n                    float Vis = visibilityOcclusion(pbrInputs);\n                    float D = microfacetDistribution(pbrInputs);\n\n                    // Calculation of analytical lighting contribution\n                    diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n                    specContrib = F * Vis * D;\n\n\n                    // vec3 lightColor = vec3(1.,0.,1.);\n\n\n                    color =  NdotL * pointLight.lightColor * (diffuseContrib + specContrib);\n\n                }\n\n\n                // color = mix(color, baseColor.rgb, 1.);\n\n                // \u574F\u5883\u5149\n                // vec4 ambLightColor = vec4(1.,1.,1.,1.);\n\n                // float ambintensityFactor = 0.6;\n                // if(ambIntensity) {\n                //     ambintensityFactor = ambIntensity;\n                // }\n\n\n                vec4 amb = vec4(ambientLight.lightColor, 1.) * baseColor * ambientLight.intensity;\n\n                gl_FragColor = amb + vec4(gammaCorrection(color), baseColor.a);\n                // gl_FragColor = baseColor;\n\n\n                return;\n\n              \n            }\n        ",
            includes: __spreadValues$2({}, LightIncludes),
          },
          __defProp$1 = Object.defineProperty,
          __defProps = Object.defineProperties,
          __getOwnPropDescs = Object.getOwnPropertyDescriptors,
          __getOwnPropSymbols$1 = Object.getOwnPropertySymbols,
          __hasOwnProp$1 = Object.prototype.hasOwnProperty,
          __propIsEnum$1 = Object.prototype.propertyIsEnumerable,
          __defNormalProp$1 = function (r, n, i) {
            return n in r
              ? __defProp$1(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues$1 = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp$1.call(n, i) && __defNormalProp$1(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols$1)
              try {
                for (
                  var l = __getOwnPropSymbols$1(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum$1.call(n, i) && __defNormalProp$1(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          __spreadProps = function (r, n) {
            return __defProps(r, __getOwnPropDescs(n));
          },
          __objRest = function (r, n) {
            var i = {};
            for (var s in r)
              __hasOwnProp$1.call(r, s) && n.indexOf(s) < 0 && (i[s] = r[s]);
            var a = !0,
              o = !1,
              l = void 0;
            if (r != null && __getOwnPropSymbols$1)
              try {
                for (
                  var u = __getOwnPropSymbols$1(r)[Symbol.iterator](), f;
                  !(a = (f = u.next()).done);
                  a = !0
                ) {
                  var s = f.value;
                  n.indexOf(s) < 0 &&
                    __propIsEnum$1.call(r, s) &&
                    (i[s] = r[s]);
                }
              } catch (c) {
                (o = !0), (l = c);
              } finally {
                try {
                  !a && u.return != null && u.return();
                } finally {
                  if (o) throw l;
                }
              }
            return i;
          },
          GLTFRender = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.m$ = function (a) {
                if (!this.regl) return !1;
                for (
                  var o = this.regl,
                    l = RenderHelper._A(a, o),
                    u = a,
                    f = u.GLTF_PARAMS,
                    c = __objRest(u, ["GLTF_PARAMS"]),
                    h = 0;
                  h < f.length;
                  h++
                )
                  this.gA(
                    GLTFShader,
                    __spreadValues$1(__spreadValues$1({}, f[h]), c),
                    {
                      attributes: {
                        model_pos: o.prop("model_pos"),
                        uvs: o.prop("model_uvs"),
                        normal_pos: o.prop("normal_pos"),
                        point_pos: o.prop("point_pos"),
                      },
                      uniforms: __spreadValues$1(
                        {
                          mvp: o.prop("mvp"),
                          rotateMatrix: o.prop("rotateMatrix"),
                          shininess: o.prop("shininess"),
                          cameraPosition: o.prop("cameraPosition"),
                          texture: o.prop("model_texture"),
                          MRtexture: o.prop("model_MRtexture"),
                          emissiveTexture: o.prop("model_emissiveTexture"),
                          lightColor: [1, 1, 1],
                          lightDir: [1, 1, 1],
                          HAS_TEXTURE: o.prop("HAS_TEXTURE"),
                          metallicFactor: o.prop("metallicFactor"),
                          roughnessFactor: o.prop("roughnessFactor"),
                          model_texture_color: o.prop("model_texture_color"),
                          model_matrix: o.prop("model_matrix"),
                        },
                        l
                      ),
                      elements: o.prop("element"),
                      blend: {
                        enable: !0,
                        func: RenderUtil.getBlend("normal"),
                      },
                      cull: { enable: !0 },
                      instances: o.prop("instances_count"),
                    },
                    h
                  );
              }),
              (s.render = function (a) {
                var o = a.B_,
                  l = a.mvp,
                  u = a.cameraPosition,
                  f = a.lights;
                if (this.regl)
                  for (var c = Object.keys(o), h = c.length, p = 0; p < h; p++)
                    for (var d = o[c[p]].F_, m = d.length, g = 0; g < m; g++) {
                      var v = d[g],
                        y = v.attributes,
                        _ = y.C_,
                        b = y.P_,
                        S = y.Iw,
                        P = S.finalMatrix,
                        I = S.parseData,
                        F = I.v_,
                        X = I.m_,
                        W = I.p_,
                        Z = I.g_,
                        j = I.d_;
                      I.b_;
                      var L = glMatrix.mat4.create();
                      if (_ && _[0]) {
                        var T = (_[0] * Math.PI) / 180;
                        glMatrix.mat4.rotateX(L, L, T);
                      }
                      if (_ && _[1]) {
                        var A = (_[1] * Math.PI) / 180;
                        glMatrix.mat4.rotateY(L, L, A);
                      }
                      if (_ && _[2]) {
                        var $ = (_[2] * Math.PI) / 180;
                        glMatrix.mat4.rotateZ(L, L, $);
                      }
                      b && glMatrix.mat4.scale(L, L, b);
                      var R = o[c[p]].position.length;
                      y = {
                        model_pos: {
                          buffer: F.array,
                          offset: F.offset,
                          divisor: 0,
                          stride: F.stride,
                        },
                        model_uvs: {
                          buffer: W.array,
                          offset: W.offset,
                          divisor: 0,
                          stride: W.stride,
                        },
                        normal_pos: {
                          buffer: j.array,
                          offset: j.offset,
                          divisor: 0,
                          stride: j.stride,
                        },
                        model_texture: Z.texture,
                        model_MRtexture: Z.MRtexture,
                        model_emissiveTexture: Z.emissiveTexture,
                        model_texture_color: Z.color,
                        point_pos: {
                          buffer: o[c[p]].positionBuffer,
                          divisor: 1,
                        },
                        element: X.array,
                        rotateMatrix: L,
                        roughnessFactor: Z.roughnessFactor,
                        metallicFactor: Z.metallicFactor,
                        instances_count: R,
                      };
                      var M = this.yA(GLTFShader, h * p + g);
                      if (!M)
                        throw new Error(
                          "Missing shader cmd at ".concat(p, " ").concat(g)
                        );
                      for (var w = 0; w < P.length; w++)
                        (y.model_matrix = P[w]),
                          M(
                            __spreadProps(
                              __spreadValues$1(
                                __spreadProps(__spreadValues$1({}, y), {
                                  isPick: !1,
                                  mvp: l,
                                  cameraPosition: u,
                                }),
                                f
                              ),
                              {
                                acceptLight: !0,
                                shininess: 5,
                                HAS_TEXTURE: Z.HAS_TEXTURE,
                              }
                            )
                          );
                    }
              }),
              (s.pickRender = function (a) {}),
              i
            );
          })(Render),
          ModelCache = (function () {
            function r(i) {
              _classCallCheck(this, r),
                (this.N_ = []),
                (this.E_ = 6),
                (this.N_ = []),
                i && i.E_ && (this.E_ = i.E_);
            }
            var n = r.prototype;
            return (
              (n.M_ = function (i) {
                var s = this.N_.length;
                s >= this.E_ && this.N_.splice(0, 1),
                  this.N_.push({ key: i, status: "loading" });
              }),
              (n.__ = function (i, s) {
                var a = this.y_(i);
                (a.status = "loaded"), (a.data = s);
              }),
              (n.y_ = function (i) {
                for (var s = this.N_.length, a = 0; a < s; a++) {
                  var o = this.N_[a];
                  if (o.key === i) return o;
                }
                return !1;
              }),
              r
            );
          })(),
          GLTFLayer = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              return (
                (o = n.call(this, a)),
                (o.CLASS_NAME = "GLTF"),
                (o.fusion = new GLTFFusion()),
                (o.ll = new GLTFRender()),
                (o.j_ = {}),
                (o.V_ = []),
                (o.R_ = {}),
                (o.S_ = {}),
                (o.acceptLight = !0),
                o.AC(a),
                (o.x_ = new ModelCache()),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.setStyle = function (a) {
                _get(_getPrototypeOf(i.prototype), "setStyle", this).call(
                  this,
                  a
                ),
                  (this.dataset = this.source.LC()),
                  this.dataset &&
                    this.dataset.length > 0 &&
                    this.meshes &&
                    this.loca &&
                    this.loca.requestRender();
              }),
              (s.buildStyle = function (a, o) {
                for (var l = gltf.style, u = [], f = 0; f < a.length; f++)
                  if (!(!a[f].features || !a[f].features.points)) {
                    var c = a[f].features.points,
                      h = StyleInstance.parse(c, o, l);
                    u.push(h);
                  }
                return u;
              }),
              (s.receiveDataset = function (a) {
                (this.V_ = []),
                  (this.R_ = {}),
                  (this.dataset = a),
                  this.setStyle(this.styleOptions),
                  this.onAdd();
              }),
              (s.jC = function () {
                _get(_getPrototypeOf(i.prototype), "jC", this).call(this),
                  !(!this.loca || !this.loca.regl || this.ll.regl) &&
                    ((this.ll.regl = this.loca.regl),
                    this.loca.rendererManager.addRenderer(this.ll));
              }),
              (s.beforeRender = function () {
                if (
                  (_get(
                    _getPrototypeOf(i.prototype),
                    "beforeRender",
                    this
                  ).call(this),
                  !this.fusion.regl &&
                    this.loca &&
                    ((this.fusion.regl = this.loca.regl),
                    this.loca.fusionManager.addFusion(this.fusion)),
                  this.jC(),
                  this.source && (this.dataset = this.source.LC()),
                  this.fusion)
                ) {
                  var a = this.WC(),
                    o = a.willFusion,
                    l = a.didFusion,
                    u = this.fusion.EC();
                  if (
                    (this.styleOptions.unit === "px"
                      ? (this.meshes = u || [])
                      : (this.meshes = l || []),
                    o.length > 0)
                  ) {
                    var f = this.fusion.fusion(o, this.styleOptions, this);
                    this.meshes = f;
                  }
                }
              }),
              (s.U_ = function (a, o, l) {
                var u = a.min,
                  f = a.max,
                  c = a.scale;
                c || (c = [1, 1, 1]);
                var h = [u[0] * c[0] + o[0], f[0] * c[0] + o[0]].sort(),
                  p = [u[1] * c[1] + o[1], f[1] * c[1] + o[1]].sort(),
                  d = [l[0][0], l[1][0]].sort(),
                  m = [l[0][1], l[1][1]].sort();
                return h[0] > d[0] && h[1] < d[1] && p[0] > m[0] && p[1] < m[1];
              }),
              (s.G_ = function () {
                if (!this.loca) return {};
                for (
                  var a = this.loca.map.getBounds(),
                    o = this.loca.customCoords.lngLatToCoord(
                      a.northEast.toArray()
                    ),
                    l = this.loca.customCoords.lngLatToCoord(
                      a.southWest.toArray()
                    ),
                    u = Object.keys(this.R_),
                    f = 0;
                  f < u.length;
                  f++
                ) {
                  for (
                    var c = u[f],
                      h = this.R_[c],
                      p = h.position,
                      d = h.sceneBBox,
                      m = !1,
                      g = 0;
                    g < p.length;
                    g++
                  ) {
                    var v = this.U_(d, p[g], [o, l]);
                    if (v) {
                      m = !0;
                      break;
                    }
                  }
                  this.R_[c].isinmap = m;
                }
                return this.R_;
              }),
              (s.render = function () {
                var a, o;
                if (!!this.loca && !!this.PA()) {
                  this.loca.regl._refresh();
                  var l =
                      (a = this.loca) == null
                        ? void 0
                        : a.customCoords.getMVPMatrix(),
                    u = RenderHelper.IA(this.loca.lights);
                  this.ll &&
                    this.V_ &&
                    this.V_.length > 0 &&
                    this.ll.render({
                      B_: this.R_,
                      cameraPosition:
                        (o = this.loca) == null
                          ? void 0
                          : o.customCoords.getCameraParams().position,
                      mvp: l,
                      lights: u,
                    });
                }
              }),
              (s.pickRender = function () {}),
              (s.afterRender = function () {}),
              (s.destroy = function () {
                _get(_getPrototypeOf(i.prototype), "destroy", this).call(this);
              }),
              (s.PA = function () {
                var a = this;
                return (
                  (this.R_ = this.G_()),
                  RenderHelper.SA(this.ll, this, function (o) {
                    switch (o) {
                      case "onFirstRendering":
                        {
                          var l = a.R_,
                            u = a.vA;
                          u.GLTF_PARAMS = [];
                          for (
                            var f = Object.keys(l), c = f.length, h = 0;
                            h < c;
                            h++
                          )
                            for (
                              var p = l[f[h]].F_, d = p.length, m = 0;
                              m < d;
                              m++
                            ) {
                              var g = p[m],
                                v = g.attributes,
                                y = v.Iw,
                                _ = y.parseData,
                                b = _.b_;
                              u.GLTF_PARAMS.push(b);
                            }
                        }
                        break;
                      case "light":
                        RenderHelper.MA(a.vA, a.loca.lights);
                        break;
                    }
                  })
                );
              }),
              i
            );
          })(Layer),
          __defProp = Object.defineProperty,
          __getOwnPropSymbols = Object.getOwnPropertySymbols,
          __hasOwnProp = Object.prototype.hasOwnProperty,
          __propIsEnum = Object.prototype.propertyIsEnumerable,
          __defNormalProp = function (r, n, i) {
            return n in r
              ? __defProp(r, n, { Fr: !0, Lr: !0, writable: !0, value: i })
              : (r[n] = i);
          },
          __spreadValues = function (r, n) {
            for (var i in n || (n = {}))
              __hasOwnProp.call(n, i) && __defNormalProp(r, i, n[i]);
            var s = !0,
              a = !1,
              o = void 0;
            if (__getOwnPropSymbols)
              try {
                for (
                  var l = __getOwnPropSymbols(n)[Symbol.iterator](), u;
                  !(s = (u = l.next()).done);
                  s = !0
                ) {
                  var i = u.value;
                  __propIsEnum.call(n, i) && __defNormalProp(r, i, n[i]);
                }
              } catch (f) {
                (a = !0), (o = f);
              } finally {
                try {
                  !s && l.return != null && l.return();
                } finally {
                  if (a) throw o;
                }
              }
            return r;
          },
          pushArray = CommonUtil$1._C,
          LabelsFusion = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              return _classCallCheck(this, i), n.apply(this, arguments);
            }
            var s = i.prototype;
            return (
              (s.DC = function () {}),
              (s.buildStyle = function (a, o) {
                for (var l, u = labels.style, f = [], c = 0; c < a.length; c++)
                  if (!(!a[c].features || !a[c].features.points)) {
                    for (
                      var h = a[c].features.points,
                        p = StyleInstance.parse(h, o, u),
                        d = {},
                        m = 0;
                      m < h.length;
                      m++
                    )
                      if (p)
                        for (var g in p.attributes) {
                          var v = p.attributes[g];
                          d[g] || (d[g] = []),
                            ((l = v[m]) == null ? void 0 : l.length) > 0
                              ? pushArray(d[g], v[m])
                              : (d[g][d[g].length] = v[m]);
                        }
                    f.push({ attributes: d, uniforms: p.uniforms, si: p.si });
                  }
                return f;
              }),
              (s.fusion = function (a, o, l) {
                if (!l.loca) return [];
                for (
                  var u = this.buildStyle(a, o), f = [], c = 0, h = a.length;
                  c < h;
                  c++
                ) {
                  var p = a[c];
                  if (!(!p.features || !p.features.points)) {
                    for (
                      var d = u[c].attributes,
                        m = p.features.points,
                        g = { labels: [] },
                        v = 0;
                      v < m.length;
                      v++
                    ) {
                      var y = m[v],
                        _ = y.coordinates;
                      if (y.type === "MultiPoint") {
                        if (d.label[v])
                          for (var b = 0, S = _.length; b < S; b++) {
                            var P = _[b];
                            g.labels.push(
                              __spreadValues({ position: P }, d.label[v])
                            );
                          }
                      } else
                        d.label[v] &&
                          g.labels.push(
                            __spreadValues({ position: _ }, d.label[v])
                          );
                    }
                    f[c] = {
                      id: p.id,
                      attributes: {},
                      uniforms: {},
                      si: {},
                      mf: { labels: g.labels },
                    };
                  }
                }
                return f;
              }),
              (s.updateStyle = function (a, o) {
                for (var l = 0, u = a.length; l < u; l++)
                  for (
                    var f = a[l],
                      c = o[l].attributes,
                      h = c.label,
                      p = f.mf.labels,
                      d = 0;
                    d < p.length;
                    d++
                  )
                    p[d] = __spreadValues(__spreadValues({}, p[d]), h[d]);
              }),
              (s.EC = function () {
                return [];
              }),
              i
            );
          })(GeometryFusion),
          LabelsRender = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i() {
              _classCallCheck(this, i);
              var a;
              return (
                (a = n.call.apply(
                  n,
                  [this].concat(Array.prototype.slice.call(arguments))
                )),
                (a.v$ = [new LabelsRender$1()]),
                a
              );
            }
            var s = i.prototype;
            return (
              (s.m$ = function (a) {
                this.v$.forEach(function (o) {
                  return o.m$(a);
                });
              }),
              (s.render = function (a) {
                for (var o = a.meshes, l = 0; l < o.length; l++) {
                  var u = !0,
                    f = !1,
                    c = void 0;
                  try {
                    for (
                      var h = this.v$[Symbol.iterator](), p;
                      !(u = (p = h.next()).done);
                      u = !0
                    ) {
                      var d = p.value;
                      d.render(o[l]);
                    }
                  } catch (m) {
                    (f = !0), (c = m);
                  } finally {
                    try {
                      !u && h.return != null && h.return();
                    } finally {
                      if (f) throw c;
                    }
                  }
                }
              }),
              (s.pickRender = function (a) {}),
              i
            );
          })(Render),
          LabelsLayer = (function (r) {
            _inherits(i, r);
            var n = _createSuper(i);
            function i(a) {
              _classCallCheck(this, i);
              var o;
              (o = n.call(this, a)),
                (o.CLASS_NAME = "Labels"),
                (o.fusion = new LabelsFusion()),
                (o.ll = new LabelsRender());
              var l = labels.Sw;
              return (
                (o.zooms = a.zooms === void 0 ? l.zooms : a.zooms),
                (o.visible = a.visible === void 0 ? l.visible : a.visible),
                (o.zIndex = a.zIndex === void 0 ? l.zIndex : a.zIndex),
                (o.opacity = a.opacity === void 0 ? l.opacity : a.opacity),
                (o.z$ = a.z$ === void 0 ? l.z$ : a.z$),
                (o.A$ = a.A$ === void 0 ? l.A$ : a.A$),
                o.AC({}),
                o.buryPoint.record(o.CLASS_NAME),
                o
              );
            }
            var s = i.prototype;
            return (
              (s.setStyle = function (a) {
                if (
                  (_get(_getPrototypeOf(i.prototype), "setStyle", this).call(
                    this,
                    a
                  ),
                  (this.dataset = this.source.LC()),
                  this.dataset && this.dataset.length > 0)
                ) {
                  var o = this.WC(),
                    l = o.didFusion,
                    u = this.fusion.buildStyle(this.dataset, this.styleOptions);
                  this.fusion.updateStyle(l, u), (this.vA.state |= MeshDirty);
                }
                this.loca && this.loca.requestRender();
              }),
              (s.receiveDataset = function (a) {
                (this.dataset = a),
                  this.setStyle(this.styleOptions),
                  this.onAdd();
              }),
              (s.beforeRender = function () {
                if (
                  (_get(
                    _getPrototypeOf(i.prototype),
                    "beforeRender",
                    this
                  ).call(this),
                  this.loca && this.loca.fusionManager.addFusion(this.fusion),
                  this.source && (this.dataset = this.source.LC()),
                  this.fusion)
                ) {
                  var a = this.WC(),
                    o = a.willFusion;
                  if (o.length > 0) {
                    var l = this.fusion.fusion(o, this.styleOptions, this);
                    (this.meshes = l), (this.vA.state |= MeshesDirty);
                  }
                }
              }),
              (s.render = function () {
                var a;
                if (!!this.loca && !!this.PA()) {
                  var o =
                    (a = this.loca) == null
                      ? void 0
                      : a.customCoords.getMVPMatrix();
                  this.ll &&
                    this.meshes.length > 0 &&
                    this.ll.render({ meshes: this.meshes, mvp: o });
                }
              }),
              (s.pickRender = function () {}),
              (s.afterRender = function () {}),
              (s.PA = function () {
                return RenderHelper.SA(this.ll, this);
              }),
              i
            );
          })(Layer),
          version = "2.0.0";
        Object.defineProperty(exports, "Bezier", {
          Fr: !0,
          get: function r() {
            return bezierJs.Bezier;
          },
        }),
          (exports.AmbientLight = AmbientLight),
          (exports.Animation = Animation$1),
          (exports.$$ = AttributesDirty),
          (exports.Clip = Clip),
          (exports.ColorGLSL = ColorGLSL),
          (exports.Df = ColorPick),
          (exports.VC = ColorUtil$1),
          (exports.CommonUtil = CommonUtil$1),
          (exports.Container = Loca),
          (exports.Ef = Context),
          (exports.Dat = Dat),
          (exports.Vf = DataSource),
          (exports.tL = DefaultLight),
          (exports.wA = Defines),
          (exports.DirectionalLight = DirectionalLight),
          (exports.IC = DomUtil),
          (exports.Rf = Earth),
          (exports.Event = Event),
          (exports.H_ = GLTFLayer),
          (exports.GeoBufferSource = GeoBufferSource),
          (exports.GeoJSONSource = GeoJSONSource),
          (exports.lL = GeoUtil),
          (exports.TC = GeometryFusion),
          (exports.GeometryUtil = GeometryUtil),
          (exports.GltfLayer = GLTFLayer),
          (exports.GridLayer = GridLayer),
          (exports.HeatMapLayer = HeatMapLayer),
          (exports.HexagonLayer = HexagonLayer),
          (exports.IconLayer = IconLayer),
          (exports.w$ = LabelsDirty),
          (exports.LabelsLayer = LabelsLayer),
          (exports.iL = LagacyLight),
          (exports.S$ = LangUtil),
          (exports.Layer = Layer),
          (exports.Legend = Legend),
          (exports.Light = Light),
          (exports.xA = LightDirty),
          (exports.kA = LightGLSL),
          (exports.LineLayer = LineLayer),
          (exports.LinkLayer = LinkLayer),
          (exports.Map = Map$1),
          (exports.OC = MathUtil),
          (exports.Ff = Mercator),
          (exports.L$ = MeshDirty),
          (exports.C$ = MeshesDirty),
          (exports.eL = NewLight),
          (exports.CA = NotDirty),
          (exports.PointLayer = PointLayer),
          (exports.PointLight = PointLight),
          (exports.PolygonLayer = PolygonLayer),
          (exports.PrismLayer = PrismLayer),
          (exports.UC = Project),
          (exports.aL = ProjectInstance),
          (exports.Lf = Projection),
          (exports.PulseLineLayer = PulseLineLayer),
          (exports.PulseLinkLayer = PulseLinkLayer),
          (exports.AA = Render),
          (exports.RenderUtil = RenderUtil),
          (exports.ScatterLayer = Scatter),
          (exports.OA = Shader),
          (exports.FC = Style),
          (exports.RC = StyleInstance),
          (exports.M$ = SubRender),
          (exports.ViewControl = ViewControl$1),
          (exports.ZMarkerLayer = ZMarkerLayer),
          (exports.buryPoint = buryPoint),
          (exports.version = version),
          Object.defineProperty(exports, "i", { value: !0 });
      }
    );
  })(lbsLocaLayers_umd_tmp$1, lbsLocaLayers_umd_tmp$1.exports);
  var lbsLocaLayers_umd_tmp = lbsLocaLayers_umd_tmp$1.exports;
  return lbsLocaLayers_umd_tmp;
});
